(() => {
  var __defineProperty = Object.defineProperty;
  var __hasOwnProperty = Object.prototype.hasOwnProperty;
  var __commonJS = (callback, module) => () => {
    if (!module) {
      module = {exports: {}};
      callback(module.exports, module);
    }
    return module.exports;
  };
  var __markAsModule = (target) => {
    return __defineProperty(target, "__esModule", {value: true});
  };
  var __exportStar = (target, module) => {
    __markAsModule(target);
    if (typeof module === "object" || typeof module === "function") {
      for (let key in module)
        if (!__hasOwnProperty.call(target, key) && key !== "default")
          __defineProperty(target, key, {get: () => module[key], enumerable: true});
    }
    return target;
  };
  var __toModule = (module) => {
    if (module && module.__esModule)
      return module;
    return __exportStar(__defineProperty({}, "default", {value: module, enumerable: true}), module);
  };

  // node_modules/maplibre-gl/dist/maplibre-gl.js
  var require_maplibre_gl = __commonJS((exports, module) => {
    (function(global, factory) {
      typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : (global = global || self, global.maplibregl = factory());
    })(exports, function() {
      "use strict";
      var shared, worker, maplibregl;
      function define2(_, chunk) {
        if (!shared) {
          shared = chunk;
        } else if (!worker) {
          worker = chunk;
        } else {
          var workerBundleString = "var sharedChunk = {}; (" + shared + ")(sharedChunk); (" + worker + ")(sharedChunk);";
          var sharedChunk = {};
          shared(sharedChunk);
          maplibregl = chunk(sharedChunk);
          if (typeof window !== "undefined") {
            maplibregl.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], {type: "text/javascript"}));
          }
        }
      }
      define2(["exports"], function(t) {
        "use strict";
        function e(t2, e2) {
          return t2(e2 = {exports: {}}, e2.exports), e2.exports;
        }
        var r = n;
        function n(t2, e2, r2, n2) {
          this.cx = 3 * t2, this.bx = 3 * (r2 - t2) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e2, this.by = 3 * (n2 - e2) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t2, this.p1y = n2, this.p2x = r2, this.p2y = n2;
        }
        n.prototype.sampleCurveX = function(t2) {
          return ((this.ax * t2 + this.bx) * t2 + this.cx) * t2;
        }, n.prototype.sampleCurveY = function(t2) {
          return ((this.ay * t2 + this.by) * t2 + this.cy) * t2;
        }, n.prototype.sampleCurveDerivativeX = function(t2) {
          return (3 * this.ax * t2 + 2 * this.bx) * t2 + this.cx;
        }, n.prototype.solveCurveX = function(t2, e2) {
          var r2, n2, i2, a2, o2;
          for (e2 === void 0 && (e2 = 1e-6), i2 = t2, o2 = 0; o2 < 8; o2++) {
            if (a2 = this.sampleCurveX(i2) - t2, Math.abs(a2) < e2)
              return i2;
            var s2 = this.sampleCurveDerivativeX(i2);
            if (Math.abs(s2) < 1e-6)
              break;
            i2 -= a2 / s2;
          }
          if ((i2 = t2) < (r2 = 0))
            return r2;
          if (i2 > (n2 = 1))
            return n2;
          for (; r2 < n2; ) {
            if (a2 = this.sampleCurveX(i2), Math.abs(a2 - t2) < e2)
              return i2;
            t2 > a2 ? r2 = i2 : n2 = i2, i2 = 0.5 * (n2 - r2) + r2;
          }
          return i2;
        }, n.prototype.solve = function(t2, e2) {
          return this.sampleCurveY(this.solveCurveX(t2, e2));
        };
        var i = a;
        function a(t2, e2) {
          this.x = t2, this.y = e2;
        }
        a.prototype = {clone: function() {
          return new a(this.x, this.y);
        }, add: function(t2) {
          return this.clone()._add(t2);
        }, sub: function(t2) {
          return this.clone()._sub(t2);
        }, multByPoint: function(t2) {
          return this.clone()._multByPoint(t2);
        }, divByPoint: function(t2) {
          return this.clone()._divByPoint(t2);
        }, mult: function(t2) {
          return this.clone()._mult(t2);
        }, div: function(t2) {
          return this.clone()._div(t2);
        }, rotate: function(t2) {
          return this.clone()._rotate(t2);
        }, rotateAround: function(t2, e2) {
          return this.clone()._rotateAround(t2, e2);
        }, matMult: function(t2) {
          return this.clone()._matMult(t2);
        }, unit: function() {
          return this.clone()._unit();
        }, perp: function() {
          return this.clone()._perp();
        }, round: function() {
          return this.clone()._round();
        }, mag: function() {
          return Math.sqrt(this.x * this.x + this.y * this.y);
        }, equals: function(t2) {
          return this.x === t2.x && this.y === t2.y;
        }, dist: function(t2) {
          return Math.sqrt(this.distSqr(t2));
        }, distSqr: function(t2) {
          var e2 = t2.x - this.x, r2 = t2.y - this.y;
          return e2 * e2 + r2 * r2;
        }, angle: function() {
          return Math.atan2(this.y, this.x);
        }, angleTo: function(t2) {
          return Math.atan2(this.y - t2.y, this.x - t2.x);
        }, angleWith: function(t2) {
          return this.angleWithSep(t2.x, t2.y);
        }, angleWithSep: function(t2, e2) {
          return Math.atan2(this.x * e2 - this.y * t2, this.x * t2 + this.y * e2);
        }, _matMult: function(t2) {
          var e2 = t2[2] * this.x + t2[3] * this.y;
          return this.x = t2[0] * this.x + t2[1] * this.y, this.y = e2, this;
        }, _add: function(t2) {
          return this.x += t2.x, this.y += t2.y, this;
        }, _sub: function(t2) {
          return this.x -= t2.x, this.y -= t2.y, this;
        }, _mult: function(t2) {
          return this.x *= t2, this.y *= t2, this;
        }, _div: function(t2) {
          return this.x /= t2, this.y /= t2, this;
        }, _multByPoint: function(t2) {
          return this.x *= t2.x, this.y *= t2.y, this;
        }, _divByPoint: function(t2) {
          return this.x /= t2.x, this.y /= t2.y, this;
        }, _unit: function() {
          return this._div(this.mag()), this;
        }, _perp: function() {
          var t2 = this.y;
          return this.y = this.x, this.x = -t2, this;
        }, _rotate: function(t2) {
          var e2 = Math.cos(t2), r2 = Math.sin(t2), n2 = r2 * this.x + e2 * this.y;
          return this.x = e2 * this.x - r2 * this.y, this.y = n2, this;
        }, _rotateAround: function(t2, e2) {
          var r2 = Math.cos(t2), n2 = Math.sin(t2), i2 = e2.y + n2 * (this.x - e2.x) + r2 * (this.y - e2.y);
          return this.x = e2.x + r2 * (this.x - e2.x) - n2 * (this.y - e2.y), this.y = i2, this;
        }, _round: function() {
          return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
        }}, a.convert = function(t2) {
          return t2 instanceof a ? t2 : Array.isArray(t2) ? new a(t2[0], t2[1]) : t2;
        };
        var o = typeof self != "undefined" ? self : {}, s = Math.pow(2, 53) - 1;
        function u(t2, e2, n2, i2) {
          var a2 = new r(t2, e2, n2, i2);
          return function(t3) {
            return a2.solve(t3);
          };
        }
        var l = u(0.25, 0.1, 0.25, 1);
        function p(t2, e2, r2) {
          return Math.min(r2, Math.max(e2, t2));
        }
        function c(t2, e2, r2) {
          var n2 = r2 - e2, i2 = ((t2 - e2) % n2 + n2) % n2 + e2;
          return i2 === e2 ? r2 : i2;
        }
        function h(t2) {
          for (var e2 = [], r2 = arguments.length - 1; r2-- > 0; )
            e2[r2] = arguments[r2 + 1];
          for (var n2 = 0, i2 = e2; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            for (var o2 in a2)
              t2[o2] = a2[o2];
          }
          return t2;
        }
        var f = 1;
        function y() {
          return f++;
        }
        function d() {
          return function t2(e2) {
            return e2 ? (e2 ^ 16 * Math.random() >> e2 / 4).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, t2);
          }();
        }
        function m(t2) {
          return !!t2 && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t2);
        }
        function v(t2, e2) {
          t2.forEach(function(t3) {
            e2[t3] && (e2[t3] = e2[t3].bind(e2));
          });
        }
        function g(t2, e2) {
          return t2.indexOf(e2, t2.length - e2.length) !== -1;
        }
        function x(t2, e2, r2) {
          var n2 = {};
          for (var i2 in t2)
            n2[i2] = e2.call(r2 || this, t2[i2], i2, t2);
          return n2;
        }
        function b(t2, e2, r2) {
          var n2 = {};
          for (var i2 in t2)
            e2.call(r2 || this, t2[i2], i2, t2) && (n2[i2] = t2[i2]);
          return n2;
        }
        function w(t2) {
          return Array.isArray(t2) ? t2.map(w) : typeof t2 == "object" && t2 ? x(t2, w) : t2;
        }
        var _ = {};
        function A(t2) {
          _[t2] || (typeof console != "undefined" && console.warn(t2), _[t2] = true);
        }
        function S(t2, e2, r2) {
          return (r2.y - t2.y) * (e2.x - t2.x) > (e2.y - t2.y) * (r2.x - t2.x);
        }
        function k(t2) {
          for (var e2 = 0, r2 = 0, n2 = t2.length, i2 = n2 - 1, a2 = void 0, o2 = void 0; r2 < n2; i2 = r2++)
            e2 += ((o2 = t2[i2]).x - (a2 = t2[r2]).x) * (a2.y + o2.y);
          return e2;
        }
        function I() {
          return typeof WorkerGlobalScope != "undefined" && typeof self != "undefined" && self instanceof WorkerGlobalScope;
        }
        function z(t2) {
          var e2 = {};
          if (t2.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, function(t3, r3, n2, i2) {
            var a2 = n2 || i2;
            return e2[r3] = !a2 || a2.toLowerCase(), "";
          }), e2["max-age"]) {
            var r2 = parseInt(e2["max-age"], 10);
            isNaN(r2) ? delete e2["max-age"] : e2["max-age"] = r2;
          }
          return e2;
        }
        var C = null;
        function E(t2) {
          if (C == null) {
            var e2 = t2.navigator ? t2.navigator.userAgent : null;
            C = !!t2.safari || !(!e2 || !(/\b(iPad|iPhone|iPod)\b/.test(e2) || e2.match("Safari") && !e2.match("Chrome")));
          }
          return C;
        }
        function P(t2) {
          try {
            var e2 = o[t2];
            return e2.setItem("_mapbox_test_", 1), e2.removeItem("_mapbox_test_"), true;
          } catch (t3) {
            return false;
          }
        }
        var M, B, T, V, F = o.performance && o.performance.now ? o.performance.now.bind(o.performance) : Date.now.bind(Date), D = o.requestAnimationFrame || o.mozRequestAnimationFrame || o.webkitRequestAnimationFrame || o.msRequestAnimationFrame, L = o.cancelAnimationFrame || o.mozCancelAnimationFrame || o.webkitCancelAnimationFrame || o.msCancelAnimationFrame, O = {now: F, frame: function(t2) {
          var e2 = D(t2);
          return {cancel: function() {
            return L(e2);
          }};
        }, getImageData: function(t2, e2) {
          e2 === void 0 && (e2 = 0);
          var r2 = o.document.createElement("canvas"), n2 = r2.getContext("2d");
          if (!n2)
            throw new Error("failed to create canvas 2d context");
          return r2.width = t2.width, r2.height = t2.height, n2.drawImage(t2, 0, 0, t2.width, t2.height), n2.getImageData(-e2, -e2, t2.width + 2 * e2, t2.height + 2 * e2);
        }, resolveURL: function(t2) {
          return M || (M = o.document.createElement("a")), M.href = t2, M.href;
        }, hardwareConcurrency: o.navigator && o.navigator.hardwareConcurrency || 4, get devicePixelRatio() {
          return o.devicePixelRatio;
        }, get prefersReducedMotion() {
          return !!o.matchMedia && (B == null && (B = o.matchMedia("(prefers-reduced-motion: reduce)")), B.matches);
        }}, R = {API_URL: "https://api.mapbox.com", get EVENTS_URL() {
          return this.API_URL ? this.API_URL.indexOf("https://api.mapbox.cn") === 0 ? "https://events.mapbox.cn/events/v2" : this.API_URL.indexOf("https://api.mapbox.com") === 0 ? "https://events.mapbox.com/events/v2" : null : null;
        }, FEEDBACK_URL: "https://apps.mapbox.com/feedback", REQUIRE_ACCESS_TOKEN: true, ACCESS_TOKEN: null, MAX_PARALLEL_IMAGE_REQUESTS: 16}, U = {supported: false, testSupport: function(t2) {
          !j && V && (q ? N(t2) : T = t2);
        }}, j = false, q = false;
        function N(t2) {
          var e2 = t2.createTexture();
          t2.bindTexture(t2.TEXTURE_2D, e2);
          try {
            if (t2.texImage2D(t2.TEXTURE_2D, 0, t2.RGBA, t2.RGBA, t2.UNSIGNED_BYTE, V), t2.isContextLost())
              return;
            U.supported = true;
          } catch (t3) {
          }
          t2.deleteTexture(e2), j = true;
        }
        o.document && ((V = o.document.createElement("img")).onload = function() {
          T && N(T), T = null, q = true;
        }, V.onerror = function() {
          j = true, T = null;
        }, V.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
        var K = "01", G = function(t2, e2) {
          this._transformRequestFn = t2, this._customAccessToken = e2, this._createSkuToken();
        };
        function Z(t2) {
          return t2.indexOf("mapbox:") === 0;
        }
        G.prototype._createSkuToken = function() {
          var t2 = function() {
            for (var t3 = "", e2 = 0; e2 < 10; e2++)
              t3 += "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62 * Math.random())];
            return {token: ["1", K, t3].join(""), tokenExpiresAt: Date.now() + 432e5};
          }();
          this._skuToken = t2.token, this._skuTokenExpiresAt = t2.tokenExpiresAt;
        }, G.prototype._isSkuTokenExpired = function() {
          return Date.now() > this._skuTokenExpiresAt;
        }, G.prototype.transformRequest = function(t2, e2) {
          return this._transformRequestFn && this._transformRequestFn(t2, e2) || {url: t2};
        }, G.prototype.normalizeStyleURL = function(t2, e2) {
          if (!Z(t2))
            return t2;
          var r2 = Y(t2);
          return r2.path = "/styles/v1" + r2.path, this._makeAPIURL(r2, this._customAccessToken || e2);
        }, G.prototype.normalizeGlyphsURL = function(t2, e2) {
          if (!Z(t2))
            return t2;
          var r2 = Y(t2);
          return r2.path = "/fonts/v1" + r2.path, this._makeAPIURL(r2, this._customAccessToken || e2);
        }, G.prototype.normalizeSourceURL = function(t2, e2) {
          if (!Z(t2))
            return t2;
          var r2 = Y(t2);
          return r2.path = "/v4/" + r2.authority + ".json", r2.params.push("secure"), this._makeAPIURL(r2, this._customAccessToken || e2);
        }, G.prototype.normalizeSpriteURL = function(t2, e2, r2, n2) {
          var i2 = Y(t2);
          return Z(t2) ? (i2.path = "/styles/v1" + i2.path + "/sprite" + e2 + r2, this._makeAPIURL(i2, this._customAccessToken || n2)) : (i2.path += "" + e2 + r2, $(i2));
        }, G.prototype.normalizeTileURL = function(t2, e2) {
          if (this._isSkuTokenExpired() && this._createSkuToken(), t2 && !Z(t2))
            return t2;
          var r2 = Y(t2);
          r2.path = r2.path.replace(/(\.(png|jpg)\d*)(?=$)/, (O.devicePixelRatio >= 2 || e2 === 512 ? "@2x" : "") + (U.supported ? ".webp" : "$1")), r2.path = r2.path.replace(/^.+\/v4\//, "/"), r2.path = "/v4" + r2.path;
          var n2 = this._customAccessToken || function(t3) {
            for (var e3 = 0, r3 = t3; e3 < r3.length; e3 += 1) {
              var n3 = r3[e3].match(/^access_token=(.*)$/);
              if (n3)
                return n3[1];
            }
            return null;
          }(r2.params) || R.ACCESS_TOKEN;
          return R.REQUIRE_ACCESS_TOKEN && n2 && this._skuToken && r2.params.push("sku=" + this._skuToken), this._makeAPIURL(r2, n2);
        }, G.prototype.canonicalizeTileURL = function(t2, e2) {
          var r2 = Y(t2);
          if (!r2.path.match(/(^\/v4\/)/) || !r2.path.match(/\.[\w]+$/))
            return t2;
          var n2 = "mapbox://tiles/";
          n2 += r2.path.replace("/v4/", "");
          var i2 = r2.params;
          return e2 && (i2 = i2.filter(function(t3) {
            return !t3.match(/^access_token=/);
          })), i2.length && (n2 += "?" + i2.join("&")), n2;
        }, G.prototype.canonicalizeTileset = function(t2, e2) {
          for (var r2 = !!e2 && Z(e2), n2 = [], i2 = 0, a2 = t2.tiles || []; i2 < a2.length; i2 += 1) {
            var o2 = a2[i2];
            J(o2) ? n2.push(this.canonicalizeTileURL(o2, r2)) : n2.push(o2);
          }
          return n2;
        }, G.prototype._makeAPIURL = function(t2, e2) {
          var r2 = "See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes", n2 = Y(R.API_URL);
          if (t2.protocol = n2.protocol, t2.authority = n2.authority, t2.protocol === "http") {
            var i2 = t2.params.indexOf("secure");
            i2 >= 0 && t2.params.splice(i2, 1);
          }
          if (n2.path !== "/" && (t2.path = "" + n2.path + t2.path), !R.REQUIRE_ACCESS_TOKEN)
            return $(t2);
          if (!(e2 = e2 || R.ACCESS_TOKEN))
            throw new Error("An API access token is required to use Mapbox GL. " + r2);
          if (e2[0] === "s")
            throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). " + r2);
          return t2.params = t2.params.filter(function(t3) {
            return t3.indexOf("access_token") === -1;
          }), t2.params.push("access_token=" + e2), $(t2);
        };
        var X = /^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;
        function J(t2) {
          return X.test(t2);
        }
        var H = /^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;
        function Y(t2) {
          var e2 = t2.match(H);
          if (!e2)
            throw new Error("Unable to parse URL object");
          return {protocol: e2[1], authority: e2[2], path: e2[3] || "/", params: e2[4] ? e2[4].split("&") : []};
        }
        function $(t2) {
          var e2 = t2.params.length ? "?" + t2.params.join("&") : "";
          return t2.protocol + "://" + t2.authority + t2.path + e2;
        }
        function W(t2) {
          if (!t2)
            return null;
          var e2 = t2.split(".");
          if (!e2 || e2.length !== 3)
            return null;
          try {
            return JSON.parse(decodeURIComponent(o.atob(e2[1]).split("").map(function(t3) {
              return "%" + ("00" + t3.charCodeAt(0).toString(16)).slice(-2);
            }).join("")));
          } catch (t3) {
            return null;
          }
        }
        var Q = function(t2) {
          this.type = t2, this.anonId = null, this.eventData = {}, this.queue = [], this.pendingRequest = null;
        };
        Q.prototype.getStorageKey = function(t2) {
          var e2, r2 = W(R.ACCESS_TOKEN);
          return e2 = r2 && r2.u ? o.btoa(encodeURIComponent(r2.u).replace(/%([0-9A-F]{2})/g, function(t3, e3) {
            return String.fromCharCode(Number("0x" + e3));
          })) : R.ACCESS_TOKEN || "", t2 ? "mapbox.eventData." + t2 + ":" + e2 : "mapbox.eventData:" + e2;
        }, Q.prototype.fetchEventData = function() {
          var t2 = P("localStorage"), e2 = this.getStorageKey(), r2 = this.getStorageKey("uuid");
          if (t2)
            try {
              var n2 = o.localStorage.getItem(e2);
              n2 && (this.eventData = JSON.parse(n2));
              var i2 = o.localStorage.getItem(r2);
              i2 && (this.anonId = i2);
            } catch (t3) {
              A("Unable to read from LocalStorage");
            }
        }, Q.prototype.saveEventData = function() {
          var t2 = P("localStorage"), e2 = this.getStorageKey(), r2 = this.getStorageKey("uuid");
          if (t2)
            try {
              o.localStorage.setItem(r2, this.anonId), Object.keys(this.eventData).length >= 1 && o.localStorage.setItem(e2, JSON.stringify(this.eventData));
            } catch (t3) {
              A("Unable to write to LocalStorage");
            }
        }, Q.prototype.processRequests = function(t2) {
        }, Q.prototype.postEvent = function(t2, e2, r2, n2) {
          var i2 = this;
          if (R.EVENTS_URL) {
            var a2 = Y(R.EVENTS_URL);
            a2.params.push("access_token=" + (n2 || R.ACCESS_TOKEN || ""));
            var o2 = {event: this.type, created: new Date(t2).toISOString(), sdkIdentifier: "mapbox-gl-js", sdkVersion: "1.13.0-rc.5", skuId: K, userId: this.anonId}, s2 = e2 ? h(o2, e2) : o2, u2 = {url: $(a2), headers: {"Content-Type": "text/plain"}, body: JSON.stringify([s2])};
            this.pendingRequest = wt(u2, function(t3) {
              i2.pendingRequest = null, r2(t3), i2.saveEventData(), i2.processRequests(n2);
            });
          }
        }, Q.prototype.queueRequest = function(t2, e2) {
          this.queue.push(t2), this.processRequests(e2);
        };
        var tt, et, rt = function(t2) {
          function e2() {
            t2.call(this, "map.load"), this.success = {}, this.skuToken = "";
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.postMapLoadEvent = function(t3, e3, r2, n2) {
            this.skuToken = r2, (R.EVENTS_URL && n2 || R.ACCESS_TOKEN && Array.isArray(t3) && t3.some(function(t4) {
              return Z(t4) || J(t4);
            })) && this.queueRequest({id: e3, timestamp: Date.now()}, n2);
          }, e2.prototype.processRequests = function(t3) {
            var e3 = this;
            if (!this.pendingRequest && this.queue.length !== 0) {
              var r2 = this.queue.shift(), n2 = r2.id, i2 = r2.timestamp;
              n2 && this.success[n2] || (this.anonId || this.fetchEventData(), m(this.anonId) || (this.anonId = d()), this.postEvent(i2, {skuToken: this.skuToken}, function(t4) {
                t4 || n2 && (e3.success[n2] = true);
              }, t3));
            }
          }, e2;
        }(Q), nt = new (function(t2) {
          function e2(e3) {
            t2.call(this, "appUserTurnstile"), this._customAccessToken = e3;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.postTurnstileEvent = function(t3, e3) {
            R.EVENTS_URL && R.ACCESS_TOKEN && Array.isArray(t3) && t3.some(function(t4) {
              return Z(t4) || J(t4);
            }) && this.queueRequest(Date.now(), e3);
          }, e2.prototype.processRequests = function(t3) {
            var e3 = this;
            if (!this.pendingRequest && this.queue.length !== 0) {
              this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();
              var r2 = W(R.ACCESS_TOKEN), n2 = r2 ? r2.u : R.ACCESS_TOKEN, i2 = n2 !== this.eventData.tokenU;
              m(this.anonId) || (this.anonId = d(), i2 = true);
              var a2 = this.queue.shift();
              if (this.eventData.lastSuccess) {
                var o2 = new Date(this.eventData.lastSuccess), s2 = new Date(a2), u2 = (a2 - this.eventData.lastSuccess) / 864e5;
                i2 = i2 || u2 >= 1 || u2 < -1 || o2.getDate() !== s2.getDate();
              } else
                i2 = true;
              if (!i2)
                return this.processRequests();
              this.postEvent(a2, {"enabled.telemetry": false}, function(t4) {
                t4 || (e3.eventData.lastSuccess = a2, e3.eventData.tokenU = n2);
              }, t3);
            }
          }, e2;
        }(Q))(), it = nt.postTurnstileEvent.bind(nt), at = new rt(), ot = at.postMapLoadEvent.bind(at), st = 500, ut = 50;
        function lt() {
          o.caches && !tt && (tt = o.caches.open("mapbox-tiles"));
        }
        function pt(t2) {
          var e2 = t2.indexOf("?");
          return e2 < 0 ? t2 : t2.slice(0, e2);
        }
        var ct, ht = 1 / 0;
        function ft() {
          return ct == null && (ct = o.OffscreenCanvas && new o.OffscreenCanvas(1, 1).getContext("2d") && typeof o.createImageBitmap == "function"), ct;
        }
        var yt = {Unknown: "Unknown", Style: "Style", Source: "Source", Tile: "Tile", Glyphs: "Glyphs", SpriteImage: "SpriteImage", SpriteJSON: "SpriteJSON", Image: "Image"};
        typeof Object.freeze == "function" && Object.freeze(yt);
        var dt = function(t2) {
          function e2(e3, r2, n2) {
            r2 === 401 && J(n2) && (e3 += ": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"), t2.call(this, e3), this.status = r2, this.url = n2, this.name = this.constructor.name, this.message = e3;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.toString = function() {
            return this.name + ": " + this.message + " (" + this.status + "): " + this.url;
          }, e2;
        }(Error), mt = I() ? function() {
          return self.worker && self.worker.referrer;
        } : function() {
          return (o.location.protocol === "blob:" ? o.parent : o).location.href;
        };
        var vt, gt, xt = function(t2, e2) {
          if (!(/^file:/.test(r2 = t2.url) || /^file:/.test(mt()) && !/^\w+:/.test(r2))) {
            if (o.fetch && o.Request && o.AbortController && o.Request.prototype.hasOwnProperty("signal"))
              return function(t3, e3) {
                var r3, n2 = new o.AbortController(), i2 = new o.Request(t3.url, {method: t3.method || "GET", body: t3.body, credentials: t3.credentials, headers: t3.headers, referrer: mt(), signal: n2.signal}), a2 = false, s2 = false, u2 = (r3 = i2.url).indexOf("sku=") > 0 && J(r3);
                t3.type === "json" && i2.headers.set("Accept", "application/json");
                var l2 = function(r4, n3, a3) {
                  if (!s2) {
                    if (r4 && r4.message !== "SecurityError" && A(r4), n3 && a3)
                      return p2(n3);
                    var l3 = Date.now();
                    o.fetch(i2).then(function(r5) {
                      if (r5.ok) {
                        var n4 = u2 ? r5.clone() : null;
                        return p2(r5, n4, l3);
                      }
                      return e3(new dt(r5.statusText, r5.status, t3.url));
                    }).catch(function(t4) {
                      t4.code !== 20 && e3(new Error(t4.message));
                    });
                  }
                }, p2 = function(r4, n3, u3) {
                  (t3.type === "arrayBuffer" ? r4.arrayBuffer() : t3.type === "json" ? r4.json() : r4.text()).then(function(t4) {
                    s2 || (n3 && u3 && function(t5, e4, r5) {
                      if (lt(), tt) {
                        var n4 = {status: e4.status, statusText: e4.statusText, headers: new o.Headers()};
                        e4.headers.forEach(function(t6, e5) {
                          return n4.headers.set(e5, t6);
                        });
                        var i3 = z(e4.headers.get("Cache-Control") || "");
                        i3["no-store"] || (i3["max-age"] && n4.headers.set("Expires", new Date(r5 + 1e3 * i3["max-age"]).toUTCString()), new Date(n4.headers.get("Expires")).getTime() - r5 < 42e4 || function(t6, e5) {
                          if (et === void 0)
                            try {
                              new Response(new ReadableStream()), et = true;
                            } catch (t7) {
                              et = false;
                            }
                          et ? e5(t6.body) : t6.blob().then(e5);
                        }(e4, function(e5) {
                          var r6 = new o.Response(e5, n4);
                          lt(), tt && tt.then(function(e6) {
                            return e6.put(pt(t5.url), r6);
                          }).catch(function(t6) {
                            return A(t6.message);
                          });
                        }));
                      }
                    }(i2, n3, u3), a2 = true, e3(null, t4, r4.headers.get("Cache-Control"), r4.headers.get("Expires")));
                  }).catch(function(t4) {
                    s2 || e3(new Error(t4.message));
                  });
                };
                return u2 ? function(t4, e4) {
                  if (lt(), !tt)
                    return e4(null);
                  var r4 = pt(t4.url);
                  tt.then(function(t5) {
                    t5.match(r4).then(function(n3) {
                      var i3 = function(t6) {
                        if (!t6)
                          return false;
                        var e5 = new Date(t6.headers.get("Expires") || 0), r5 = z(t6.headers.get("Cache-Control") || "");
                        return e5 > Date.now() && !r5["no-cache"];
                      }(n3);
                      t5.delete(r4), i3 && t5.put(r4, n3.clone()), e4(null, n3, i3);
                    }).catch(e4);
                  }).catch(e4);
                }(i2, l2) : l2(null, null), {cancel: function() {
                  s2 = true, a2 || n2.abort();
                }};
              }(t2, e2);
            if (I() && self.worker && self.worker.actor)
              return self.worker.actor.send("getResource", t2, e2, void 0, true);
          }
          var r2;
          return function(t3, e3) {
            var r3 = new o.XMLHttpRequest();
            for (var n2 in r3.open(t3.method || "GET", t3.url, true), t3.type === "arrayBuffer" && (r3.responseType = "arraybuffer"), t3.headers)
              r3.setRequestHeader(n2, t3.headers[n2]);
            return t3.type === "json" && (r3.responseType = "text", r3.setRequestHeader("Accept", "application/json")), r3.withCredentials = t3.credentials === "include", r3.onerror = function() {
              e3(new Error(r3.statusText));
            }, r3.onload = function() {
              if ((r3.status >= 200 && r3.status < 300 || r3.status === 0) && r3.response !== null) {
                var n3 = r3.response;
                if (t3.type === "json")
                  try {
                    n3 = JSON.parse(r3.response);
                  } catch (t4) {
                    return e3(t4);
                  }
                e3(null, n3, r3.getResponseHeader("Cache-Control"), r3.getResponseHeader("Expires"));
              } else
                e3(new dt(r3.statusText, r3.status, t3.url));
            }, r3.send(t3.body), {cancel: function() {
              return r3.abort();
            }};
          }(t2, e2);
        }, bt = function(t2, e2) {
          return xt(h(t2, {type: "arrayBuffer"}), e2);
        }, wt = function(t2, e2) {
          return xt(h(t2, {method: "POST"}), e2);
        }, _t = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";
        vt = [], gt = 0;
        var At = function(t2, e2) {
          if (U.supported && (t2.headers || (t2.headers = {}), t2.headers.accept = "image/webp,*/*"), gt >= R.MAX_PARALLEL_IMAGE_REQUESTS) {
            var r2 = {requestParameters: t2, callback: e2, cancelled: false, cancel: function() {
              this.cancelled = true;
            }};
            return vt.push(r2), r2;
          }
          gt++;
          var n2 = false, i2 = function() {
            if (!n2)
              for (n2 = true, gt--; vt.length && gt < R.MAX_PARALLEL_IMAGE_REQUESTS; ) {
                var t3 = vt.shift();
                t3.cancelled || (t3.cancel = At(t3.requestParameters, t3.callback).cancel);
              }
          }, a2 = bt(t2, function(t3, r3, n3, a3) {
            i2(), t3 ? e2(t3) : r3 && (ft() ? function(t4, e3) {
              var r4 = new o.Blob([new Uint8Array(t4)], {type: "image/png"});
              o.createImageBitmap(r4).then(function(t5) {
                e3(null, t5);
              }).catch(function(t5) {
                e3(new Error("Could not load image because of " + t5.message + ". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));
              });
            }(r3, e2) : function(t4, e3, r4, n4) {
              var i3 = new o.Image(), a4 = o.URL;
              i3.onload = function() {
                e3(null, i3), a4.revokeObjectURL(i3.src), i3.onload = null, o.requestAnimationFrame(function() {
                  i3.src = _t;
                });
              }, i3.onerror = function() {
                return e3(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));
              };
              var s2 = new o.Blob([new Uint8Array(t4)], {type: "image/png"});
              i3.cacheControl = r4, i3.expires = n4, i3.src = t4.byteLength ? a4.createObjectURL(s2) : _t;
            }(r3, e2, n3, a3));
          });
          return {cancel: function() {
            a2.cancel(), i2();
          }};
        };
        function St(t2, e2, r2) {
          r2[t2] && r2[t2].indexOf(e2) !== -1 || (r2[t2] = r2[t2] || [], r2[t2].push(e2));
        }
        function kt(t2, e2, r2) {
          if (r2 && r2[t2]) {
            var n2 = r2[t2].indexOf(e2);
            n2 !== -1 && r2[t2].splice(n2, 1);
          }
        }
        var It = function(t2, e2) {
          e2 === void 0 && (e2 = {}), h(this, e2), this.type = t2;
        }, zt = function(t2) {
          function e2(e3, r2) {
            r2 === void 0 && (r2 = {}), t2.call(this, "error", h({error: e3}, r2));
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2;
        }(It), Ct = function() {
        };
        Ct.prototype.on = function(t2, e2) {
          return this._listeners = this._listeners || {}, St(t2, e2, this._listeners), this;
        }, Ct.prototype.off = function(t2, e2) {
          return kt(t2, e2, this._listeners), kt(t2, e2, this._oneTimeListeners), this;
        }, Ct.prototype.once = function(t2, e2) {
          return this._oneTimeListeners = this._oneTimeListeners || {}, St(t2, e2, this._oneTimeListeners), this;
        }, Ct.prototype.fire = function(t2, e2) {
          typeof t2 == "string" && (t2 = new It(t2, e2 || {}));
          var r2 = t2.type;
          if (this.listens(r2)) {
            t2.target = this;
            for (var n2 = 0, i2 = this._listeners && this._listeners[r2] ? this._listeners[r2].slice() : []; n2 < i2.length; n2 += 1)
              i2[n2].call(this, t2);
            for (var a2 = 0, o2 = this._oneTimeListeners && this._oneTimeListeners[r2] ? this._oneTimeListeners[r2].slice() : []; a2 < o2.length; a2 += 1) {
              var s2 = o2[a2];
              kt(r2, s2, this._oneTimeListeners), s2.call(this, t2);
            }
            var u2 = this._eventedParent;
            u2 && (h(t2, typeof this._eventedParentData == "function" ? this._eventedParentData() : this._eventedParentData), u2.fire(t2));
          } else
            t2 instanceof zt && console.error(t2.error);
          return this;
        }, Ct.prototype.listens = function(t2) {
          return this._listeners && this._listeners[t2] && this._listeners[t2].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t2] && this._oneTimeListeners[t2].length > 0 || this._eventedParent && this._eventedParent.listens(t2);
        }, Ct.prototype.setEventedParent = function(t2, e2) {
          return this._eventedParent = t2, this._eventedParentData = e2, this;
        };
        var Et = {$version: 8, $root: {version: {required: true, type: "enum", values: [8]}, name: {type: "string"}, metadata: {type: "*"}, center: {type: "array", value: "number"}, zoom: {type: "number"}, bearing: {type: "number", default: 0, period: 360, units: "degrees"}, pitch: {type: "number", default: 0, units: "degrees"}, light: {type: "light"}, sources: {required: true, type: "sources"}, sprite: {type: "string"}, glyphs: {type: "string"}, transition: {type: "transition"}, layers: {required: true, type: "array", value: "layer"}}, sources: {"*": {type: "source"}}, source: ["source_vector", "source_raster", "source_raster_dem", "source_geojson", "source_video", "source_image"], source_vector: {type: {required: true, type: "enum", values: {vector: {}}}, url: {type: "string"}, tiles: {type: "array", value: "string"}, bounds: {type: "array", value: "number", length: 4, default: [-180, -85.051129, 180, 85.051129]}, scheme: {type: "enum", values: {xyz: {}, tms: {}}, default: "xyz"}, minzoom: {type: "number", default: 0}, maxzoom: {type: "number", default: 22}, attribution: {type: "string"}, promoteId: {type: "promoteId"}, volatile: {type: "boolean", default: false}, "*": {type: "*"}}, source_raster: {type: {required: true, type: "enum", values: {raster: {}}}, url: {type: "string"}, tiles: {type: "array", value: "string"}, bounds: {type: "array", value: "number", length: 4, default: [-180, -85.051129, 180, 85.051129]}, minzoom: {type: "number", default: 0}, maxzoom: {type: "number", default: 22}, tileSize: {type: "number", default: 512, units: "pixels"}, scheme: {type: "enum", values: {xyz: {}, tms: {}}, default: "xyz"}, attribution: {type: "string"}, volatile: {type: "boolean", default: false}, "*": {type: "*"}}, source_raster_dem: {type: {required: true, type: "enum", values: {"raster-dem": {}}}, url: {type: "string"}, tiles: {type: "array", value: "string"}, bounds: {type: "array", value: "number", length: 4, default: [-180, -85.051129, 180, 85.051129]}, minzoom: {type: "number", default: 0}, maxzoom: {type: "number", default: 22}, tileSize: {type: "number", default: 512, units: "pixels"}, attribution: {type: "string"}, encoding: {type: "enum", values: {terrarium: {}, mapbox: {}}, default: "mapbox"}, volatile: {type: "boolean", default: false}, "*": {type: "*"}}, source_geojson: {type: {required: true, type: "enum", values: {geojson: {}}}, data: {type: "*"}, maxzoom: {type: "number", default: 18}, attribution: {type: "string"}, buffer: {type: "number", default: 128, maximum: 512, minimum: 0}, filter: {type: "*"}, tolerance: {type: "number", default: 0.375}, cluster: {type: "boolean", default: false}, clusterRadius: {type: "number", default: 50, minimum: 0}, clusterMaxZoom: {type: "number"}, clusterMinPoints: {type: "number"}, clusterProperties: {type: "*"}, lineMetrics: {type: "boolean", default: false}, generateId: {type: "boolean", default: false}, promoteId: {type: "promoteId"}}, source_video: {type: {required: true, type: "enum", values: {video: {}}}, urls: {required: true, type: "array", value: "string"}, coordinates: {required: true, type: "array", length: 4, value: {type: "array", length: 2, value: "number"}}}, source_image: {type: {required: true, type: "enum", values: {image: {}}}, url: {required: true, type: "string"}, coordinates: {required: true, type: "array", length: 4, value: {type: "array", length: 2, value: "number"}}}, layer: {id: {type: "string", required: true}, type: {type: "enum", values: {fill: {}, line: {}, symbol: {}, circle: {}, heatmap: {}, "fill-extrusion": {}, raster: {}, hillshade: {}, background: {}}, required: true}, metadata: {type: "*"}, source: {type: "string"}, "source-layer": {type: "string"}, minzoom: {type: "number", minimum: 0, maximum: 24}, maxzoom: {type: "number", minimum: 0, maximum: 24}, filter: {type: "filter"}, layout: {type: "layout"}, paint: {type: "paint"}}, layout: ["layout_fill", "layout_line", "layout_circle", "layout_heatmap", "layout_fill-extrusion", "layout_symbol", "layout_raster", "layout_hillshade", "layout_background"], layout_background: {visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_fill: {"fill-sort-key": {type: "number", expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_circle: {"circle-sort-key": {type: "number", expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_heatmap: {visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, "layout_fill-extrusion": {visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_line: {"line-cap": {type: "enum", values: {butt: {}, round: {}, square: {}}, default: "butt", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "line-join": {type: "enum", values: {bevel: {}, round: {}, miter: {}}, default: "miter", expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "line-miter-limit": {type: "number", default: 2, requires: [{"line-join": "miter"}], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "line-round-limit": {type: "number", default: 1.05, requires: [{"line-join": "round"}], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "line-sort-key": {type: "number", expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_symbol: {"symbol-placement": {type: "enum", values: {point: {}, line: {}, "line-center": {}}, default: "point", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "symbol-spacing": {type: "number", default: 250, minimum: 1, units: "pixels", requires: [{"symbol-placement": "line"}], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "symbol-avoid-edges": {type: "boolean", default: false, expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "symbol-sort-key": {type: "number", expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "symbol-z-order": {type: "enum", values: {auto: {}, "viewport-y": {}, source: {}}, default: "auto", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-allow-overlap": {type: "boolean", default: false, requires: ["icon-image"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-ignore-placement": {type: "boolean", default: false, requires: ["icon-image"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-optional": {type: "boolean", default: false, requires: ["icon-image", "text-field"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-rotation-alignment": {type: "enum", values: {map: {}, viewport: {}, auto: {}}, default: "auto", requires: ["icon-image"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-size": {type: "number", default: 1, minimum: 0, units: "factor of the original icon size", requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "icon-text-fit": {type: "enum", values: {none: {}, width: {}, height: {}, both: {}}, default: "none", requires: ["icon-image", "text-field"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-text-fit-padding": {type: "array", value: "number", length: 4, default: [0, 0, 0, 0], units: "pixels", requires: ["icon-image", "text-field", {"icon-text-fit": ["both", "width", "height"]}], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-image": {type: "resolvedImage", tokens: true, expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "icon-rotate": {type: "number", default: 0, period: 360, units: "degrees", requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "icon-padding": {type: "number", default: 2, minimum: 0, units: "pixels", requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-keep-upright": {type: "boolean", default: false, requires: ["icon-image", {"icon-rotation-alignment": "map"}, {"symbol-placement": ["line", "line-center"]}], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-offset": {type: "array", value: "number", length: 2, default: [0, 0], requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "icon-anchor": {type: "enum", values: {center: {}, left: {}, right: {}, top: {}, bottom: {}, "top-left": {}, "top-right": {}, "bottom-left": {}, "bottom-right": {}}, default: "center", requires: ["icon-image"], expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "icon-pitch-alignment": {type: "enum", values: {map: {}, viewport: {}, auto: {}}, default: "auto", requires: ["icon-image"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-pitch-alignment": {type: "enum", values: {map: {}, viewport: {}, auto: {}}, default: "auto", requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-rotation-alignment": {type: "enum", values: {map: {}, viewport: {}, auto: {}}, default: "auto", requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-field": {type: "formatted", default: "", tokens: true, expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-font": {type: "array", value: "string", default: ["Open Sans Regular", "Arial Unicode MS Regular"], requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-size": {type: "number", default: 16, minimum: 0, units: "pixels", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-max-width": {type: "number", default: 10, minimum: 0, units: "ems", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-line-height": {type: "number", default: 1.2, units: "ems", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-letter-spacing": {type: "number", default: 0, units: "ems", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-justify": {type: "enum", values: {auto: {}, left: {}, center: {}, right: {}}, default: "center", requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-radial-offset": {type: "number", units: "ems", default: 0, requires: ["text-field"], "property-type": "data-driven", expression: {interpolated: true, parameters: ["zoom", "feature"]}}, "text-variable-anchor": {type: "array", value: "enum", values: {center: {}, left: {}, right: {}, top: {}, bottom: {}, "top-left": {}, "top-right": {}, "bottom-left": {}, "bottom-right": {}}, requires: ["text-field", {"symbol-placement": ["point"]}], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-anchor": {type: "enum", values: {center: {}, left: {}, right: {}, top: {}, bottom: {}, "top-left": {}, "top-right": {}, "bottom-left": {}, "bottom-right": {}}, default: "center", requires: ["text-field", {"!": "text-variable-anchor"}], expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-max-angle": {type: "number", default: 45, units: "degrees", requires: ["text-field", {"symbol-placement": ["line", "line-center"]}], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-writing-mode": {type: "array", value: "enum", values: {horizontal: {}, vertical: {}}, requires: ["text-field", {"symbol-placement": ["point"]}], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-rotate": {type: "number", default: 0, period: 360, units: "degrees", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-padding": {type: "number", default: 2, minimum: 0, units: "pixels", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-keep-upright": {type: "boolean", default: true, requires: ["text-field", {"text-rotation-alignment": "map"}, {"symbol-placement": ["line", "line-center"]}], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-transform": {type: "enum", values: {none: {}, uppercase: {}, lowercase: {}}, default: "none", requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-offset": {type: "array", value: "number", units: "ems", length: 2, default: [0, 0], requires: ["text-field", {"!": "text-radial-offset"}], expression: {interpolated: true, parameters: ["zoom", "feature"]}, "property-type": "data-driven"}, "text-allow-overlap": {type: "boolean", default: false, requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-ignore-placement": {type: "boolean", default: false, requires: ["text-field"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-optional": {type: "boolean", default: false, requires: ["text-field", "icon-image"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_raster: {visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, layout_hillshade: {visibility: {type: "enum", values: {visible: {}, none: {}}, default: "visible", "property-type": "constant"}}, filter: {type: "array", value: "*"}, filter_operator: {type: "enum", values: {"==": {}, "!=": {}, ">": {}, ">=": {}, "<": {}, "<=": {}, in: {}, "!in": {}, all: {}, any: {}, none: {}, has: {}, "!has": {}, within: {}}}, geometry_type: {type: "enum", values: {Point: {}, LineString: {}, Polygon: {}}}, function: {expression: {type: "expression"}, stops: {type: "array", value: "function_stop"}, base: {type: "number", default: 1, minimum: 0}, property: {type: "string", default: "$zoom"}, type: {type: "enum", values: {identity: {}, exponential: {}, interval: {}, categorical: {}}, default: "exponential"}, colorSpace: {type: "enum", values: {rgb: {}, lab: {}, hcl: {}}, default: "rgb"}, default: {type: "*", required: false}}, function_stop: {type: "array", minimum: 0, maximum: 24, value: ["number", "color"], length: 2}, expression: {type: "array", value: "*", minimum: 1}, light: {anchor: {type: "enum", default: "viewport", values: {map: {}, viewport: {}}, "property-type": "data-constant", transition: false, expression: {interpolated: false, parameters: ["zoom"]}}, position: {type: "array", default: [1.15, 210, 30], length: 3, value: "number", "property-type": "data-constant", transition: true, expression: {interpolated: true, parameters: ["zoom"]}}, color: {type: "color", "property-type": "data-constant", default: "#ffffff", expression: {interpolated: true, parameters: ["zoom"]}, transition: true}, intensity: {type: "number", "property-type": "data-constant", default: 0.5, minimum: 0, maximum: 1, expression: {interpolated: true, parameters: ["zoom"]}, transition: true}}, paint: ["paint_fill", "paint_line", "paint_circle", "paint_heatmap", "paint_fill-extrusion", "paint_symbol", "paint_raster", "paint_hillshade", "paint_background"], paint_fill: {"fill-antialias": {type: "boolean", default: true, expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "fill-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "fill-color": {type: "color", default: "#000000", transition: true, requires: [{"!": "fill-pattern"}], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "fill-outline-color": {type: "color", transition: true, requires: [{"!": "fill-pattern"}, {"fill-antialias": true}], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "fill-translate": {type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "fill-translate-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "map", requires: ["fill-translate"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "fill-pattern": {type: "resolvedImage", transition: true, expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "cross-faded-data-driven"}}, "paint_fill-extrusion": {"fill-extrusion-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "fill-extrusion-color": {type: "color", default: "#000000", transition: true, requires: [{"!": "fill-extrusion-pattern"}], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "fill-extrusion-translate": {type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "fill-extrusion-translate-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "map", requires: ["fill-extrusion-translate"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "fill-extrusion-pattern": {type: "resolvedImage", transition: true, expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "cross-faded-data-driven"}, "fill-extrusion-height": {type: "number", default: 0, minimum: 0, units: "meters", transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "fill-extrusion-base": {type: "number", default: 0, minimum: 0, units: "meters", transition: true, requires: ["fill-extrusion-height"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "fill-extrusion-vertical-gradient": {type: "boolean", default: true, transition: false, expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}}, paint_line: {"line-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "line-color": {type: "color", default: "#000000", transition: true, requires: [{"!": "line-pattern"}], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "line-translate": {type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "line-translate-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "map", requires: ["line-translate"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "line-width": {type: "number", default: 1, minimum: 0, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "line-gap-width": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "line-offset": {type: "number", default: 0, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "line-blur": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "line-dasharray": {type: "array", value: "number", minimum: 0, transition: true, units: "line widths", requires: [{"!": "line-pattern"}], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "cross-faded"}, "line-pattern": {type: "resolvedImage", transition: true, expression: {interpolated: false, parameters: ["zoom", "feature"]}, "property-type": "cross-faded-data-driven"}, "line-gradient": {type: "color", transition: false, requires: [{"!": "line-dasharray"}, {"!": "line-pattern"}, {source: "geojson", has: {lineMetrics: true}}], expression: {interpolated: true, parameters: ["line-progress"]}, "property-type": "color-ramp"}}, paint_circle: {"circle-radius": {type: "number", default: 5, minimum: 0, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "circle-color": {type: "color", default: "#000000", transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "circle-blur": {type: "number", default: 0, transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "circle-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "circle-translate": {type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "circle-translate-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "map", requires: ["circle-translate"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "circle-pitch-scale": {type: "enum", values: {map: {}, viewport: {}}, default: "map", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "circle-pitch-alignment": {type: "enum", values: {map: {}, viewport: {}}, default: "viewport", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "circle-stroke-width": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "circle-stroke-color": {type: "color", default: "#000000", transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "circle-stroke-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}}, paint_heatmap: {"heatmap-radius": {type: "number", default: 30, minimum: 1, transition: true, units: "pixels", expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "heatmap-weight": {type: "number", default: 1, minimum: 0, transition: false, expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "heatmap-intensity": {type: "number", default: 1, minimum: 0, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "heatmap-color": {type: "color", default: ["interpolate", ["linear"], ["heatmap-density"], 0, "rgba(0, 0, 255, 0)", 0.1, "royalblue", 0.3, "cyan", 0.5, "lime", 0.7, "yellow", 1, "red"], transition: false, expression: {interpolated: true, parameters: ["heatmap-density"]}, "property-type": "color-ramp"}, "heatmap-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}}, paint_symbol: {"icon-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "icon-color": {type: "color", default: "#000000", transition: true, requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "icon-halo-color": {type: "color", default: "rgba(0, 0, 0, 0)", transition: true, requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "icon-halo-width": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "icon-halo-blur": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "icon-translate": {type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", requires: ["icon-image"], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "icon-translate-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "map", requires: ["icon-image", "icon-translate"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "text-color": {type: "color", default: "#000000", transition: true, overridable: true, requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "text-halo-color": {type: "color", default: "rgba(0, 0, 0, 0)", transition: true, requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "text-halo-width": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "text-halo-blur": {type: "number", default: 0, minimum: 0, transition: true, units: "pixels", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom", "feature", "feature-state"]}, "property-type": "data-driven"}, "text-translate": {type: "array", value: "number", length: 2, default: [0, 0], transition: true, units: "pixels", requires: ["text-field"], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "text-translate-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "map", requires: ["text-field", "text-translate"], expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}}, paint_raster: {"raster-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-hue-rotate": {type: "number", default: 0, period: 360, transition: true, units: "degrees", expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-brightness-min": {type: "number", default: 0, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-brightness-max": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-saturation": {type: "number", default: 0, minimum: -1, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-contrast": {type: "number", default: 0, minimum: -1, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-resampling": {type: "enum", values: {linear: {}, nearest: {}}, default: "linear", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "raster-fade-duration": {type: "number", default: 300, minimum: 0, transition: false, units: "milliseconds", expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}}, paint_hillshade: {"hillshade-illumination-direction": {type: "number", default: 335, minimum: 0, maximum: 359, transition: false, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "hillshade-illumination-anchor": {type: "enum", values: {map: {}, viewport: {}}, default: "viewport", expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "data-constant"}, "hillshade-exaggeration": {type: "number", default: 0.5, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "hillshade-shadow-color": {type: "color", default: "#000000", transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "hillshade-highlight-color": {type: "color", default: "#FFFFFF", transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "hillshade-accent-color": {type: "color", default: "#000000", transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}}, paint_background: {"background-color": {type: "color", default: "#000000", transition: true, requires: [{"!": "background-pattern"}], expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}, "background-pattern": {type: "resolvedImage", transition: true, expression: {interpolated: false, parameters: ["zoom"]}, "property-type": "cross-faded"}, "background-opacity": {type: "number", default: 1, minimum: 0, maximum: 1, transition: true, expression: {interpolated: true, parameters: ["zoom"]}, "property-type": "data-constant"}}, transition: {duration: {type: "number", default: 300, minimum: 0, units: "milliseconds"}, delay: {type: "number", default: 0, minimum: 0, units: "milliseconds"}}, "property-type": {"data-driven": {type: "property-type"}, "cross-faded": {type: "property-type"}, "cross-faded-data-driven": {type: "property-type"}, "color-ramp": {type: "property-type"}, "data-constant": {type: "property-type"}, constant: {type: "property-type"}}, promoteId: {"*": {type: "string"}}}, Pt = function(t2, e2, r2, n2) {
          this.message = (t2 ? t2 + ": " : "") + r2, n2 && (this.identifier = n2), e2 != null && e2.__line__ && (this.line = e2.__line__);
        };
        function Mt(t2) {
          var e2 = t2.value;
          return e2 ? [new Pt(t2.key, e2, "constants have been deprecated as of v8")] : [];
        }
        function Bt(t2) {
          for (var e2 = [], r2 = arguments.length - 1; r2-- > 0; )
            e2[r2] = arguments[r2 + 1];
          for (var n2 = 0, i2 = e2; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            for (var o2 in a2)
              t2[o2] = a2[o2];
          }
          return t2;
        }
        function Tt(t2) {
          return t2 instanceof Number || t2 instanceof String || t2 instanceof Boolean ? t2.valueOf() : t2;
        }
        function Vt(t2) {
          if (Array.isArray(t2))
            return t2.map(Vt);
          if (t2 instanceof Object && !(t2 instanceof Number || t2 instanceof String || t2 instanceof Boolean)) {
            var e2 = {};
            for (var r2 in t2)
              e2[r2] = Vt(t2[r2]);
            return e2;
          }
          return Tt(t2);
        }
        var Ft = function(t2) {
          function e2(e3, r2) {
            t2.call(this, r2), this.message = r2, this.key = e3;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2;
        }(Error), Dt = function(t2, e2) {
          e2 === void 0 && (e2 = []), this.parent = t2, this.bindings = {};
          for (var r2 = 0, n2 = e2; r2 < n2.length; r2 += 1) {
            var i2 = n2[r2];
            this.bindings[i2[0]] = i2[1];
          }
        };
        Dt.prototype.concat = function(t2) {
          return new Dt(this, t2);
        }, Dt.prototype.get = function(t2) {
          if (this.bindings[t2])
            return this.bindings[t2];
          if (this.parent)
            return this.parent.get(t2);
          throw new Error(t2 + " not found in scope.");
        }, Dt.prototype.has = function(t2) {
          return !!this.bindings[t2] || !!this.parent && this.parent.has(t2);
        };
        var Lt = {kind: "null"}, Ot = {kind: "number"}, Rt = {kind: "string"}, Ut = {kind: "boolean"}, jt = {kind: "color"}, qt = {kind: "object"}, Nt = {kind: "value"}, Kt = {kind: "collator"}, Gt = {kind: "formatted"}, Zt = {kind: "resolvedImage"};
        function Xt(t2, e2) {
          return {kind: "array", itemType: t2, N: e2};
        }
        function Jt(t2) {
          if (t2.kind === "array") {
            var e2 = Jt(t2.itemType);
            return typeof t2.N == "number" ? "array<" + e2 + ", " + t2.N + ">" : t2.itemType.kind === "value" ? "array" : "array<" + e2 + ">";
          }
          return t2.kind;
        }
        var Ht = [Lt, Ot, Rt, Ut, jt, Gt, qt, Xt(Nt), Zt];
        function Yt(t2, e2) {
          if (e2.kind === "error")
            return null;
          if (t2.kind === "array") {
            if (e2.kind === "array" && (e2.N === 0 && e2.itemType.kind === "value" || !Yt(t2.itemType, e2.itemType)) && (typeof t2.N != "number" || t2.N === e2.N))
              return null;
          } else {
            if (t2.kind === e2.kind)
              return null;
            if (t2.kind === "value") {
              for (var r2 = 0, n2 = Ht; r2 < n2.length; r2 += 1)
                if (!Yt(n2[r2], e2))
                  return null;
            }
          }
          return "Expected " + Jt(t2) + " but found " + Jt(e2) + " instead.";
        }
        function $t(t2, e2) {
          return e2.some(function(e3) {
            return e3.kind === t2.kind;
          });
        }
        function Wt(t2, e2) {
          return e2.some(function(e3) {
            return e3 === "null" ? t2 === null : e3 === "array" ? Array.isArray(t2) : e3 === "object" ? t2 && !Array.isArray(t2) && typeof t2 == "object" : e3 === typeof t2;
          });
        }
        var Qt = e(function(t2, e2) {
          var r2 = {transparent: [0, 0, 0, 0], aliceblue: [240, 248, 255, 1], antiquewhite: [250, 235, 215, 1], aqua: [0, 255, 255, 1], aquamarine: [127, 255, 212, 1], azure: [240, 255, 255, 1], beige: [245, 245, 220, 1], bisque: [255, 228, 196, 1], black: [0, 0, 0, 1], blanchedalmond: [255, 235, 205, 1], blue: [0, 0, 255, 1], blueviolet: [138, 43, 226, 1], brown: [165, 42, 42, 1], burlywood: [222, 184, 135, 1], cadetblue: [95, 158, 160, 1], chartreuse: [127, 255, 0, 1], chocolate: [210, 105, 30, 1], coral: [255, 127, 80, 1], cornflowerblue: [100, 149, 237, 1], cornsilk: [255, 248, 220, 1], crimson: [220, 20, 60, 1], cyan: [0, 255, 255, 1], darkblue: [0, 0, 139, 1], darkcyan: [0, 139, 139, 1], darkgoldenrod: [184, 134, 11, 1], darkgray: [169, 169, 169, 1], darkgreen: [0, 100, 0, 1], darkgrey: [169, 169, 169, 1], darkkhaki: [189, 183, 107, 1], darkmagenta: [139, 0, 139, 1], darkolivegreen: [85, 107, 47, 1], darkorange: [255, 140, 0, 1], darkorchid: [153, 50, 204, 1], darkred: [139, 0, 0, 1], darksalmon: [233, 150, 122, 1], darkseagreen: [143, 188, 143, 1], darkslateblue: [72, 61, 139, 1], darkslategray: [47, 79, 79, 1], darkslategrey: [47, 79, 79, 1], darkturquoise: [0, 206, 209, 1], darkviolet: [148, 0, 211, 1], deeppink: [255, 20, 147, 1], deepskyblue: [0, 191, 255, 1], dimgray: [105, 105, 105, 1], dimgrey: [105, 105, 105, 1], dodgerblue: [30, 144, 255, 1], firebrick: [178, 34, 34, 1], floralwhite: [255, 250, 240, 1], forestgreen: [34, 139, 34, 1], fuchsia: [255, 0, 255, 1], gainsboro: [220, 220, 220, 1], ghostwhite: [248, 248, 255, 1], gold: [255, 215, 0, 1], goldenrod: [218, 165, 32, 1], gray: [128, 128, 128, 1], green: [0, 128, 0, 1], greenyellow: [173, 255, 47, 1], grey: [128, 128, 128, 1], honeydew: [240, 255, 240, 1], hotpink: [255, 105, 180, 1], indianred: [205, 92, 92, 1], indigo: [75, 0, 130, 1], ivory: [255, 255, 240, 1], khaki: [240, 230, 140, 1], lavender: [230, 230, 250, 1], lavenderblush: [255, 240, 245, 1], lawngreen: [124, 252, 0, 1], lemonchiffon: [255, 250, 205, 1], lightblue: [173, 216, 230, 1], lightcoral: [240, 128, 128, 1], lightcyan: [224, 255, 255, 1], lightgoldenrodyellow: [250, 250, 210, 1], lightgray: [211, 211, 211, 1], lightgreen: [144, 238, 144, 1], lightgrey: [211, 211, 211, 1], lightpink: [255, 182, 193, 1], lightsalmon: [255, 160, 122, 1], lightseagreen: [32, 178, 170, 1], lightskyblue: [135, 206, 250, 1], lightslategray: [119, 136, 153, 1], lightslategrey: [119, 136, 153, 1], lightsteelblue: [176, 196, 222, 1], lightyellow: [255, 255, 224, 1], lime: [0, 255, 0, 1], limegreen: [50, 205, 50, 1], linen: [250, 240, 230, 1], magenta: [255, 0, 255, 1], maroon: [128, 0, 0, 1], mediumaquamarine: [102, 205, 170, 1], mediumblue: [0, 0, 205, 1], mediumorchid: [186, 85, 211, 1], mediumpurple: [147, 112, 219, 1], mediumseagreen: [60, 179, 113, 1], mediumslateblue: [123, 104, 238, 1], mediumspringgreen: [0, 250, 154, 1], mediumturquoise: [72, 209, 204, 1], mediumvioletred: [199, 21, 133, 1], midnightblue: [25, 25, 112, 1], mintcream: [245, 255, 250, 1], mistyrose: [255, 228, 225, 1], moccasin: [255, 228, 181, 1], navajowhite: [255, 222, 173, 1], navy: [0, 0, 128, 1], oldlace: [253, 245, 230, 1], olive: [128, 128, 0, 1], olivedrab: [107, 142, 35, 1], orange: [255, 165, 0, 1], orangered: [255, 69, 0, 1], orchid: [218, 112, 214, 1], palegoldenrod: [238, 232, 170, 1], palegreen: [152, 251, 152, 1], paleturquoise: [175, 238, 238, 1], palevioletred: [219, 112, 147, 1], papayawhip: [255, 239, 213, 1], peachpuff: [255, 218, 185, 1], peru: [205, 133, 63, 1], pink: [255, 192, 203, 1], plum: [221, 160, 221, 1], powderblue: [176, 224, 230, 1], purple: [128, 0, 128, 1], rebeccapurple: [102, 51, 153, 1], red: [255, 0, 0, 1], rosybrown: [188, 143, 143, 1], royalblue: [65, 105, 225, 1], saddlebrown: [139, 69, 19, 1], salmon: [250, 128, 114, 1], sandybrown: [244, 164, 96, 1], seagreen: [46, 139, 87, 1], seashell: [255, 245, 238, 1], sienna: [160, 82, 45, 1], silver: [192, 192, 192, 1], skyblue: [135, 206, 235, 1], slateblue: [106, 90, 205, 1], slategray: [112, 128, 144, 1], slategrey: [112, 128, 144, 1], snow: [255, 250, 250, 1], springgreen: [0, 255, 127, 1], steelblue: [70, 130, 180, 1], tan: [210, 180, 140, 1], teal: [0, 128, 128, 1], thistle: [216, 191, 216, 1], tomato: [255, 99, 71, 1], turquoise: [64, 224, 208, 1], violet: [238, 130, 238, 1], wheat: [245, 222, 179, 1], white: [255, 255, 255, 1], whitesmoke: [245, 245, 245, 1], yellow: [255, 255, 0, 1], yellowgreen: [154, 205, 50, 1]};
          function n2(t3) {
            return (t3 = Math.round(t3)) < 0 ? 0 : t3 > 255 ? 255 : t3;
          }
          function i2(t3) {
            return n2(t3[t3.length - 1] === "%" ? parseFloat(t3) / 100 * 255 : parseInt(t3));
          }
          function a2(t3) {
            return (e3 = t3[t3.length - 1] === "%" ? parseFloat(t3) / 100 : parseFloat(t3)) < 0 ? 0 : e3 > 1 ? 1 : e3;
            var e3;
          }
          function o2(t3, e3, r3) {
            return r3 < 0 ? r3 += 1 : r3 > 1 && (r3 -= 1), 6 * r3 < 1 ? t3 + (e3 - t3) * r3 * 6 : 2 * r3 < 1 ? e3 : 3 * r3 < 2 ? t3 + (e3 - t3) * (2 / 3 - r3) * 6 : t3;
          }
          try {
            e2.parseCSSColor = function(t3) {
              var e3, s2 = t3.replace(/ /g, "").toLowerCase();
              if (s2 in r2)
                return r2[s2].slice();
              if (s2[0] === "#")
                return s2.length === 4 ? (e3 = parseInt(s2.substr(1), 16)) >= 0 && e3 <= 4095 ? [(3840 & e3) >> 4 | (3840 & e3) >> 8, 240 & e3 | (240 & e3) >> 4, 15 & e3 | (15 & e3) << 4, 1] : null : s2.length === 7 && (e3 = parseInt(s2.substr(1), 16)) >= 0 && e3 <= 16777215 ? [(16711680 & e3) >> 16, (65280 & e3) >> 8, 255 & e3, 1] : null;
              var u2 = s2.indexOf("("), l2 = s2.indexOf(")");
              if (u2 !== -1 && l2 + 1 === s2.length) {
                var p2 = s2.substr(0, u2), c2 = s2.substr(u2 + 1, l2 - (u2 + 1)).split(","), h2 = 1;
                switch (p2) {
                  case "rgba":
                    if (c2.length !== 4)
                      return null;
                    h2 = a2(c2.pop());
                  case "rgb":
                    return c2.length !== 3 ? null : [i2(c2[0]), i2(c2[1]), i2(c2[2]), h2];
                  case "hsla":
                    if (c2.length !== 4)
                      return null;
                    h2 = a2(c2.pop());
                  case "hsl":
                    if (c2.length !== 3)
                      return null;
                    var f2 = (parseFloat(c2[0]) % 360 + 360) % 360 / 360, y2 = a2(c2[1]), d2 = a2(c2[2]), m2 = d2 <= 0.5 ? d2 * (y2 + 1) : d2 + y2 - d2 * y2, v2 = 2 * d2 - m2;
                    return [n2(255 * o2(v2, m2, f2 + 1 / 3)), n2(255 * o2(v2, m2, f2)), n2(255 * o2(v2, m2, f2 - 1 / 3)), h2];
                  default:
                    return null;
                }
              }
              return null;
            };
          } catch (t3) {
          }
        }).parseCSSColor, te = function(t2, e2, r2, n2) {
          n2 === void 0 && (n2 = 1), this.r = t2, this.g = e2, this.b = r2, this.a = n2;
        };
        te.parse = function(t2) {
          if (t2) {
            if (t2 instanceof te)
              return t2;
            if (typeof t2 == "string") {
              var e2 = Qt(t2);
              if (e2)
                return new te(e2[0] / 255 * e2[3], e2[1] / 255 * e2[3], e2[2] / 255 * e2[3], e2[3]);
            }
          }
        }, te.prototype.toString = function() {
          var t2 = this.toArray(), e2 = t2[1], r2 = t2[2], n2 = t2[3];
          return "rgba(" + Math.round(t2[0]) + "," + Math.round(e2) + "," + Math.round(r2) + "," + n2 + ")";
        }, te.prototype.toArray = function() {
          var t2 = this.a;
          return t2 === 0 ? [0, 0, 0, 0] : [255 * this.r / t2, 255 * this.g / t2, 255 * this.b / t2, t2];
        }, te.black = new te(0, 0, 0, 1), te.white = new te(1, 1, 1, 1), te.transparent = new te(0, 0, 0, 0), te.red = new te(1, 0, 0, 1);
        var ee = function(t2, e2, r2) {
          this.sensitivity = t2 ? e2 ? "variant" : "case" : e2 ? "accent" : "base", this.locale = r2, this.collator = new Intl.Collator(this.locale ? this.locale : [], {sensitivity: this.sensitivity, usage: "search"});
        };
        ee.prototype.compare = function(t2, e2) {
          return this.collator.compare(t2, e2);
        }, ee.prototype.resolvedLocale = function() {
          return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale;
        };
        var re = function(t2, e2, r2, n2, i2) {
          this.text = t2, this.image = e2, this.scale = r2, this.fontStack = n2, this.textColor = i2;
        }, ne = function(t2) {
          this.sections = t2;
        };
        ne.fromString = function(t2) {
          return new ne([new re(t2, null, null, null, null)]);
        }, ne.prototype.isEmpty = function() {
          return this.sections.length === 0 || !this.sections.some(function(t2) {
            return t2.text.length !== 0 || t2.image && t2.image.name.length !== 0;
          });
        }, ne.factory = function(t2) {
          return t2 instanceof ne ? t2 : ne.fromString(t2);
        }, ne.prototype.toString = function() {
          return this.sections.length === 0 ? "" : this.sections.map(function(t2) {
            return t2.text;
          }).join("");
        }, ne.prototype.serialize = function() {
          for (var t2 = ["format"], e2 = 0, r2 = this.sections; e2 < r2.length; e2 += 1) {
            var n2 = r2[e2];
            if (n2.image)
              t2.push(["image", n2.image.name]);
            else {
              t2.push(n2.text);
              var i2 = {};
              n2.fontStack && (i2["text-font"] = ["literal", n2.fontStack.split(",")]), n2.scale && (i2["font-scale"] = n2.scale), n2.textColor && (i2["text-color"] = ["rgba"].concat(n2.textColor.toArray())), t2.push(i2);
            }
          }
          return t2;
        };
        var ie = function(t2) {
          this.name = t2.name, this.available = t2.available;
        };
        function ae(t2, e2, r2, n2) {
          return typeof t2 == "number" && t2 >= 0 && t2 <= 255 && typeof e2 == "number" && e2 >= 0 && e2 <= 255 && typeof r2 == "number" && r2 >= 0 && r2 <= 255 ? n2 === void 0 || typeof n2 == "number" && n2 >= 0 && n2 <= 1 ? null : "Invalid rgba value [" + [t2, e2, r2, n2].join(", ") + "]: 'a' must be between 0 and 1." : "Invalid rgba value [" + (typeof n2 == "number" ? [t2, e2, r2, n2] : [t2, e2, r2]).join(", ") + "]: 'r', 'g', and 'b' must be between 0 and 255.";
        }
        function oe(t2) {
          if (t2 === null)
            return true;
          if (typeof t2 == "string")
            return true;
          if (typeof t2 == "boolean")
            return true;
          if (typeof t2 == "number")
            return true;
          if (t2 instanceof te)
            return true;
          if (t2 instanceof ee)
            return true;
          if (t2 instanceof ne)
            return true;
          if (t2 instanceof ie)
            return true;
          if (Array.isArray(t2)) {
            for (var e2 = 0, r2 = t2; e2 < r2.length; e2 += 1)
              if (!oe(r2[e2]))
                return false;
            return true;
          }
          if (typeof t2 == "object") {
            for (var n2 in t2)
              if (!oe(t2[n2]))
                return false;
            return true;
          }
          return false;
        }
        function se(t2) {
          if (t2 === null)
            return Lt;
          if (typeof t2 == "string")
            return Rt;
          if (typeof t2 == "boolean")
            return Ut;
          if (typeof t2 == "number")
            return Ot;
          if (t2 instanceof te)
            return jt;
          if (t2 instanceof ee)
            return Kt;
          if (t2 instanceof ne)
            return Gt;
          if (t2 instanceof ie)
            return Zt;
          if (Array.isArray(t2)) {
            for (var e2, r2 = t2.length, n2 = 0, i2 = t2; n2 < i2.length; n2 += 1) {
              var a2 = se(i2[n2]);
              if (e2) {
                if (e2 === a2)
                  continue;
                e2 = Nt;
                break;
              }
              e2 = a2;
            }
            return Xt(e2 || Nt, r2);
          }
          return qt;
        }
        function ue(t2) {
          var e2 = typeof t2;
          return t2 === null ? "" : e2 === "string" || e2 === "number" || e2 === "boolean" ? String(t2) : t2 instanceof te || t2 instanceof ne || t2 instanceof ie ? t2.toString() : JSON.stringify(t2);
        }
        ie.prototype.toString = function() {
          return this.name;
        }, ie.fromString = function(t2) {
          return t2 ? new ie({name: t2, available: false}) : null;
        }, ie.prototype.serialize = function() {
          return ["image", this.name];
        };
        var le = function(t2, e2) {
          this.type = t2, this.value = e2;
        };
        le.parse = function(t2, e2) {
          if (t2.length !== 2)
            return e2.error("'literal' expression requires exactly one argument, but found " + (t2.length - 1) + " instead.");
          if (!oe(t2[1]))
            return e2.error("invalid value");
          var r2 = t2[1], n2 = se(r2), i2 = e2.expectedType;
          return n2.kind !== "array" || n2.N !== 0 || !i2 || i2.kind !== "array" || typeof i2.N == "number" && i2.N !== 0 || (n2 = i2), new le(n2, r2);
        }, le.prototype.evaluate = function() {
          return this.value;
        }, le.prototype.eachChild = function() {
        }, le.prototype.outputDefined = function() {
          return true;
        }, le.prototype.serialize = function() {
          return this.type.kind === "array" || this.type.kind === "object" ? ["literal", this.value] : this.value instanceof te ? ["rgba"].concat(this.value.toArray()) : this.value instanceof ne ? this.value.serialize() : this.value;
        };
        var pe = function(t2) {
          this.name = "ExpressionEvaluationError", this.message = t2;
        };
        pe.prototype.toJSON = function() {
          return this.message;
        };
        var ce = {string: Rt, number: Ot, boolean: Ut, object: qt}, he = function(t2, e2) {
          this.type = t2, this.args = e2;
        };
        he.parse = function(t2, e2) {
          if (t2.length < 2)
            return e2.error("Expected at least one argument.");
          var r2, n2 = 1, i2 = t2[0];
          if (i2 === "array") {
            var a2, o2;
            if (t2.length > 2) {
              var s2 = t2[1];
              if (typeof s2 != "string" || !(s2 in ce) || s2 === "object")
                return e2.error('The item type argument of "array" must be one of string, number, boolean', 1);
              a2 = ce[s2], n2++;
            } else
              a2 = Nt;
            if (t2.length > 3) {
              if (t2[2] !== null && (typeof t2[2] != "number" || t2[2] < 0 || t2[2] !== Math.floor(t2[2])))
                return e2.error('The length argument to "array" must be a positive integer literal', 2);
              o2 = t2[2], n2++;
            }
            r2 = Xt(a2, o2);
          } else
            r2 = ce[i2];
          for (var u2 = []; n2 < t2.length; n2++) {
            var l2 = e2.parse(t2[n2], n2, Nt);
            if (!l2)
              return null;
            u2.push(l2);
          }
          return new he(r2, u2);
        }, he.prototype.evaluate = function(t2) {
          for (var e2 = 0; e2 < this.args.length; e2++) {
            var r2 = this.args[e2].evaluate(t2);
            if (!Yt(this.type, se(r2)))
              return r2;
            if (e2 === this.args.length - 1)
              throw new pe("Expected value to be of type " + Jt(this.type) + ", but found " + Jt(se(r2)) + " instead.");
          }
          return null;
        }, he.prototype.eachChild = function(t2) {
          this.args.forEach(t2);
        }, he.prototype.outputDefined = function() {
          return this.args.every(function(t2) {
            return t2.outputDefined();
          });
        }, he.prototype.serialize = function() {
          var t2 = this.type, e2 = [t2.kind];
          if (t2.kind === "array") {
            var r2 = t2.itemType;
            if (r2.kind === "string" || r2.kind === "number" || r2.kind === "boolean") {
              e2.push(r2.kind);
              var n2 = t2.N;
              (typeof n2 == "number" || this.args.length > 1) && e2.push(n2);
            }
          }
          return e2.concat(this.args.map(function(t3) {
            return t3.serialize();
          }));
        };
        var fe = function(t2) {
          this.type = Gt, this.sections = t2;
        };
        fe.parse = function(t2, e2) {
          if (t2.length < 2)
            return e2.error("Expected at least one argument.");
          var r2 = t2[1];
          if (!Array.isArray(r2) && typeof r2 == "object")
            return e2.error("First argument must be an image or text section.");
          for (var n2 = [], i2 = false, a2 = 1; a2 <= t2.length - 1; ++a2) {
            var o2 = t2[a2];
            if (i2 && typeof o2 == "object" && !Array.isArray(o2)) {
              i2 = false;
              var s2 = null;
              if (o2["font-scale"] && !(s2 = e2.parse(o2["font-scale"], 1, Ot)))
                return null;
              var u2 = null;
              if (o2["text-font"] && !(u2 = e2.parse(o2["text-font"], 1, Xt(Rt))))
                return null;
              var l2 = null;
              if (o2["text-color"] && !(l2 = e2.parse(o2["text-color"], 1, jt)))
                return null;
              var p2 = n2[n2.length - 1];
              p2.scale = s2, p2.font = u2, p2.textColor = l2;
            } else {
              var c2 = e2.parse(t2[a2], 1, Nt);
              if (!c2)
                return null;
              var h2 = c2.type.kind;
              if (h2 !== "string" && h2 !== "value" && h2 !== "null" && h2 !== "resolvedImage")
                return e2.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
              i2 = true, n2.push({content: c2, scale: null, font: null, textColor: null});
            }
          }
          return new fe(n2);
        }, fe.prototype.evaluate = function(t2) {
          return new ne(this.sections.map(function(e2) {
            var r2 = e2.content.evaluate(t2);
            return se(r2) === Zt ? new re("", r2, null, null, null) : new re(ue(r2), null, e2.scale ? e2.scale.evaluate(t2) : null, e2.font ? e2.font.evaluate(t2).join(",") : null, e2.textColor ? e2.textColor.evaluate(t2) : null);
          }));
        }, fe.prototype.eachChild = function(t2) {
          for (var e2 = 0, r2 = this.sections; e2 < r2.length; e2 += 1) {
            var n2 = r2[e2];
            t2(n2.content), n2.scale && t2(n2.scale), n2.font && t2(n2.font), n2.textColor && t2(n2.textColor);
          }
        }, fe.prototype.outputDefined = function() {
          return false;
        }, fe.prototype.serialize = function() {
          for (var t2 = ["format"], e2 = 0, r2 = this.sections; e2 < r2.length; e2 += 1) {
            var n2 = r2[e2];
            t2.push(n2.content.serialize());
            var i2 = {};
            n2.scale && (i2["font-scale"] = n2.scale.serialize()), n2.font && (i2["text-font"] = n2.font.serialize()), n2.textColor && (i2["text-color"] = n2.textColor.serialize()), t2.push(i2);
          }
          return t2;
        };
        var ye = function(t2) {
          this.type = Zt, this.input = t2;
        };
        ye.parse = function(t2, e2) {
          if (t2.length !== 2)
            return e2.error("Expected two arguments.");
          var r2 = e2.parse(t2[1], 1, Rt);
          return r2 ? new ye(r2) : e2.error("No image name provided.");
        }, ye.prototype.evaluate = function(t2) {
          var e2 = this.input.evaluate(t2), r2 = ie.fromString(e2);
          return r2 && t2.availableImages && (r2.available = t2.availableImages.indexOf(e2) > -1), r2;
        }, ye.prototype.eachChild = function(t2) {
          t2(this.input);
        }, ye.prototype.outputDefined = function() {
          return false;
        }, ye.prototype.serialize = function() {
          return ["image", this.input.serialize()];
        };
        var de = {"to-boolean": Ut, "to-color": jt, "to-number": Ot, "to-string": Rt}, me = function(t2, e2) {
          this.type = t2, this.args = e2;
        };
        me.parse = function(t2, e2) {
          if (t2.length < 2)
            return e2.error("Expected at least one argument.");
          var r2 = t2[0];
          if ((r2 === "to-boolean" || r2 === "to-string") && t2.length !== 2)
            return e2.error("Expected one argument.");
          for (var n2 = de[r2], i2 = [], a2 = 1; a2 < t2.length; a2++) {
            var o2 = e2.parse(t2[a2], a2, Nt);
            if (!o2)
              return null;
            i2.push(o2);
          }
          return new me(n2, i2);
        }, me.prototype.evaluate = function(t2) {
          if (this.type.kind === "boolean")
            return Boolean(this.args[0].evaluate(t2));
          if (this.type.kind === "color") {
            for (var e2, r2, n2 = 0, i2 = this.args; n2 < i2.length; n2 += 1) {
              if (r2 = null, (e2 = i2[n2].evaluate(t2)) instanceof te)
                return e2;
              if (typeof e2 == "string") {
                var a2 = t2.parseColor(e2);
                if (a2)
                  return a2;
              } else if (Array.isArray(e2) && !(r2 = e2.length < 3 || e2.length > 4 ? "Invalid rbga value " + JSON.stringify(e2) + ": expected an array containing either three or four numeric values." : ae(e2[0], e2[1], e2[2], e2[3])))
                return new te(e2[0] / 255, e2[1] / 255, e2[2] / 255, e2[3]);
            }
            throw new pe(r2 || "Could not parse color from value '" + (typeof e2 == "string" ? e2 : String(JSON.stringify(e2))) + "'");
          }
          if (this.type.kind === "number") {
            for (var o2 = null, s2 = 0, u2 = this.args; s2 < u2.length; s2 += 1) {
              if ((o2 = u2[s2].evaluate(t2)) === null)
                return 0;
              var l2 = Number(o2);
              if (!isNaN(l2))
                return l2;
            }
            throw new pe("Could not convert " + JSON.stringify(o2) + " to number.");
          }
          return this.type.kind === "formatted" ? ne.fromString(ue(this.args[0].evaluate(t2))) : this.type.kind === "resolvedImage" ? ie.fromString(ue(this.args[0].evaluate(t2))) : ue(this.args[0].evaluate(t2));
        }, me.prototype.eachChild = function(t2) {
          this.args.forEach(t2);
        }, me.prototype.outputDefined = function() {
          return this.args.every(function(t2) {
            return t2.outputDefined();
          });
        }, me.prototype.serialize = function() {
          if (this.type.kind === "formatted")
            return new fe([{content: this.args[0], scale: null, font: null, textColor: null}]).serialize();
          if (this.type.kind === "resolvedImage")
            return new ye(this.args[0]).serialize();
          var t2 = ["to-" + this.type.kind];
          return this.eachChild(function(e2) {
            t2.push(e2.serialize());
          }), t2;
        };
        var ve = ["Unknown", "Point", "LineString", "Polygon"], ge = function() {
          this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null;
        };
        ge.prototype.id = function() {
          return this.feature && "id" in this.feature ? this.feature.id : null;
        }, ge.prototype.geometryType = function() {
          return this.feature ? typeof this.feature.type == "number" ? ve[this.feature.type] : this.feature.type : null;
        }, ge.prototype.geometry = function() {
          return this.feature && "geometry" in this.feature ? this.feature.geometry : null;
        }, ge.prototype.canonicalID = function() {
          return this.canonical;
        }, ge.prototype.properties = function() {
          return this.feature && this.feature.properties || {};
        }, ge.prototype.parseColor = function(t2) {
          var e2 = this._parseColorCache[t2];
          return e2 || (e2 = this._parseColorCache[t2] = te.parse(t2)), e2;
        };
        var xe = function(t2, e2, r2, n2) {
          this.name = t2, this.type = e2, this._evaluate = r2, this.args = n2;
        };
        xe.prototype.evaluate = function(t2) {
          return this._evaluate(t2, this.args);
        }, xe.prototype.eachChild = function(t2) {
          this.args.forEach(t2);
        }, xe.prototype.outputDefined = function() {
          return false;
        }, xe.prototype.serialize = function() {
          return [this.name].concat(this.args.map(function(t2) {
            return t2.serialize();
          }));
        }, xe.parse = function(t2, e2) {
          var r2, n2 = t2[0], i2 = xe.definitions[n2];
          if (!i2)
            return e2.error('Unknown expression "' + n2 + '". If you wanted a literal array, use ["literal", [...]].', 0);
          for (var a2 = Array.isArray(i2) ? i2[0] : i2.type, o2 = Array.isArray(i2) ? [[i2[1], i2[2]]] : i2.overloads, s2 = o2.filter(function(e3) {
            var r3 = e3[0];
            return !Array.isArray(r3) || r3.length === t2.length - 1;
          }), u2 = null, l2 = 0, p2 = s2; l2 < p2.length; l2 += 1) {
            var c2 = p2[l2], h2 = c2[0], f2 = c2[1];
            u2 = new je(e2.registry, e2.path, null, e2.scope);
            for (var y2 = [], d2 = false, m2 = 1; m2 < t2.length; m2++) {
              var v2 = t2[m2], g2 = Array.isArray(h2) ? h2[m2 - 1] : h2.type, x2 = u2.parse(v2, 1 + y2.length, g2);
              if (!x2) {
                d2 = true;
                break;
              }
              y2.push(x2);
            }
            if (!d2)
              if (Array.isArray(h2) && h2.length !== y2.length)
                u2.error("Expected " + h2.length + " arguments, but found " + y2.length + " instead.");
              else {
                for (var b2 = 0; b2 < y2.length; b2++) {
                  var w2 = Array.isArray(h2) ? h2[b2] : h2.type, _2 = y2[b2];
                  u2.concat(b2 + 1).checkSubtype(w2, _2.type);
                }
                if (u2.errors.length === 0)
                  return new xe(n2, a2, f2, y2);
              }
          }
          if (s2.length === 1)
            (r2 = e2.errors).push.apply(r2, u2.errors);
          else {
            for (var A2 = (s2.length ? s2 : o2).map(function(t3) {
              var e3;
              return e3 = t3[0], Array.isArray(e3) ? "(" + e3.map(Jt).join(", ") + ")" : "(" + Jt(e3.type) + "...)";
            }).join(" | "), S2 = [], k2 = 1; k2 < t2.length; k2++) {
              var I2 = e2.parse(t2[k2], 1 + S2.length);
              if (!I2)
                return null;
              S2.push(Jt(I2.type));
            }
            e2.error("Expected arguments of type " + A2 + ", but found (" + S2.join(", ") + ") instead.");
          }
          return null;
        }, xe.register = function(t2, e2) {
          for (var r2 in xe.definitions = e2, e2)
            t2[r2] = xe;
        };
        var be = function(t2, e2, r2) {
          this.type = Kt, this.locale = r2, this.caseSensitive = t2, this.diacriticSensitive = e2;
        };
        function we(t2, e2) {
          t2[0] = Math.min(t2[0], e2[0]), t2[1] = Math.min(t2[1], e2[1]), t2[2] = Math.max(t2[2], e2[0]), t2[3] = Math.max(t2[3], e2[1]);
        }
        function _e(t2, e2) {
          return !(t2[0] <= e2[0] || t2[2] >= e2[2] || t2[1] <= e2[1] || t2[3] >= e2[3]);
        }
        function Ae(t2, e2) {
          var r2 = (180 + t2[0]) / 360, n2 = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t2[1] * Math.PI / 360))) / 360, i2 = Math.pow(2, e2.z);
          return [Math.round(r2 * i2 * 8192), Math.round(n2 * i2 * 8192)];
        }
        function Se(t2, e2, r2) {
          return e2[1] > t2[1] != r2[1] > t2[1] && t2[0] < (r2[0] - e2[0]) * (t2[1] - e2[1]) / (r2[1] - e2[1]) + e2[0];
        }
        function ke(t2, e2) {
          for (var r2, n2, i2, a2, o2, s2, u2, l2 = false, p2 = 0, c2 = e2.length; p2 < c2; p2++)
            for (var h2 = e2[p2], f2 = 0, y2 = h2.length; f2 < y2 - 1; f2++) {
              if ((a2 = (r2 = t2)[0] - (n2 = h2[f2])[0]) * (u2 = r2[1] - (i2 = h2[f2 + 1])[1]) - (s2 = r2[0] - i2[0]) * (o2 = r2[1] - n2[1]) == 0 && a2 * s2 <= 0 && o2 * u2 <= 0)
                return false;
              Se(t2, h2[f2], h2[f2 + 1]) && (l2 = !l2);
            }
          return l2;
        }
        function Ie(t2, e2) {
          for (var r2 = 0; r2 < e2.length; r2++)
            if (ke(t2, e2[r2]))
              return true;
          return false;
        }
        function ze(t2, e2, r2, n2) {
          var i2 = n2[0] - r2[0], a2 = n2[1] - r2[1], o2 = (t2[0] - r2[0]) * a2 - i2 * (t2[1] - r2[1]), s2 = (e2[0] - r2[0]) * a2 - i2 * (e2[1] - r2[1]);
          return o2 > 0 && s2 < 0 || o2 < 0 && s2 > 0;
        }
        function Ce(t2, e2, r2) {
          for (var n2 = 0, i2 = r2; n2 < i2.length; n2 += 1)
            for (var a2 = i2[n2], o2 = 0; o2 < a2.length - 1; ++o2)
              if ((c2 = [(p2 = a2[o2 + 1])[0] - (l2 = a2[o2])[0], p2[1] - l2[1]])[0] * (h2 = [(u2 = e2)[0] - (s2 = t2)[0], u2[1] - s2[1]])[1] - c2[1] * h2[0] != 0 && ze(s2, u2, l2, p2) && ze(l2, p2, s2, u2))
                return true;
          var s2, u2, l2, p2, c2, h2;
          return false;
        }
        function Ee(t2, e2) {
          for (var r2 = 0; r2 < t2.length; ++r2)
            if (!ke(t2[r2], e2))
              return false;
          for (var n2 = 0; n2 < t2.length - 1; ++n2)
            if (Ce(t2[n2], t2[n2 + 1], e2))
              return false;
          return true;
        }
        function Pe(t2, e2) {
          for (var r2 = 0; r2 < e2.length; r2++)
            if (Ee(t2, e2[r2]))
              return true;
          return false;
        }
        function Me(t2, e2, r2) {
          for (var n2 = [], i2 = 0; i2 < t2.length; i2++) {
            for (var a2 = [], o2 = 0; o2 < t2[i2].length; o2++) {
              var s2 = Ae(t2[i2][o2], r2);
              we(e2, s2), a2.push(s2);
            }
            n2.push(a2);
          }
          return n2;
        }
        function Be(t2, e2, r2) {
          for (var n2 = [], i2 = 0; i2 < t2.length; i2++) {
            var a2 = Me(t2[i2], e2, r2);
            n2.push(a2);
          }
          return n2;
        }
        function Te(t2, e2, r2, n2) {
          if (t2[0] < r2[0] || t2[0] > r2[2]) {
            var i2 = 0.5 * n2, a2 = t2[0] - r2[0] > i2 ? -n2 : r2[0] - t2[0] > i2 ? n2 : 0;
            a2 === 0 && (a2 = t2[0] - r2[2] > i2 ? -n2 : r2[2] - t2[0] > i2 ? n2 : 0), t2[0] += a2;
          }
          we(e2, t2);
        }
        function Ve(t2, e2, r2, n2) {
          for (var i2 = 8192 * Math.pow(2, n2.z), a2 = [8192 * n2.x, 8192 * n2.y], o2 = [], s2 = 0, u2 = t2; s2 < u2.length; s2 += 1)
            for (var l2 = 0, p2 = u2[s2]; l2 < p2.length; l2 += 1) {
              var c2 = p2[l2], h2 = [c2.x + a2[0], c2.y + a2[1]];
              Te(h2, e2, r2, i2), o2.push(h2);
            }
          return o2;
        }
        function Fe(t2, e2, r2, n2) {
          for (var i2, a2 = 8192 * Math.pow(2, n2.z), o2 = [8192 * n2.x, 8192 * n2.y], s2 = [], u2 = 0, l2 = t2; u2 < l2.length; u2 += 1) {
            for (var p2 = [], c2 = 0, h2 = l2[u2]; c2 < h2.length; c2 += 1) {
              var f2 = h2[c2], y2 = [f2.x + o2[0], f2.y + o2[1]];
              we(e2, y2), p2.push(y2);
            }
            s2.push(p2);
          }
          if (e2[2] - e2[0] <= a2 / 2) {
            (i2 = e2)[0] = i2[1] = 1 / 0, i2[2] = i2[3] = -1 / 0;
            for (var d2 = 0, m2 = s2; d2 < m2.length; d2 += 1)
              for (var v2 = 0, g2 = m2[d2]; v2 < g2.length; v2 += 1)
                Te(g2[v2], e2, r2, a2);
          }
          return s2;
        }
        be.parse = function(t2, e2) {
          if (t2.length !== 2)
            return e2.error("Expected one argument.");
          var r2 = t2[1];
          if (typeof r2 != "object" || Array.isArray(r2))
            return e2.error("Collator options argument must be an object.");
          var n2 = e2.parse(r2["case-sensitive"] !== void 0 && r2["case-sensitive"], 1, Ut);
          if (!n2)
            return null;
          var i2 = e2.parse(r2["diacritic-sensitive"] !== void 0 && r2["diacritic-sensitive"], 1, Ut);
          if (!i2)
            return null;
          var a2 = null;
          return r2.locale && !(a2 = e2.parse(r2.locale, 1, Rt)) ? null : new be(n2, i2, a2);
        }, be.prototype.evaluate = function(t2) {
          return new ee(this.caseSensitive.evaluate(t2), this.diacriticSensitive.evaluate(t2), this.locale ? this.locale.evaluate(t2) : null);
        }, be.prototype.eachChild = function(t2) {
          t2(this.caseSensitive), t2(this.diacriticSensitive), this.locale && t2(this.locale);
        }, be.prototype.outputDefined = function() {
          return false;
        }, be.prototype.serialize = function() {
          var t2 = {};
          return t2["case-sensitive"] = this.caseSensitive.serialize(), t2["diacritic-sensitive"] = this.diacriticSensitive.serialize(), this.locale && (t2.locale = this.locale.serialize()), ["collator", t2];
        };
        var De = function(t2, e2) {
          this.type = Ut, this.geojson = t2, this.geometries = e2;
        };
        function Le(t2) {
          if (t2 instanceof xe) {
            if (t2.name === "get" && t2.args.length === 1)
              return false;
            if (t2.name === "feature-state")
              return false;
            if (t2.name === "has" && t2.args.length === 1)
              return false;
            if (t2.name === "properties" || t2.name === "geometry-type" || t2.name === "id")
              return false;
            if (/^filter-/.test(t2.name))
              return false;
          }
          if (t2 instanceof De)
            return false;
          var e2 = true;
          return t2.eachChild(function(t3) {
            e2 && !Le(t3) && (e2 = false);
          }), e2;
        }
        function Oe(t2) {
          if (t2 instanceof xe && t2.name === "feature-state")
            return false;
          var e2 = true;
          return t2.eachChild(function(t3) {
            e2 && !Oe(t3) && (e2 = false);
          }), e2;
        }
        function Re(t2, e2) {
          if (t2 instanceof xe && e2.indexOf(t2.name) >= 0)
            return false;
          var r2 = true;
          return t2.eachChild(function(t3) {
            r2 && !Re(t3, e2) && (r2 = false);
          }), r2;
        }
        De.parse = function(t2, e2) {
          if (t2.length !== 2)
            return e2.error("'within' expression requires exactly one argument, but found " + (t2.length - 1) + " instead.");
          if (oe(t2[1])) {
            var r2 = t2[1];
            if (r2.type === "FeatureCollection")
              for (var n2 = 0; n2 < r2.features.length; ++n2) {
                var i2 = r2.features[n2].geometry.type;
                if (i2 === "Polygon" || i2 === "MultiPolygon")
                  return new De(r2, r2.features[n2].geometry);
              }
            else if (r2.type === "Feature") {
              var a2 = r2.geometry.type;
              if (a2 === "Polygon" || a2 === "MultiPolygon")
                return new De(r2, r2.geometry);
            } else if (r2.type === "Polygon" || r2.type === "MultiPolygon")
              return new De(r2, r2);
          }
          return e2.error("'within' expression requires valid geojson object that contains polygon geometry type.");
        }, De.prototype.evaluate = function(t2) {
          if (t2.geometry() != null && t2.canonicalID() != null) {
            if (t2.geometryType() === "Point")
              return function(t3, e2) {
                var r2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], n2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], i2 = t3.canonicalID();
                if (e2.type === "Polygon") {
                  var a2 = Me(e2.coordinates, n2, i2), o2 = Ve(t3.geometry(), r2, n2, i2);
                  if (!_e(r2, n2))
                    return false;
                  for (var s2 = 0, u2 = o2; s2 < u2.length; s2 += 1)
                    if (!ke(u2[s2], a2))
                      return false;
                }
                if (e2.type === "MultiPolygon") {
                  var l2 = Be(e2.coordinates, n2, i2), p2 = Ve(t3.geometry(), r2, n2, i2);
                  if (!_e(r2, n2))
                    return false;
                  for (var c2 = 0, h2 = p2; c2 < h2.length; c2 += 1)
                    if (!Ie(h2[c2], l2))
                      return false;
                }
                return true;
              }(t2, this.geometries);
            if (t2.geometryType() === "LineString")
              return function(t3, e2) {
                var r2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], n2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], i2 = t3.canonicalID();
                if (e2.type === "Polygon") {
                  var a2 = Me(e2.coordinates, n2, i2), o2 = Fe(t3.geometry(), r2, n2, i2);
                  if (!_e(r2, n2))
                    return false;
                  for (var s2 = 0, u2 = o2; s2 < u2.length; s2 += 1)
                    if (!Ee(u2[s2], a2))
                      return false;
                }
                if (e2.type === "MultiPolygon") {
                  var l2 = Be(e2.coordinates, n2, i2), p2 = Fe(t3.geometry(), r2, n2, i2);
                  if (!_e(r2, n2))
                    return false;
                  for (var c2 = 0, h2 = p2; c2 < h2.length; c2 += 1)
                    if (!Pe(h2[c2], l2))
                      return false;
                }
                return true;
              }(t2, this.geometries);
          }
          return false;
        }, De.prototype.eachChild = function() {
        }, De.prototype.outputDefined = function() {
          return true;
        }, De.prototype.serialize = function() {
          return ["within", this.geojson];
        };
        var Ue = function(t2, e2) {
          this.type = e2.type, this.name = t2, this.boundExpression = e2;
        };
        Ue.parse = function(t2, e2) {
          if (t2.length !== 2 || typeof t2[1] != "string")
            return e2.error("'var' expression requires exactly one string literal argument.");
          var r2 = t2[1];
          return e2.scope.has(r2) ? new Ue(r2, e2.scope.get(r2)) : e2.error('Unknown variable "' + r2 + '". Make sure "' + r2 + '" has been bound in an enclosing "let" expression before using it.', 1);
        }, Ue.prototype.evaluate = function(t2) {
          return this.boundExpression.evaluate(t2);
        }, Ue.prototype.eachChild = function() {
        }, Ue.prototype.outputDefined = function() {
          return false;
        }, Ue.prototype.serialize = function() {
          return ["var", this.name];
        };
        var je = function(t2, e2, r2, n2, i2) {
          e2 === void 0 && (e2 = []), n2 === void 0 && (n2 = new Dt()), i2 === void 0 && (i2 = []), this.registry = t2, this.path = e2, this.key = e2.map(function(t3) {
            return "[" + t3 + "]";
          }).join(""), this.scope = n2, this.errors = i2, this.expectedType = r2;
        };
        function qe(t2, e2) {
          for (var r2, n2 = t2.length - 1, i2 = 0, a2 = n2, o2 = 0; i2 <= a2; )
            if ((r2 = t2[o2 = Math.floor((i2 + a2) / 2)]) <= e2) {
              if (o2 === n2 || e2 < t2[o2 + 1])
                return o2;
              i2 = o2 + 1;
            } else {
              if (!(r2 > e2))
                throw new pe("Input is not a number.");
              a2 = o2 - 1;
            }
          return 0;
        }
        je.prototype.parse = function(t2, e2, r2, n2, i2) {
          return i2 === void 0 && (i2 = {}), e2 ? this.concat(e2, r2, n2)._parse(t2, i2) : this._parse(t2, i2);
        }, je.prototype._parse = function(t2, e2) {
          function r2(t3, e3, r3) {
            return r3 === "assert" ? new he(e3, [t3]) : r3 === "coerce" ? new me(e3, [t3]) : t3;
          }
          if (t2 !== null && typeof t2 != "string" && typeof t2 != "boolean" && typeof t2 != "number" || (t2 = ["literal", t2]), Array.isArray(t2)) {
            if (t2.length === 0)
              return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
            var n2 = t2[0];
            if (typeof n2 != "string")
              return this.error("Expression name must be a string, but found " + typeof n2 + ' instead. If you wanted a literal array, use ["literal", [...]].', 0), null;
            var i2 = this.registry[n2];
            if (i2) {
              var a2 = i2.parse(t2, this);
              if (!a2)
                return null;
              if (this.expectedType) {
                var o2 = this.expectedType, s2 = a2.type;
                if (o2.kind !== "string" && o2.kind !== "number" && o2.kind !== "boolean" && o2.kind !== "object" && o2.kind !== "array" || s2.kind !== "value")
                  if (o2.kind !== "color" && o2.kind !== "formatted" && o2.kind !== "resolvedImage" || s2.kind !== "value" && s2.kind !== "string") {
                    if (this.checkSubtype(o2, s2))
                      return null;
                  } else
                    a2 = r2(a2, o2, e2.typeAnnotation || "coerce");
                else
                  a2 = r2(a2, o2, e2.typeAnnotation || "assert");
              }
              if (!(a2 instanceof le) && a2.type.kind !== "resolvedImage" && function t3(e3) {
                if (e3 instanceof Ue)
                  return t3(e3.boundExpression);
                if (e3 instanceof xe && e3.name === "error")
                  return false;
                if (e3 instanceof be)
                  return false;
                if (e3 instanceof De)
                  return false;
                var r3 = e3 instanceof me || e3 instanceof he, n3 = true;
                return e3.eachChild(function(e4) {
                  n3 = r3 ? n3 && t3(e4) : n3 && e4 instanceof le;
                }), !!n3 && Le(e3) && Re(e3, ["zoom", "heatmap-density", "line-progress", "accumulated", "is-supported-script"]);
              }(a2)) {
                var u2 = new ge();
                try {
                  a2 = new le(a2.type, a2.evaluate(u2));
                } catch (t3) {
                  return this.error(t3.message), null;
                }
              }
              return a2;
            }
            return this.error('Unknown expression "' + n2 + '". If you wanted a literal array, use ["literal", [...]].', 0);
          }
          return this.error(t2 === void 0 ? "'undefined' value invalid. Use null instead." : typeof t2 == "object" ? 'Bare objects invalid. Use ["literal", {...}] instead.' : "Expected an array, but found " + typeof t2 + " instead.");
        }, je.prototype.concat = function(t2, e2, r2) {
          var n2 = typeof t2 == "number" ? this.path.concat(t2) : this.path, i2 = r2 ? this.scope.concat(r2) : this.scope;
          return new je(this.registry, n2, e2 || null, i2, this.errors);
        }, je.prototype.error = function(t2) {
          for (var e2 = [], r2 = arguments.length - 1; r2-- > 0; )
            e2[r2] = arguments[r2 + 1];
          var n2 = "" + this.key + e2.map(function(t3) {
            return "[" + t3 + "]";
          }).join("");
          this.errors.push(new Ft(n2, t2));
        }, je.prototype.checkSubtype = function(t2, e2) {
          var r2 = Yt(t2, e2);
          return r2 && this.error(r2), r2;
        };
        var Ne = function(t2, e2, r2) {
          this.type = t2, this.input = e2, this.labels = [], this.outputs = [];
          for (var n2 = 0, i2 = r2; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2], o2 = a2[1];
            this.labels.push(a2[0]), this.outputs.push(o2);
          }
        };
        function Ke(t2, e2, r2) {
          return t2 * (1 - r2) + e2 * r2;
        }
        Ne.parse = function(t2, e2) {
          if (t2.length - 1 < 4)
            return e2.error("Expected at least 4 arguments, but found only " + (t2.length - 1) + ".");
          if ((t2.length - 1) % 2 != 0)
            return e2.error("Expected an even number of arguments.");
          var r2 = e2.parse(t2[1], 1, Ot);
          if (!r2)
            return null;
          var n2 = [], i2 = null;
          e2.expectedType && e2.expectedType.kind !== "value" && (i2 = e2.expectedType);
          for (var a2 = 1; a2 < t2.length; a2 += 2) {
            var o2 = a2 === 1 ? -1 / 0 : t2[a2], s2 = t2[a2 + 1], u2 = a2, l2 = a2 + 1;
            if (typeof o2 != "number")
              return e2.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', u2);
            if (n2.length && n2[n2.length - 1][0] >= o2)
              return e2.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', u2);
            var p2 = e2.parse(s2, l2, i2);
            if (!p2)
              return null;
            i2 = i2 || p2.type, n2.push([o2, p2]);
          }
          return new Ne(i2, r2, n2);
        }, Ne.prototype.evaluate = function(t2) {
          var e2 = this.labels, r2 = this.outputs;
          if (e2.length === 1)
            return r2[0].evaluate(t2);
          var n2 = this.input.evaluate(t2);
          if (n2 <= e2[0])
            return r2[0].evaluate(t2);
          var i2 = e2.length;
          return n2 >= e2[i2 - 1] ? r2[i2 - 1].evaluate(t2) : r2[qe(e2, n2)].evaluate(t2);
        }, Ne.prototype.eachChild = function(t2) {
          t2(this.input);
          for (var e2 = 0, r2 = this.outputs; e2 < r2.length; e2 += 1)
            t2(r2[e2]);
        }, Ne.prototype.outputDefined = function() {
          return this.outputs.every(function(t2) {
            return t2.outputDefined();
          });
        }, Ne.prototype.serialize = function() {
          for (var t2 = ["step", this.input.serialize()], e2 = 0; e2 < this.labels.length; e2++)
            e2 > 0 && t2.push(this.labels[e2]), t2.push(this.outputs[e2].serialize());
          return t2;
        };
        var Ge = Object.freeze({__proto__: null, number: Ke, color: function(t2, e2, r2) {
          return new te(Ke(t2.r, e2.r, r2), Ke(t2.g, e2.g, r2), Ke(t2.b, e2.b, r2), Ke(t2.a, e2.a, r2));
        }, array: function(t2, e2, r2) {
          return t2.map(function(t3, n2) {
            return Ke(t3, e2[n2], r2);
          });
        }}), Ze = 6 / 29 * 3 * (6 / 29), Xe = Math.PI / 180, Je = 180 / Math.PI;
        function He(t2) {
          return t2 > 0.008856451679035631 ? Math.pow(t2, 1 / 3) : t2 / Ze + 4 / 29;
        }
        function Ye(t2) {
          return t2 > 6 / 29 ? t2 * t2 * t2 : Ze * (t2 - 4 / 29);
        }
        function $e(t2) {
          return 255 * (t2 <= 31308e-7 ? 12.92 * t2 : 1.055 * Math.pow(t2, 1 / 2.4) - 0.055);
        }
        function We(t2) {
          return (t2 /= 255) <= 0.04045 ? t2 / 12.92 : Math.pow((t2 + 0.055) / 1.055, 2.4);
        }
        function Qe(t2) {
          var e2 = We(t2.r), r2 = We(t2.g), n2 = We(t2.b), i2 = He((0.4124564 * e2 + 0.3575761 * r2 + 0.1804375 * n2) / 0.95047), a2 = He((0.2126729 * e2 + 0.7151522 * r2 + 0.072175 * n2) / 1);
          return {l: 116 * a2 - 16, a: 500 * (i2 - a2), b: 200 * (a2 - He((0.0193339 * e2 + 0.119192 * r2 + 0.9503041 * n2) / 1.08883)), alpha: t2.a};
        }
        function tr(t2) {
          var e2 = (t2.l + 16) / 116, r2 = isNaN(t2.a) ? e2 : e2 + t2.a / 500, n2 = isNaN(t2.b) ? e2 : e2 - t2.b / 200;
          return e2 = 1 * Ye(e2), r2 = 0.95047 * Ye(r2), n2 = 1.08883 * Ye(n2), new te($e(3.2404542 * r2 - 1.5371385 * e2 - 0.4985314 * n2), $e(-0.969266 * r2 + 1.8760108 * e2 + 0.041556 * n2), $e(0.0556434 * r2 - 0.2040259 * e2 + 1.0572252 * n2), t2.alpha);
        }
        function er(t2, e2, r2) {
          var n2 = e2 - t2;
          return t2 + r2 * (n2 > 180 || n2 < -180 ? n2 - 360 * Math.round(n2 / 360) : n2);
        }
        var rr = {forward: Qe, reverse: tr, interpolate: function(t2, e2, r2) {
          return {l: Ke(t2.l, e2.l, r2), a: Ke(t2.a, e2.a, r2), b: Ke(t2.b, e2.b, r2), alpha: Ke(t2.alpha, e2.alpha, r2)};
        }}, nr = {forward: function(t2) {
          var e2 = Qe(t2), r2 = e2.l, n2 = e2.a, i2 = e2.b, a2 = Math.atan2(i2, n2) * Je;
          return {h: a2 < 0 ? a2 + 360 : a2, c: Math.sqrt(n2 * n2 + i2 * i2), l: r2, alpha: t2.a};
        }, reverse: function(t2) {
          var e2 = t2.h * Xe, r2 = t2.c;
          return tr({l: t2.l, a: Math.cos(e2) * r2, b: Math.sin(e2) * r2, alpha: t2.alpha});
        }, interpolate: function(t2, e2, r2) {
          return {h: er(t2.h, e2.h, r2), c: Ke(t2.c, e2.c, r2), l: Ke(t2.l, e2.l, r2), alpha: Ke(t2.alpha, e2.alpha, r2)};
        }}, ir = Object.freeze({__proto__: null, lab: rr, hcl: nr}), ar = function(t2, e2, r2, n2, i2) {
          this.type = t2, this.operator = e2, this.interpolation = r2, this.input = n2, this.labels = [], this.outputs = [];
          for (var a2 = 0, o2 = i2; a2 < o2.length; a2 += 1) {
            var s2 = o2[a2], u2 = s2[1];
            this.labels.push(s2[0]), this.outputs.push(u2);
          }
        };
        function or(t2, e2, r2, n2) {
          var i2 = n2 - r2, a2 = t2 - r2;
          return i2 === 0 ? 0 : e2 === 1 ? a2 / i2 : (Math.pow(e2, a2) - 1) / (Math.pow(e2, i2) - 1);
        }
        ar.interpolationFactor = function(t2, e2, n2, i2) {
          var a2 = 0;
          if (t2.name === "exponential")
            a2 = or(e2, t2.base, n2, i2);
          else if (t2.name === "linear")
            a2 = or(e2, 1, n2, i2);
          else if (t2.name === "cubic-bezier") {
            var o2 = t2.controlPoints;
            a2 = new r(o2[0], o2[1], o2[2], o2[3]).solve(or(e2, 1, n2, i2));
          }
          return a2;
        }, ar.parse = function(t2, e2) {
          var r2 = t2[0], n2 = t2[1], i2 = t2[2], a2 = t2.slice(3);
          if (!Array.isArray(n2) || n2.length === 0)
            return e2.error("Expected an interpolation type expression.", 1);
          if (n2[0] === "linear")
            n2 = {name: "linear"};
          else if (n2[0] === "exponential") {
            var o2 = n2[1];
            if (typeof o2 != "number")
              return e2.error("Exponential interpolation requires a numeric base.", 1, 1);
            n2 = {name: "exponential", base: o2};
          } else {
            if (n2[0] !== "cubic-bezier")
              return e2.error("Unknown interpolation type " + String(n2[0]), 1, 0);
            var s2 = n2.slice(1);
            if (s2.length !== 4 || s2.some(function(t3) {
              return typeof t3 != "number" || t3 < 0 || t3 > 1;
            }))
              return e2.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
            n2 = {name: "cubic-bezier", controlPoints: s2};
          }
          if (t2.length - 1 < 4)
            return e2.error("Expected at least 4 arguments, but found only " + (t2.length - 1) + ".");
          if ((t2.length - 1) % 2 != 0)
            return e2.error("Expected an even number of arguments.");
          if (!(i2 = e2.parse(i2, 2, Ot)))
            return null;
          var u2 = [], l2 = null;
          r2 === "interpolate-hcl" || r2 === "interpolate-lab" ? l2 = jt : e2.expectedType && e2.expectedType.kind !== "value" && (l2 = e2.expectedType);
          for (var p2 = 0; p2 < a2.length; p2 += 2) {
            var c2 = a2[p2], h2 = a2[p2 + 1], f2 = p2 + 3, y2 = p2 + 4;
            if (typeof c2 != "number")
              return e2.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', f2);
            if (u2.length && u2[u2.length - 1][0] >= c2)
              return e2.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', f2);
            var d2 = e2.parse(h2, y2, l2);
            if (!d2)
              return null;
            l2 = l2 || d2.type, u2.push([c2, d2]);
          }
          return l2.kind === "number" || l2.kind === "color" || l2.kind === "array" && l2.itemType.kind === "number" && typeof l2.N == "number" ? new ar(l2, r2, n2, i2, u2) : e2.error("Type " + Jt(l2) + " is not interpolatable.");
        }, ar.prototype.evaluate = function(t2) {
          var e2 = this.labels, r2 = this.outputs;
          if (e2.length === 1)
            return r2[0].evaluate(t2);
          var n2 = this.input.evaluate(t2);
          if (n2 <= e2[0])
            return r2[0].evaluate(t2);
          var i2 = e2.length;
          if (n2 >= e2[i2 - 1])
            return r2[i2 - 1].evaluate(t2);
          var a2 = qe(e2, n2), o2 = ar.interpolationFactor(this.interpolation, n2, e2[a2], e2[a2 + 1]), s2 = r2[a2].evaluate(t2), u2 = r2[a2 + 1].evaluate(t2);
          return this.operator === "interpolate" ? Ge[this.type.kind.toLowerCase()](s2, u2, o2) : this.operator === "interpolate-hcl" ? nr.reverse(nr.interpolate(nr.forward(s2), nr.forward(u2), o2)) : rr.reverse(rr.interpolate(rr.forward(s2), rr.forward(u2), o2));
        }, ar.prototype.eachChild = function(t2) {
          t2(this.input);
          for (var e2 = 0, r2 = this.outputs; e2 < r2.length; e2 += 1)
            t2(r2[e2]);
        }, ar.prototype.outputDefined = function() {
          return this.outputs.every(function(t2) {
            return t2.outputDefined();
          });
        }, ar.prototype.serialize = function() {
          var t2;
          t2 = this.interpolation.name === "linear" ? ["linear"] : this.interpolation.name === "exponential" ? this.interpolation.base === 1 ? ["linear"] : ["exponential", this.interpolation.base] : ["cubic-bezier"].concat(this.interpolation.controlPoints);
          for (var e2 = [this.operator, t2, this.input.serialize()], r2 = 0; r2 < this.labels.length; r2++)
            e2.push(this.labels[r2], this.outputs[r2].serialize());
          return e2;
        };
        var sr = function(t2, e2) {
          this.type = t2, this.args = e2;
        };
        sr.parse = function(t2, e2) {
          if (t2.length < 2)
            return e2.error("Expectected at least one argument.");
          var r2 = null, n2 = e2.expectedType;
          n2 && n2.kind !== "value" && (r2 = n2);
          for (var i2 = [], a2 = 0, o2 = t2.slice(1); a2 < o2.length; a2 += 1) {
            var s2 = e2.parse(o2[a2], 1 + i2.length, r2, void 0, {typeAnnotation: "omit"});
            if (!s2)
              return null;
            r2 = r2 || s2.type, i2.push(s2);
          }
          var u2 = n2 && i2.some(function(t3) {
            return Yt(n2, t3.type);
          });
          return new sr(u2 ? Nt : r2, i2);
        }, sr.prototype.evaluate = function(t2) {
          for (var e2, r2 = null, n2 = 0, i2 = 0, a2 = this.args; i2 < a2.length && (n2++, (r2 = a2[i2].evaluate(t2)) && r2 instanceof ie && !r2.available && (e2 || (e2 = r2.name), r2 = null, n2 === this.args.length && (r2 = e2)), r2 === null); i2 += 1)
            ;
          return r2;
        }, sr.prototype.eachChild = function(t2) {
          this.args.forEach(t2);
        }, sr.prototype.outputDefined = function() {
          return this.args.every(function(t2) {
            return t2.outputDefined();
          });
        }, sr.prototype.serialize = function() {
          var t2 = ["coalesce"];
          return this.eachChild(function(e2) {
            t2.push(e2.serialize());
          }), t2;
        };
        var ur = function(t2, e2) {
          this.type = e2.type, this.bindings = [].concat(t2), this.result = e2;
        };
        ur.prototype.evaluate = function(t2) {
          return this.result.evaluate(t2);
        }, ur.prototype.eachChild = function(t2) {
          for (var e2 = 0, r2 = this.bindings; e2 < r2.length; e2 += 1)
            t2(r2[e2][1]);
          t2(this.result);
        }, ur.parse = function(t2, e2) {
          if (t2.length < 4)
            return e2.error("Expected at least 3 arguments, but found " + (t2.length - 1) + " instead.");
          for (var r2 = [], n2 = 1; n2 < t2.length - 1; n2 += 2) {
            var i2 = t2[n2];
            if (typeof i2 != "string")
              return e2.error("Expected string, but found " + typeof i2 + " instead.", n2);
            if (/[^a-zA-Z0-9_]/.test(i2))
              return e2.error("Variable names must contain only alphanumeric characters or '_'.", n2);
            var a2 = e2.parse(t2[n2 + 1], n2 + 1);
            if (!a2)
              return null;
            r2.push([i2, a2]);
          }
          var o2 = e2.parse(t2[t2.length - 1], t2.length - 1, e2.expectedType, r2);
          return o2 ? new ur(r2, o2) : null;
        }, ur.prototype.outputDefined = function() {
          return this.result.outputDefined();
        }, ur.prototype.serialize = function() {
          for (var t2 = ["let"], e2 = 0, r2 = this.bindings; e2 < r2.length; e2 += 1) {
            var n2 = r2[e2];
            t2.push(n2[0], n2[1].serialize());
          }
          return t2.push(this.result.serialize()), t2;
        };
        var lr = function(t2, e2, r2) {
          this.type = t2, this.index = e2, this.input = r2;
        };
        lr.parse = function(t2, e2) {
          if (t2.length !== 3)
            return e2.error("Expected 2 arguments, but found " + (t2.length - 1) + " instead.");
          var r2 = e2.parse(t2[1], 1, Ot), n2 = e2.parse(t2[2], 2, Xt(e2.expectedType || Nt));
          return r2 && n2 ? new lr(n2.type.itemType, r2, n2) : null;
        }, lr.prototype.evaluate = function(t2) {
          var e2 = this.index.evaluate(t2), r2 = this.input.evaluate(t2);
          if (e2 < 0)
            throw new pe("Array index out of bounds: " + e2 + " < 0.");
          if (e2 >= r2.length)
            throw new pe("Array index out of bounds: " + e2 + " > " + (r2.length - 1) + ".");
          if (e2 !== Math.floor(e2))
            throw new pe("Array index must be an integer, but found " + e2 + " instead.");
          return r2[e2];
        }, lr.prototype.eachChild = function(t2) {
          t2(this.index), t2(this.input);
        }, lr.prototype.outputDefined = function() {
          return false;
        }, lr.prototype.serialize = function() {
          return ["at", this.index.serialize(), this.input.serialize()];
        };
        var pr = function(t2, e2) {
          this.type = Ut, this.needle = t2, this.haystack = e2;
        };
        pr.parse = function(t2, e2) {
          if (t2.length !== 3)
            return e2.error("Expected 2 arguments, but found " + (t2.length - 1) + " instead.");
          var r2 = e2.parse(t2[1], 1, Nt), n2 = e2.parse(t2[2], 2, Nt);
          return r2 && n2 ? $t(r2.type, [Ut, Rt, Ot, Lt, Nt]) ? new pr(r2, n2) : e2.error("Expected first argument to be of type boolean, string, number or null, but found " + Jt(r2.type) + " instead") : null;
        }, pr.prototype.evaluate = function(t2) {
          var e2 = this.needle.evaluate(t2), r2 = this.haystack.evaluate(t2);
          if (!r2)
            return false;
          if (!Wt(e2, ["boolean", "string", "number", "null"]))
            throw new pe("Expected first argument to be of type boolean, string, number or null, but found " + Jt(se(e2)) + " instead.");
          if (!Wt(r2, ["string", "array"]))
            throw new pe("Expected second argument to be of type array or string, but found " + Jt(se(r2)) + " instead.");
          return r2.indexOf(e2) >= 0;
        }, pr.prototype.eachChild = function(t2) {
          t2(this.needle), t2(this.haystack);
        }, pr.prototype.outputDefined = function() {
          return true;
        }, pr.prototype.serialize = function() {
          return ["in", this.needle.serialize(), this.haystack.serialize()];
        };
        var cr = function(t2, e2, r2) {
          this.type = Ot, this.needle = t2, this.haystack = e2, this.fromIndex = r2;
        };
        cr.parse = function(t2, e2) {
          if (t2.length <= 2 || t2.length >= 5)
            return e2.error("Expected 3 or 4 arguments, but found " + (t2.length - 1) + " instead.");
          var r2 = e2.parse(t2[1], 1, Nt), n2 = e2.parse(t2[2], 2, Nt);
          if (!r2 || !n2)
            return null;
          if (!$t(r2.type, [Ut, Rt, Ot, Lt, Nt]))
            return e2.error("Expected first argument to be of type boolean, string, number or null, but found " + Jt(r2.type) + " instead");
          if (t2.length === 4) {
            var i2 = e2.parse(t2[3], 3, Ot);
            return i2 ? new cr(r2, n2, i2) : null;
          }
          return new cr(r2, n2);
        }, cr.prototype.evaluate = function(t2) {
          var e2 = this.needle.evaluate(t2), r2 = this.haystack.evaluate(t2);
          if (!Wt(e2, ["boolean", "string", "number", "null"]))
            throw new pe("Expected first argument to be of type boolean, string, number or null, but found " + Jt(se(e2)) + " instead.");
          if (!Wt(r2, ["string", "array"]))
            throw new pe("Expected second argument to be of type array or string, but found " + Jt(se(r2)) + " instead.");
          if (this.fromIndex) {
            var n2 = this.fromIndex.evaluate(t2);
            return r2.indexOf(e2, n2);
          }
          return r2.indexOf(e2);
        }, cr.prototype.eachChild = function(t2) {
          t2(this.needle), t2(this.haystack), this.fromIndex && t2(this.fromIndex);
        }, cr.prototype.outputDefined = function() {
          return false;
        }, cr.prototype.serialize = function() {
          if (this.fromIndex != null && this.fromIndex !== void 0) {
            var t2 = this.fromIndex.serialize();
            return ["index-of", this.needle.serialize(), this.haystack.serialize(), t2];
          }
          return ["index-of", this.needle.serialize(), this.haystack.serialize()];
        };
        var hr = function(t2, e2, r2, n2, i2, a2) {
          this.inputType = t2, this.type = e2, this.input = r2, this.cases = n2, this.outputs = i2, this.otherwise = a2;
        };
        hr.parse = function(t2, e2) {
          if (t2.length < 5)
            return e2.error("Expected at least 4 arguments, but found only " + (t2.length - 1) + ".");
          if (t2.length % 2 != 1)
            return e2.error("Expected an even number of arguments.");
          var r2, n2;
          e2.expectedType && e2.expectedType.kind !== "value" && (n2 = e2.expectedType);
          for (var i2 = {}, a2 = [], o2 = 2; o2 < t2.length - 1; o2 += 2) {
            var s2 = t2[o2], u2 = t2[o2 + 1];
            Array.isArray(s2) || (s2 = [s2]);
            var l2 = e2.concat(o2);
            if (s2.length === 0)
              return l2.error("Expected at least one branch label.");
            for (var p2 = 0, c2 = s2; p2 < c2.length; p2 += 1) {
              var h2 = c2[p2];
              if (typeof h2 != "number" && typeof h2 != "string")
                return l2.error("Branch labels must be numbers or strings.");
              if (typeof h2 == "number" && Math.abs(h2) > Number.MAX_SAFE_INTEGER)
                return l2.error("Branch labels must be integers no larger than " + Number.MAX_SAFE_INTEGER + ".");
              if (typeof h2 == "number" && Math.floor(h2) !== h2)
                return l2.error("Numeric branch labels must be integer values.");
              if (r2) {
                if (l2.checkSubtype(r2, se(h2)))
                  return null;
              } else
                r2 = se(h2);
              if (i2[String(h2)] !== void 0)
                return l2.error("Branch labels must be unique.");
              i2[String(h2)] = a2.length;
            }
            var f2 = e2.parse(u2, o2, n2);
            if (!f2)
              return null;
            n2 = n2 || f2.type, a2.push(f2);
          }
          var y2 = e2.parse(t2[1], 1, Nt);
          if (!y2)
            return null;
          var d2 = e2.parse(t2[t2.length - 1], t2.length - 1, n2);
          return d2 ? y2.type.kind !== "value" && e2.concat(1).checkSubtype(r2, y2.type) ? null : new hr(r2, n2, y2, i2, a2, d2) : null;
        }, hr.prototype.evaluate = function(t2) {
          var e2 = this.input.evaluate(t2);
          return (se(e2) === this.inputType && this.outputs[this.cases[e2]] || this.otherwise).evaluate(t2);
        }, hr.prototype.eachChild = function(t2) {
          t2(this.input), this.outputs.forEach(t2), t2(this.otherwise);
        }, hr.prototype.outputDefined = function() {
          return this.outputs.every(function(t2) {
            return t2.outputDefined();
          }) && this.otherwise.outputDefined();
        }, hr.prototype.serialize = function() {
          for (var t2 = this, e2 = ["match", this.input.serialize()], r2 = [], n2 = {}, i2 = 0, a2 = Object.keys(this.cases).sort(); i2 < a2.length; i2 += 1) {
            var o2 = a2[i2];
            (c2 = n2[this.cases[o2]]) === void 0 ? (n2[this.cases[o2]] = r2.length, r2.push([this.cases[o2], [o2]])) : r2[c2][1].push(o2);
          }
          for (var s2 = function(e3) {
            return t2.inputType.kind === "number" ? Number(e3) : e3;
          }, u2 = 0, l2 = r2; u2 < l2.length; u2 += 1) {
            var p2 = l2[u2], c2 = p2[0], h2 = p2[1];
            e2.push(h2.length === 1 ? s2(h2[0]) : h2.map(s2)), e2.push(this.outputs[outputIndex$1].serialize());
          }
          return e2.push(this.otherwise.serialize()), e2;
        };
        var fr = function(t2, e2, r2) {
          this.type = t2, this.branches = e2, this.otherwise = r2;
        };
        fr.parse = function(t2, e2) {
          if (t2.length < 4)
            return e2.error("Expected at least 3 arguments, but found only " + (t2.length - 1) + ".");
          if (t2.length % 2 != 0)
            return e2.error("Expected an odd number of arguments.");
          var r2;
          e2.expectedType && e2.expectedType.kind !== "value" && (r2 = e2.expectedType);
          for (var n2 = [], i2 = 1; i2 < t2.length - 1; i2 += 2) {
            var a2 = e2.parse(t2[i2], i2, Ut);
            if (!a2)
              return null;
            var o2 = e2.parse(t2[i2 + 1], i2 + 1, r2);
            if (!o2)
              return null;
            n2.push([a2, o2]), r2 = r2 || o2.type;
          }
          var s2 = e2.parse(t2[t2.length - 1], t2.length - 1, r2);
          return s2 ? new fr(r2, n2, s2) : null;
        }, fr.prototype.evaluate = function(t2) {
          for (var e2 = 0, r2 = this.branches; e2 < r2.length; e2 += 1) {
            var n2 = r2[e2], i2 = n2[1];
            if (n2[0].evaluate(t2))
              return i2.evaluate(t2);
          }
          return this.otherwise.evaluate(t2);
        }, fr.prototype.eachChild = function(t2) {
          for (var e2 = 0, r2 = this.branches; e2 < r2.length; e2 += 1) {
            var n2 = r2[e2], i2 = n2[1];
            t2(n2[0]), t2(i2);
          }
          t2(this.otherwise);
        }, fr.prototype.outputDefined = function() {
          return this.branches.every(function(t2) {
            return t2[1].outputDefined();
          }) && this.otherwise.outputDefined();
        }, fr.prototype.serialize = function() {
          var t2 = ["case"];
          return this.eachChild(function(e2) {
            t2.push(e2.serialize());
          }), t2;
        };
        var yr = function(t2, e2, r2, n2) {
          this.type = t2, this.input = e2, this.beginIndex = r2, this.endIndex = n2;
        };
        function dr(t2, e2) {
          return t2 === "==" || t2 === "!=" ? e2.kind === "boolean" || e2.kind === "string" || e2.kind === "number" || e2.kind === "null" || e2.kind === "value" : e2.kind === "string" || e2.kind === "number" || e2.kind === "value";
        }
        function mr(t2, e2, r2, n2) {
          return n2.compare(e2, r2) === 0;
        }
        function vr(t2, e2, r2) {
          var n2 = t2 !== "==" && t2 !== "!=";
          return function() {
            function i2(t3, e3, r3) {
              this.type = Ut, this.lhs = t3, this.rhs = e3, this.collator = r3, this.hasUntypedArgument = t3.type.kind === "value" || e3.type.kind === "value";
            }
            return i2.parse = function(t3, e3) {
              if (t3.length !== 3 && t3.length !== 4)
                return e3.error("Expected two or three arguments.");
              var r3 = t3[0], a2 = e3.parse(t3[1], 1, Nt);
              if (!a2)
                return null;
              if (!dr(r3, a2.type))
                return e3.concat(1).error('"' + r3 + `" comparisons are not supported for type '` + Jt(a2.type) + "'.");
              var o2 = e3.parse(t3[2], 2, Nt);
              if (!o2)
                return null;
              if (!dr(r3, o2.type))
                return e3.concat(2).error('"' + r3 + `" comparisons are not supported for type '` + Jt(o2.type) + "'.");
              if (a2.type.kind !== o2.type.kind && a2.type.kind !== "value" && o2.type.kind !== "value")
                return e3.error("Cannot compare types '" + Jt(a2.type) + "' and '" + Jt(o2.type) + "'.");
              n2 && (a2.type.kind === "value" && o2.type.kind !== "value" ? a2 = new he(o2.type, [a2]) : a2.type.kind !== "value" && o2.type.kind === "value" && (o2 = new he(a2.type, [o2])));
              var s2 = null;
              if (t3.length === 4) {
                if (a2.type.kind !== "string" && o2.type.kind !== "string" && a2.type.kind !== "value" && o2.type.kind !== "value")
                  return e3.error("Cannot use collator to compare non-string types.");
                if (!(s2 = e3.parse(t3[3], 3, Kt)))
                  return null;
              }
              return new i2(a2, o2, s2);
            }, i2.prototype.evaluate = function(i3) {
              var a2 = this.lhs.evaluate(i3), o2 = this.rhs.evaluate(i3);
              if (n2 && this.hasUntypedArgument) {
                var s2 = se(a2), u2 = se(o2);
                if (s2.kind !== u2.kind || s2.kind !== "string" && s2.kind !== "number")
                  throw new pe('Expected arguments for "' + t2 + '" to be (string, string) or (number, number), but found (' + s2.kind + ", " + u2.kind + ") instead.");
              }
              if (this.collator && !n2 && this.hasUntypedArgument) {
                var l2 = se(a2), p2 = se(o2);
                if (l2.kind !== "string" || p2.kind !== "string")
                  return e2(i3, a2, o2);
              }
              return this.collator ? r2(i3, a2, o2, this.collator.evaluate(i3)) : e2(i3, a2, o2);
            }, i2.prototype.eachChild = function(t3) {
              t3(this.lhs), t3(this.rhs), this.collator && t3(this.collator);
            }, i2.prototype.outputDefined = function() {
              return true;
            }, i2.prototype.serialize = function() {
              var e3 = [t2];
              return this.eachChild(function(t3) {
                e3.push(t3.serialize());
              }), e3;
            }, i2;
          }();
        }
        yr.parse = function(t2, e2) {
          if (t2.length <= 2 || t2.length >= 5)
            return e2.error("Expected 3 or 4 arguments, but found " + (t2.length - 1) + " instead.");
          var r2 = e2.parse(t2[1], 1, Nt), n2 = e2.parse(t2[2], 2, Ot);
          if (!r2 || !n2)
            return null;
          if (!$t(r2.type, [Xt(Nt), Rt, Nt]))
            return e2.error("Expected first argument to be of type array or string, but found " + Jt(r2.type) + " instead");
          if (t2.length === 4) {
            var i2 = e2.parse(t2[3], 3, Ot);
            return i2 ? new yr(r2.type, r2, n2, i2) : null;
          }
          return new yr(r2.type, r2, n2);
        }, yr.prototype.evaluate = function(t2) {
          var e2 = this.input.evaluate(t2), r2 = this.beginIndex.evaluate(t2);
          if (!Wt(e2, ["string", "array"]))
            throw new pe("Expected first argument to be of type array or string, but found " + Jt(se(e2)) + " instead.");
          if (this.endIndex) {
            var n2 = this.endIndex.evaluate(t2);
            return e2.slice(r2, n2);
          }
          return e2.slice(r2);
        }, yr.prototype.eachChild = function(t2) {
          t2(this.input), t2(this.beginIndex), this.endIndex && t2(this.endIndex);
        }, yr.prototype.outputDefined = function() {
          return false;
        }, yr.prototype.serialize = function() {
          if (this.endIndex != null && this.endIndex !== void 0) {
            var t2 = this.endIndex.serialize();
            return ["slice", this.input.serialize(), this.beginIndex.serialize(), t2];
          }
          return ["slice", this.input.serialize(), this.beginIndex.serialize()];
        };
        var gr = vr("==", function(t2, e2, r2) {
          return e2 === r2;
        }, mr), xr = vr("!=", function(t2, e2, r2) {
          return e2 !== r2;
        }, function(t2, e2, r2, n2) {
          return !mr(0, e2, r2, n2);
        }), br = vr("<", function(t2, e2, r2) {
          return e2 < r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) < 0;
        }), wr = vr(">", function(t2, e2, r2) {
          return e2 > r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) > 0;
        }), _r = vr("<=", function(t2, e2, r2) {
          return e2 <= r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) <= 0;
        }), Ar = vr(">=", function(t2, e2, r2) {
          return e2 >= r2;
        }, function(t2, e2, r2, n2) {
          return n2.compare(e2, r2) >= 0;
        }), Sr = function(t2, e2, r2, n2, i2) {
          this.type = Rt, this.number = t2, this.locale = e2, this.currency = r2, this.minFractionDigits = n2, this.maxFractionDigits = i2;
        };
        Sr.parse = function(t2, e2) {
          if (t2.length !== 3)
            return e2.error("Expected two arguments.");
          var r2 = e2.parse(t2[1], 1, Ot);
          if (!r2)
            return null;
          var n2 = t2[2];
          if (typeof n2 != "object" || Array.isArray(n2))
            return e2.error("NumberFormat options argument must be an object.");
          var i2 = null;
          if (n2.locale && !(i2 = e2.parse(n2.locale, 1, Rt)))
            return null;
          var a2 = null;
          if (n2.currency && !(a2 = e2.parse(n2.currency, 1, Rt)))
            return null;
          var o2 = null;
          if (n2["min-fraction-digits"] && !(o2 = e2.parse(n2["min-fraction-digits"], 1, Ot)))
            return null;
          var s2 = null;
          return n2["max-fraction-digits"] && !(s2 = e2.parse(n2["max-fraction-digits"], 1, Ot)) ? null : new Sr(r2, i2, a2, o2, s2);
        }, Sr.prototype.evaluate = function(t2) {
          return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t2) : [], {style: this.currency ? "currency" : "decimal", currency: this.currency ? this.currency.evaluate(t2) : void 0, minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t2) : void 0, maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t2) : void 0}).format(this.number.evaluate(t2));
        }, Sr.prototype.eachChild = function(t2) {
          t2(this.number), this.locale && t2(this.locale), this.currency && t2(this.currency), this.minFractionDigits && t2(this.minFractionDigits), this.maxFractionDigits && t2(this.maxFractionDigits);
        }, Sr.prototype.outputDefined = function() {
          return false;
        }, Sr.prototype.serialize = function() {
          var t2 = {};
          return this.locale && (t2.locale = this.locale.serialize()), this.currency && (t2.currency = this.currency.serialize()), this.minFractionDigits && (t2["min-fraction-digits"] = this.minFractionDigits.serialize()), this.maxFractionDigits && (t2["max-fraction-digits"] = this.maxFractionDigits.serialize()), ["number-format", this.number.serialize(), t2];
        };
        var kr = function(t2) {
          this.type = Ot, this.input = t2;
        };
        kr.parse = function(t2, e2) {
          if (t2.length !== 2)
            return e2.error("Expected 1 argument, but found " + (t2.length - 1) + " instead.");
          var r2 = e2.parse(t2[1], 1);
          return r2 ? r2.type.kind !== "array" && r2.type.kind !== "string" && r2.type.kind !== "value" ? e2.error("Expected argument of type string or array, but found " + Jt(r2.type) + " instead.") : new kr(r2) : null;
        }, kr.prototype.evaluate = function(t2) {
          var e2 = this.input.evaluate(t2);
          if (typeof e2 == "string")
            return e2.length;
          if (Array.isArray(e2))
            return e2.length;
          throw new pe("Expected value to be of type string or array, but found " + Jt(se(e2)) + " instead.");
        }, kr.prototype.eachChild = function(t2) {
          t2(this.input);
        }, kr.prototype.outputDefined = function() {
          return false;
        }, kr.prototype.serialize = function() {
          var t2 = ["length"];
          return this.eachChild(function(e2) {
            t2.push(e2.serialize());
          }), t2;
        };
        var Ir = {"==": gr, "!=": xr, ">": wr, "<": br, ">=": Ar, "<=": _r, array: he, at: lr, boolean: he, case: fr, coalesce: sr, collator: be, format: fe, image: ye, in: pr, "index-of": cr, interpolate: ar, "interpolate-hcl": ar, "interpolate-lab": ar, length: kr, let: ur, literal: le, match: hr, number: he, "number-format": Sr, object: he, slice: yr, step: Ne, string: he, "to-boolean": me, "to-color": me, "to-number": me, "to-string": me, var: Ue, within: De};
        function zr(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = e2[2], a2 = e2[3];
          r2 = r2.evaluate(t2), n2 = n2.evaluate(t2), i2 = i2.evaluate(t2);
          var o2 = a2 ? a2.evaluate(t2) : 1, s2 = ae(r2, n2, i2, o2);
          if (s2)
            throw new pe(s2);
          return new te(r2 / 255 * o2, n2 / 255 * o2, i2 / 255 * o2, o2);
        }
        function Cr(t2, e2) {
          return t2 in e2;
        }
        function Er(t2, e2) {
          var r2 = e2[t2];
          return r2 === void 0 ? null : r2;
        }
        function Pr(t2) {
          return {type: t2};
        }
        function Mr(t2) {
          return {result: "success", value: t2};
        }
        function Br(t2) {
          return {result: "error", value: t2};
        }
        function Tr(t2) {
          return t2["property-type"] === "data-driven" || t2["property-type"] === "cross-faded-data-driven";
        }
        function Vr(t2) {
          return !!t2.expression && t2.expression.parameters.indexOf("zoom") > -1;
        }
        function Fr(t2) {
          return !!t2.expression && t2.expression.interpolated;
        }
        function Dr(t2) {
          return t2 instanceof Number ? "number" : t2 instanceof String ? "string" : t2 instanceof Boolean ? "boolean" : Array.isArray(t2) ? "array" : t2 === null ? "null" : typeof t2;
        }
        function Lr(t2) {
          return typeof t2 == "object" && t2 !== null && !Array.isArray(t2);
        }
        function Or(t2) {
          return t2;
        }
        function Rr(t2, e2, r2) {
          return t2 !== void 0 ? t2 : e2 !== void 0 ? e2 : r2 !== void 0 ? r2 : void 0;
        }
        function Ur(t2, e2, r2, n2, i2) {
          return Rr(typeof r2 === i2 ? n2[r2] : void 0, t2.default, e2.default);
        }
        function jr(t2, e2, r2) {
          if (Dr(r2) !== "number")
            return Rr(t2.default, e2.default);
          var n2 = t2.stops.length;
          if (n2 === 1)
            return t2.stops[0][1];
          if (r2 <= t2.stops[0][0])
            return t2.stops[0][1];
          if (r2 >= t2.stops[n2 - 1][0])
            return t2.stops[n2 - 1][1];
          var i2 = qe(t2.stops.map(function(t3) {
            return t3[0];
          }), r2);
          return t2.stops[i2][1];
        }
        function qr(t2, e2, r2) {
          var n2 = t2.base !== void 0 ? t2.base : 1;
          if (Dr(r2) !== "number")
            return Rr(t2.default, e2.default);
          var i2 = t2.stops.length;
          if (i2 === 1)
            return t2.stops[0][1];
          if (r2 <= t2.stops[0][0])
            return t2.stops[0][1];
          if (r2 >= t2.stops[i2 - 1][0])
            return t2.stops[i2 - 1][1];
          var a2 = qe(t2.stops.map(function(t3) {
            return t3[0];
          }), r2), o2 = function(t3, e3, r3, n3) {
            var i3 = n3 - r3, a3 = t3 - r3;
            return i3 === 0 ? 0 : e3 === 1 ? a3 / i3 : (Math.pow(e3, a3) - 1) / (Math.pow(e3, i3) - 1);
          }(r2, n2, t2.stops[a2][0], t2.stops[a2 + 1][0]), s2 = t2.stops[a2][1], u2 = t2.stops[a2 + 1][1], l2 = Ge[e2.type] || Or;
          if (t2.colorSpace && t2.colorSpace !== "rgb") {
            var p2 = ir[t2.colorSpace];
            l2 = function(t3, e3) {
              return p2.reverse(p2.interpolate(p2.forward(t3), p2.forward(e3), o2));
            };
          }
          return typeof s2.evaluate == "function" ? {evaluate: function() {
            for (var t3 = [], e3 = arguments.length; e3--; )
              t3[e3] = arguments[e3];
            var r3 = s2.evaluate.apply(void 0, t3), n3 = u2.evaluate.apply(void 0, t3);
            if (r3 !== void 0 && n3 !== void 0)
              return l2(r3, n3, o2);
          }} : l2(s2, u2, o2);
        }
        function Nr(t2, e2, r2) {
          return e2.type === "color" ? r2 = te.parse(r2) : e2.type === "formatted" ? r2 = ne.fromString(r2.toString()) : e2.type === "resolvedImage" ? r2 = ie.fromString(r2.toString()) : Dr(r2) === e2.type || e2.type === "enum" && e2.values[r2] || (r2 = void 0), Rr(r2, t2.default, e2.default);
        }
        xe.register(Ir, {error: [{kind: "error"}, [Rt], function(t2, e2) {
          throw new pe(e2[0].evaluate(t2));
        }], typeof: [Rt, [Nt], function(t2, e2) {
          return Jt(se(e2[0].evaluate(t2)));
        }], "to-rgba": [Xt(Ot, 4), [jt], function(t2, e2) {
          return e2[0].evaluate(t2).toArray();
        }], rgb: [jt, [Ot, Ot, Ot], zr], rgba: [jt, [Ot, Ot, Ot, Ot], zr], has: {type: Ut, overloads: [[[Rt], function(t2, e2) {
          return Cr(e2[0].evaluate(t2), t2.properties());
        }], [[Rt, qt], function(t2, e2) {
          var r2 = e2[1];
          return Cr(e2[0].evaluate(t2), r2.evaluate(t2));
        }]]}, get: {type: Nt, overloads: [[[Rt], function(t2, e2) {
          return Er(e2[0].evaluate(t2), t2.properties());
        }], [[Rt, qt], function(t2, e2) {
          var r2 = e2[1];
          return Er(e2[0].evaluate(t2), r2.evaluate(t2));
        }]]}, "feature-state": [Nt, [Rt], function(t2, e2) {
          return Er(e2[0].evaluate(t2), t2.featureState || {});
        }], properties: [qt, [], function(t2) {
          return t2.properties();
        }], "geometry-type": [Rt, [], function(t2) {
          return t2.geometryType();
        }], id: [Nt, [], function(t2) {
          return t2.id();
        }], zoom: [Ot, [], function(t2) {
          return t2.globals.zoom;
        }], "heatmap-density": [Ot, [], function(t2) {
          return t2.globals.heatmapDensity || 0;
        }], "line-progress": [Ot, [], function(t2) {
          return t2.globals.lineProgress || 0;
        }], accumulated: [Nt, [], function(t2) {
          return t2.globals.accumulated === void 0 ? null : t2.globals.accumulated;
        }], "+": [Ot, Pr(Ot), function(t2, e2) {
          for (var r2 = 0, n2 = 0, i2 = e2; n2 < i2.length; n2 += 1)
            r2 += i2[n2].evaluate(t2);
          return r2;
        }], "*": [Ot, Pr(Ot), function(t2, e2) {
          for (var r2 = 1, n2 = 0, i2 = e2; n2 < i2.length; n2 += 1)
            r2 *= i2[n2].evaluate(t2);
          return r2;
        }], "-": {type: Ot, overloads: [[[Ot, Ot], function(t2, e2) {
          var r2 = e2[1];
          return e2[0].evaluate(t2) - r2.evaluate(t2);
        }], [[Ot], function(t2, e2) {
          return -e2[0].evaluate(t2);
        }]]}, "/": [Ot, [Ot, Ot], function(t2, e2) {
          var r2 = e2[1];
          return e2[0].evaluate(t2) / r2.evaluate(t2);
        }], "%": [Ot, [Ot, Ot], function(t2, e2) {
          var r2 = e2[1];
          return e2[0].evaluate(t2) % r2.evaluate(t2);
        }], ln2: [Ot, [], function() {
          return Math.LN2;
        }], pi: [Ot, [], function() {
          return Math.PI;
        }], e: [Ot, [], function() {
          return Math.E;
        }], "^": [Ot, [Ot, Ot], function(t2, e2) {
          var r2 = e2[1];
          return Math.pow(e2[0].evaluate(t2), r2.evaluate(t2));
        }], sqrt: [Ot, [Ot], function(t2, e2) {
          return Math.sqrt(e2[0].evaluate(t2));
        }], log10: [Ot, [Ot], function(t2, e2) {
          return Math.log(e2[0].evaluate(t2)) / Math.LN10;
        }], ln: [Ot, [Ot], function(t2, e2) {
          return Math.log(e2[0].evaluate(t2));
        }], log2: [Ot, [Ot], function(t2, e2) {
          return Math.log(e2[0].evaluate(t2)) / Math.LN2;
        }], sin: [Ot, [Ot], function(t2, e2) {
          return Math.sin(e2[0].evaluate(t2));
        }], cos: [Ot, [Ot], function(t2, e2) {
          return Math.cos(e2[0].evaluate(t2));
        }], tan: [Ot, [Ot], function(t2, e2) {
          return Math.tan(e2[0].evaluate(t2));
        }], asin: [Ot, [Ot], function(t2, e2) {
          return Math.asin(e2[0].evaluate(t2));
        }], acos: [Ot, [Ot], function(t2, e2) {
          return Math.acos(e2[0].evaluate(t2));
        }], atan: [Ot, [Ot], function(t2, e2) {
          return Math.atan(e2[0].evaluate(t2));
        }], min: [Ot, Pr(Ot), function(t2, e2) {
          return Math.min.apply(Math, e2.map(function(e3) {
            return e3.evaluate(t2);
          }));
        }], max: [Ot, Pr(Ot), function(t2, e2) {
          return Math.max.apply(Math, e2.map(function(e3) {
            return e3.evaluate(t2);
          }));
        }], abs: [Ot, [Ot], function(t2, e2) {
          return Math.abs(e2[0].evaluate(t2));
        }], round: [Ot, [Ot], function(t2, e2) {
          var r2 = e2[0].evaluate(t2);
          return r2 < 0 ? -Math.round(-r2) : Math.round(r2);
        }], floor: [Ot, [Ot], function(t2, e2) {
          return Math.floor(e2[0].evaluate(t2));
        }], ceil: [Ot, [Ot], function(t2, e2) {
          return Math.ceil(e2[0].evaluate(t2));
        }], "filter-==": [Ut, [Rt, Nt], function(t2, e2) {
          var r2 = e2[0], n2 = e2[1];
          return t2.properties()[r2.value] === n2.value;
        }], "filter-id-==": [Ut, [Nt], function(t2, e2) {
          var r2 = e2[0];
          return t2.id() === r2.value;
        }], "filter-type-==": [Ut, [Rt], function(t2, e2) {
          var r2 = e2[0];
          return t2.geometryType() === r2.value;
        }], "filter-<": [Ut, [Rt, Nt], function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = t2.properties()[r2.value], a2 = n2.value;
          return typeof i2 == typeof a2 && i2 < a2;
        }], "filter-id-<": [Ut, [Nt], function(t2, e2) {
          var r2 = e2[0], n2 = t2.id(), i2 = r2.value;
          return typeof n2 == typeof i2 && n2 < i2;
        }], "filter->": [Ut, [Rt, Nt], function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = t2.properties()[r2.value], a2 = n2.value;
          return typeof i2 == typeof a2 && i2 > a2;
        }], "filter-id->": [Ut, [Nt], function(t2, e2) {
          var r2 = e2[0], n2 = t2.id(), i2 = r2.value;
          return typeof n2 == typeof i2 && n2 > i2;
        }], "filter-<=": [Ut, [Rt, Nt], function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = t2.properties()[r2.value], a2 = n2.value;
          return typeof i2 == typeof a2 && i2 <= a2;
        }], "filter-id-<=": [Ut, [Nt], function(t2, e2) {
          var r2 = e2[0], n2 = t2.id(), i2 = r2.value;
          return typeof n2 == typeof i2 && n2 <= i2;
        }], "filter->=": [Ut, [Rt, Nt], function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = t2.properties()[r2.value], a2 = n2.value;
          return typeof i2 == typeof a2 && i2 >= a2;
        }], "filter-id->=": [Ut, [Nt], function(t2, e2) {
          var r2 = e2[0], n2 = t2.id(), i2 = r2.value;
          return typeof n2 == typeof i2 && n2 >= i2;
        }], "filter-has": [Ut, [Nt], function(t2, e2) {
          return e2[0].value in t2.properties();
        }], "filter-has-id": [Ut, [], function(t2) {
          return t2.id() !== null && t2.id() !== void 0;
        }], "filter-type-in": [Ut, [Xt(Rt)], function(t2, e2) {
          return e2[0].value.indexOf(t2.geometryType()) >= 0;
        }], "filter-id-in": [Ut, [Xt(Nt)], function(t2, e2) {
          return e2[0].value.indexOf(t2.id()) >= 0;
        }], "filter-in-small": [Ut, [Rt, Xt(Nt)], function(t2, e2) {
          var r2 = e2[0];
          return e2[1].value.indexOf(t2.properties()[r2.value]) >= 0;
        }], "filter-in-large": [Ut, [Rt, Xt(Nt)], function(t2, e2) {
          var r2 = e2[0], n2 = e2[1];
          return function(t3, e3, r3, n3) {
            for (; r3 <= n3; ) {
              var i2 = r3 + n3 >> 1;
              if (e3[i2] === t3)
                return true;
              e3[i2] > t3 ? n3 = i2 - 1 : r3 = i2 + 1;
            }
            return false;
          }(t2.properties()[r2.value], n2.value, 0, n2.value.length - 1);
        }], all: {type: Ut, overloads: [[[Ut, Ut], function(t2, e2) {
          var r2 = e2[1];
          return e2[0].evaluate(t2) && r2.evaluate(t2);
        }], [Pr(Ut), function(t2, e2) {
          for (var r2 = 0, n2 = e2; r2 < n2.length; r2 += 1)
            if (!n2[r2].evaluate(t2))
              return false;
          return true;
        }]]}, any: {type: Ut, overloads: [[[Ut, Ut], function(t2, e2) {
          var r2 = e2[1];
          return e2[0].evaluate(t2) || r2.evaluate(t2);
        }], [Pr(Ut), function(t2, e2) {
          for (var r2 = 0, n2 = e2; r2 < n2.length; r2 += 1)
            if (n2[r2].evaluate(t2))
              return true;
          return false;
        }]]}, "!": [Ut, [Ut], function(t2, e2) {
          return !e2[0].evaluate(t2);
        }], "is-supported-script": [Ut, [Rt], function(t2, e2) {
          var r2 = t2.globals && t2.globals.isSupportedScript;
          return !r2 || r2(e2[0].evaluate(t2));
        }], upcase: [Rt, [Rt], function(t2, e2) {
          return e2[0].evaluate(t2).toUpperCase();
        }], downcase: [Rt, [Rt], function(t2, e2) {
          return e2[0].evaluate(t2).toLowerCase();
        }], concat: [Rt, Pr(Nt), function(t2, e2) {
          return e2.map(function(e3) {
            return ue(e3.evaluate(t2));
          }).join("");
        }], "resolved-locale": [Rt, [Kt], function(t2, e2) {
          return e2[0].evaluate(t2).resolvedLocale();
        }]});
        var Kr = function(t2, e2) {
          this.expression = t2, this._warningHistory = {}, this._evaluator = new ge(), this._defaultValue = e2 ? function(t3) {
            return t3.type === "color" && Lr(t3.default) ? new te(0, 0, 0, 0) : t3.type === "color" ? te.parse(t3.default) || null : t3.default === void 0 ? null : t3.default;
          }(e2) : null, this._enumValues = e2 && e2.type === "enum" ? e2.values : null;
        };
        function Gr(t2) {
          return Array.isArray(t2) && t2.length > 0 && typeof t2[0] == "string" && t2[0] in Ir;
        }
        function Zr(t2, e2) {
          var r2 = new je(Ir, [], e2 ? function(t3) {
            var e3 = {color: jt, string: Rt, number: Ot, enum: Rt, boolean: Ut, formatted: Gt, resolvedImage: Zt};
            return t3.type === "array" ? Xt(e3[t3.value] || Nt, t3.length) : e3[t3.type];
          }(e2) : void 0), n2 = r2.parse(t2, void 0, void 0, void 0, e2 && e2.type === "string" ? {typeAnnotation: "coerce"} : void 0);
          return n2 ? Mr(new Kr(n2, e2)) : Br(r2.errors);
        }
        Kr.prototype.evaluateWithoutErrorHandling = function(t2, e2, r2, n2, i2, a2) {
          return this._evaluator.globals = t2, this._evaluator.feature = e2, this._evaluator.featureState = r2, this._evaluator.canonical = n2, this._evaluator.availableImages = i2 || null, this._evaluator.formattedSection = a2, this.expression.evaluate(this._evaluator);
        }, Kr.prototype.evaluate = function(t2, e2, r2, n2, i2, a2) {
          this._evaluator.globals = t2, this._evaluator.feature = e2 || null, this._evaluator.featureState = r2 || null, this._evaluator.canonical = n2, this._evaluator.availableImages = i2 || null, this._evaluator.formattedSection = a2 || null;
          try {
            var o2 = this.expression.evaluate(this._evaluator);
            if (o2 == null || typeof o2 == "number" && o2 != o2)
              return this._defaultValue;
            if (this._enumValues && !(o2 in this._enumValues))
              throw new pe("Expected value to be one of " + Object.keys(this._enumValues).map(function(t3) {
                return JSON.stringify(t3);
              }).join(", ") + ", but found " + JSON.stringify(o2) + " instead.");
            return o2;
          } catch (t3) {
            return this._warningHistory[t3.message] || (this._warningHistory[t3.message] = true, typeof console != "undefined" && console.warn(t3.message)), this._defaultValue;
          }
        };
        var Xr = function(t2, e2) {
          this.kind = t2, this._styleExpression = e2, this.isStateDependent = t2 !== "constant" && !Oe(e2.expression);
        };
        Xr.prototype.evaluateWithoutErrorHandling = function(t2, e2, r2, n2, i2, a2) {
          return this._styleExpression.evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2);
        }, Xr.prototype.evaluate = function(t2, e2, r2, n2, i2, a2) {
          return this._styleExpression.evaluate(t2, e2, r2, n2, i2, a2);
        };
        var Jr = function(t2, e2, r2, n2) {
          this.kind = t2, this.zoomStops = r2, this._styleExpression = e2, this.isStateDependent = t2 !== "camera" && !Oe(e2.expression), this.interpolationType = n2;
        };
        function Hr(t2, e2) {
          if ((t2 = Zr(t2, e2)).result === "error")
            return t2;
          var r2 = t2.value.expression, n2 = Le(r2);
          if (!n2 && !Tr(e2))
            return Br([new Ft("", "data expressions not supported")]);
          var i2 = Re(r2, ["zoom"]);
          if (!i2 && !Vr(e2))
            return Br([new Ft("", "zoom expressions not supported")]);
          var a2 = function t3(e3) {
            var r3 = null;
            if (e3 instanceof ur)
              r3 = t3(e3.result);
            else if (e3 instanceof sr)
              for (var n3 = 0, i3 = e3.args; n3 < i3.length && !(r3 = t3(i3[n3])); n3 += 1)
                ;
            else
              (e3 instanceof Ne || e3 instanceof ar) && e3.input instanceof xe && e3.input.name === "zoom" && (r3 = e3);
            return r3 instanceof Ft || e3.eachChild(function(e4) {
              var n4 = t3(e4);
              n4 instanceof Ft ? r3 = n4 : !r3 && n4 ? r3 = new Ft("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : r3 && n4 && r3 !== n4 && (r3 = new Ft("", 'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'));
            }), r3;
          }(r2);
          return a2 || i2 ? a2 instanceof Ft ? Br([a2]) : a2 instanceof ar && !Fr(e2) ? Br([new Ft("", '"interpolate" expressions cannot be used with this property')]) : Mr(a2 ? new Jr(n2 ? "camera" : "composite", t2.value, a2.labels, a2 instanceof ar ? a2.interpolation : void 0) : new Xr(n2 ? "constant" : "source", t2.value)) : Br([new Ft("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);
        }
        Jr.prototype.evaluateWithoutErrorHandling = function(t2, e2, r2, n2, i2, a2) {
          return this._styleExpression.evaluateWithoutErrorHandling(t2, e2, r2, n2, i2, a2);
        }, Jr.prototype.evaluate = function(t2, e2, r2, n2, i2, a2) {
          return this._styleExpression.evaluate(t2, e2, r2, n2, i2, a2);
        }, Jr.prototype.interpolationFactor = function(t2, e2, r2) {
          return this.interpolationType ? ar.interpolationFactor(this.interpolationType, t2, e2, r2) : 0;
        };
        var Yr = function(t2, e2) {
          this._parameters = t2, this._specification = e2, Bt(this, function t3(e3, r2) {
            var n2, i2, a2, o2 = r2.type === "color", s2 = e3.stops && typeof e3.stops[0][0] == "object", u2 = s2 || !(s2 || e3.property !== void 0), l2 = e3.type || (Fr(r2) ? "exponential" : "interval");
            if (o2 && ((e3 = Bt({}, e3)).stops && (e3.stops = e3.stops.map(function(t4) {
              return [t4[0], te.parse(t4[1])];
            })), e3.default = te.parse(e3.default ? e3.default : r2.default)), e3.colorSpace && e3.colorSpace !== "rgb" && !ir[e3.colorSpace])
              throw new Error("Unknown color space: " + e3.colorSpace);
            if (l2 === "exponential")
              n2 = qr;
            else if (l2 === "interval")
              n2 = jr;
            else if (l2 === "categorical") {
              n2 = Ur, i2 = Object.create(null);
              for (var p2 = 0, c2 = e3.stops; p2 < c2.length; p2 += 1) {
                var h2 = c2[p2];
                i2[h2[0]] = h2[1];
              }
              a2 = typeof e3.stops[0][0];
            } else {
              if (l2 !== "identity")
                throw new Error('Unknown function type "' + l2 + '"');
              n2 = Nr;
            }
            if (s2) {
              for (var f2 = {}, y2 = [], d2 = 0; d2 < e3.stops.length; d2++) {
                var m2 = e3.stops[d2], v2 = m2[0].zoom;
                f2[v2] === void 0 && (f2[v2] = {zoom: v2, type: e3.type, property: e3.property, default: e3.default, stops: []}, y2.push(v2)), f2[v2].stops.push([m2[0].value, m2[1]]);
              }
              for (var g2 = [], x2 = 0, b2 = y2; x2 < b2.length; x2 += 1) {
                var w2 = b2[x2];
                g2.push([f2[w2].zoom, t3(f2[w2], r2)]);
              }
              var _2 = {name: "linear"};
              return {kind: "composite", interpolationType: _2, interpolationFactor: ar.interpolationFactor.bind(void 0, _2), zoomStops: g2.map(function(t4) {
                return t4[0];
              }), evaluate: function(t4, n3) {
                var i3 = t4.zoom;
                return qr({stops: g2, base: e3.base}, r2, i3).evaluate(i3, n3);
              }};
            }
            if (u2) {
              var A2 = l2 === "exponential" ? {name: "exponential", base: e3.base !== void 0 ? e3.base : 1} : null;
              return {kind: "camera", interpolationType: A2, interpolationFactor: ar.interpolationFactor.bind(void 0, A2), zoomStops: e3.stops.map(function(t4) {
                return t4[0];
              }), evaluate: function(t4) {
                return n2(e3, r2, t4.zoom, i2, a2);
              }};
            }
            return {kind: "source", evaluate: function(t4, o3) {
              var s3 = o3 && o3.properties ? o3.properties[e3.property] : void 0;
              return s3 === void 0 ? Rr(e3.default, r2.default) : n2(e3, r2, s3, i2, a2);
            }};
          }(this._parameters, this._specification));
        };
        function $r(t2) {
          var e2 = t2.key, r2 = t2.value, n2 = t2.valueSpec || {}, i2 = t2.objectElementValidators || {}, a2 = t2.style, o2 = t2.styleSpec, s2 = [], u2 = Dr(r2);
          if (u2 !== "object")
            return [new Pt(e2, r2, "object expected, " + u2 + " found")];
          for (var l2 in r2) {
            var p2 = l2.split(".")[0], c2 = n2[p2] || n2["*"], h2 = void 0;
            if (i2[p2])
              h2 = i2[p2];
            else if (n2[p2])
              h2 = An;
            else if (i2["*"])
              h2 = i2["*"];
            else {
              if (!n2["*"]) {
                s2.push(new Pt(e2, r2[l2], 'unknown property "' + l2 + '"'));
                continue;
              }
              h2 = An;
            }
            s2 = s2.concat(h2({key: (e2 ? e2 + "." : e2) + l2, value: r2[l2], valueSpec: c2, style: a2, styleSpec: o2, object: r2, objectKey: l2}, r2));
          }
          for (var f2 in n2)
            i2[f2] || n2[f2].required && n2[f2].default === void 0 && r2[f2] === void 0 && s2.push(new Pt(e2, r2, 'missing required property "' + f2 + '"'));
          return s2;
        }
        function Wr(t2) {
          var e2 = t2.value, r2 = t2.valueSpec, n2 = t2.style, i2 = t2.styleSpec, a2 = t2.key, o2 = t2.arrayElementValidator || An;
          if (Dr(e2) !== "array")
            return [new Pt(a2, e2, "array expected, " + Dr(e2) + " found")];
          if (r2.length && e2.length !== r2.length)
            return [new Pt(a2, e2, "array length " + r2.length + " expected, length " + e2.length + " found")];
          if (r2["min-length"] && e2.length < r2["min-length"])
            return [new Pt(a2, e2, "array length at least " + r2["min-length"] + " expected, length " + e2.length + " found")];
          var s2 = {type: r2.value, values: r2.values};
          i2.$version < 7 && (s2.function = r2.function), Dr(r2.value) === "object" && (s2 = r2.value);
          for (var u2 = [], l2 = 0; l2 < e2.length; l2++)
            u2 = u2.concat(o2({array: e2, arrayIndex: l2, value: e2[l2], valueSpec: s2, style: n2, styleSpec: i2, key: a2 + "[" + l2 + "]"}));
          return u2;
        }
        function Qr(t2) {
          var e2 = t2.key, r2 = t2.value, n2 = t2.valueSpec, i2 = Dr(r2);
          return i2 === "number" && r2 != r2 && (i2 = "NaN"), i2 !== "number" ? [new Pt(e2, r2, "number expected, " + i2 + " found")] : "minimum" in n2 && r2 < n2.minimum ? [new Pt(e2, r2, r2 + " is less than the minimum value " + n2.minimum)] : "maximum" in n2 && r2 > n2.maximum ? [new Pt(e2, r2, r2 + " is greater than the maximum value " + n2.maximum)] : [];
        }
        function tn(t2) {
          var e2, r2, n2, i2 = t2.valueSpec, a2 = Tt(t2.value.type), o2 = {}, s2 = a2 !== "categorical" && t2.value.property === void 0, u2 = !s2, l2 = Dr(t2.value.stops) === "array" && Dr(t2.value.stops[0]) === "array" && Dr(t2.value.stops[0][0]) === "object", p2 = $r({key: t2.key, value: t2.value, valueSpec: t2.styleSpec.function, style: t2.style, styleSpec: t2.styleSpec, objectElementValidators: {stops: function(t3) {
            if (a2 === "identity")
              return [new Pt(t3.key, t3.value, 'identity function may not have a "stops" property')];
            var e3 = [], r3 = t3.value;
            return e3 = e3.concat(Wr({key: t3.key, value: r3, valueSpec: t3.valueSpec, style: t3.style, styleSpec: t3.styleSpec, arrayElementValidator: c2})), Dr(r3) === "array" && r3.length === 0 && e3.push(new Pt(t3.key, r3, "array must have at least one stop")), e3;
          }, default: function(t3) {
            return An({key: t3.key, value: t3.value, valueSpec: i2, style: t3.style, styleSpec: t3.styleSpec});
          }}});
          return a2 === "identity" && s2 && p2.push(new Pt(t2.key, t2.value, 'missing required property "property"')), a2 === "identity" || t2.value.stops || p2.push(new Pt(t2.key, t2.value, 'missing required property "stops"')), a2 === "exponential" && t2.valueSpec.expression && !Fr(t2.valueSpec) && p2.push(new Pt(t2.key, t2.value, "exponential functions not supported")), t2.styleSpec.$version >= 8 && (u2 && !Tr(t2.valueSpec) ? p2.push(new Pt(t2.key, t2.value, "property functions not supported")) : s2 && !Vr(t2.valueSpec) && p2.push(new Pt(t2.key, t2.value, "zoom functions not supported"))), a2 !== "categorical" && !l2 || t2.value.property !== void 0 || p2.push(new Pt(t2.key, t2.value, '"property" property is required')), p2;
          function c2(t3) {
            var e3 = [], a3 = t3.value, s3 = t3.key;
            if (Dr(a3) !== "array")
              return [new Pt(s3, a3, "array expected, " + Dr(a3) + " found")];
            if (a3.length !== 2)
              return [new Pt(s3, a3, "array length 2 expected, length " + a3.length + " found")];
            if (l2) {
              if (Dr(a3[0]) !== "object")
                return [new Pt(s3, a3, "object expected, " + Dr(a3[0]) + " found")];
              if (a3[0].zoom === void 0)
                return [new Pt(s3, a3, "object stop key must have zoom")];
              if (a3[0].value === void 0)
                return [new Pt(s3, a3, "object stop key must have value")];
              if (n2 && n2 > Tt(a3[0].zoom))
                return [new Pt(s3, a3[0].zoom, "stop zoom values must appear in ascending order")];
              Tt(a3[0].zoom) !== n2 && (n2 = Tt(a3[0].zoom), r2 = void 0, o2 = {}), e3 = e3.concat($r({key: s3 + "[0]", value: a3[0], valueSpec: {zoom: {}}, style: t3.style, styleSpec: t3.styleSpec, objectElementValidators: {zoom: Qr, value: h2}}));
            } else
              e3 = e3.concat(h2({key: s3 + "[0]", value: a3[0], valueSpec: {}, style: t3.style, styleSpec: t3.styleSpec}, a3));
            return Gr(Vt(a3[1])) ? e3.concat([new Pt(s3 + "[1]", a3[1], "expressions are not allowed in function stops.")]) : e3.concat(An({key: s3 + "[1]", value: a3[1], valueSpec: i2, style: t3.style, styleSpec: t3.styleSpec}));
          }
          function h2(t3, n3) {
            var s3 = Dr(t3.value), u3 = Tt(t3.value), l3 = t3.value !== null ? t3.value : n3;
            if (e2) {
              if (s3 !== e2)
                return [new Pt(t3.key, l3, s3 + " stop domain type must match previous stop domain type " + e2)];
            } else
              e2 = s3;
            if (s3 !== "number" && s3 !== "string" && s3 !== "boolean")
              return [new Pt(t3.key, l3, "stop domain value must be a number, string, or boolean")];
            if (s3 !== "number" && a2 !== "categorical") {
              var p3 = "number expected, " + s3 + " found";
              return Tr(i2) && a2 === void 0 && (p3 += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'), [new Pt(t3.key, l3, p3)];
            }
            return a2 !== "categorical" || s3 !== "number" || isFinite(u3) && Math.floor(u3) === u3 ? a2 !== "categorical" && s3 === "number" && r2 !== void 0 && u3 < r2 ? [new Pt(t3.key, l3, "stop domain values must appear in ascending order")] : (r2 = u3, a2 === "categorical" && u3 in o2 ? [new Pt(t3.key, l3, "stop domain values must be unique")] : (o2[u3] = true, [])) : [new Pt(t3.key, l3, "integer expected, found " + u3)];
          }
        }
        function en(t2) {
          var e2 = (t2.expressionContext === "property" ? Hr : Zr)(Vt(t2.value), t2.valueSpec);
          if (e2.result === "error")
            return e2.value.map(function(e3) {
              return new Pt("" + t2.key + e3.key, t2.value, e3.message);
            });
          var r2 = e2.value.expression || e2.value._styleExpression.expression;
          if (t2.expressionContext === "property" && t2.propertyKey === "text-font" && !r2.outputDefined())
            return [new Pt(t2.key, t2.value, 'Invalid data expression for "' + t2.propertyKey + '". Output values must be contained as literals within the expression.')];
          if (t2.expressionContext === "property" && t2.propertyType === "layout" && !Oe(r2))
            return [new Pt(t2.key, t2.value, '"feature-state" data expressions are not supported with layout properties.')];
          if (t2.expressionContext === "filter" && !Oe(r2))
            return [new Pt(t2.key, t2.value, '"feature-state" data expressions are not supported with filters.')];
          if (t2.expressionContext && t2.expressionContext.indexOf("cluster") === 0) {
            if (!Re(r2, ["zoom", "feature-state"]))
              return [new Pt(t2.key, t2.value, '"zoom" and "feature-state" expressions are not supported with cluster properties.')];
            if (t2.expressionContext === "cluster-initial" && !Le(r2))
              return [new Pt(t2.key, t2.value, "Feature data expressions are not supported with initial expression part of cluster properties.")];
          }
          return [];
        }
        function rn(t2) {
          var e2 = t2.key, r2 = t2.value, n2 = t2.valueSpec, i2 = [];
          return Array.isArray(n2.values) ? n2.values.indexOf(Tt(r2)) === -1 && i2.push(new Pt(e2, r2, "expected one of [" + n2.values.join(", ") + "], " + JSON.stringify(r2) + " found")) : Object.keys(n2.values).indexOf(Tt(r2)) === -1 && i2.push(new Pt(e2, r2, "expected one of [" + Object.keys(n2.values).join(", ") + "], " + JSON.stringify(r2) + " found")), i2;
        }
        function nn(t2) {
          if (t2 === true || t2 === false)
            return true;
          if (!Array.isArray(t2) || t2.length === 0)
            return false;
          switch (t2[0]) {
            case "has":
              return t2.length >= 2 && t2[1] !== "$id" && t2[1] !== "$type";
            case "in":
              return t2.length >= 3 && (typeof t2[1] != "string" || Array.isArray(t2[2]));
            case "!in":
            case "!has":
            case "none":
              return false;
            case "==":
            case "!=":
            case ">":
            case ">=":
            case "<":
            case "<=":
              return t2.length !== 3 || Array.isArray(t2[1]) || Array.isArray(t2[2]);
            case "any":
            case "all":
              for (var e2 = 0, r2 = t2.slice(1); e2 < r2.length; e2 += 1) {
                var n2 = r2[e2];
                if (!nn(n2) && typeof n2 != "boolean")
                  return false;
              }
              return true;
            default:
              return true;
          }
        }
        Yr.deserialize = function(t2) {
          return new Yr(t2._parameters, t2._specification);
        }, Yr.serialize = function(t2) {
          return {_parameters: t2._parameters, _specification: t2._specification};
        };
        var an = {type: "boolean", default: false, transition: false, "property-type": "data-driven", expression: {interpolated: false, parameters: ["zoom", "feature"]}};
        function on(t2) {
          if (t2 == null)
            return {filter: function() {
              return true;
            }, needGeometry: false};
          nn(t2) || (t2 = un(t2));
          var e2 = Zr(t2, an);
          if (e2.result === "error")
            throw new Error(e2.value.map(function(t3) {
              return t3.key + ": " + t3.message;
            }).join(", "));
          return {filter: function(t3, r2, n2) {
            return e2.value.evaluate(t3, r2, {}, n2);
          }, needGeometry: function t3(e3) {
            if (!Array.isArray(e3))
              return false;
            if (e3[0] === "within")
              return true;
            for (var r2 = 1; r2 < e3.length; r2++)
              if (t3(e3[r2]))
                return true;
            return false;
          }(t2)};
        }
        function sn(t2, e2) {
          return t2 < e2 ? -1 : t2 > e2 ? 1 : 0;
        }
        function un(t2) {
          if (!t2)
            return true;
          var e2, r2 = t2[0];
          return t2.length <= 1 ? r2 !== "any" : r2 === "==" ? ln(t2[1], t2[2], "==") : r2 === "!=" ? hn(ln(t2[1], t2[2], "==")) : r2 === "<" || r2 === ">" || r2 === "<=" || r2 === ">=" ? ln(t2[1], t2[2], r2) : r2 === "any" ? (e2 = t2.slice(1), ["any"].concat(e2.map(un))) : r2 === "all" ? ["all"].concat(t2.slice(1).map(un)) : r2 === "none" ? ["all"].concat(t2.slice(1).map(un).map(hn)) : r2 === "in" ? pn(t2[1], t2.slice(2)) : r2 === "!in" ? hn(pn(t2[1], t2.slice(2))) : r2 === "has" ? cn(t2[1]) : r2 === "!has" ? hn(cn(t2[1])) : r2 !== "within" || t2;
        }
        function ln(t2, e2, r2) {
          switch (t2) {
            case "$type":
              return ["filter-type-" + r2, e2];
            case "$id":
              return ["filter-id-" + r2, e2];
            default:
              return ["filter-" + r2, t2, e2];
          }
        }
        function pn(t2, e2) {
          if (e2.length === 0)
            return false;
          switch (t2) {
            case "$type":
              return ["filter-type-in", ["literal", e2]];
            case "$id":
              return ["filter-id-in", ["literal", e2]];
            default:
              return e2.length > 200 && !e2.some(function(t3) {
                return typeof t3 != typeof e2[0];
              }) ? ["filter-in-large", t2, ["literal", e2.sort(sn)]] : ["filter-in-small", t2, ["literal", e2]];
          }
        }
        function cn(t2) {
          switch (t2) {
            case "$type":
              return true;
            case "$id":
              return ["filter-has-id"];
            default:
              return ["filter-has", t2];
          }
        }
        function hn(t2) {
          return ["!", t2];
        }
        function fn(t2) {
          return nn(Vt(t2.value)) ? en(Bt({}, t2, {expressionContext: "filter", valueSpec: {value: "boolean"}})) : function t3(e2) {
            var r2 = e2.value, n2 = e2.key;
            if (Dr(r2) !== "array")
              return [new Pt(n2, r2, "array expected, " + Dr(r2) + " found")];
            var i2, a2 = e2.styleSpec, o2 = [];
            if (r2.length < 1)
              return [new Pt(n2, r2, "filter array must have at least 1 element")];
            switch (o2 = o2.concat(rn({key: n2 + "[0]", value: r2[0], valueSpec: a2.filter_operator, style: e2.style, styleSpec: e2.styleSpec})), Tt(r2[0])) {
              case "<":
              case "<=":
              case ">":
              case ">=":
                r2.length >= 2 && Tt(r2[1]) === "$type" && o2.push(new Pt(n2, r2, '"$type" cannot be use with operator "' + r2[0] + '"'));
              case "==":
              case "!=":
                r2.length !== 3 && o2.push(new Pt(n2, r2, 'filter array for operator "' + r2[0] + '" must have 3 elements'));
              case "in":
              case "!in":
                r2.length >= 2 && (i2 = Dr(r2[1])) !== "string" && o2.push(new Pt(n2 + "[1]", r2[1], "string expected, " + i2 + " found"));
                for (var s2 = 2; s2 < r2.length; s2++)
                  i2 = Dr(r2[s2]), Tt(r2[1]) === "$type" ? o2 = o2.concat(rn({key: n2 + "[" + s2 + "]", value: r2[s2], valueSpec: a2.geometry_type, style: e2.style, styleSpec: e2.styleSpec})) : i2 !== "string" && i2 !== "number" && i2 !== "boolean" && o2.push(new Pt(n2 + "[" + s2 + "]", r2[s2], "string, number, or boolean expected, " + i2 + " found"));
                break;
              case "any":
              case "all":
              case "none":
                for (var u2 = 1; u2 < r2.length; u2++)
                  o2 = o2.concat(t3({key: n2 + "[" + u2 + "]", value: r2[u2], style: e2.style, styleSpec: e2.styleSpec}));
                break;
              case "has":
              case "!has":
                i2 = Dr(r2[1]), r2.length !== 2 ? o2.push(new Pt(n2, r2, 'filter array for "' + r2[0] + '" operator must have 2 elements')) : i2 !== "string" && o2.push(new Pt(n2 + "[1]", r2[1], "string expected, " + i2 + " found"));
                break;
              case "within":
                i2 = Dr(r2[1]), r2.length !== 2 ? o2.push(new Pt(n2, r2, 'filter array for "' + r2[0] + '" operator must have 2 elements')) : i2 !== "object" && o2.push(new Pt(n2 + "[1]", r2[1], "object expected, " + i2 + " found"));
            }
            return o2;
          }(t2);
        }
        function yn(t2, e2) {
          var r2 = t2.key, n2 = t2.style, i2 = t2.styleSpec, a2 = t2.value, o2 = t2.objectKey, s2 = i2[e2 + "_" + t2.layerType];
          if (!s2)
            return [];
          var u2 = o2.match(/^(.*)-transition$/);
          if (e2 === "paint" && u2 && s2[u2[1]] && s2[u2[1]].transition)
            return An({key: r2, value: a2, valueSpec: i2.transition, style: n2, styleSpec: i2});
          var l2, p2 = t2.valueSpec || s2[o2];
          if (!p2)
            return [new Pt(r2, a2, 'unknown property "' + o2 + '"')];
          if (Dr(a2) === "string" && Tr(p2) && !p2.tokens && (l2 = /^{([^}]+)}$/.exec(a2)))
            return [new Pt(r2, a2, '"' + o2 + '" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ' + JSON.stringify(l2[1]) + " }`.")];
          var c2 = [];
          return t2.layerType === "symbol" && (o2 === "text-field" && n2 && !n2.glyphs && c2.push(new Pt(r2, a2, 'use of "text-field" requires a style "glyphs" property')), o2 === "text-font" && Lr(Vt(a2)) && Tt(a2.type) === "identity" && c2.push(new Pt(r2, a2, '"text-font" does not support identity functions'))), c2.concat(An({key: t2.key, value: a2, valueSpec: p2, style: n2, styleSpec: i2, expressionContext: "property", propertyType: e2, propertyKey: o2}));
        }
        function dn(t2) {
          return yn(t2, "paint");
        }
        function mn(t2) {
          return yn(t2, "layout");
        }
        function vn(t2) {
          var e2 = [], r2 = t2.value, n2 = t2.key, i2 = t2.style, a2 = t2.styleSpec;
          r2.type || r2.ref || e2.push(new Pt(n2, r2, 'either "type" or "ref" is required'));
          var o2, s2 = Tt(r2.type), u2 = Tt(r2.ref);
          if (r2.id)
            for (var l2 = Tt(r2.id), p2 = 0; p2 < t2.arrayIndex; p2++) {
              var c2 = i2.layers[p2];
              Tt(c2.id) === l2 && e2.push(new Pt(n2, r2.id, 'duplicate layer id "' + r2.id + '", previously used at line ' + c2.id.__line__));
            }
          if ("ref" in r2)
            ["type", "source", "source-layer", "filter", "layout"].forEach(function(t3) {
              t3 in r2 && e2.push(new Pt(n2, r2[t3], '"' + t3 + '" is prohibited for ref layers'));
            }), i2.layers.forEach(function(t3) {
              Tt(t3.id) === u2 && (o2 = t3);
            }), o2 ? o2.ref ? e2.push(new Pt(n2, r2.ref, "ref cannot reference another ref layer")) : s2 = Tt(o2.type) : e2.push(new Pt(n2, r2.ref, 'ref layer "' + u2 + '" not found'));
          else if (s2 !== "background")
            if (r2.source) {
              var h2 = i2.sources && i2.sources[r2.source], f2 = h2 && Tt(h2.type);
              h2 ? f2 === "vector" && s2 === "raster" ? e2.push(new Pt(n2, r2.source, 'layer "' + r2.id + '" requires a raster source')) : f2 === "raster" && s2 !== "raster" ? e2.push(new Pt(n2, r2.source, 'layer "' + r2.id + '" requires a vector source')) : f2 !== "vector" || r2["source-layer"] ? f2 === "raster-dem" && s2 !== "hillshade" ? e2.push(new Pt(n2, r2.source, "raster-dem source can only be used with layer type 'hillshade'.")) : s2 !== "line" || !r2.paint || !r2.paint["line-gradient"] || f2 === "geojson" && h2.lineMetrics || e2.push(new Pt(n2, r2, 'layer "' + r2.id + '" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')) : e2.push(new Pt(n2, r2, 'layer "' + r2.id + '" must specify a "source-layer"')) : e2.push(new Pt(n2, r2.source, 'source "' + r2.source + '" not found'));
            } else
              e2.push(new Pt(n2, r2, 'missing required property "source"'));
          return e2 = e2.concat($r({key: n2, value: r2, valueSpec: a2.layer, style: t2.style, styleSpec: t2.styleSpec, objectElementValidators: {"*": function() {
            return [];
          }, type: function() {
            return An({key: n2 + ".type", value: r2.type, valueSpec: a2.layer.type, style: t2.style, styleSpec: t2.styleSpec, object: r2, objectKey: "type"});
          }, filter: fn, layout: function(t3) {
            return $r({layer: r2, key: t3.key, value: t3.value, style: t3.style, styleSpec: t3.styleSpec, objectElementValidators: {"*": function(t4) {
              return mn(Bt({layerType: s2}, t4));
            }}});
          }, paint: function(t3) {
            return $r({layer: r2, key: t3.key, value: t3.value, style: t3.style, styleSpec: t3.styleSpec, objectElementValidators: {"*": function(t4) {
              return dn(Bt({layerType: s2}, t4));
            }}});
          }}}));
        }
        function gn(t2) {
          var e2 = t2.value, r2 = t2.key, n2 = Dr(e2);
          return n2 !== "string" ? [new Pt(r2, e2, "string expected, " + n2 + " found")] : [];
        }
        var xn = {promoteId: function(t2) {
          var e2 = t2.key, r2 = t2.value;
          if (Dr(r2) === "string")
            return gn({key: e2, value: r2});
          var n2 = [];
          for (var i2 in r2)
            n2.push.apply(n2, gn({key: e2 + "." + i2, value: r2[i2]}));
          return n2;
        }};
        function bn(t2) {
          var e2 = t2.value, r2 = t2.key, n2 = t2.styleSpec, i2 = t2.style;
          if (!e2.type)
            return [new Pt(r2, e2, '"type" is required')];
          var a2, o2 = Tt(e2.type);
          switch (o2) {
            case "vector":
            case "raster":
            case "raster-dem":
              return $r({key: r2, value: e2, valueSpec: n2["source_" + o2.replace("-", "_")], style: t2.style, styleSpec: n2, objectElementValidators: xn});
            case "geojson":
              if (a2 = $r({key: r2, value: e2, valueSpec: n2.source_geojson, style: i2, styleSpec: n2, objectElementValidators: xn}), e2.cluster)
                for (var s2 in e2.clusterProperties) {
                  var u2 = e2.clusterProperties[s2], l2 = u2[0], p2 = typeof l2 == "string" ? [l2, ["accumulated"], ["get", s2]] : l2;
                  a2.push.apply(a2, en({key: r2 + "." + s2 + ".map", value: u2[1], expressionContext: "cluster-map"})), a2.push.apply(a2, en({key: r2 + "." + s2 + ".reduce", value: p2, expressionContext: "cluster-reduce"}));
                }
              return a2;
            case "video":
              return $r({key: r2, value: e2, valueSpec: n2.source_video, style: i2, styleSpec: n2});
            case "image":
              return $r({key: r2, value: e2, valueSpec: n2.source_image, style: i2, styleSpec: n2});
            case "canvas":
              return [new Pt(r2, null, "Please use runtime APIs to add canvas sources, rather than including them in stylesheets.", "source.canvas")];
            default:
              return rn({key: r2 + ".type", value: e2.type, valueSpec: {values: ["vector", "raster", "raster-dem", "geojson", "video", "image"]}, style: i2, styleSpec: n2});
          }
        }
        function wn(t2) {
          var e2 = t2.value, r2 = t2.styleSpec, n2 = r2.light, i2 = t2.style, a2 = [], o2 = Dr(e2);
          if (e2 === void 0)
            return a2;
          if (o2 !== "object")
            return a2.concat([new Pt("light", e2, "object expected, " + o2 + " found")]);
          for (var s2 in e2) {
            var u2 = s2.match(/^(.*)-transition$/);
            a2 = a2.concat(u2 && n2[u2[1]] && n2[u2[1]].transition ? An({key: s2, value: e2[s2], valueSpec: r2.transition, style: i2, styleSpec: r2}) : n2[s2] ? An({key: s2, value: e2[s2], valueSpec: n2[s2], style: i2, styleSpec: r2}) : [new Pt(s2, e2[s2], 'unknown property "' + s2 + '"')]);
          }
          return a2;
        }
        var _n = {"*": function() {
          return [];
        }, array: Wr, boolean: function(t2) {
          var e2 = t2.value, r2 = t2.key, n2 = Dr(e2);
          return n2 !== "boolean" ? [new Pt(r2, e2, "boolean expected, " + n2 + " found")] : [];
        }, number: Qr, color: function(t2) {
          var e2 = t2.key, r2 = t2.value, n2 = Dr(r2);
          return n2 !== "string" ? [new Pt(e2, r2, "color expected, " + n2 + " found")] : Qt(r2) === null ? [new Pt(e2, r2, 'color expected, "' + r2 + '" found')] : [];
        }, constants: Mt, enum: rn, filter: fn, function: tn, layer: vn, object: $r, source: bn, light: wn, string: gn, formatted: function(t2) {
          return gn(t2).length === 0 ? [] : en(t2);
        }, resolvedImage: function(t2) {
          return gn(t2).length === 0 ? [] : en(t2);
        }};
        function An(t2) {
          var e2 = t2.value, r2 = t2.valueSpec, n2 = t2.styleSpec;
          return r2.expression && Lr(Tt(e2)) ? tn(t2) : r2.expression && Gr(Vt(e2)) ? en(t2) : r2.type && _n[r2.type] ? _n[r2.type](t2) : $r(Bt({}, t2, {valueSpec: r2.type ? n2[r2.type] : r2}));
        }
        function Sn(t2) {
          var e2 = t2.value, r2 = t2.key, n2 = gn(t2);
          return n2.length || (e2.indexOf("{fontstack}") === -1 && n2.push(new Pt(r2, e2, '"glyphs" url must include a "{fontstack}" token')), e2.indexOf("{range}") === -1 && n2.push(new Pt(r2, e2, '"glyphs" url must include a "{range}" token'))), n2;
        }
        function kn(t2, e2) {
          e2 === void 0 && (e2 = Et);
          var r2 = [];
          return r2 = r2.concat(An({key: "", value: t2, valueSpec: e2.$root, styleSpec: e2, style: t2, objectElementValidators: {glyphs: Sn, "*": function() {
            return [];
          }}})), t2.constants && (r2 = r2.concat(Mt({key: "constants", value: t2.constants, style: t2, styleSpec: e2}))), In(r2);
        }
        function In(t2) {
          return [].concat(t2).sort(function(t3, e2) {
            return t3.line - e2.line;
          });
        }
        function zn(t2) {
          return function() {
            for (var e2 = [], r2 = arguments.length; r2--; )
              e2[r2] = arguments[r2];
            return In(t2.apply(this, e2));
          };
        }
        kn.source = zn(bn), kn.light = zn(wn), kn.layer = zn(vn), kn.filter = zn(fn), kn.paintProperty = zn(dn), kn.layoutProperty = zn(mn);
        var Cn = kn, En = Cn.light, Pn = Cn.paintProperty, Mn = Cn.layoutProperty;
        function Bn(t2, e2) {
          var r2 = false;
          if (e2 && e2.length)
            for (var n2 = 0, i2 = e2; n2 < i2.length; n2 += 1)
              t2.fire(new zt(new Error(i2[n2].message))), r2 = true;
          return r2;
        }
        var Tn = Vn;
        function Vn(t2, e2, r2) {
          var n2 = this.cells = [];
          if (t2 instanceof ArrayBuffer) {
            this.arrayBuffer = t2;
            var i2 = new Int32Array(this.arrayBuffer);
            t2 = i2[0], this.d = (e2 = i2[1]) + 2 * (r2 = i2[2]);
            for (var a2 = 0; a2 < this.d * this.d; a2++) {
              var o2 = i2[3 + a2], s2 = i2[3 + a2 + 1];
              n2.push(o2 === s2 ? null : i2.subarray(o2, s2));
            }
            var u2 = i2[3 + n2.length + 1];
            this.keys = i2.subarray(i2[3 + n2.length], u2), this.bboxes = i2.subarray(u2), this.insert = this._insertReadonly;
          } else {
            this.d = e2 + 2 * r2;
            for (var l2 = 0; l2 < this.d * this.d; l2++)
              n2.push([]);
            this.keys = [], this.bboxes = [];
          }
          this.n = e2, this.extent = t2, this.padding = r2, this.scale = e2 / t2, this.uid = 0;
          var p2 = r2 / e2 * t2;
          this.min = -p2, this.max = t2 + p2;
        }
        Vn.prototype.insert = function(t2, e2, r2, n2, i2) {
          this._forEachCell(e2, r2, n2, i2, this._insertCell, this.uid++), this.keys.push(t2), this.bboxes.push(e2), this.bboxes.push(r2), this.bboxes.push(n2), this.bboxes.push(i2);
        }, Vn.prototype._insertReadonly = function() {
          throw "Cannot insert into a GridIndex created from an ArrayBuffer.";
        }, Vn.prototype._insertCell = function(t2, e2, r2, n2, i2, a2) {
          this.cells[i2].push(a2);
        }, Vn.prototype.query = function(t2, e2, r2, n2, i2) {
          var a2 = this.min, o2 = this.max;
          if (t2 <= a2 && e2 <= a2 && o2 <= r2 && o2 <= n2 && !i2)
            return Array.prototype.slice.call(this.keys);
          var s2 = [];
          return this._forEachCell(t2, e2, r2, n2, this._queryCell, s2, {}, i2), s2;
        }, Vn.prototype._queryCell = function(t2, e2, r2, n2, i2, a2, o2, s2) {
          var u2 = this.cells[i2];
          if (u2 !== null)
            for (var l2 = this.keys, p2 = this.bboxes, c2 = 0; c2 < u2.length; c2++) {
              var h2 = u2[c2];
              if (o2[h2] === void 0) {
                var f2 = 4 * h2;
                (s2 ? s2(p2[f2 + 0], p2[f2 + 1], p2[f2 + 2], p2[f2 + 3]) : t2 <= p2[f2 + 2] && e2 <= p2[f2 + 3] && r2 >= p2[f2 + 0] && n2 >= p2[f2 + 1]) ? (o2[h2] = true, a2.push(l2[h2])) : o2[h2] = false;
              }
            }
        }, Vn.prototype._forEachCell = function(t2, e2, r2, n2, i2, a2, o2, s2) {
          for (var u2 = this._convertToCellCoord(t2), l2 = this._convertToCellCoord(e2), p2 = this._convertToCellCoord(r2), c2 = this._convertToCellCoord(n2), h2 = u2; h2 <= p2; h2++)
            for (var f2 = l2; f2 <= c2; f2++) {
              var y2 = this.d * f2 + h2;
              if ((!s2 || s2(this._convertFromCellCoord(h2), this._convertFromCellCoord(f2), this._convertFromCellCoord(h2 + 1), this._convertFromCellCoord(f2 + 1))) && i2.call(this, t2, e2, r2, n2, y2, a2, o2, s2))
                return;
            }
        }, Vn.prototype._convertFromCellCoord = function(t2) {
          return (t2 - this.padding) / this.scale;
        }, Vn.prototype._convertToCellCoord = function(t2) {
          return Math.max(0, Math.min(this.d - 1, Math.floor(t2 * this.scale) + this.padding));
        }, Vn.prototype.toArrayBuffer = function() {
          if (this.arrayBuffer)
            return this.arrayBuffer;
          for (var t2 = this.cells, e2 = 3 + this.cells.length + 1 + 1, r2 = 0, n2 = 0; n2 < this.cells.length; n2++)
            r2 += this.cells[n2].length;
          var i2 = new Int32Array(e2 + r2 + this.keys.length + this.bboxes.length);
          i2[0] = this.extent, i2[1] = this.n, i2[2] = this.padding;
          for (var a2 = e2, o2 = 0; o2 < t2.length; o2++) {
            var s2 = t2[o2];
            i2[3 + o2] = a2, i2.set(s2, a2), a2 += s2.length;
          }
          return i2[3 + t2.length] = a2, i2.set(this.keys, a2), i2[3 + t2.length + 1] = a2 += this.keys.length, i2.set(this.bboxes, a2), a2 += this.bboxes.length, i2.buffer;
        };
        var Fn = o.ImageData, Dn = o.ImageBitmap, Ln = {};
        function On(t2, e2, r2) {
          r2 === void 0 && (r2 = {}), Object.defineProperty(e2, "_classRegistryKey", {value: t2, writeable: false}), Ln[t2] = {klass: e2, omit: r2.omit || [], shallow: r2.shallow || []};
        }
        for (var Rn in On("Object", Object), Tn.serialize = function(t2, e2) {
          var r2 = t2.toArrayBuffer();
          return e2 && e2.push(r2), {buffer: r2};
        }, Tn.deserialize = function(t2) {
          return new Tn(t2.buffer);
        }, On("Grid", Tn), On("Color", te), On("Error", Error), On("ResolvedImage", ie), On("StylePropertyFunction", Yr), On("StyleExpression", Kr, {omit: ["_evaluator"]}), On("ZoomDependentExpression", Jr), On("ZoomConstantExpression", Xr), On("CompoundExpression", xe, {omit: ["_evaluate"]}), Ir)
          Ir[Rn]._classRegistryKey || On("Expression_" + Rn, Ir[Rn]);
        function Un(t2) {
          return t2 && typeof ArrayBuffer != "undefined" && (t2 instanceof ArrayBuffer || t2.constructor && t2.constructor.name === "ArrayBuffer");
        }
        function jn(t2) {
          return Dn && t2 instanceof Dn;
        }
        function qn(t2, e2) {
          if (t2 == null || typeof t2 == "boolean" || typeof t2 == "number" || typeof t2 == "string" || t2 instanceof Boolean || t2 instanceof Number || t2 instanceof String || t2 instanceof Date || t2 instanceof RegExp)
            return t2;
          if (Un(t2) || jn(t2))
            return e2 && e2.push(t2), t2;
          if (ArrayBuffer.isView(t2)) {
            var r2 = t2;
            return e2 && e2.push(r2.buffer), r2;
          }
          if (t2 instanceof Fn)
            return e2 && e2.push(t2.data.buffer), t2;
          if (Array.isArray(t2)) {
            for (var n2 = [], i2 = 0, a2 = t2; i2 < a2.length; i2 += 1)
              n2.push(qn(a2[i2], e2));
            return n2;
          }
          if (typeof t2 == "object") {
            var o2 = t2.constructor, s2 = o2._classRegistryKey;
            if (!s2)
              throw new Error("can't serialize object of unregistered class");
            var u2 = o2.serialize ? o2.serialize(t2, e2) : {};
            if (!o2.serialize) {
              for (var l2 in t2)
                if (t2.hasOwnProperty(l2) && !(Ln[s2].omit.indexOf(l2) >= 0)) {
                  var p2 = t2[l2];
                  u2[l2] = Ln[s2].shallow.indexOf(l2) >= 0 ? p2 : qn(p2, e2);
                }
              t2 instanceof Error && (u2.message = t2.message);
            }
            if (u2.$name)
              throw new Error("$name property is reserved for worker serialization logic.");
            return s2 !== "Object" && (u2.$name = s2), u2;
          }
          throw new Error("can't serialize object of type " + typeof t2);
        }
        function Nn(t2) {
          if (t2 == null || typeof t2 == "boolean" || typeof t2 == "number" || typeof t2 == "string" || t2 instanceof Boolean || t2 instanceof Number || t2 instanceof String || t2 instanceof Date || t2 instanceof RegExp || Un(t2) || jn(t2) || ArrayBuffer.isView(t2) || t2 instanceof Fn)
            return t2;
          if (Array.isArray(t2))
            return t2.map(Nn);
          if (typeof t2 == "object") {
            var e2 = t2.$name || "Object", r2 = Ln[e2].klass;
            if (!r2)
              throw new Error("can't deserialize unregistered class " + e2);
            if (r2.deserialize)
              return r2.deserialize(t2);
            for (var n2 = Object.create(r2.prototype), i2 = 0, a2 = Object.keys(t2); i2 < a2.length; i2 += 1) {
              var o2 = a2[i2];
              if (o2 !== "$name") {
                var s2 = t2[o2];
                n2[o2] = Ln[e2].shallow.indexOf(o2) >= 0 ? s2 : Nn(s2);
              }
            }
            return n2;
          }
          throw new Error("can't deserialize object of type " + typeof t2);
        }
        var Kn = function() {
          this.first = true;
        };
        Kn.prototype.update = function(t2, e2) {
          var r2 = Math.floor(t2);
          return this.first ? (this.first = false, this.lastIntegerZoom = r2, this.lastIntegerZoomTime = 0, this.lastZoom = t2, this.lastFloorZoom = r2, true) : (this.lastFloorZoom > r2 ? (this.lastIntegerZoom = r2 + 1, this.lastIntegerZoomTime = e2) : this.lastFloorZoom < r2 && (this.lastIntegerZoom = r2, this.lastIntegerZoomTime = e2), t2 !== this.lastZoom && (this.lastZoom = t2, this.lastFloorZoom = r2, true));
        };
        var Gn = {"Latin-1 Supplement": function(t2) {
          return t2 >= 128 && t2 <= 255;
        }, Arabic: function(t2) {
          return t2 >= 1536 && t2 <= 1791;
        }, "Arabic Supplement": function(t2) {
          return t2 >= 1872 && t2 <= 1919;
        }, "Arabic Extended-A": function(t2) {
          return t2 >= 2208 && t2 <= 2303;
        }, "Hangul Jamo": function(t2) {
          return t2 >= 4352 && t2 <= 4607;
        }, "Unified Canadian Aboriginal Syllabics": function(t2) {
          return t2 >= 5120 && t2 <= 5759;
        }, Khmer: function(t2) {
          return t2 >= 6016 && t2 <= 6143;
        }, "Unified Canadian Aboriginal Syllabics Extended": function(t2) {
          return t2 >= 6320 && t2 <= 6399;
        }, "General Punctuation": function(t2) {
          return t2 >= 8192 && t2 <= 8303;
        }, "Letterlike Symbols": function(t2) {
          return t2 >= 8448 && t2 <= 8527;
        }, "Number Forms": function(t2) {
          return t2 >= 8528 && t2 <= 8591;
        }, "Miscellaneous Technical": function(t2) {
          return t2 >= 8960 && t2 <= 9215;
        }, "Control Pictures": function(t2) {
          return t2 >= 9216 && t2 <= 9279;
        }, "Optical Character Recognition": function(t2) {
          return t2 >= 9280 && t2 <= 9311;
        }, "Enclosed Alphanumerics": function(t2) {
          return t2 >= 9312 && t2 <= 9471;
        }, "Geometric Shapes": function(t2) {
          return t2 >= 9632 && t2 <= 9727;
        }, "Miscellaneous Symbols": function(t2) {
          return t2 >= 9728 && t2 <= 9983;
        }, "Miscellaneous Symbols and Arrows": function(t2) {
          return t2 >= 11008 && t2 <= 11263;
        }, "CJK Radicals Supplement": function(t2) {
          return t2 >= 11904 && t2 <= 12031;
        }, "Kangxi Radicals": function(t2) {
          return t2 >= 12032 && t2 <= 12255;
        }, "Ideographic Description Characters": function(t2) {
          return t2 >= 12272 && t2 <= 12287;
        }, "CJK Symbols and Punctuation": function(t2) {
          return t2 >= 12288 && t2 <= 12351;
        }, Hiragana: function(t2) {
          return t2 >= 12352 && t2 <= 12447;
        }, Katakana: function(t2) {
          return t2 >= 12448 && t2 <= 12543;
        }, Bopomofo: function(t2) {
          return t2 >= 12544 && t2 <= 12591;
        }, "Hangul Compatibility Jamo": function(t2) {
          return t2 >= 12592 && t2 <= 12687;
        }, Kanbun: function(t2) {
          return t2 >= 12688 && t2 <= 12703;
        }, "Bopomofo Extended": function(t2) {
          return t2 >= 12704 && t2 <= 12735;
        }, "CJK Strokes": function(t2) {
          return t2 >= 12736 && t2 <= 12783;
        }, "Katakana Phonetic Extensions": function(t2) {
          return t2 >= 12784 && t2 <= 12799;
        }, "Enclosed CJK Letters and Months": function(t2) {
          return t2 >= 12800 && t2 <= 13055;
        }, "CJK Compatibility": function(t2) {
          return t2 >= 13056 && t2 <= 13311;
        }, "CJK Unified Ideographs Extension A": function(t2) {
          return t2 >= 13312 && t2 <= 19903;
        }, "Yijing Hexagram Symbols": function(t2) {
          return t2 >= 19904 && t2 <= 19967;
        }, "CJK Unified Ideographs": function(t2) {
          return t2 >= 19968 && t2 <= 40959;
        }, "Yi Syllables": function(t2) {
          return t2 >= 40960 && t2 <= 42127;
        }, "Yi Radicals": function(t2) {
          return t2 >= 42128 && t2 <= 42191;
        }, "Hangul Jamo Extended-A": function(t2) {
          return t2 >= 43360 && t2 <= 43391;
        }, "Hangul Syllables": function(t2) {
          return t2 >= 44032 && t2 <= 55215;
        }, "Hangul Jamo Extended-B": function(t2) {
          return t2 >= 55216 && t2 <= 55295;
        }, "Private Use Area": function(t2) {
          return t2 >= 57344 && t2 <= 63743;
        }, "CJK Compatibility Ideographs": function(t2) {
          return t2 >= 63744 && t2 <= 64255;
        }, "Arabic Presentation Forms-A": function(t2) {
          return t2 >= 64336 && t2 <= 65023;
        }, "Vertical Forms": function(t2) {
          return t2 >= 65040 && t2 <= 65055;
        }, "CJK Compatibility Forms": function(t2) {
          return t2 >= 65072 && t2 <= 65103;
        }, "Small Form Variants": function(t2) {
          return t2 >= 65104 && t2 <= 65135;
        }, "Arabic Presentation Forms-B": function(t2) {
          return t2 >= 65136 && t2 <= 65279;
        }, "Halfwidth and Fullwidth Forms": function(t2) {
          return t2 >= 65280 && t2 <= 65519;
        }};
        function Zn(t2) {
          for (var e2 = 0, r2 = t2; e2 < r2.length; e2 += 1)
            if (Xn(r2[e2].charCodeAt(0)))
              return true;
          return false;
        }
        function Xn(t2) {
          return !(t2 !== 746 && t2 !== 747 && (t2 < 4352 || !(Gn["Bopomofo Extended"](t2) || Gn.Bopomofo(t2) || Gn["CJK Compatibility Forms"](t2) && !(t2 >= 65097 && t2 <= 65103) || Gn["CJK Compatibility Ideographs"](t2) || Gn["CJK Compatibility"](t2) || Gn["CJK Radicals Supplement"](t2) || Gn["CJK Strokes"](t2) || !(!Gn["CJK Symbols and Punctuation"](t2) || t2 >= 12296 && t2 <= 12305 || t2 >= 12308 && t2 <= 12319 || t2 === 12336) || Gn["CJK Unified Ideographs Extension A"](t2) || Gn["CJK Unified Ideographs"](t2) || Gn["Enclosed CJK Letters and Months"](t2) || Gn["Hangul Compatibility Jamo"](t2) || Gn["Hangul Jamo Extended-A"](t2) || Gn["Hangul Jamo Extended-B"](t2) || Gn["Hangul Jamo"](t2) || Gn["Hangul Syllables"](t2) || Gn.Hiragana(t2) || Gn["Ideographic Description Characters"](t2) || Gn.Kanbun(t2) || Gn["Kangxi Radicals"](t2) || Gn["Katakana Phonetic Extensions"](t2) || Gn.Katakana(t2) && t2 !== 12540 || !(!Gn["Halfwidth and Fullwidth Forms"](t2) || t2 === 65288 || t2 === 65289 || t2 === 65293 || t2 >= 65306 && t2 <= 65310 || t2 === 65339 || t2 === 65341 || t2 === 65343 || t2 >= 65371 && t2 <= 65503 || t2 === 65507 || t2 >= 65512 && t2 <= 65519) || !(!Gn["Small Form Variants"](t2) || t2 >= 65112 && t2 <= 65118 || t2 >= 65123 && t2 <= 65126) || Gn["Unified Canadian Aboriginal Syllabics"](t2) || Gn["Unified Canadian Aboriginal Syllabics Extended"](t2) || Gn["Vertical Forms"](t2) || Gn["Yijing Hexagram Symbols"](t2) || Gn["Yi Syllables"](t2) || Gn["Yi Radicals"](t2))));
        }
        function Jn(t2) {
          return !(Xn(t2) || function(t3) {
            return !!(Gn["Latin-1 Supplement"](t3) && (t3 === 167 || t3 === 169 || t3 === 174 || t3 === 177 || t3 === 188 || t3 === 189 || t3 === 190 || t3 === 215 || t3 === 247) || Gn["General Punctuation"](t3) && (t3 === 8214 || t3 === 8224 || t3 === 8225 || t3 === 8240 || t3 === 8241 || t3 === 8251 || t3 === 8252 || t3 === 8258 || t3 === 8263 || t3 === 8264 || t3 === 8265 || t3 === 8273) || Gn["Letterlike Symbols"](t3) || Gn["Number Forms"](t3) || Gn["Miscellaneous Technical"](t3) && (t3 >= 8960 && t3 <= 8967 || t3 >= 8972 && t3 <= 8991 || t3 >= 8996 && t3 <= 9e3 || t3 === 9003 || t3 >= 9085 && t3 <= 9114 || t3 >= 9150 && t3 <= 9165 || t3 === 9167 || t3 >= 9169 && t3 <= 9179 || t3 >= 9186 && t3 <= 9215) || Gn["Control Pictures"](t3) && t3 !== 9251 || Gn["Optical Character Recognition"](t3) || Gn["Enclosed Alphanumerics"](t3) || Gn["Geometric Shapes"](t3) || Gn["Miscellaneous Symbols"](t3) && !(t3 >= 9754 && t3 <= 9759) || Gn["Miscellaneous Symbols and Arrows"](t3) && (t3 >= 11026 && t3 <= 11055 || t3 >= 11088 && t3 <= 11097 || t3 >= 11192 && t3 <= 11243) || Gn["CJK Symbols and Punctuation"](t3) || Gn.Katakana(t3) || Gn["Private Use Area"](t3) || Gn["CJK Compatibility Forms"](t3) || Gn["Small Form Variants"](t3) || Gn["Halfwidth and Fullwidth Forms"](t3) || t3 === 8734 || t3 === 8756 || t3 === 8757 || t3 >= 9984 && t3 <= 10087 || t3 >= 10102 && t3 <= 10131 || t3 === 65532 || t3 === 65533);
          }(t2));
        }
        function Hn(t2) {
          return t2 >= 1424 && t2 <= 2303 || Gn["Arabic Presentation Forms-A"](t2) || Gn["Arabic Presentation Forms-B"](t2);
        }
        function Yn(t2, e2) {
          return !(!e2 && Hn(t2) || t2 >= 2304 && t2 <= 3583 || t2 >= 3840 && t2 <= 4255 || Gn.Khmer(t2));
        }
        function $n(t2) {
          for (var e2 = 0, r2 = t2; e2 < r2.length; e2 += 1)
            if (Hn(r2[e2].charCodeAt(0)))
              return true;
          return false;
        }
        var Wn = null, Qn = "unavailable", ti = null, ei = function(t2) {
          t2 && typeof t2 == "string" && t2.indexOf("NetworkError") > -1 && (Qn = "error"), Wn && Wn(t2);
        };
        function ri() {
          ni.fire(new It("pluginStateChange", {pluginStatus: Qn, pluginURL: ti}));
        }
        var ni = new Ct(), ii = function() {
          return Qn;
        }, ai = function() {
          if (Qn !== "deferred" || !ti)
            throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
          Qn = "loading", ri(), ti && bt({url: ti}, function(t2) {
            t2 ? ei(t2) : (Qn = "loaded", ri());
          });
        }, oi = {applyArabicShaping: null, processBidirectionalText: null, processStyledBidirectionalText: null, isLoaded: function() {
          return Qn === "loaded" || oi.applyArabicShaping != null;
        }, isLoading: function() {
          return Qn === "loading";
        }, setState: function(t2) {
          Qn = t2.pluginStatus, ti = t2.pluginURL;
        }, isParsed: function() {
          return oi.applyArabicShaping != null && oi.processBidirectionalText != null && oi.processStyledBidirectionalText != null;
        }, getPluginURL: function() {
          return ti;
        }}, si = function(t2, e2) {
          this.zoom = t2, e2 ? (this.now = e2.now, this.fadeDuration = e2.fadeDuration, this.zoomHistory = e2.zoomHistory, this.transition = e2.transition) : (this.now = 0, this.fadeDuration = 0, this.zoomHistory = new Kn(), this.transition = {});
        };
        si.prototype.isSupportedScript = function(t2) {
          return function(t3, e2) {
            for (var r2 = 0, n2 = t3; r2 < n2.length; r2 += 1)
              if (!Yn(n2[r2].charCodeAt(0), e2))
                return false;
            return true;
          }(t2, oi.isLoaded());
        }, si.prototype.crossFadingFactor = function() {
          return this.fadeDuration === 0 ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1);
        }, si.prototype.getCrossfadeParameters = function() {
          var t2 = this.zoom, e2 = t2 - Math.floor(t2), r2 = this.crossFadingFactor();
          return t2 > this.zoomHistory.lastIntegerZoom ? {fromScale: 2, toScale: 1, t: e2 + (1 - e2) * r2} : {fromScale: 0.5, toScale: 1, t: 1 - (1 - r2) * e2};
        };
        var ui = function(t2, e2) {
          this.property = t2, this.value = e2, this.expression = function(t3, e3) {
            if (Lr(t3))
              return new Yr(t3, e3);
            if (Gr(t3)) {
              var r2 = Hr(t3, e3);
              if (r2.result === "error")
                throw new Error(r2.value.map(function(t4) {
                  return t4.key + ": " + t4.message;
                }).join(", "));
              return r2.value;
            }
            var n2 = t3;
            return typeof t3 == "string" && e3.type === "color" && (n2 = te.parse(t3)), {kind: "constant", evaluate: function() {
              return n2;
            }};
          }(e2 === void 0 ? t2.specification.default : e2, t2.specification);
        };
        ui.prototype.isDataDriven = function() {
          return this.expression.kind === "source" || this.expression.kind === "composite";
        }, ui.prototype.possiblyEvaluate = function(t2, e2, r2) {
          return this.property.possiblyEvaluate(this, t2, e2, r2);
        };
        var li = function(t2) {
          this.property = t2, this.value = new ui(t2, void 0);
        };
        li.prototype.transitioned = function(t2, e2) {
          return new ci(this.property, this.value, e2, h({}, t2.transition, this.transition), t2.now);
        }, li.prototype.untransitioned = function() {
          return new ci(this.property, this.value, null, {}, 0);
        };
        var pi = function(t2) {
          this._properties = t2, this._values = Object.create(t2.defaultTransitionablePropertyValues);
        };
        pi.prototype.getValue = function(t2) {
          return w(this._values[t2].value.value);
        }, pi.prototype.setValue = function(t2, e2) {
          this._values.hasOwnProperty(t2) || (this._values[t2] = new li(this._values[t2].property)), this._values[t2].value = new ui(this._values[t2].property, e2 === null ? void 0 : w(e2));
        }, pi.prototype.getTransition = function(t2) {
          return w(this._values[t2].transition);
        }, pi.prototype.setTransition = function(t2, e2) {
          this._values.hasOwnProperty(t2) || (this._values[t2] = new li(this._values[t2].property)), this._values[t2].transition = w(e2) || void 0;
        }, pi.prototype.serialize = function() {
          for (var t2 = {}, e2 = 0, r2 = Object.keys(this._values); e2 < r2.length; e2 += 1) {
            var n2 = r2[e2], i2 = this.getValue(n2);
            i2 !== void 0 && (t2[n2] = i2);
            var a2 = this.getTransition(n2);
            a2 !== void 0 && (t2[n2 + "-transition"] = a2);
          }
          return t2;
        }, pi.prototype.transitioned = function(t2, e2) {
          for (var r2 = new hi(this._properties), n2 = 0, i2 = Object.keys(this._values); n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            r2._values[a2] = this._values[a2].transitioned(t2, e2._values[a2]);
          }
          return r2;
        }, pi.prototype.untransitioned = function() {
          for (var t2 = new hi(this._properties), e2 = 0, r2 = Object.keys(this._values); e2 < r2.length; e2 += 1) {
            var n2 = r2[e2];
            t2._values[n2] = this._values[n2].untransitioned();
          }
          return t2;
        };
        var ci = function(t2, e2, r2, n2, i2) {
          this.property = t2, this.value = e2, this.begin = i2 + n2.delay || 0, this.end = this.begin + n2.duration || 0, t2.specification.transition && (n2.delay || n2.duration) && (this.prior = r2);
        };
        ci.prototype.possiblyEvaluate = function(t2, e2, r2) {
          var n2 = t2.now || 0, i2 = this.value.possiblyEvaluate(t2, e2, r2), a2 = this.prior;
          if (a2) {
            if (n2 > this.end)
              return this.prior = null, i2;
            if (this.value.isDataDriven())
              return this.prior = null, i2;
            if (n2 < this.begin)
              return a2.possiblyEvaluate(t2, e2, r2);
            var o2 = (n2 - this.begin) / (this.end - this.begin);
            return this.property.interpolate(a2.possiblyEvaluate(t2, e2, r2), i2, function(t3) {
              if (t3 <= 0)
                return 0;
              if (t3 >= 1)
                return 1;
              var e3 = t3 * t3, r3 = e3 * t3;
              return 4 * (t3 < 0.5 ? r3 : 3 * (t3 - e3) + r3 - 0.75);
            }(o2));
          }
          return i2;
        };
        var hi = function(t2) {
          this._properties = t2, this._values = Object.create(t2.defaultTransitioningPropertyValues);
        };
        hi.prototype.possiblyEvaluate = function(t2, e2, r2) {
          for (var n2 = new di(this._properties), i2 = 0, a2 = Object.keys(this._values); i2 < a2.length; i2 += 1) {
            var o2 = a2[i2];
            n2._values[o2] = this._values[o2].possiblyEvaluate(t2, e2, r2);
          }
          return n2;
        }, hi.prototype.hasTransition = function() {
          for (var t2 = 0, e2 = Object.keys(this._values); t2 < e2.length; t2 += 1)
            if (this._values[e2[t2]].prior)
              return true;
          return false;
        };
        var fi = function(t2) {
          this._properties = t2, this._values = Object.create(t2.defaultPropertyValues);
        };
        fi.prototype.getValue = function(t2) {
          return w(this._values[t2].value);
        }, fi.prototype.setValue = function(t2, e2) {
          this._values[t2] = new ui(this._values[t2].property, e2 === null ? void 0 : w(e2));
        }, fi.prototype.serialize = function() {
          for (var t2 = {}, e2 = 0, r2 = Object.keys(this._values); e2 < r2.length; e2 += 1) {
            var n2 = r2[e2], i2 = this.getValue(n2);
            i2 !== void 0 && (t2[n2] = i2);
          }
          return t2;
        }, fi.prototype.possiblyEvaluate = function(t2, e2, r2) {
          for (var n2 = new di(this._properties), i2 = 0, a2 = Object.keys(this._values); i2 < a2.length; i2 += 1) {
            var o2 = a2[i2];
            n2._values[o2] = this._values[o2].possiblyEvaluate(t2, e2, r2);
          }
          return n2;
        };
        var yi = function(t2, e2, r2) {
          this.property = t2, this.value = e2, this.parameters = r2;
        };
        yi.prototype.isConstant = function() {
          return this.value.kind === "constant";
        }, yi.prototype.constantOr = function(t2) {
          return this.value.kind === "constant" ? this.value.value : t2;
        }, yi.prototype.evaluate = function(t2, e2, r2, n2) {
          return this.property.evaluate(this.value, this.parameters, t2, e2, r2, n2);
        };
        var di = function(t2) {
          this._properties = t2, this._values = Object.create(t2.defaultPossiblyEvaluatedValues);
        };
        di.prototype.get = function(t2) {
          return this._values[t2];
        };
        var mi = function(t2) {
          this.specification = t2;
        };
        mi.prototype.possiblyEvaluate = function(t2, e2) {
          return t2.expression.evaluate(e2);
        }, mi.prototype.interpolate = function(t2, e2, r2) {
          var n2 = Ge[this.specification.type];
          return n2 ? n2(t2, e2, r2) : t2;
        };
        var vi = function(t2, e2) {
          this.specification = t2, this.overrides = e2;
        };
        vi.prototype.possiblyEvaluate = function(t2, e2, r2, n2) {
          return new yi(this, t2.expression.kind === "constant" || t2.expression.kind === "camera" ? {kind: "constant", value: t2.expression.evaluate(e2, null, {}, r2, n2)} : t2.expression, e2);
        }, vi.prototype.interpolate = function(t2, e2, r2) {
          if (t2.value.kind !== "constant" || e2.value.kind !== "constant")
            return t2;
          if (t2.value.value === void 0 || e2.value.value === void 0)
            return new yi(this, {kind: "constant", value: void 0}, t2.parameters);
          var n2 = Ge[this.specification.type];
          return n2 ? new yi(this, {kind: "constant", value: n2(t2.value.value, e2.value.value, r2)}, t2.parameters) : t2;
        }, vi.prototype.evaluate = function(t2, e2, r2, n2, i2, a2) {
          return t2.kind === "constant" ? t2.value : t2.evaluate(e2, r2, n2, i2, a2);
        };
        var gi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.possiblyEvaluate = function(t3, e3, r2, n2) {
            if (t3.value === void 0)
              return new yi(this, {kind: "constant", value: void 0}, e3);
            if (t3.expression.kind === "constant") {
              var i2 = t3.expression.evaluate(e3, null, {}, r2, n2), a2 = t3.property.specification.type === "resolvedImage" && typeof i2 != "string" ? i2.name : i2, o2 = this._calculate(a2, a2, a2, e3);
              return new yi(this, {kind: "constant", value: o2}, e3);
            }
            if (t3.expression.kind === "camera") {
              var s2 = this._calculate(t3.expression.evaluate({zoom: e3.zoom - 1}), t3.expression.evaluate({zoom: e3.zoom}), t3.expression.evaluate({zoom: e3.zoom + 1}), e3);
              return new yi(this, {kind: "constant", value: s2}, e3);
            }
            return new yi(this, t3.expression, e3);
          }, e2.prototype.evaluate = function(t3, e3, r2, n2, i2, a2) {
            if (t3.kind === "source") {
              var o2 = t3.evaluate(e3, r2, n2, i2, a2);
              return this._calculate(o2, o2, o2, e3);
            }
            return t3.kind === "composite" ? this._calculate(t3.evaluate({zoom: Math.floor(e3.zoom) - 1}, r2, n2), t3.evaluate({zoom: Math.floor(e3.zoom)}, r2, n2), t3.evaluate({zoom: Math.floor(e3.zoom) + 1}, r2, n2), e3) : t3.value;
          }, e2.prototype._calculate = function(t3, e3, r2, n2) {
            return n2.zoom > n2.zoomHistory.lastIntegerZoom ? {from: t3, to: e3} : {from: r2, to: e3};
          }, e2.prototype.interpolate = function(t3) {
            return t3;
          }, e2;
        }(vi), xi = function(t2) {
          this.specification = t2;
        };
        xi.prototype.possiblyEvaluate = function(t2, e2, r2, n2) {
          if (t2.value !== void 0) {
            if (t2.expression.kind === "constant") {
              var i2 = t2.expression.evaluate(e2, null, {}, r2, n2);
              return this._calculate(i2, i2, i2, e2);
            }
            return this._calculate(t2.expression.evaluate(new si(Math.floor(e2.zoom - 1), e2)), t2.expression.evaluate(new si(Math.floor(e2.zoom), e2)), t2.expression.evaluate(new si(Math.floor(e2.zoom + 1), e2)), e2);
          }
        }, xi.prototype._calculate = function(t2, e2, r2, n2) {
          return n2.zoom > n2.zoomHistory.lastIntegerZoom ? {from: t2, to: e2} : {from: r2, to: e2};
        }, xi.prototype.interpolate = function(t2) {
          return t2;
        };
        var bi = function(t2) {
          this.specification = t2;
        };
        bi.prototype.possiblyEvaluate = function(t2, e2, r2, n2) {
          return !!t2.expression.evaluate(e2, null, {}, r2, n2);
        }, bi.prototype.interpolate = function() {
          return false;
        };
        var wi = function(t2) {
          for (var e2 in this.properties = t2, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [], t2) {
            var r2 = t2[e2];
            r2.specification.overridable && this.overridableProperties.push(e2);
            var n2 = this.defaultPropertyValues[e2] = new ui(r2, void 0), i2 = this.defaultTransitionablePropertyValues[e2] = new li(r2);
            this.defaultTransitioningPropertyValues[e2] = i2.untransitioned(), this.defaultPossiblyEvaluatedValues[e2] = n2.possiblyEvaluate({});
          }
        };
        On("DataDrivenProperty", vi), On("DataConstantProperty", mi), On("CrossFadedDataDrivenProperty", gi), On("CrossFadedProperty", xi), On("ColorRampProperty", bi);
        var _i = function(t2) {
          function e2(e3, r2) {
            if (t2.call(this), this.id = e3.id, this.type = e3.type, this._featureFilter = {filter: function() {
              return true;
            }, needGeometry: false}, e3.type !== "custom" && (this.metadata = (e3 = e3).metadata, this.minzoom = e3.minzoom, this.maxzoom = e3.maxzoom, e3.type !== "background" && (this.source = e3.source, this.sourceLayer = e3["source-layer"], this.filter = e3.filter), r2.layout && (this._unevaluatedLayout = new fi(r2.layout)), r2.paint)) {
              for (var n2 in this._transitionablePaint = new pi(r2.paint), e3.paint)
                this.setPaintProperty(n2, e3.paint[n2], {validate: false});
              for (var i2 in e3.layout)
                this.setLayoutProperty(i2, e3.layout[i2], {validate: false});
              this._transitioningPaint = this._transitionablePaint.untransitioned(), this.paint = new di(r2.paint);
            }
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getCrossfadeParameters = function() {
            return this._crossfadeParameters;
          }, e2.prototype.getLayoutProperty = function(t3) {
            return t3 === "visibility" ? this.visibility : this._unevaluatedLayout.getValue(t3);
          }, e2.prototype.setLayoutProperty = function(t3, e3, r2) {
            r2 === void 0 && (r2 = {}), e3 != null && this._validate(Mn, "layers." + this.id + ".layout." + t3, t3, e3, r2) || (t3 !== "visibility" ? this._unevaluatedLayout.setValue(t3, e3) : this.visibility = e3);
          }, e2.prototype.getPaintProperty = function(t3) {
            return g(t3, "-transition") ? this._transitionablePaint.getTransition(t3.slice(0, -"-transition".length)) : this._transitionablePaint.getValue(t3);
          }, e2.prototype.setPaintProperty = function(t3, e3, r2) {
            if (r2 === void 0 && (r2 = {}), e3 != null && this._validate(Pn, "layers." + this.id + ".paint." + t3, t3, e3, r2))
              return false;
            if (g(t3, "-transition"))
              return this._transitionablePaint.setTransition(t3.slice(0, -"-transition".length), e3 || void 0), false;
            var n2 = this._transitionablePaint._values[t3], i2 = n2.property.specification["property-type"] === "cross-faded-data-driven", a2 = n2.value.isDataDriven(), o2 = n2.value;
            this._transitionablePaint.setValue(t3, e3), this._handleSpecialPaintPropertyUpdate(t3);
            var s2 = this._transitionablePaint._values[t3].value;
            return s2.isDataDriven() || a2 || i2 || this._handleOverridablePaintPropertyUpdate(t3, o2, s2);
          }, e2.prototype._handleSpecialPaintPropertyUpdate = function(t3) {
          }, e2.prototype._handleOverridablePaintPropertyUpdate = function(t3, e3, r2) {
            return false;
          }, e2.prototype.isHidden = function(t3) {
            return !!(this.minzoom && t3 < this.minzoom) || !!(this.maxzoom && t3 >= this.maxzoom) || this.visibility === "none";
          }, e2.prototype.updateTransitions = function(t3) {
            this._transitioningPaint = this._transitionablePaint.transitioned(t3, this._transitioningPaint);
          }, e2.prototype.hasTransition = function() {
            return this._transitioningPaint.hasTransition();
          }, e2.prototype.recalculate = function(t3, e3) {
            t3.getCrossfadeParameters && (this._crossfadeParameters = t3.getCrossfadeParameters()), this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t3, void 0, e3)), this.paint = this._transitioningPaint.possiblyEvaluate(t3, void 0, e3);
          }, e2.prototype.serialize = function() {
            var t3 = {id: this.id, type: this.type, source: this.source, "source-layer": this.sourceLayer, metadata: this.metadata, minzoom: this.minzoom, maxzoom: this.maxzoom, filter: this.filter, layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(), paint: this._transitionablePaint && this._transitionablePaint.serialize()};
            return this.visibility && (t3.layout = t3.layout || {}, t3.layout.visibility = this.visibility), b(t3, function(t4, e3) {
              return !(t4 === void 0 || e3 === "layout" && !Object.keys(t4).length || e3 === "paint" && !Object.keys(t4).length);
            });
          }, e2.prototype._validate = function(t3, e3, r2, n2, i2) {
            return i2 === void 0 && (i2 = {}), (!i2 || i2.validate !== false) && Bn(this, t3.call(Cn, {key: e3, layerType: this.type, objectKey: r2, value: n2, styleSpec: Et, style: {glyphs: true, sprite: true}}));
          }, e2.prototype.is3D = function() {
            return false;
          }, e2.prototype.isTileClipped = function() {
            return false;
          }, e2.prototype.hasOffscreenPass = function() {
            return false;
          }, e2.prototype.resize = function() {
          }, e2.prototype.isStateDependent = function() {
            for (var t3 in this.paint._values) {
              var e3 = this.paint.get(t3);
              if (e3 instanceof yi && Tr(e3.property.specification) && (e3.value.kind === "source" || e3.value.kind === "composite") && e3.value.isStateDependent)
                return true;
            }
            return false;
          }, e2;
        }(Ct), Ai = {Int8: Int8Array, Uint8: Uint8Array, Int16: Int16Array, Uint16: Uint16Array, Int32: Int32Array, Uint32: Uint32Array, Float32: Float32Array}, Si = function(t2, e2) {
          this._structArray = t2, this._pos1 = e2 * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8;
        }, ki = function() {
          this.isTransferred = false, this.capacity = -1, this.resize(0);
        };
        function Ii(t2, e2) {
          e2 === void 0 && (e2 = 1);
          var r2 = 0, n2 = 0;
          return {members: t2.map(function(t3) {
            var i2 = Ai[t3.type].BYTES_PER_ELEMENT, a2 = r2 = zi(r2, Math.max(e2, i2)), o2 = t3.components || 1;
            return n2 = Math.max(n2, i2), r2 += i2 * o2, {name: t3.name, type: t3.type, components: o2, offset: a2};
          }), size: zi(r2, Math.max(n2, e2)), alignment: e2};
        }
        function zi(t2, e2) {
          return Math.ceil(t2 / e2) * e2;
        }
        ki.serialize = function(t2, e2) {
          return t2._trim(), e2 && (t2.isTransferred = true, e2.push(t2.arrayBuffer)), {length: t2.length, arrayBuffer: t2.arrayBuffer};
        }, ki.deserialize = function(t2) {
          var e2 = Object.create(this.prototype);
          return e2.arrayBuffer = t2.arrayBuffer, e2.length = t2.length, e2.capacity = t2.arrayBuffer.byteLength / e2.bytesPerElement, e2._refreshViews(), e2;
        }, ki.prototype._trim = function() {
          this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews());
        }, ki.prototype.clear = function() {
          this.length = 0;
        }, ki.prototype.resize = function(t2) {
          this.reserve(t2), this.length = t2;
        }, ki.prototype.reserve = function(t2) {
          if (t2 > this.capacity) {
            this.capacity = Math.max(t2, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
            var e2 = this.uint8;
            this._refreshViews(), e2 && this.uint8.set(e2);
          }
        }, ki.prototype._refreshViews = function() {
          throw new Error("_refreshViews() must be implemented by each concrete StructArray layout");
        };
        var Ci = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3) {
            var r2 = this.length;
            return this.resize(r2 + 1), this.emplace(r2, t3, e3);
          }, e2.prototype.emplace = function(t3, e3, r2) {
            var n2 = 2 * t3;
            return this.int16[n2 + 0] = e3, this.int16[n2 + 1] = r2, t3;
          }, e2;
        }(ki);
        Ci.prototype.bytesPerElement = 4, On("StructArrayLayout2i4", Ci);
        var Ei = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2) {
            var i2 = this.length;
            return this.resize(i2 + 1), this.emplace(i2, t3, e3, r2, n2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2) {
            var a2 = 4 * t3;
            return this.int16[a2 + 0] = e3, this.int16[a2 + 1] = r2, this.int16[a2 + 2] = n2, this.int16[a2 + 3] = i2, t3;
          }, e2;
        }(ki);
        Ei.prototype.bytesPerElement = 8, On("StructArrayLayout4i8", Ei);
        var Pi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2) {
            var o2 = this.length;
            return this.resize(o2 + 1), this.emplace(o2, t3, e3, r2, n2, i2, a2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2) {
            var s2 = 6 * t3;
            return this.int16[s2 + 0] = e3, this.int16[s2 + 1] = r2, this.int16[s2 + 2] = n2, this.int16[s2 + 3] = i2, this.int16[s2 + 4] = a2, this.int16[s2 + 5] = o2, t3;
          }, e2;
        }(ki);
        Pi.prototype.bytesPerElement = 12, On("StructArrayLayout2i4i12", Pi);
        var Mi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2) {
            var o2 = this.length;
            return this.resize(o2 + 1), this.emplace(o2, t3, e3, r2, n2, i2, a2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2) {
            var s2 = 4 * t3, u2 = 8 * t3;
            return this.int16[s2 + 0] = e3, this.int16[s2 + 1] = r2, this.uint8[u2 + 4] = n2, this.uint8[u2 + 5] = i2, this.uint8[u2 + 6] = a2, this.uint8[u2 + 7] = o2, t3;
          }, e2;
        }(ki);
        Mi.prototype.bytesPerElement = 8, On("StructArrayLayout2i4ub8", Mi);
        var Bi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3) {
            var r2 = this.length;
            return this.resize(r2 + 1), this.emplace(r2, t3, e3);
          }, e2.prototype.emplace = function(t3, e3, r2) {
            var n2 = 2 * t3;
            return this.float32[n2 + 0] = e3, this.float32[n2 + 1] = r2, t3;
          }, e2;
        }(ki);
        Bi.prototype.bytesPerElement = 8, On("StructArrayLayout2f8", Bi);
        var Ti = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2) {
            var p2 = this.length;
            return this.resize(p2 + 1), this.emplace(p2, t3, e3, r2, n2, i2, a2, o2, s2, u2, l2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2) {
            var c2 = 10 * t3;
            return this.uint16[c2 + 0] = e3, this.uint16[c2 + 1] = r2, this.uint16[c2 + 2] = n2, this.uint16[c2 + 3] = i2, this.uint16[c2 + 4] = a2, this.uint16[c2 + 5] = o2, this.uint16[c2 + 6] = s2, this.uint16[c2 + 7] = u2, this.uint16[c2 + 8] = l2, this.uint16[c2 + 9] = p2, t3;
          }, e2;
        }(ki);
        Ti.prototype.bytesPerElement = 20, On("StructArrayLayout10ui20", Ti);
        var Vi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2) {
            var h2 = this.length;
            return this.resize(h2 + 1), this.emplace(h2, t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2) {
            var f2 = 12 * t3;
            return this.int16[f2 + 0] = e3, this.int16[f2 + 1] = r2, this.int16[f2 + 2] = n2, this.int16[f2 + 3] = i2, this.uint16[f2 + 4] = a2, this.uint16[f2 + 5] = o2, this.uint16[f2 + 6] = s2, this.uint16[f2 + 7] = u2, this.int16[f2 + 8] = l2, this.int16[f2 + 9] = p2, this.int16[f2 + 10] = c2, this.int16[f2 + 11] = h2, t3;
          }, e2;
        }(ki);
        Vi.prototype.bytesPerElement = 24, On("StructArrayLayout4i4ui4i24", Vi);
        var Fi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2) {
            var n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t3, e3, r2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2) {
            var i2 = 3 * t3;
            return this.float32[i2 + 0] = e3, this.float32[i2 + 1] = r2, this.float32[i2 + 2] = n2, t3;
          }, e2;
        }(ki);
        Fi.prototype.bytesPerElement = 12, On("StructArrayLayout3f12", Fi);
        var Di = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3) {
            var e3 = this.length;
            return this.resize(e3 + 1), this.emplace(e3, t3);
          }, e2.prototype.emplace = function(t3, e3) {
            return this.uint32[1 * t3 + 0] = e3, t3;
          }, e2;
        }(ki);
        Di.prototype.bytesPerElement = 4, On("StructArrayLayout1ul4", Di);
        var Li = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2, o2, s2, u2) {
            var l2 = this.length;
            return this.resize(l2 + 1), this.emplace(l2, t3, e3, r2, n2, i2, a2, o2, s2, u2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2) {
            var p2 = 10 * t3, c2 = 5 * t3;
            return this.int16[p2 + 0] = e3, this.int16[p2 + 1] = r2, this.int16[p2 + 2] = n2, this.int16[p2 + 3] = i2, this.int16[p2 + 4] = a2, this.int16[p2 + 5] = o2, this.uint32[c2 + 3] = s2, this.uint16[p2 + 8] = u2, this.uint16[p2 + 9] = l2, t3;
          }, e2;
        }(ki);
        Li.prototype.bytesPerElement = 20, On("StructArrayLayout6i1ul2ui20", Li);
        var Oi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2) {
            var o2 = this.length;
            return this.resize(o2 + 1), this.emplace(o2, t3, e3, r2, n2, i2, a2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2) {
            var s2 = 6 * t3;
            return this.int16[s2 + 0] = e3, this.int16[s2 + 1] = r2, this.int16[s2 + 2] = n2, this.int16[s2 + 3] = i2, this.int16[s2 + 4] = a2, this.int16[s2 + 5] = o2, t3;
          }, e2;
        }(ki);
        Oi.prototype.bytesPerElement = 12, On("StructArrayLayout2i2i2i12", Oi);
        var Ri = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2) {
            var a2 = this.length;
            return this.resize(a2 + 1), this.emplace(a2, t3, e3, r2, n2, i2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2) {
            var o2 = 4 * t3, s2 = 8 * t3;
            return this.float32[o2 + 0] = e3, this.float32[o2 + 1] = r2, this.float32[o2 + 2] = n2, this.int16[s2 + 6] = i2, this.int16[s2 + 7] = a2, t3;
          }, e2;
        }(ki);
        Ri.prototype.bytesPerElement = 16, On("StructArrayLayout2f1f2i16", Ri);
        var Ui = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2) {
            var i2 = this.length;
            return this.resize(i2 + 1), this.emplace(i2, t3, e3, r2, n2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2) {
            var a2 = 12 * t3, o2 = 3 * t3;
            return this.uint8[a2 + 0] = e3, this.uint8[a2 + 1] = r2, this.float32[o2 + 1] = n2, this.float32[o2 + 2] = i2, t3;
          }, e2;
        }(ki);
        Ui.prototype.bytesPerElement = 12, On("StructArrayLayout2ub2f12", Ui);
        var ji = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2) {
            var n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t3, e3, r2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2) {
            var i2 = 3 * t3;
            return this.uint16[i2 + 0] = e3, this.uint16[i2 + 1] = r2, this.uint16[i2 + 2] = n2, t3;
          }, e2;
        }(ki);
        ji.prototype.bytesPerElement = 6, On("StructArrayLayout3ui6", ji);
        var qi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2, m2) {
            var v2 = this.length;
            return this.resize(v2 + 1), this.emplace(v2, t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2, m2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2, m2, v2) {
            var g2 = 24 * t3, x2 = 12 * t3, b2 = 48 * t3;
            return this.int16[g2 + 0] = e3, this.int16[g2 + 1] = r2, this.uint16[g2 + 2] = n2, this.uint16[g2 + 3] = i2, this.uint32[x2 + 2] = a2, this.uint32[x2 + 3] = o2, this.uint32[x2 + 4] = s2, this.uint16[g2 + 10] = u2, this.uint16[g2 + 11] = l2, this.uint16[g2 + 12] = p2, this.float32[x2 + 7] = c2, this.float32[x2 + 8] = h2, this.uint8[b2 + 36] = f2, this.uint8[b2 + 37] = y2, this.uint8[b2 + 38] = d2, this.uint32[x2 + 10] = m2, this.int16[g2 + 22] = v2, t3;
          }, e2;
        }(ki);
        qi.prototype.bytesPerElement = 48, On("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48", qi);
        var Ni = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2, m2, v2, g2, x2, b2, w2, _2, A2, S2, k2, I2, z2) {
            var C2 = this.length;
            return this.resize(C2 + 1), this.emplace(C2, t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2, m2, v2, g2, x2, b2, w2, _2, A2, S2, k2, I2, z2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2, m2, v2, g2, x2, b2, w2, _2, A2, S2, k2, I2, z2, C2) {
            var E2 = 34 * t3, P2 = 17 * t3;
            return this.int16[E2 + 0] = e3, this.int16[E2 + 1] = r2, this.int16[E2 + 2] = n2, this.int16[E2 + 3] = i2, this.int16[E2 + 4] = a2, this.int16[E2 + 5] = o2, this.int16[E2 + 6] = s2, this.int16[E2 + 7] = u2, this.uint16[E2 + 8] = l2, this.uint16[E2 + 9] = p2, this.uint16[E2 + 10] = c2, this.uint16[E2 + 11] = h2, this.uint16[E2 + 12] = f2, this.uint16[E2 + 13] = y2, this.uint16[E2 + 14] = d2, this.uint16[E2 + 15] = m2, this.uint16[E2 + 16] = v2, this.uint16[E2 + 17] = g2, this.uint16[E2 + 18] = x2, this.uint16[E2 + 19] = b2, this.uint16[E2 + 20] = w2, this.uint16[E2 + 21] = _2, this.uint16[E2 + 22] = A2, this.uint32[P2 + 12] = S2, this.float32[P2 + 13] = k2, this.float32[P2 + 14] = I2, this.float32[P2 + 15] = z2, this.float32[P2 + 16] = C2, t3;
          }, e2;
        }(ki);
        Ni.prototype.bytesPerElement = 68, On("StructArrayLayout8i15ui1ul4f68", Ni);
        var Ki = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3) {
            var e3 = this.length;
            return this.resize(e3 + 1), this.emplace(e3, t3);
          }, e2.prototype.emplace = function(t3, e3) {
            return this.float32[1 * t3 + 0] = e3, t3;
          }, e2;
        }(ki);
        Ki.prototype.bytesPerElement = 4, On("StructArrayLayout1f4", Ki);
        var Gi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2) {
            var n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t3, e3, r2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2) {
            var i2 = 3 * t3;
            return this.int16[i2 + 0] = e3, this.int16[i2 + 1] = r2, this.int16[i2 + 2] = n2, t3;
          }, e2;
        }(ki);
        Gi.prototype.bytesPerElement = 6, On("StructArrayLayout3i6", Gi);
        var Zi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2) {
            var n2 = this.length;
            return this.resize(n2 + 1), this.emplace(n2, t3, e3, r2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2) {
            var i2 = 4 * t3;
            return this.uint32[2 * t3 + 0] = e3, this.uint16[i2 + 2] = r2, this.uint16[i2 + 3] = n2, t3;
          }, e2;
        }(ki);
        Zi.prototype.bytesPerElement = 8, On("StructArrayLayout1ul2ui8", Zi);
        var Xi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3) {
            var r2 = this.length;
            return this.resize(r2 + 1), this.emplace(r2, t3, e3);
          }, e2.prototype.emplace = function(t3, e3, r2) {
            var n2 = 2 * t3;
            return this.uint16[n2 + 0] = e3, this.uint16[n2 + 1] = r2, t3;
          }, e2;
        }(ki);
        Xi.prototype.bytesPerElement = 4, On("StructArrayLayout2ui4", Xi);
        var Ji = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3) {
            var e3 = this.length;
            return this.resize(e3 + 1), this.emplace(e3, t3);
          }, e2.prototype.emplace = function(t3, e3) {
            return this.uint16[1 * t3 + 0] = e3, t3;
          }, e2;
        }(ki);
        Ji.prototype.bytesPerElement = 2, On("StructArrayLayout1ui2", Ji);
        var Hi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._refreshViews = function() {
            this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
          }, e2.prototype.emplaceBack = function(t3, e3, r2, n2) {
            var i2 = this.length;
            return this.resize(i2 + 1), this.emplace(i2, t3, e3, r2, n2);
          }, e2.prototype.emplace = function(t3, e3, r2, n2, i2) {
            var a2 = 4 * t3;
            return this.float32[a2 + 0] = e3, this.float32[a2 + 1] = r2, this.float32[a2 + 2] = n2, this.float32[a2 + 3] = i2, t3;
          }, e2;
        }(ki);
        Hi.prototype.bytesPerElement = 16, On("StructArrayLayout4f16", Hi);
        var Yi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2;
          var r2 = {anchorPointX: {configurable: true}, anchorPointY: {configurable: true}, x1: {configurable: true}, y1: {configurable: true}, x2: {configurable: true}, y2: {configurable: true}, featureIndex: {configurable: true}, sourceLayerIndex: {configurable: true}, bucketIndex: {configurable: true}, anchorPoint: {configurable: true}};
          return r2.anchorPointX.get = function() {
            return this._structArray.int16[this._pos2 + 0];
          }, r2.anchorPointY.get = function() {
            return this._structArray.int16[this._pos2 + 1];
          }, r2.x1.get = function() {
            return this._structArray.int16[this._pos2 + 2];
          }, r2.y1.get = function() {
            return this._structArray.int16[this._pos2 + 3];
          }, r2.x2.get = function() {
            return this._structArray.int16[this._pos2 + 4];
          }, r2.y2.get = function() {
            return this._structArray.int16[this._pos2 + 5];
          }, r2.featureIndex.get = function() {
            return this._structArray.uint32[this._pos4 + 3];
          }, r2.sourceLayerIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 8];
          }, r2.bucketIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 9];
          }, r2.anchorPoint.get = function() {
            return new i(this.anchorPointX, this.anchorPointY);
          }, Object.defineProperties(e2.prototype, r2), e2;
        }(Si);
        Yi.prototype.size = 20;
        var $i = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.get = function(t3) {
            return new Yi(this, t3);
          }, e2;
        }(Li);
        On("CollisionBoxArray", $i);
        var Wi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2;
          var r2 = {anchorX: {configurable: true}, anchorY: {configurable: true}, glyphStartIndex: {configurable: true}, numGlyphs: {configurable: true}, vertexStartIndex: {configurable: true}, lineStartIndex: {configurable: true}, lineLength: {configurable: true}, segment: {configurable: true}, lowerSize: {configurable: true}, upperSize: {configurable: true}, lineOffsetX: {configurable: true}, lineOffsetY: {configurable: true}, writingMode: {configurable: true}, placedOrientation: {configurable: true}, hidden: {configurable: true}, crossTileID: {configurable: true}, associatedIconIndex: {configurable: true}};
          return r2.anchorX.get = function() {
            return this._structArray.int16[this._pos2 + 0];
          }, r2.anchorY.get = function() {
            return this._structArray.int16[this._pos2 + 1];
          }, r2.glyphStartIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 2];
          }, r2.numGlyphs.get = function() {
            return this._structArray.uint16[this._pos2 + 3];
          }, r2.vertexStartIndex.get = function() {
            return this._structArray.uint32[this._pos4 + 2];
          }, r2.lineStartIndex.get = function() {
            return this._structArray.uint32[this._pos4 + 3];
          }, r2.lineLength.get = function() {
            return this._structArray.uint32[this._pos4 + 4];
          }, r2.segment.get = function() {
            return this._structArray.uint16[this._pos2 + 10];
          }, r2.lowerSize.get = function() {
            return this._structArray.uint16[this._pos2 + 11];
          }, r2.upperSize.get = function() {
            return this._structArray.uint16[this._pos2 + 12];
          }, r2.lineOffsetX.get = function() {
            return this._structArray.float32[this._pos4 + 7];
          }, r2.lineOffsetY.get = function() {
            return this._structArray.float32[this._pos4 + 8];
          }, r2.writingMode.get = function() {
            return this._structArray.uint8[this._pos1 + 36];
          }, r2.placedOrientation.get = function() {
            return this._structArray.uint8[this._pos1 + 37];
          }, r2.placedOrientation.set = function(t3) {
            this._structArray.uint8[this._pos1 + 37] = t3;
          }, r2.hidden.get = function() {
            return this._structArray.uint8[this._pos1 + 38];
          }, r2.hidden.set = function(t3) {
            this._structArray.uint8[this._pos1 + 38] = t3;
          }, r2.crossTileID.get = function() {
            return this._structArray.uint32[this._pos4 + 10];
          }, r2.crossTileID.set = function(t3) {
            this._structArray.uint32[this._pos4 + 10] = t3;
          }, r2.associatedIconIndex.get = function() {
            return this._structArray.int16[this._pos2 + 22];
          }, Object.defineProperties(e2.prototype, r2), e2;
        }(Si);
        Wi.prototype.size = 48;
        var Qi = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.get = function(t3) {
            return new Wi(this, t3);
          }, e2;
        }(qi);
        On("PlacedSymbolArray", Qi);
        var ta = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2;
          var r2 = {anchorX: {configurable: true}, anchorY: {configurable: true}, rightJustifiedTextSymbolIndex: {configurable: true}, centerJustifiedTextSymbolIndex: {configurable: true}, leftJustifiedTextSymbolIndex: {configurable: true}, verticalPlacedTextSymbolIndex: {configurable: true}, placedIconSymbolIndex: {configurable: true}, verticalPlacedIconSymbolIndex: {configurable: true}, key: {configurable: true}, textBoxStartIndex: {configurable: true}, textBoxEndIndex: {configurable: true}, verticalTextBoxStartIndex: {configurable: true}, verticalTextBoxEndIndex: {configurable: true}, iconBoxStartIndex: {configurable: true}, iconBoxEndIndex: {configurable: true}, verticalIconBoxStartIndex: {configurable: true}, verticalIconBoxEndIndex: {configurable: true}, featureIndex: {configurable: true}, numHorizontalGlyphVertices: {configurable: true}, numVerticalGlyphVertices: {configurable: true}, numIconVertices: {configurable: true}, numVerticalIconVertices: {configurable: true}, useRuntimeCollisionCircles: {configurable: true}, crossTileID: {configurable: true}, textBoxScale: {configurable: true}, textOffset0: {configurable: true}, textOffset1: {configurable: true}, collisionCircleDiameter: {configurable: true}};
          return r2.anchorX.get = function() {
            return this._structArray.int16[this._pos2 + 0];
          }, r2.anchorY.get = function() {
            return this._structArray.int16[this._pos2 + 1];
          }, r2.rightJustifiedTextSymbolIndex.get = function() {
            return this._structArray.int16[this._pos2 + 2];
          }, r2.centerJustifiedTextSymbolIndex.get = function() {
            return this._structArray.int16[this._pos2 + 3];
          }, r2.leftJustifiedTextSymbolIndex.get = function() {
            return this._structArray.int16[this._pos2 + 4];
          }, r2.verticalPlacedTextSymbolIndex.get = function() {
            return this._structArray.int16[this._pos2 + 5];
          }, r2.placedIconSymbolIndex.get = function() {
            return this._structArray.int16[this._pos2 + 6];
          }, r2.verticalPlacedIconSymbolIndex.get = function() {
            return this._structArray.int16[this._pos2 + 7];
          }, r2.key.get = function() {
            return this._structArray.uint16[this._pos2 + 8];
          }, r2.textBoxStartIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 9];
          }, r2.textBoxEndIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 10];
          }, r2.verticalTextBoxStartIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 11];
          }, r2.verticalTextBoxEndIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 12];
          }, r2.iconBoxStartIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 13];
          }, r2.iconBoxEndIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 14];
          }, r2.verticalIconBoxStartIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 15];
          }, r2.verticalIconBoxEndIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 16];
          }, r2.featureIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 17];
          }, r2.numHorizontalGlyphVertices.get = function() {
            return this._structArray.uint16[this._pos2 + 18];
          }, r2.numVerticalGlyphVertices.get = function() {
            return this._structArray.uint16[this._pos2 + 19];
          }, r2.numIconVertices.get = function() {
            return this._structArray.uint16[this._pos2 + 20];
          }, r2.numVerticalIconVertices.get = function() {
            return this._structArray.uint16[this._pos2 + 21];
          }, r2.useRuntimeCollisionCircles.get = function() {
            return this._structArray.uint16[this._pos2 + 22];
          }, r2.crossTileID.get = function() {
            return this._structArray.uint32[this._pos4 + 12];
          }, r2.crossTileID.set = function(t3) {
            this._structArray.uint32[this._pos4 + 12] = t3;
          }, r2.textBoxScale.get = function() {
            return this._structArray.float32[this._pos4 + 13];
          }, r2.textOffset0.get = function() {
            return this._structArray.float32[this._pos4 + 14];
          }, r2.textOffset1.get = function() {
            return this._structArray.float32[this._pos4 + 15];
          }, r2.collisionCircleDiameter.get = function() {
            return this._structArray.float32[this._pos4 + 16];
          }, Object.defineProperties(e2.prototype, r2), e2;
        }(Si);
        ta.prototype.size = 68;
        var ea = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.get = function(t3) {
            return new ta(this, t3);
          }, e2;
        }(Ni);
        On("SymbolInstanceArray", ea);
        var ra = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getoffsetX = function(t3) {
            return this.float32[1 * t3 + 0];
          }, e2;
        }(Ki);
        On("GlyphOffsetArray", ra);
        var na = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getx = function(t3) {
            return this.int16[3 * t3 + 0];
          }, e2.prototype.gety = function(t3) {
            return this.int16[3 * t3 + 1];
          }, e2.prototype.gettileUnitDistanceFromAnchor = function(t3) {
            return this.int16[3 * t3 + 2];
          }, e2;
        }(Gi);
        On("SymbolLineVertexArray", na);
        var ia = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2;
          var r2 = {featureIndex: {configurable: true}, sourceLayerIndex: {configurable: true}, bucketIndex: {configurable: true}};
          return r2.featureIndex.get = function() {
            return this._structArray.uint32[this._pos4 + 0];
          }, r2.sourceLayerIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 2];
          }, r2.bucketIndex.get = function() {
            return this._structArray.uint16[this._pos2 + 3];
          }, Object.defineProperties(e2.prototype, r2), e2;
        }(Si);
        ia.prototype.size = 8;
        var aa = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.get = function(t3) {
            return new ia(this, t3);
          }, e2;
        }(Zi);
        On("FeatureIndexArray", aa);
        var oa = Ii([{name: "a_pos", components: 2, type: "Int16"}], 4).members, sa = function(t2) {
          t2 === void 0 && (t2 = []), this.segments = t2;
        };
        function ua(t2, e2) {
          return 256 * (t2 = p(Math.floor(t2), 0, 255)) + p(Math.floor(e2), 0, 255);
        }
        sa.prototype.prepareSegment = function(t2, e2, r2, n2) {
          var i2 = this.segments[this.segments.length - 1];
          return t2 > sa.MAX_VERTEX_ARRAY_LENGTH && A("Max vertices per segment is " + sa.MAX_VERTEX_ARRAY_LENGTH + ": bucket requested " + t2), (!i2 || i2.vertexLength + t2 > sa.MAX_VERTEX_ARRAY_LENGTH || i2.sortKey !== n2) && (i2 = {vertexOffset: e2.length, primitiveOffset: r2.length, vertexLength: 0, primitiveLength: 0}, n2 !== void 0 && (i2.sortKey = n2), this.segments.push(i2)), i2;
        }, sa.prototype.get = function() {
          return this.segments;
        }, sa.prototype.destroy = function() {
          for (var t2 = 0, e2 = this.segments; t2 < e2.length; t2 += 1) {
            var r2 = e2[t2];
            for (var n2 in r2.vaos)
              r2.vaos[n2].destroy();
          }
        }, sa.simpleSegment = function(t2, e2, r2, n2) {
          return new sa([{vertexOffset: t2, primitiveOffset: e2, vertexLength: r2, primitiveLength: n2, vaos: {}, sortKey: 0}]);
        }, sa.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, On("SegmentVector", sa);
        var la = Ii([{name: "a_pattern_from", components: 4, type: "Uint16"}, {name: "a_pattern_to", components: 4, type: "Uint16"}, {name: "a_pixel_ratio_from", components: 1, type: "Uint16"}, {name: "a_pixel_ratio_to", components: 1, type: "Uint16"}]), pa = e(function(t2) {
          t2.exports = function(t3, e2) {
            var r2, n2, i2, a2, o2, s2, u2, l2;
            for (n2 = t3.length - (r2 = 3 & t3.length), i2 = e2, o2 = 3432918353, s2 = 461845907, l2 = 0; l2 < n2; )
              u2 = 255 & t3.charCodeAt(l2) | (255 & t3.charCodeAt(++l2)) << 8 | (255 & t3.charCodeAt(++l2)) << 16 | (255 & t3.charCodeAt(++l2)) << 24, ++l2, i2 = 27492 + (65535 & (a2 = 5 * (65535 & (i2 = (i2 ^= u2 = (65535 & (u2 = (u2 = (65535 & u2) * o2 + (((u2 >>> 16) * o2 & 65535) << 16) & 4294967295) << 15 | u2 >>> 17)) * s2 + (((u2 >>> 16) * s2 & 65535) << 16) & 4294967295) << 13 | i2 >>> 19)) + ((5 * (i2 >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (a2 >>> 16) & 65535) << 16);
            switch (u2 = 0, r2) {
              case 3:
                u2 ^= (255 & t3.charCodeAt(l2 + 2)) << 16;
              case 2:
                u2 ^= (255 & t3.charCodeAt(l2 + 1)) << 8;
              case 1:
                i2 ^= u2 = (65535 & (u2 = (u2 = (65535 & (u2 ^= 255 & t3.charCodeAt(l2))) * o2 + (((u2 >>> 16) * o2 & 65535) << 16) & 4294967295) << 15 | u2 >>> 17)) * s2 + (((u2 >>> 16) * s2 & 65535) << 16) & 4294967295;
            }
            return i2 ^= t3.length, i2 = 2246822507 * (65535 & (i2 ^= i2 >>> 16)) + ((2246822507 * (i2 >>> 16) & 65535) << 16) & 4294967295, i2 = 3266489909 * (65535 & (i2 ^= i2 >>> 13)) + ((3266489909 * (i2 >>> 16) & 65535) << 16) & 4294967295, (i2 ^= i2 >>> 16) >>> 0;
          };
        }), ca = e(function(t2) {
          t2.exports = function(t3, e2) {
            for (var r2, n2 = t3.length, i2 = e2 ^ n2, a2 = 0; n2 >= 4; )
              r2 = 1540483477 * (65535 & (r2 = 255 & t3.charCodeAt(a2) | (255 & t3.charCodeAt(++a2)) << 8 | (255 & t3.charCodeAt(++a2)) << 16 | (255 & t3.charCodeAt(++a2)) << 24)) + ((1540483477 * (r2 >>> 16) & 65535) << 16), i2 = 1540483477 * (65535 & i2) + ((1540483477 * (i2 >>> 16) & 65535) << 16) ^ (r2 = 1540483477 * (65535 & (r2 ^= r2 >>> 24)) + ((1540483477 * (r2 >>> 16) & 65535) << 16)), n2 -= 4, ++a2;
            switch (n2) {
              case 3:
                i2 ^= (255 & t3.charCodeAt(a2 + 2)) << 16;
              case 2:
                i2 ^= (255 & t3.charCodeAt(a2 + 1)) << 8;
              case 1:
                i2 = 1540483477 * (65535 & (i2 ^= 255 & t3.charCodeAt(a2))) + ((1540483477 * (i2 >>> 16) & 65535) << 16);
            }
            return i2 = 1540483477 * (65535 & (i2 ^= i2 >>> 13)) + ((1540483477 * (i2 >>> 16) & 65535) << 16), (i2 ^= i2 >>> 15) >>> 0;
          };
        }), ha = pa, fa = ca;
        ha.murmur3 = pa, ha.murmur2 = fa;
        var ya = function() {
          this.ids = [], this.positions = [], this.indexed = false;
        };
        ya.prototype.add = function(t2, e2, r2, n2) {
          this.ids.push(ma(t2)), this.positions.push(e2, r2, n2);
        }, ya.prototype.getPositions = function(t2) {
          for (var e2 = ma(t2), r2 = 0, n2 = this.ids.length - 1; r2 < n2; ) {
            var i2 = r2 + n2 >> 1;
            this.ids[i2] >= e2 ? n2 = i2 : r2 = i2 + 1;
          }
          for (var a2 = []; this.ids[r2] === e2; )
            a2.push({index: this.positions[3 * r2], start: this.positions[3 * r2 + 1], end: this.positions[3 * r2 + 2]}), r2++;
          return a2;
        }, ya.serialize = function(t2, e2) {
          var r2 = new Float64Array(t2.ids), n2 = new Uint32Array(t2.positions);
          return function t3(e3, r3, n3, i2) {
            for (; n3 < i2; ) {
              for (var a2 = e3[n3 + i2 >> 1], o2 = n3 - 1, s2 = i2 + 1; ; ) {
                do {
                  o2++;
                } while (e3[o2] < a2);
                do {
                  s2--;
                } while (e3[s2] > a2);
                if (o2 >= s2)
                  break;
                va(e3, o2, s2), va(r3, 3 * o2, 3 * s2), va(r3, 3 * o2 + 1, 3 * s2 + 1), va(r3, 3 * o2 + 2, 3 * s2 + 2);
              }
              s2 - n3 < i2 - s2 ? (t3(e3, r3, n3, s2), n3 = s2 + 1) : (t3(e3, r3, s2 + 1, i2), i2 = s2);
            }
          }(r2, n2, 0, r2.length - 1), e2 && e2.push(r2.buffer, n2.buffer), {ids: r2, positions: n2};
        }, ya.deserialize = function(t2) {
          var e2 = new ya();
          return e2.ids = t2.ids, e2.positions = t2.positions, e2.indexed = true, e2;
        };
        var da = Math.pow(2, 53) - 1;
        function ma(t2) {
          var e2 = +t2;
          return !isNaN(e2) && e2 <= da ? e2 : ha(String(t2));
        }
        function va(t2, e2, r2) {
          var n2 = t2[e2];
          t2[e2] = t2[r2], t2[r2] = n2;
        }
        On("FeaturePositionMap", ya);
        var ga = function(t2, e2) {
          this.gl = t2.gl, this.location = e2;
        }, xa = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = 0;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            this.current !== t3 && (this.current = t3, this.gl.uniform1i(this.location, t3));
          }, e2;
        }(ga), ba = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = 0;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            this.current !== t3 && (this.current = t3, this.gl.uniform1f(this.location, t3));
          }, e2;
        }(ga), wa = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = [0, 0];
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            t3[0] === this.current[0] && t3[1] === this.current[1] || (this.current = t3, this.gl.uniform2f(this.location, t3[0], t3[1]));
          }, e2;
        }(ga), _a = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = [0, 0, 0];
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            t3[0] === this.current[0] && t3[1] === this.current[1] && t3[2] === this.current[2] || (this.current = t3, this.gl.uniform3f(this.location, t3[0], t3[1], t3[2]));
          }, e2;
        }(ga), Aa = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = [0, 0, 0, 0];
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            t3[0] === this.current[0] && t3[1] === this.current[1] && t3[2] === this.current[2] && t3[3] === this.current[3] || (this.current = t3, this.gl.uniform4f(this.location, t3[0], t3[1], t3[2], t3[3]));
          }, e2;
        }(ga), Sa = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = te.transparent;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            t3.r === this.current.r && t3.g === this.current.g && t3.b === this.current.b && t3.a === this.current.a || (this.current = t3, this.gl.uniform4f(this.location, t3.r, t3.g, t3.b, t3.a));
          }, e2;
        }(ga), ka = new Float32Array(16), Ia = function(t2) {
          function e2(e3, r2) {
            t2.call(this, e3, r2), this.current = ka;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            if (t3[12] !== this.current[12] || t3[0] !== this.current[0])
              return this.current = t3, void this.gl.uniformMatrix4fv(this.location, false, t3);
            for (var e3 = 1; e3 < 16; e3++)
              if (t3[e3] !== this.current[e3]) {
                this.current = t3, this.gl.uniformMatrix4fv(this.location, false, t3);
                break;
              }
          }, e2;
        }(ga);
        function za(t2) {
          return [ua(255 * t2.r, 255 * t2.g), ua(255 * t2.b, 255 * t2.a)];
        }
        var Ca = function(t2, e2, r2) {
          this.value = t2, this.uniformNames = e2.map(function(t3) {
            return "u_" + t3;
          }), this.type = r2;
        };
        Ca.prototype.setUniform = function(t2, e2, r2) {
          t2.set(r2.constantOr(this.value));
        }, Ca.prototype.getBinding = function(t2, e2, r2) {
          return this.type === "color" ? new Sa(t2, e2) : new ba(t2, e2);
        };
        var Ea = function(t2, e2) {
          this.uniformNames = e2.map(function(t3) {
            return "u_" + t3;
          }), this.patternFrom = null, this.patternTo = null, this.pixelRatioFrom = 1, this.pixelRatioTo = 1;
        };
        Ea.prototype.setConstantPatternPositions = function(t2, e2) {
          this.pixelRatioFrom = e2.pixelRatio, this.pixelRatioTo = t2.pixelRatio, this.patternFrom = e2.tlbr, this.patternTo = t2.tlbr;
        }, Ea.prototype.setUniform = function(t2, e2, r2, n2) {
          var i2 = n2 === "u_pattern_to" ? this.patternTo : n2 === "u_pattern_from" ? this.patternFrom : n2 === "u_pixel_ratio_to" ? this.pixelRatioTo : n2 === "u_pixel_ratio_from" ? this.pixelRatioFrom : null;
          i2 && t2.set(i2);
        }, Ea.prototype.getBinding = function(t2, e2, r2) {
          return r2.substr(0, 9) === "u_pattern" ? new Aa(t2, e2) : new ba(t2, e2);
        };
        var Pa = function(t2, e2, r2, n2) {
          this.expression = t2, this.type = r2, this.maxValue = 0, this.paintVertexAttributes = e2.map(function(t3) {
            return {name: "a_" + t3, type: "Float32", components: r2 === "color" ? 2 : 1, offset: 0};
          }), this.paintVertexArray = new n2();
        };
        Pa.prototype.populatePaintArray = function(t2, e2, r2, n2, i2) {
          var a2 = this.paintVertexArray.length, o2 = this.expression.evaluate(new si(0), e2, {}, n2, [], i2);
          this.paintVertexArray.resize(t2), this._setPaintValue(a2, t2, o2);
        }, Pa.prototype.updatePaintArray = function(t2, e2, r2, n2) {
          var i2 = this.expression.evaluate({zoom: 0}, r2, n2);
          this._setPaintValue(t2, e2, i2);
        }, Pa.prototype._setPaintValue = function(t2, e2, r2) {
          if (this.type === "color")
            for (var n2 = za(r2), i2 = t2; i2 < e2; i2++)
              this.paintVertexArray.emplace(i2, n2[0], n2[1]);
          else {
            for (var a2 = t2; a2 < e2; a2++)
              this.paintVertexArray.emplace(a2, r2);
            this.maxValue = Math.max(this.maxValue, Math.abs(r2));
          }
        }, Pa.prototype.upload = function(t2) {
          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t2.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }, Pa.prototype.destroy = function() {
          this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        };
        var Ma = function(t2, e2, r2, n2, i2, a2) {
          this.expression = t2, this.uniformNames = e2.map(function(t3) {
            return "u_" + t3 + "_t";
          }), this.type = r2, this.useIntegerZoom = n2, this.zoom = i2, this.maxValue = 0, this.paintVertexAttributes = e2.map(function(t3) {
            return {name: "a_" + t3, type: "Float32", components: r2 === "color" ? 4 : 2, offset: 0};
          }), this.paintVertexArray = new a2();
        };
        Ma.prototype.populatePaintArray = function(t2, e2, r2, n2, i2) {
          var a2 = this.expression.evaluate(new si(this.zoom), e2, {}, n2, [], i2), o2 = this.expression.evaluate(new si(this.zoom + 1), e2, {}, n2, [], i2), s2 = this.paintVertexArray.length;
          this.paintVertexArray.resize(t2), this._setPaintValue(s2, t2, a2, o2);
        }, Ma.prototype.updatePaintArray = function(t2, e2, r2, n2) {
          var i2 = this.expression.evaluate({zoom: this.zoom}, r2, n2), a2 = this.expression.evaluate({zoom: this.zoom + 1}, r2, n2);
          this._setPaintValue(t2, e2, i2, a2);
        }, Ma.prototype._setPaintValue = function(t2, e2, r2, n2) {
          if (this.type === "color")
            for (var i2 = za(r2), a2 = za(n2), o2 = t2; o2 < e2; o2++)
              this.paintVertexArray.emplace(o2, i2[0], i2[1], a2[0], a2[1]);
          else {
            for (var s2 = t2; s2 < e2; s2++)
              this.paintVertexArray.emplace(s2, r2, n2);
            this.maxValue = Math.max(this.maxValue, Math.abs(r2), Math.abs(n2));
          }
        }, Ma.prototype.upload = function(t2) {
          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t2.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }, Ma.prototype.destroy = function() {
          this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        }, Ma.prototype.setUniform = function(t2, e2) {
          var r2 = this.useIntegerZoom ? Math.floor(e2.zoom) : e2.zoom, n2 = p(this.expression.interpolationFactor(r2, this.zoom, this.zoom + 1), 0, 1);
          t2.set(n2);
        }, Ma.prototype.getBinding = function(t2, e2, r2) {
          return new ba(t2, e2);
        };
        var Ba = function(t2, e2, r2, n2, i2, a2) {
          this.expression = t2, this.type = e2, this.useIntegerZoom = r2, this.zoom = n2, this.layerId = a2, this.zoomInPaintVertexArray = new i2(), this.zoomOutPaintVertexArray = new i2();
        };
        Ba.prototype.populatePaintArray = function(t2, e2, r2) {
          var n2 = this.zoomInPaintVertexArray.length;
          this.zoomInPaintVertexArray.resize(t2), this.zoomOutPaintVertexArray.resize(t2), this._setPaintValues(n2, t2, e2.patterns && e2.patterns[this.layerId], r2);
        }, Ba.prototype.updatePaintArray = function(t2, e2, r2, n2, i2) {
          this._setPaintValues(t2, e2, r2.patterns && r2.patterns[this.layerId], i2);
        }, Ba.prototype._setPaintValues = function(t2, e2, r2, n2) {
          if (n2 && r2) {
            var i2 = n2[r2.min], a2 = n2[r2.mid], o2 = n2[r2.max];
            if (i2 && a2 && o2)
              for (var s2 = t2; s2 < e2; s2++)
                this.zoomInPaintVertexArray.emplace(s2, a2.tl[0], a2.tl[1], a2.br[0], a2.br[1], i2.tl[0], i2.tl[1], i2.br[0], i2.br[1], a2.pixelRatio, i2.pixelRatio), this.zoomOutPaintVertexArray.emplace(s2, a2.tl[0], a2.tl[1], a2.br[0], a2.br[1], o2.tl[0], o2.tl[1], o2.br[0], o2.br[1], a2.pixelRatio, o2.pixelRatio);
          }
        }, Ba.prototype.upload = function(t2) {
          this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = t2.createVertexBuffer(this.zoomInPaintVertexArray, la.members, this.expression.isStateDependent), this.zoomOutPaintVertexBuffer = t2.createVertexBuffer(this.zoomOutPaintVertexArray, la.members, this.expression.isStateDependent));
        }, Ba.prototype.destroy = function() {
          this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(), this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy();
        };
        var Ta = function(t2, e2, r2) {
          this.binders = {}, this._buffers = [];
          var n2 = [];
          for (var i2 in t2.paint._values)
            if (r2(i2)) {
              var a2 = t2.paint.get(i2);
              if (a2 instanceof yi && Tr(a2.property.specification)) {
                var o2 = Fa(i2, t2.type), s2 = a2.value, u2 = a2.property.specification.type, l2 = a2.property.useIntegerZoom, p2 = a2.property.specification["property-type"], c2 = p2 === "cross-faded" || p2 === "cross-faded-data-driven";
                if (s2.kind === "constant")
                  this.binders[i2] = c2 ? new Ea(s2.value, o2) : new Ca(s2.value, o2, u2), n2.push("/u_" + i2);
                else if (s2.kind === "source" || c2) {
                  var h2 = Da(i2, u2, "source");
                  this.binders[i2] = c2 ? new Ba(s2, u2, l2, e2, h2, t2.id) : new Pa(s2, o2, u2, h2), n2.push("/a_" + i2);
                } else {
                  var f2 = Da(i2, u2, "composite");
                  this.binders[i2] = new Ma(s2, o2, u2, l2, e2, f2), n2.push("/z_" + i2);
                }
              }
            }
          this.cacheKey = n2.sort().join("");
        };
        Ta.prototype.getMaxValue = function(t2) {
          var e2 = this.binders[t2];
          return e2 instanceof Pa || e2 instanceof Ma ? e2.maxValue : 0;
        }, Ta.prototype.populatePaintArrays = function(t2, e2, r2, n2, i2) {
          for (var a2 in this.binders) {
            var o2 = this.binders[a2];
            (o2 instanceof Pa || o2 instanceof Ma || o2 instanceof Ba) && o2.populatePaintArray(t2, e2, r2, n2, i2);
          }
        }, Ta.prototype.setConstantPatternPositions = function(t2, e2) {
          for (var r2 in this.binders) {
            var n2 = this.binders[r2];
            n2 instanceof Ea && n2.setConstantPatternPositions(t2, e2);
          }
        }, Ta.prototype.updatePaintArrays = function(t2, e2, r2, n2, i2) {
          var a2 = false;
          for (var o2 in t2)
            for (var s2 = 0, u2 = e2.getPositions(o2); s2 < u2.length; s2 += 1) {
              var l2 = u2[s2], p2 = r2.feature(l2.index);
              for (var c2 in this.binders) {
                var h2 = this.binders[c2];
                if ((h2 instanceof Pa || h2 instanceof Ma || h2 instanceof Ba) && h2.expression.isStateDependent === true) {
                  var f2 = n2.paint.get(c2);
                  h2.expression = f2.value, h2.updatePaintArray(l2.start, l2.end, p2, t2[o2], i2), a2 = true;
                }
              }
            }
          return a2;
        }, Ta.prototype.defines = function() {
          var t2 = [];
          for (var e2 in this.binders) {
            var r2 = this.binders[e2];
            (r2 instanceof Ca || r2 instanceof Ea) && t2.push.apply(t2, r2.uniformNames.map(function(t3) {
              return "#define HAS_UNIFORM_" + t3;
            }));
          }
          return t2;
        }, Ta.prototype.getBinderAttributes = function() {
          var t2 = [];
          for (var e2 in this.binders) {
            var r2 = this.binders[e2];
            if (r2 instanceof Pa || r2 instanceof Ma)
              for (var n2 = 0; n2 < r2.paintVertexAttributes.length; n2++)
                t2.push(r2.paintVertexAttributes[n2].name);
            else if (r2 instanceof Ba)
              for (var i2 = 0; i2 < la.members.length; i2++)
                t2.push(la.members[i2].name);
          }
          return t2;
        }, Ta.prototype.getBinderUniforms = function() {
          var t2 = [];
          for (var e2 in this.binders) {
            var r2 = this.binders[e2];
            if (r2 instanceof Ca || r2 instanceof Ea || r2 instanceof Ma)
              for (var n2 = 0, i2 = r2.uniformNames; n2 < i2.length; n2 += 1)
                t2.push(i2[n2]);
          }
          return t2;
        }, Ta.prototype.getPaintVertexBuffers = function() {
          return this._buffers;
        }, Ta.prototype.getUniforms = function(t2, e2) {
          var r2 = [];
          for (var n2 in this.binders) {
            var i2 = this.binders[n2];
            if (i2 instanceof Ca || i2 instanceof Ea || i2 instanceof Ma)
              for (var a2 = 0, o2 = i2.uniformNames; a2 < o2.length; a2 += 1) {
                var s2 = o2[a2];
                if (e2[s2]) {
                  var u2 = i2.getBinding(t2, e2[s2], s2);
                  r2.push({name: s2, property: n2, binding: u2});
                }
              }
          }
          return r2;
        }, Ta.prototype.setUniforms = function(t2, e2, r2, n2) {
          for (var i2 = 0, a2 = e2; i2 < a2.length; i2 += 1) {
            var o2 = a2[i2], s2 = o2.name, u2 = o2.property;
            this.binders[u2].setUniform(o2.binding, n2, r2.get(u2), s2);
          }
        }, Ta.prototype.updatePaintBuffers = function(t2) {
          for (var e2 in this._buffers = [], this.binders) {
            var r2 = this.binders[e2];
            if (t2 && r2 instanceof Ba) {
              var n2 = t2.fromScale === 2 ? r2.zoomInPaintVertexBuffer : r2.zoomOutPaintVertexBuffer;
              n2 && this._buffers.push(n2);
            } else
              (r2 instanceof Pa || r2 instanceof Ma) && r2.paintVertexBuffer && this._buffers.push(r2.paintVertexBuffer);
          }
        }, Ta.prototype.upload = function(t2) {
          for (var e2 in this.binders) {
            var r2 = this.binders[e2];
            (r2 instanceof Pa || r2 instanceof Ma || r2 instanceof Ba) && r2.upload(t2);
          }
          this.updatePaintBuffers();
        }, Ta.prototype.destroy = function() {
          for (var t2 in this.binders) {
            var e2 = this.binders[t2];
            (e2 instanceof Pa || e2 instanceof Ma || e2 instanceof Ba) && e2.destroy();
          }
        };
        var Va = function(t2, e2, r2) {
          r2 === void 0 && (r2 = function() {
            return true;
          }), this.programConfigurations = {};
          for (var n2 = 0, i2 = t2; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            this.programConfigurations[a2.id] = new Ta(a2, e2, r2);
          }
          this.needsUpload = false, this._featureMap = new ya(), this._bufferOffset = 0;
        };
        function Fa(t2, e2) {
          return {"text-opacity": ["opacity"], "icon-opacity": ["opacity"], "text-color": ["fill_color"], "icon-color": ["fill_color"], "text-halo-color": ["halo_color"], "icon-halo-color": ["halo_color"], "text-halo-blur": ["halo_blur"], "icon-halo-blur": ["halo_blur"], "text-halo-width": ["halo_width"], "icon-halo-width": ["halo_width"], "line-gap-width": ["gapwidth"], "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"], "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"], "fill-extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"]}[t2] || [t2.replace(e2 + "-", "").replace(/-/g, "_")];
        }
        function Da(t2, e2, r2) {
          var n2 = {color: {source: Bi, composite: Hi}, number: {source: Ki, composite: Bi}}, i2 = function(t3) {
            return {"line-pattern": {source: Ti, composite: Ti}, "fill-pattern": {source: Ti, composite: Ti}, "fill-extrusion-pattern": {source: Ti, composite: Ti}}[t3];
          }(t2);
          return i2 && i2[r2] || n2[e2][r2];
        }
        Va.prototype.populatePaintArrays = function(t2, e2, r2, n2, i2, a2) {
          for (var o2 in this.programConfigurations)
            this.programConfigurations[o2].populatePaintArrays(t2, e2, n2, i2, a2);
          e2.id !== void 0 && this._featureMap.add(e2.id, r2, this._bufferOffset, t2), this._bufferOffset = t2, this.needsUpload = true;
        }, Va.prototype.updatePaintArrays = function(t2, e2, r2, n2) {
          for (var i2 = 0, a2 = r2; i2 < a2.length; i2 += 1) {
            var o2 = a2[i2];
            this.needsUpload = this.programConfigurations[o2.id].updatePaintArrays(t2, this._featureMap, e2, o2, n2) || this.needsUpload;
          }
        }, Va.prototype.get = function(t2) {
          return this.programConfigurations[t2];
        }, Va.prototype.upload = function(t2) {
          if (this.needsUpload) {
            for (var e2 in this.programConfigurations)
              this.programConfigurations[e2].upload(t2);
            this.needsUpload = false;
          }
        }, Va.prototype.destroy = function() {
          for (var t2 in this.programConfigurations)
            this.programConfigurations[t2].destroy();
        }, On("ConstantBinder", Ca), On("CrossFadedConstantBinder", Ea), On("SourceExpressionBinder", Pa), On("CrossFadedCompositeBinder", Ba), On("CompositeExpressionBinder", Ma), On("ProgramConfiguration", Ta, {omit: ["_buffers"]}), On("ProgramConfigurationSet", Va);
        var La = Math.pow(2, 14) - 1, Oa = -La - 1;
        function Ra(t2) {
          for (var e2 = 8192 / t2.extent, r2 = t2.loadGeometry(), n2 = 0; n2 < r2.length; n2++)
            for (var i2 = r2[n2], a2 = 0; a2 < i2.length; a2++) {
              var o2 = i2[a2], s2 = Math.round(o2.x * e2), u2 = Math.round(o2.y * e2);
              o2.x = p(s2, Oa, La), o2.y = p(u2, Oa, La), (s2 < o2.x || s2 > o2.x + 1 || u2 < o2.y || u2 > o2.y + 1) && A("Geometry exceeds allowed extent, reduce your vector tile buffer size");
            }
          return r2;
        }
        function Ua(t2, e2) {
          return {type: t2.type, id: t2.id, properties: t2.properties, geometry: e2 ? Ra(t2) : []};
        }
        function ja(t2, e2, r2, n2, i2) {
          t2.emplaceBack(2 * e2 + (n2 + 1) / 2, 2 * r2 + (i2 + 1) / 2);
        }
        var qa = function(t2) {
          this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map(function(t3) {
            return t3.id;
          }), this.index = t2.index, this.hasPattern = false, this.layoutVertexArray = new Ci(), this.indexArray = new ji(), this.segments = new sa(), this.programConfigurations = new Va(t2.layers, t2.zoom), this.stateDependentLayerIds = this.layers.filter(function(t3) {
            return t3.isStateDependent();
          }).map(function(t3) {
            return t3.id;
          });
        };
        function Na(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            if (Wa(e2, t2[r2]))
              return true;
          for (var n2 = 0; n2 < e2.length; n2++)
            if (Wa(t2, e2[n2]))
              return true;
          return !!Xa(t2, e2);
        }
        function Ka(t2, e2, r2) {
          return !!Wa(t2, e2) || !!Ha(e2, t2, r2);
        }
        function Ga(t2, e2) {
          if (t2.length === 1)
            return $a(e2, t2[0]);
          for (var r2 = 0; r2 < e2.length; r2++)
            for (var n2 = e2[r2], i2 = 0; i2 < n2.length; i2++)
              if (Wa(t2, n2[i2]))
                return true;
          for (var a2 = 0; a2 < t2.length; a2++)
            if ($a(e2, t2[a2]))
              return true;
          for (var o2 = 0; o2 < e2.length; o2++)
            if (Xa(t2, e2[o2]))
              return true;
          return false;
        }
        function Za(t2, e2, r2) {
          if (t2.length > 1) {
            if (Xa(t2, e2))
              return true;
            for (var n2 = 0; n2 < e2.length; n2++)
              if (Ha(e2[n2], t2, r2))
                return true;
          }
          for (var i2 = 0; i2 < t2.length; i2++)
            if (Ha(t2[i2], e2, r2))
              return true;
          return false;
        }
        function Xa(t2, e2) {
          if (t2.length === 0 || e2.length === 0)
            return false;
          for (var r2 = 0; r2 < t2.length - 1; r2++)
            for (var n2 = t2[r2], i2 = t2[r2 + 1], a2 = 0; a2 < e2.length - 1; a2++)
              if (Ja(n2, i2, e2[a2], e2[a2 + 1]))
                return true;
          return false;
        }
        function Ja(t2, e2, r2, n2) {
          return S(t2, r2, n2) !== S(e2, r2, n2) && S(t2, e2, r2) !== S(t2, e2, n2);
        }
        function Ha(t2, e2, r2) {
          var n2 = r2 * r2;
          if (e2.length === 1)
            return t2.distSqr(e2[0]) < n2;
          for (var i2 = 1; i2 < e2.length; i2++)
            if (Ya(t2, e2[i2 - 1], e2[i2]) < n2)
              return true;
          return false;
        }
        function Ya(t2, e2, r2) {
          var n2 = e2.distSqr(r2);
          if (n2 === 0)
            return t2.distSqr(e2);
          var i2 = ((t2.x - e2.x) * (r2.x - e2.x) + (t2.y - e2.y) * (r2.y - e2.y)) / n2;
          return t2.distSqr(i2 < 0 ? e2 : i2 > 1 ? r2 : r2.sub(e2)._mult(i2)._add(e2));
        }
        function $a(t2, e2) {
          for (var r2, n2, i2, a2 = false, o2 = 0; o2 < t2.length; o2++)
            for (var s2 = 0, u2 = (r2 = t2[o2]).length - 1; s2 < r2.length; u2 = s2++)
              (n2 = r2[s2]).y > e2.y != (i2 = r2[u2]).y > e2.y && e2.x < (i2.x - n2.x) * (e2.y - n2.y) / (i2.y - n2.y) + n2.x && (a2 = !a2);
          return a2;
        }
        function Wa(t2, e2) {
          for (var r2 = false, n2 = 0, i2 = t2.length - 1; n2 < t2.length; i2 = n2++) {
            var a2 = t2[n2], o2 = t2[i2];
            a2.y > e2.y != o2.y > e2.y && e2.x < (o2.x - a2.x) * (e2.y - a2.y) / (o2.y - a2.y) + a2.x && (r2 = !r2);
          }
          return r2;
        }
        function Qa(t2, e2, r2) {
          var n2 = r2[0], i2 = r2[2];
          if (t2.x < n2.x && e2.x < n2.x || t2.x > i2.x && e2.x > i2.x || t2.y < n2.y && e2.y < n2.y || t2.y > i2.y && e2.y > i2.y)
            return false;
          var a2 = S(t2, e2, r2[0]);
          return a2 !== S(t2, e2, r2[1]) || a2 !== S(t2, e2, r2[2]) || a2 !== S(t2, e2, r2[3]);
        }
        function to(t2, e2, r2) {
          var n2 = e2.paint.get(t2).value;
          return n2.kind === "constant" ? n2.value : r2.programConfigurations.get(e2.id).getMaxValue(t2);
        }
        function eo(t2) {
          return Math.sqrt(t2[0] * t2[0] + t2[1] * t2[1]);
        }
        function ro(t2, e2, r2, n2, a2) {
          if (!e2[0] && !e2[1])
            return t2;
          var o2 = i.convert(e2)._mult(a2);
          r2 === "viewport" && o2._rotate(-n2);
          for (var s2 = [], u2 = 0; u2 < t2.length; u2++)
            s2.push(t2[u2].sub(o2));
          return s2;
        }
        qa.prototype.populate = function(t2, e2, r2) {
          var n2 = this.layers[0], i2 = [], a2 = null;
          n2.type === "circle" && (a2 = n2.layout.get("circle-sort-key"));
          for (var o2 = 0, s2 = t2; o2 < s2.length; o2 += 1) {
            var u2 = s2[o2], l2 = u2.feature, p2 = u2.id, c2 = u2.index, h2 = u2.sourceLayerIndex, f2 = this.layers[0]._featureFilter.needGeometry, y2 = Ua(l2, f2);
            if (this.layers[0]._featureFilter.filter(new si(this.zoom), y2, r2)) {
              var d2 = a2 ? a2.evaluate(y2, {}, r2) : void 0, m2 = {id: p2, properties: l2.properties, type: l2.type, sourceLayerIndex: h2, index: c2, geometry: f2 ? y2.geometry : Ra(l2), patterns: {}, sortKey: d2};
              i2.push(m2);
            }
          }
          a2 && i2.sort(function(t3, e3) {
            return t3.sortKey - e3.sortKey;
          });
          for (var v2 = 0, g2 = i2; v2 < g2.length; v2 += 1) {
            var x2 = g2[v2], b2 = x2.geometry, w2 = x2.index, _2 = x2.sourceLayerIndex, A2 = t2[w2].feature;
            this.addFeature(x2, b2, w2, r2), e2.featureIndex.insert(A2, b2, w2, _2, this.index);
          }
        }, qa.prototype.update = function(t2, e2, r2) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
        }, qa.prototype.isEmpty = function() {
          return this.layoutVertexArray.length === 0;
        }, qa.prototype.uploadPending = function() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }, qa.prototype.upload = function(t2) {
          this.uploaded || (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, oa), this.indexBuffer = t2.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t2), this.uploaded = true;
        }, qa.prototype.destroy = function() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, qa.prototype.addFeature = function(t2, e2, r2, n2) {
          for (var i2 = 0, a2 = e2; i2 < a2.length; i2 += 1)
            for (var o2 = 0, s2 = a2[i2]; o2 < s2.length; o2 += 1) {
              var u2 = s2[o2], l2 = u2.x, p2 = u2.y;
              if (!(l2 < 0 || l2 >= 8192 || p2 < 0 || p2 >= 8192)) {
                var c2 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t2.sortKey), h2 = c2.vertexLength;
                ja(this.layoutVertexArray, l2, p2, -1, -1), ja(this.layoutVertexArray, l2, p2, 1, -1), ja(this.layoutVertexArray, l2, p2, 1, 1), ja(this.layoutVertexArray, l2, p2, -1, 1), this.indexArray.emplaceBack(h2, h2 + 1, h2 + 2), this.indexArray.emplaceBack(h2, h2 + 3, h2 + 2), c2.vertexLength += 4, c2.primitiveLength += 2;
              }
            }
          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, {}, n2);
        }, On("CircleBucket", qa, {omit: ["layers"]});
        var no = new wi({"circle-sort-key": new vi(Et.layout_circle["circle-sort-key"])}), io = {paint: new wi({"circle-radius": new vi(Et.paint_circle["circle-radius"]), "circle-color": new vi(Et.paint_circle["circle-color"]), "circle-blur": new vi(Et.paint_circle["circle-blur"]), "circle-opacity": new vi(Et.paint_circle["circle-opacity"]), "circle-translate": new mi(Et.paint_circle["circle-translate"]), "circle-translate-anchor": new mi(Et.paint_circle["circle-translate-anchor"]), "circle-pitch-scale": new mi(Et.paint_circle["circle-pitch-scale"]), "circle-pitch-alignment": new mi(Et.paint_circle["circle-pitch-alignment"]), "circle-stroke-width": new vi(Et.paint_circle["circle-stroke-width"]), "circle-stroke-color": new vi(Et.paint_circle["circle-stroke-color"]), "circle-stroke-opacity": new vi(Et.paint_circle["circle-stroke-opacity"])}), layout: no}, ao = typeof Float32Array != "undefined" ? Float32Array : Array;
        function oo(t2) {
          return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = 1, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 1, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
        }
        function so(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], o2 = e2[3], s2 = e2[4], u2 = e2[5], l2 = e2[6], p2 = e2[7], c2 = e2[8], h2 = e2[9], f2 = e2[10], y2 = e2[11], d2 = e2[12], m2 = e2[13], v2 = e2[14], g2 = e2[15], x2 = r2[0], b2 = r2[1], w2 = r2[2], _2 = r2[3];
          return t2[0] = x2 * n2 + b2 * s2 + w2 * c2 + _2 * d2, t2[1] = x2 * i2 + b2 * u2 + w2 * h2 + _2 * m2, t2[2] = x2 * a2 + b2 * l2 + w2 * f2 + _2 * v2, t2[3] = x2 * o2 + b2 * p2 + w2 * y2 + _2 * g2, t2[4] = (x2 = r2[4]) * n2 + (b2 = r2[5]) * s2 + (w2 = r2[6]) * c2 + (_2 = r2[7]) * d2, t2[5] = x2 * i2 + b2 * u2 + w2 * h2 + _2 * m2, t2[6] = x2 * a2 + b2 * l2 + w2 * f2 + _2 * v2, t2[7] = x2 * o2 + b2 * p2 + w2 * y2 + _2 * g2, t2[8] = (x2 = r2[8]) * n2 + (b2 = r2[9]) * s2 + (w2 = r2[10]) * c2 + (_2 = r2[11]) * d2, t2[9] = x2 * i2 + b2 * u2 + w2 * h2 + _2 * m2, t2[10] = x2 * a2 + b2 * l2 + w2 * f2 + _2 * v2, t2[11] = x2 * o2 + b2 * p2 + w2 * y2 + _2 * g2, t2[12] = (x2 = r2[12]) * n2 + (b2 = r2[13]) * s2 + (w2 = r2[14]) * c2 + (_2 = r2[15]) * d2, t2[13] = x2 * i2 + b2 * u2 + w2 * h2 + _2 * m2, t2[14] = x2 * a2 + b2 * l2 + w2 * f2 + _2 * v2, t2[15] = x2 * o2 + b2 * p2 + w2 * y2 + _2 * g2, t2;
        }
        Math.hypot || (Math.hypot = function() {
          for (var t2 = arguments, e2 = 0, r2 = arguments.length; r2--; )
            e2 += t2[r2] * t2[r2];
          return Math.sqrt(e2);
        });
        var uo, lo = so;
        function po(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], o2 = e2[3];
          return t2[0] = r2[0] * n2 + r2[4] * i2 + r2[8] * a2 + r2[12] * o2, t2[1] = r2[1] * n2 + r2[5] * i2 + r2[9] * a2 + r2[13] * o2, t2[2] = r2[2] * n2 + r2[6] * i2 + r2[10] * a2 + r2[14] * o2, t2[3] = r2[3] * n2 + r2[7] * i2 + r2[11] * a2 + r2[15] * o2, t2;
        }
        uo = new ao(3), ao != Float32Array && (uo[0] = 0, uo[1] = 0, uo[2] = 0), function() {
          var t2 = new ao(4);
          ao != Float32Array && (t2[0] = 0, t2[1] = 0, t2[2] = 0, t2[3] = 0);
        }();
        var co = (function() {
          var t2 = new ao(2);
          ao != Float32Array && (t2[0] = 0, t2[1] = 0);
        }(), function(t2) {
          function e2(e3) {
            t2.call(this, e3, io);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.createBucket = function(t3) {
            return new qa(t3);
          }, e2.prototype.queryRadius = function(t3) {
            var e3 = t3;
            return to("circle-radius", this, e3) + to("circle-stroke-width", this, e3) + eo(this.paint.get("circle-translate"));
          }, e2.prototype.queryIntersectsFeature = function(t3, e3, r2, n2, i2, a2, o2, s2) {
            for (var u2 = ro(t3, this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), a2.angle, o2), l2 = this.paint.get("circle-radius").evaluate(e3, r2) + this.paint.get("circle-stroke-width").evaluate(e3, r2), p2 = this.paint.get("circle-pitch-alignment") === "map", c2 = p2 ? u2 : function(t4, e4) {
              return t4.map(function(t5) {
                return ho(t5, e4);
              });
            }(u2, s2), h2 = p2 ? l2 * o2 : l2, f2 = 0, y2 = n2; f2 < y2.length; f2 += 1)
              for (var d2 = 0, m2 = y2[f2]; d2 < m2.length; d2 += 1) {
                var v2 = m2[d2], g2 = p2 ? v2 : ho(v2, s2), x2 = h2, b2 = po([], [v2.x, v2.y, 0, 1], s2);
                if (this.paint.get("circle-pitch-scale") === "viewport" && this.paint.get("circle-pitch-alignment") === "map" ? x2 *= b2[3] / a2.cameraToCenterDistance : this.paint.get("circle-pitch-scale") === "map" && this.paint.get("circle-pitch-alignment") === "viewport" && (x2 *= a2.cameraToCenterDistance / b2[3]), Ka(c2, g2, x2))
                  return true;
              }
            return false;
          }, e2;
        }(_i));
        function ho(t2, e2) {
          var r2 = po([], [t2.x, t2.y, 0, 1], e2);
          return new i(r2[0] / r2[3], r2[1] / r2[3]);
        }
        var fo = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2;
        }(qa);
        function yo(t2, e2, r2, n2) {
          var i2 = e2.width, a2 = e2.height;
          if (n2) {
            if (n2 instanceof Uint8ClampedArray)
              n2 = new Uint8Array(n2.buffer);
            else if (n2.length !== i2 * a2 * r2)
              throw new RangeError("mismatched image size");
          } else
            n2 = new Uint8Array(i2 * a2 * r2);
          return t2.width = i2, t2.height = a2, t2.data = n2, t2;
        }
        function mo(t2, e2, r2) {
          var n2 = e2.width, i2 = e2.height;
          if (n2 !== t2.width || i2 !== t2.height) {
            var a2 = yo({}, {width: n2, height: i2}, r2);
            vo(t2, a2, {x: 0, y: 0}, {x: 0, y: 0}, {width: Math.min(t2.width, n2), height: Math.min(t2.height, i2)}, r2), t2.width = n2, t2.height = i2, t2.data = a2.data;
          }
        }
        function vo(t2, e2, r2, n2, i2, a2) {
          if (i2.width === 0 || i2.height === 0)
            return e2;
          if (i2.width > t2.width || i2.height > t2.height || r2.x > t2.width - i2.width || r2.y > t2.height - i2.height)
            throw new RangeError("out of range source coordinates for image copy");
          if (i2.width > e2.width || i2.height > e2.height || n2.x > e2.width - i2.width || n2.y > e2.height - i2.height)
            throw new RangeError("out of range destination coordinates for image copy");
          for (var o2 = t2.data, s2 = e2.data, u2 = 0; u2 < i2.height; u2++)
            for (var l2 = ((r2.y + u2) * t2.width + r2.x) * a2, p2 = ((n2.y + u2) * e2.width + n2.x) * a2, c2 = 0; c2 < i2.width * a2; c2++)
              s2[p2 + c2] = o2[l2 + c2];
          return e2;
        }
        On("HeatmapBucket", fo, {omit: ["layers"]});
        var go = function(t2, e2) {
          yo(this, t2, 1, e2);
        };
        go.prototype.resize = function(t2) {
          mo(this, t2, 1);
        }, go.prototype.clone = function() {
          return new go({width: this.width, height: this.height}, new Uint8Array(this.data));
        }, go.copy = function(t2, e2, r2, n2, i2) {
          vo(t2, e2, r2, n2, i2, 1);
        };
        var xo = function(t2, e2) {
          yo(this, t2, 4, e2);
        };
        xo.prototype.resize = function(t2) {
          mo(this, t2, 4);
        }, xo.prototype.replace = function(t2, e2) {
          e2 ? this.data.set(t2) : this.data = t2 instanceof Uint8ClampedArray ? new Uint8Array(t2.buffer) : t2;
        }, xo.prototype.clone = function() {
          return new xo({width: this.width, height: this.height}, new Uint8Array(this.data));
        }, xo.copy = function(t2, e2, r2, n2, i2) {
          vo(t2, e2, r2, n2, i2, 4);
        }, On("AlphaImage", go), On("RGBAImage", xo);
        var bo = {paint: new wi({"heatmap-radius": new vi(Et.paint_heatmap["heatmap-radius"]), "heatmap-weight": new vi(Et.paint_heatmap["heatmap-weight"]), "heatmap-intensity": new mi(Et.paint_heatmap["heatmap-intensity"]), "heatmap-color": new bi(Et.paint_heatmap["heatmap-color"]), "heatmap-opacity": new mi(Et.paint_heatmap["heatmap-opacity"])})};
        function wo(t2) {
          var e2 = {}, r2 = t2.resolution || 256, n2 = t2.clips ? t2.clips.length : 1, i2 = t2.image || new xo({width: r2, height: n2}), a2 = function(r3, n3, a3) {
            e2[t2.evaluationKey] = a3;
            var o3 = t2.expression.evaluate(e2);
            i2.data[r3 + n3 + 0] = Math.floor(255 * o3.r / o3.a), i2.data[r3 + n3 + 1] = Math.floor(255 * o3.g / o3.a), i2.data[r3 + n3 + 2] = Math.floor(255 * o3.b / o3.a), i2.data[r3 + n3 + 3] = Math.floor(255 * o3.a);
          };
          if (t2.clips)
            for (var o2 = 0, s2 = 0; o2 < n2; ++o2, s2 += 4 * r2)
              for (var u2 = 0, l2 = 0; u2 < r2; u2++, l2 += 4) {
                var p2 = u2 / (r2 - 1), c2 = t2.clips[o2];
                a2(s2, l2, c2.start * (1 - p2) + c2.end * p2);
              }
          else
            for (var h2 = 0, f2 = 0; h2 < r2; h2++, f2 += 4)
              a2(0, f2, h2 / (r2 - 1));
          return i2;
        }
        var _o = function(t2) {
          function e2(e3) {
            t2.call(this, e3, bo), this._updateColorRamp();
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.createBucket = function(t3) {
            return new fo(t3);
          }, e2.prototype._handleSpecialPaintPropertyUpdate = function(t3) {
            t3 === "heatmap-color" && this._updateColorRamp();
          }, e2.prototype._updateColorRamp = function() {
            this.colorRamp = wo({expression: this._transitionablePaint._values["heatmap-color"].value.expression, evaluationKey: "heatmapDensity", image: this.colorRamp}), this.colorRampTexture = null;
          }, e2.prototype.resize = function() {
            this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null);
          }, e2.prototype.queryRadius = function() {
            return 0;
          }, e2.prototype.queryIntersectsFeature = function() {
            return false;
          }, e2.prototype.hasOffscreenPass = function() {
            return this.paint.get("heatmap-opacity") !== 0 && this.visibility !== "none";
          }, e2;
        }(_i), Ao = {paint: new wi({"hillshade-illumination-direction": new mi(Et.paint_hillshade["hillshade-illumination-direction"]), "hillshade-illumination-anchor": new mi(Et.paint_hillshade["hillshade-illumination-anchor"]), "hillshade-exaggeration": new mi(Et.paint_hillshade["hillshade-exaggeration"]), "hillshade-shadow-color": new mi(Et.paint_hillshade["hillshade-shadow-color"]), "hillshade-highlight-color": new mi(Et.paint_hillshade["hillshade-highlight-color"]), "hillshade-accent-color": new mi(Et.paint_hillshade["hillshade-accent-color"])})}, So = function(t2) {
          function e2(e3) {
            t2.call(this, e3, Ao);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.hasOffscreenPass = function() {
            return this.paint.get("hillshade-exaggeration") !== 0 && this.visibility !== "none";
          }, e2;
        }(_i), ko = Ii([{name: "a_pos", components: 2, type: "Int16"}], 4).members, Io = Co, zo = Co;
        function Co(t2, e2, r2) {
          r2 = r2 || 2;
          var n2, i2, a2, o2, s2, u2, l2, p2 = e2 && e2.length, c2 = p2 ? e2[0] * r2 : t2.length, h2 = Eo(t2, 0, c2, r2, true), f2 = [];
          if (!h2 || h2.next === h2.prev)
            return f2;
          if (p2 && (h2 = function(t3, e3, r3, n3) {
            var i3, a3, o3, s3 = [];
            for (i3 = 0, a3 = e3.length; i3 < a3; i3++)
              (o3 = Eo(t3, e3[i3] * n3, i3 < a3 - 1 ? e3[i3 + 1] * n3 : t3.length, n3, false)) === o3.next && (o3.steiner = true), s3.push(Uo(o3));
            for (s3.sort(Do), i3 = 0; i3 < s3.length; i3++)
              Lo(s3[i3], r3), r3 = Po(r3, r3.next);
            return r3;
          }(t2, e2, h2, r2)), t2.length > 80 * r2) {
            n2 = a2 = t2[0], i2 = o2 = t2[1];
            for (var y2 = r2; y2 < c2; y2 += r2)
              (s2 = t2[y2]) < n2 && (n2 = s2), (u2 = t2[y2 + 1]) < i2 && (i2 = u2), s2 > a2 && (a2 = s2), u2 > o2 && (o2 = u2);
            l2 = (l2 = Math.max(a2 - n2, o2 - i2)) !== 0 ? 1 / l2 : 0;
          }
          return Mo(h2, f2, r2, n2, i2, l2), f2;
        }
        function Eo(t2, e2, r2, n2, i2) {
          var a2, o2;
          if (i2 === Qo(t2, e2, r2, n2) > 0)
            for (a2 = e2; a2 < r2; a2 += n2)
              o2 = Yo(a2, t2[a2], t2[a2 + 1], o2);
          else
            for (a2 = r2 - n2; a2 >= e2; a2 -= n2)
              o2 = Yo(a2, t2[a2], t2[a2 + 1], o2);
          return o2 && Ko(o2, o2.next) && ($o(o2), o2 = o2.next), o2;
        }
        function Po(t2, e2) {
          if (!t2)
            return t2;
          e2 || (e2 = t2);
          var r2, n2 = t2;
          do {
            if (r2 = false, n2.steiner || !Ko(n2, n2.next) && No(n2.prev, n2, n2.next) !== 0)
              n2 = n2.next;
            else {
              if ($o(n2), (n2 = e2 = n2.prev) === n2.next)
                break;
              r2 = true;
            }
          } while (r2 || n2 !== e2);
          return e2;
        }
        function Mo(t2, e2, r2, n2, i2, a2, o2) {
          if (t2) {
            !o2 && a2 && function(t3, e3, r3, n3) {
              var i3 = t3;
              do {
                i3.z === null && (i3.z = Ro(i3.x, i3.y, e3, r3, n3)), i3.prevZ = i3.prev, i3.nextZ = i3.next, i3 = i3.next;
              } while (i3 !== t3);
              i3.prevZ.nextZ = null, i3.prevZ = null, function(t4) {
                var e4, r4, n4, i4, a3, o3, s3, u3, l3 = 1;
                do {
                  for (r4 = t4, t4 = null, a3 = null, o3 = 0; r4; ) {
                    for (o3++, n4 = r4, s3 = 0, e4 = 0; e4 < l3 && (s3++, n4 = n4.nextZ); e4++)
                      ;
                    for (u3 = l3; s3 > 0 || u3 > 0 && n4; )
                      s3 !== 0 && (u3 === 0 || !n4 || r4.z <= n4.z) ? (i4 = r4, r4 = r4.nextZ, s3--) : (i4 = n4, n4 = n4.nextZ, u3--), a3 ? a3.nextZ = i4 : t4 = i4, i4.prevZ = a3, a3 = i4;
                    r4 = n4;
                  }
                  a3.nextZ = null, l3 *= 2;
                } while (o3 > 1);
              }(i3);
            }(t2, n2, i2, a2);
            for (var s2, u2, l2 = t2; t2.prev !== t2.next; )
              if (s2 = t2.prev, u2 = t2.next, a2 ? To(t2, n2, i2, a2) : Bo(t2))
                e2.push(s2.i / r2), e2.push(t2.i / r2), e2.push(u2.i / r2), $o(t2), t2 = u2.next, l2 = u2.next;
              else if ((t2 = u2) === l2) {
                o2 ? o2 === 1 ? Mo(t2 = Vo(Po(t2), e2, r2), e2, r2, n2, i2, a2, 2) : o2 === 2 && Fo(t2, e2, r2, n2, i2, a2) : Mo(Po(t2), e2, r2, n2, i2, a2, 1);
                break;
              }
          }
        }
        function Bo(t2) {
          var e2 = t2.prev, r2 = t2, n2 = t2.next;
          if (No(e2, r2, n2) >= 0)
            return false;
          for (var i2 = t2.next.next; i2 !== t2.prev; ) {
            if (jo(e2.x, e2.y, r2.x, r2.y, n2.x, n2.y, i2.x, i2.y) && No(i2.prev, i2, i2.next) >= 0)
              return false;
            i2 = i2.next;
          }
          return true;
        }
        function To(t2, e2, r2, n2) {
          var i2 = t2.prev, a2 = t2, o2 = t2.next;
          if (No(i2, a2, o2) >= 0)
            return false;
          for (var s2 = i2.x > a2.x ? i2.x > o2.x ? i2.x : o2.x : a2.x > o2.x ? a2.x : o2.x, u2 = i2.y > a2.y ? i2.y > o2.y ? i2.y : o2.y : a2.y > o2.y ? a2.y : o2.y, l2 = Ro(i2.x < a2.x ? i2.x < o2.x ? i2.x : o2.x : a2.x < o2.x ? a2.x : o2.x, i2.y < a2.y ? i2.y < o2.y ? i2.y : o2.y : a2.y < o2.y ? a2.y : o2.y, e2, r2, n2), p2 = Ro(s2, u2, e2, r2, n2), c2 = t2.prevZ, h2 = t2.nextZ; c2 && c2.z >= l2 && h2 && h2.z <= p2; ) {
            if (c2 !== t2.prev && c2 !== t2.next && jo(i2.x, i2.y, a2.x, a2.y, o2.x, o2.y, c2.x, c2.y) && No(c2.prev, c2, c2.next) >= 0)
              return false;
            if (c2 = c2.prevZ, h2 !== t2.prev && h2 !== t2.next && jo(i2.x, i2.y, a2.x, a2.y, o2.x, o2.y, h2.x, h2.y) && No(h2.prev, h2, h2.next) >= 0)
              return false;
            h2 = h2.nextZ;
          }
          for (; c2 && c2.z >= l2; ) {
            if (c2 !== t2.prev && c2 !== t2.next && jo(i2.x, i2.y, a2.x, a2.y, o2.x, o2.y, c2.x, c2.y) && No(c2.prev, c2, c2.next) >= 0)
              return false;
            c2 = c2.prevZ;
          }
          for (; h2 && h2.z <= p2; ) {
            if (h2 !== t2.prev && h2 !== t2.next && jo(i2.x, i2.y, a2.x, a2.y, o2.x, o2.y, h2.x, h2.y) && No(h2.prev, h2, h2.next) >= 0)
              return false;
            h2 = h2.nextZ;
          }
          return true;
        }
        function Vo(t2, e2, r2) {
          var n2 = t2;
          do {
            var i2 = n2.prev, a2 = n2.next.next;
            !Ko(i2, a2) && Go(i2, n2, n2.next, a2) && Jo(i2, a2) && Jo(a2, i2) && (e2.push(i2.i / r2), e2.push(n2.i / r2), e2.push(a2.i / r2), $o(n2), $o(n2.next), n2 = t2 = a2), n2 = n2.next;
          } while (n2 !== t2);
          return Po(n2);
        }
        function Fo(t2, e2, r2, n2, i2, a2) {
          var o2 = t2;
          do {
            for (var s2 = o2.next.next; s2 !== o2.prev; ) {
              if (o2.i !== s2.i && qo(o2, s2)) {
                var u2 = Ho(o2, s2);
                return o2 = Po(o2, o2.next), u2 = Po(u2, u2.next), Mo(o2, e2, r2, n2, i2, a2), void Mo(u2, e2, r2, n2, i2, a2);
              }
              s2 = s2.next;
            }
            o2 = o2.next;
          } while (o2 !== t2);
        }
        function Do(t2, e2) {
          return t2.x - e2.x;
        }
        function Lo(t2, e2) {
          if (e2 = function(t3, e3) {
            var r3, n2 = e3, i2 = t3.x, a2 = t3.y, o2 = -1 / 0;
            do {
              if (a2 <= n2.y && a2 >= n2.next.y && n2.next.y !== n2.y) {
                var s2 = n2.x + (a2 - n2.y) * (n2.next.x - n2.x) / (n2.next.y - n2.y);
                if (s2 <= i2 && s2 > o2) {
                  if (o2 = s2, s2 === i2) {
                    if (a2 === n2.y)
                      return n2;
                    if (a2 === n2.next.y)
                      return n2.next;
                  }
                  r3 = n2.x < n2.next.x ? n2 : n2.next;
                }
              }
              n2 = n2.next;
            } while (n2 !== e3);
            if (!r3)
              return null;
            if (i2 === o2)
              return r3;
            var u2, l2 = r3, p2 = r3.x, c2 = r3.y, h2 = 1 / 0;
            n2 = r3;
            do {
              i2 >= n2.x && n2.x >= p2 && i2 !== n2.x && jo(a2 < c2 ? i2 : o2, a2, p2, c2, a2 < c2 ? o2 : i2, a2, n2.x, n2.y) && (u2 = Math.abs(a2 - n2.y) / (i2 - n2.x), Jo(n2, t3) && (u2 < h2 || u2 === h2 && (n2.x > r3.x || n2.x === r3.x && Oo(r3, n2))) && (r3 = n2, h2 = u2)), n2 = n2.next;
            } while (n2 !== l2);
            return r3;
          }(t2, e2)) {
            var r2 = Ho(e2, t2);
            Po(e2, e2.next), Po(r2, r2.next);
          }
        }
        function Oo(t2, e2) {
          return No(t2.prev, t2, e2.prev) < 0 && No(e2.next, t2, t2.next) < 0;
        }
        function Ro(t2, e2, r2, n2, i2) {
          return (t2 = 1431655765 & ((t2 = 858993459 & ((t2 = 252645135 & ((t2 = 16711935 & ((t2 = 32767 * (t2 - r2) * i2) | t2 << 8)) | t2 << 4)) | t2 << 2)) | t2 << 1)) | (e2 = 1431655765 & ((e2 = 858993459 & ((e2 = 252645135 & ((e2 = 16711935 & ((e2 = 32767 * (e2 - n2) * i2) | e2 << 8)) | e2 << 4)) | e2 << 2)) | e2 << 1)) << 1;
        }
        function Uo(t2) {
          var e2 = t2, r2 = t2;
          do {
            (e2.x < r2.x || e2.x === r2.x && e2.y < r2.y) && (r2 = e2), e2 = e2.next;
          } while (e2 !== t2);
          return r2;
        }
        function jo(t2, e2, r2, n2, i2, a2, o2, s2) {
          return (i2 - o2) * (e2 - s2) - (t2 - o2) * (a2 - s2) >= 0 && (t2 - o2) * (n2 - s2) - (r2 - o2) * (e2 - s2) >= 0 && (r2 - o2) * (a2 - s2) - (i2 - o2) * (n2 - s2) >= 0;
        }
        function qo(t2, e2) {
          return t2.next.i !== e2.i && t2.prev.i !== e2.i && !function(t3, e3) {
            var r2 = t3;
            do {
              if (r2.i !== t3.i && r2.next.i !== t3.i && r2.i !== e3.i && r2.next.i !== e3.i && Go(r2, r2.next, t3, e3))
                return true;
              r2 = r2.next;
            } while (r2 !== t3);
            return false;
          }(t2, e2) && (Jo(t2, e2) && Jo(e2, t2) && function(t3, e3) {
            var r2 = t3, n2 = false, i2 = (t3.x + e3.x) / 2, a2 = (t3.y + e3.y) / 2;
            do {
              r2.y > a2 != r2.next.y > a2 && r2.next.y !== r2.y && i2 < (r2.next.x - r2.x) * (a2 - r2.y) / (r2.next.y - r2.y) + r2.x && (n2 = !n2), r2 = r2.next;
            } while (r2 !== t3);
            return n2;
          }(t2, e2) && (No(t2.prev, t2, e2.prev) || No(t2, e2.prev, e2)) || Ko(t2, e2) && No(t2.prev, t2, t2.next) > 0 && No(e2.prev, e2, e2.next) > 0);
        }
        function No(t2, e2, r2) {
          return (e2.y - t2.y) * (r2.x - e2.x) - (e2.x - t2.x) * (r2.y - e2.y);
        }
        function Ko(t2, e2) {
          return t2.x === e2.x && t2.y === e2.y;
        }
        function Go(t2, e2, r2, n2) {
          var i2 = Xo(No(t2, e2, r2)), a2 = Xo(No(t2, e2, n2)), o2 = Xo(No(r2, n2, t2)), s2 = Xo(No(r2, n2, e2));
          return i2 !== a2 && o2 !== s2 || !(i2 !== 0 || !Zo(t2, r2, e2)) || !(a2 !== 0 || !Zo(t2, n2, e2)) || !(o2 !== 0 || !Zo(r2, t2, n2)) || !(s2 !== 0 || !Zo(r2, e2, n2));
        }
        function Zo(t2, e2, r2) {
          return e2.x <= Math.max(t2.x, r2.x) && e2.x >= Math.min(t2.x, r2.x) && e2.y <= Math.max(t2.y, r2.y) && e2.y >= Math.min(t2.y, r2.y);
        }
        function Xo(t2) {
          return t2 > 0 ? 1 : t2 < 0 ? -1 : 0;
        }
        function Jo(t2, e2) {
          return No(t2.prev, t2, t2.next) < 0 ? No(t2, e2, t2.next) >= 0 && No(t2, t2.prev, e2) >= 0 : No(t2, e2, t2.prev) < 0 || No(t2, t2.next, e2) < 0;
        }
        function Ho(t2, e2) {
          var r2 = new Wo(t2.i, t2.x, t2.y), n2 = new Wo(e2.i, e2.x, e2.y), i2 = t2.next, a2 = e2.prev;
          return t2.next = e2, e2.prev = t2, r2.next = i2, i2.prev = r2, n2.next = r2, r2.prev = n2, a2.next = n2, n2.prev = a2, n2;
        }
        function Yo(t2, e2, r2, n2) {
          var i2 = new Wo(t2, e2, r2);
          return n2 ? (i2.next = n2.next, i2.prev = n2, n2.next.prev = i2, n2.next = i2) : (i2.prev = i2, i2.next = i2), i2;
        }
        function $o(t2) {
          t2.next.prev = t2.prev, t2.prev.next = t2.next, t2.prevZ && (t2.prevZ.nextZ = t2.nextZ), t2.nextZ && (t2.nextZ.prevZ = t2.prevZ);
        }
        function Wo(t2, e2, r2) {
          this.i = t2, this.x = e2, this.y = r2, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = false;
        }
        function Qo(t2, e2, r2, n2) {
          for (var i2 = 0, a2 = e2, o2 = r2 - n2; a2 < r2; a2 += n2)
            i2 += (t2[o2] - t2[a2]) * (t2[a2 + 1] + t2[o2 + 1]), o2 = a2;
          return i2;
        }
        function ts(t2, e2, r2, n2, i2) {
          !function t3(e3, r3, n3, i3, a2) {
            for (; i3 > n3; ) {
              if (i3 - n3 > 600) {
                var o2 = i3 - n3 + 1, s2 = r3 - n3 + 1, u2 = Math.log(o2), l2 = 0.5 * Math.exp(2 * u2 / 3), p2 = 0.5 * Math.sqrt(u2 * l2 * (o2 - l2) / o2) * (s2 - o2 / 2 < 0 ? -1 : 1);
                t3(e3, r3, Math.max(n3, Math.floor(r3 - s2 * l2 / o2 + p2)), Math.min(i3, Math.floor(r3 + (o2 - s2) * l2 / o2 + p2)), a2);
              }
              var c2 = e3[r3], h2 = n3, f2 = i3;
              for (es(e3, n3, r3), a2(e3[i3], c2) > 0 && es(e3, n3, i3); h2 < f2; ) {
                for (es(e3, h2, f2), h2++, f2--; a2(e3[h2], c2) < 0; )
                  h2++;
                for (; a2(e3[f2], c2) > 0; )
                  f2--;
              }
              a2(e3[n3], c2) === 0 ? es(e3, n3, f2) : es(e3, ++f2, i3), f2 <= r3 && (n3 = f2 + 1), r3 <= f2 && (i3 = f2 - 1);
            }
          }(t2, e2, r2 || 0, n2 || t2.length - 1, i2 || rs);
        }
        function es(t2, e2, r2) {
          var n2 = t2[e2];
          t2[e2] = t2[r2], t2[r2] = n2;
        }
        function rs(t2, e2) {
          return t2 < e2 ? -1 : t2 > e2 ? 1 : 0;
        }
        function ns(t2, e2) {
          var r2 = t2.length;
          if (r2 <= 1)
            return [t2];
          for (var n2, i2, a2 = [], o2 = 0; o2 < r2; o2++) {
            var s2 = k(t2[o2]);
            s2 !== 0 && (t2[o2].area = Math.abs(s2), i2 === void 0 && (i2 = s2 < 0), i2 === s2 < 0 ? (n2 && a2.push(n2), n2 = [t2[o2]]) : n2.push(t2[o2]));
          }
          if (n2 && a2.push(n2), e2 > 1)
            for (var u2 = 0; u2 < a2.length; u2++)
              a2[u2].length <= e2 || (ts(a2[u2], e2, 1, a2[u2].length - 1, is), a2[u2] = a2[u2].slice(0, e2));
          return a2;
        }
        function is(t2, e2) {
          return e2.area - t2.area;
        }
        function as(t2, e2, r2) {
          for (var n2 = r2.patternDependencies, i2 = false, a2 = 0, o2 = e2; a2 < o2.length; a2 += 1) {
            var s2 = o2[a2].paint.get(t2 + "-pattern");
            s2.isConstant() || (i2 = true);
            var u2 = s2.constantOr(null);
            u2 && (i2 = true, n2[u2.to] = true, n2[u2.from] = true);
          }
          return i2;
        }
        function os(t2, e2, r2, n2, i2) {
          for (var a2 = i2.patternDependencies, o2 = 0, s2 = e2; o2 < s2.length; o2 += 1) {
            var u2 = s2[o2], l2 = u2.paint.get(t2 + "-pattern").value;
            if (l2.kind !== "constant") {
              var p2 = l2.evaluate({zoom: n2 - 1}, r2, {}, i2.availableImages), c2 = l2.evaluate({zoom: n2}, r2, {}, i2.availableImages), h2 = l2.evaluate({zoom: n2 + 1}, r2, {}, i2.availableImages);
              c2 = c2 && c2.name ? c2.name : c2, h2 = h2 && h2.name ? h2.name : h2, a2[p2 = p2 && p2.name ? p2.name : p2] = true, a2[c2] = true, a2[h2] = true, r2.patterns[u2.id] = {min: p2, mid: c2, max: h2};
            }
          }
          return r2;
        }
        Co.deviation = function(t2, e2, r2, n2) {
          var i2 = e2 && e2.length, a2 = Math.abs(Qo(t2, 0, i2 ? e2[0] * r2 : t2.length, r2));
          if (i2)
            for (var o2 = 0, s2 = e2.length; o2 < s2; o2++)
              a2 -= Math.abs(Qo(t2, e2[o2] * r2, o2 < s2 - 1 ? e2[o2 + 1] * r2 : t2.length, r2));
          var u2 = 0;
          for (o2 = 0; o2 < n2.length; o2 += 3) {
            var l2 = n2[o2] * r2, p2 = n2[o2 + 1] * r2, c2 = n2[o2 + 2] * r2;
            u2 += Math.abs((t2[l2] - t2[c2]) * (t2[p2 + 1] - t2[l2 + 1]) - (t2[l2] - t2[p2]) * (t2[c2 + 1] - t2[l2 + 1]));
          }
          return a2 === 0 && u2 === 0 ? 0 : Math.abs((u2 - a2) / a2);
        }, Co.flatten = function(t2) {
          for (var e2 = t2[0][0].length, r2 = {vertices: [], holes: [], dimensions: e2}, n2 = 0, i2 = 0; i2 < t2.length; i2++) {
            for (var a2 = 0; a2 < t2[i2].length; a2++)
              for (var o2 = 0; o2 < e2; o2++)
                r2.vertices.push(t2[i2][a2][o2]);
            i2 > 0 && r2.holes.push(n2 += t2[i2 - 1].length);
          }
          return r2;
        }, Io.default = zo;
        var ss = function(t2) {
          this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map(function(t3) {
            return t3.id;
          }), this.index = t2.index, this.hasPattern = false, this.patternFeatures = [], this.layoutVertexArray = new Ci(), this.indexArray = new ji(), this.indexArray2 = new Xi(), this.programConfigurations = new Va(t2.layers, t2.zoom), this.segments = new sa(), this.segments2 = new sa(), this.stateDependentLayerIds = this.layers.filter(function(t3) {
            return t3.isStateDependent();
          }).map(function(t3) {
            return t3.id;
          });
        };
        ss.prototype.populate = function(t2, e2, r2) {
          this.hasPattern = as("fill", this.layers, e2);
          for (var n2 = this.layers[0].layout.get("fill-sort-key"), i2 = [], a2 = 0, o2 = t2; a2 < o2.length; a2 += 1) {
            var s2 = o2[a2], u2 = s2.feature, l2 = s2.id, p2 = s2.index, c2 = s2.sourceLayerIndex, h2 = this.layers[0]._featureFilter.needGeometry, f2 = Ua(u2, h2);
            if (this.layers[0]._featureFilter.filter(new si(this.zoom), f2, r2)) {
              var y2 = n2 ? n2.evaluate(f2, {}, r2, e2.availableImages) : void 0, d2 = {id: l2, properties: u2.properties, type: u2.type, sourceLayerIndex: c2, index: p2, geometry: h2 ? f2.geometry : Ra(u2), patterns: {}, sortKey: y2};
              i2.push(d2);
            }
          }
          n2 && i2.sort(function(t3, e3) {
            return t3.sortKey - e3.sortKey;
          });
          for (var m2 = 0, v2 = i2; m2 < v2.length; m2 += 1) {
            var g2 = v2[m2], x2 = g2.geometry, b2 = g2.index, w2 = g2.sourceLayerIndex;
            if (this.hasPattern) {
              var _2 = os("fill", this.layers, g2, this.zoom, e2);
              this.patternFeatures.push(_2);
            } else
              this.addFeature(g2, x2, b2, r2, {});
            e2.featureIndex.insert(t2[b2].feature, x2, b2, w2, this.index);
          }
        }, ss.prototype.update = function(t2, e2, r2) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
        }, ss.prototype.addFeatures = function(t2, e2, r2) {
          for (var n2 = 0, i2 = this.patternFeatures; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            this.addFeature(a2, a2.geometry, a2.index, e2, r2);
          }
        }, ss.prototype.isEmpty = function() {
          return this.layoutVertexArray.length === 0;
        }, ss.prototype.uploadPending = function() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }, ss.prototype.upload = function(t2) {
          this.uploaded || (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, ko), this.indexBuffer = t2.createIndexBuffer(this.indexArray), this.indexBuffer2 = t2.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t2), this.uploaded = true;
        }, ss.prototype.destroy = function() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy());
        }, ss.prototype.addFeature = function(t2, e2, r2, n2, i2) {
          for (var a2 = 0, o2 = ns(e2, 500); a2 < o2.length; a2 += 1) {
            for (var s2 = o2[a2], u2 = 0, l2 = 0, p2 = s2; l2 < p2.length; l2 += 1)
              u2 += p2[l2].length;
            for (var c2 = this.segments.prepareSegment(u2, this.layoutVertexArray, this.indexArray), h2 = c2.vertexLength, f2 = [], y2 = [], d2 = 0, m2 = s2; d2 < m2.length; d2 += 1) {
              var v2 = m2[d2];
              if (v2.length !== 0) {
                v2 !== s2[0] && y2.push(f2.length / 2);
                var g2 = this.segments2.prepareSegment(v2.length, this.layoutVertexArray, this.indexArray2), x2 = g2.vertexLength;
                this.layoutVertexArray.emplaceBack(v2[0].x, v2[0].y), this.indexArray2.emplaceBack(x2 + v2.length - 1, x2), f2.push(v2[0].x), f2.push(v2[0].y);
                for (var b2 = 1; b2 < v2.length; b2++)
                  this.layoutVertexArray.emplaceBack(v2[b2].x, v2[b2].y), this.indexArray2.emplaceBack(x2 + b2 - 1, x2 + b2), f2.push(v2[b2].x), f2.push(v2[b2].y);
                g2.vertexLength += v2.length, g2.primitiveLength += v2.length;
              }
            }
            for (var w2 = Io(f2, y2), _2 = 0; _2 < w2.length; _2 += 3)
              this.indexArray.emplaceBack(h2 + w2[_2], h2 + w2[_2 + 1], h2 + w2[_2 + 2]);
            c2.vertexLength += u2, c2.primitiveLength += w2.length / 3;
          }
          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, i2, n2);
        }, On("FillBucket", ss, {omit: ["layers", "patternFeatures"]});
        var us = new wi({"fill-sort-key": new vi(Et.layout_fill["fill-sort-key"])}), ls = {paint: new wi({"fill-antialias": new mi(Et.paint_fill["fill-antialias"]), "fill-opacity": new vi(Et.paint_fill["fill-opacity"]), "fill-color": new vi(Et.paint_fill["fill-color"]), "fill-outline-color": new vi(Et.paint_fill["fill-outline-color"]), "fill-translate": new mi(Et.paint_fill["fill-translate"]), "fill-translate-anchor": new mi(Et.paint_fill["fill-translate-anchor"]), "fill-pattern": new gi(Et.paint_fill["fill-pattern"])}), layout: us}, ps = function(t2) {
          function e2(e3) {
            t2.call(this, e3, ls);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.recalculate = function(e3, r2) {
            t2.prototype.recalculate.call(this, e3, r2);
            var n2 = this.paint._values["fill-outline-color"];
            n2.value.kind === "constant" && n2.value.value === void 0 && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"]);
          }, e2.prototype.createBucket = function(t3) {
            return new ss(t3);
          }, e2.prototype.queryRadius = function() {
            return eo(this.paint.get("fill-translate"));
          }, e2.prototype.queryIntersectsFeature = function(t3, e3, r2, n2, i2, a2, o2) {
            return Ga(ro(t3, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), a2.angle, o2), n2);
          }, e2.prototype.isTileClipped = function() {
            return true;
          }, e2;
        }(_i), cs = Ii([{name: "a_pos", components: 2, type: "Int16"}, {name: "a_normal_ed", components: 4, type: "Int16"}], 4).members, hs = fs;
        function fs(t2, e2, r2, n2, i2) {
          this.properties = {}, this.extent = r2, this.type = 0, this._pbf = t2, this._geometry = -1, this._keys = n2, this._values = i2, t2.readFields(ys, this, e2);
        }
        function ys(t2, e2, r2) {
          t2 == 1 ? e2.id = r2.readVarint() : t2 == 2 ? function(t3, e3) {
            for (var r3 = t3.readVarint() + t3.pos; t3.pos < r3; ) {
              var n2 = e3._keys[t3.readVarint()], i2 = e3._values[t3.readVarint()];
              e3.properties[n2] = i2;
            }
          }(r2, e2) : t2 == 3 ? e2.type = r2.readVarint() : t2 == 4 && (e2._geometry = r2.pos);
        }
        function ds(t2) {
          for (var e2, r2, n2 = 0, i2 = 0, a2 = t2.length, o2 = a2 - 1; i2 < a2; o2 = i2++)
            n2 += ((r2 = t2[o2]).x - (e2 = t2[i2]).x) * (e2.y + r2.y);
          return n2;
        }
        fs.types = ["Unknown", "Point", "LineString", "Polygon"], fs.prototype.loadGeometry = function() {
          var t2 = this._pbf;
          t2.pos = this._geometry;
          for (var e2, r2 = t2.readVarint() + t2.pos, n2 = 1, a2 = 0, o2 = 0, s2 = 0, u2 = []; t2.pos < r2; ) {
            if (a2 <= 0) {
              var l2 = t2.readVarint();
              n2 = 7 & l2, a2 = l2 >> 3;
            }
            if (a2--, n2 === 1 || n2 === 2)
              o2 += t2.readSVarint(), s2 += t2.readSVarint(), n2 === 1 && (e2 && u2.push(e2), e2 = []), e2.push(new i(o2, s2));
            else {
              if (n2 !== 7)
                throw new Error("unknown command " + n2);
              e2 && e2.push(e2[0].clone());
            }
          }
          return e2 && u2.push(e2), u2;
        }, fs.prototype.bbox = function() {
          var t2 = this._pbf;
          t2.pos = this._geometry;
          for (var e2 = t2.readVarint() + t2.pos, r2 = 1, n2 = 0, i2 = 0, a2 = 0, o2 = 1 / 0, s2 = -1 / 0, u2 = 1 / 0, l2 = -1 / 0; t2.pos < e2; ) {
            if (n2 <= 0) {
              var p2 = t2.readVarint();
              r2 = 7 & p2, n2 = p2 >> 3;
            }
            if (n2--, r2 === 1 || r2 === 2)
              (i2 += t2.readSVarint()) < o2 && (o2 = i2), i2 > s2 && (s2 = i2), (a2 += t2.readSVarint()) < u2 && (u2 = a2), a2 > l2 && (l2 = a2);
            else if (r2 !== 7)
              throw new Error("unknown command " + r2);
          }
          return [o2, u2, s2, l2];
        }, fs.prototype.toGeoJSON = function(t2, e2, r2) {
          var n2, i2, a2 = this.extent * Math.pow(2, r2), o2 = this.extent * t2, s2 = this.extent * e2, u2 = this.loadGeometry(), l2 = fs.types[this.type];
          function p2(t3) {
            for (var e3 = 0; e3 < t3.length; e3++) {
              var r3 = t3[e3];
              t3[e3] = [360 * (r3.x + o2) / a2 - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (r3.y + s2) / a2) * Math.PI / 180)) - 90];
            }
          }
          switch (this.type) {
            case 1:
              var c2 = [];
              for (n2 = 0; n2 < u2.length; n2++)
                c2[n2] = u2[n2][0];
              p2(u2 = c2);
              break;
            case 2:
              for (n2 = 0; n2 < u2.length; n2++)
                p2(u2[n2]);
              break;
            case 3:
              for (u2 = function(t3) {
                var e3 = t3.length;
                if (e3 <= 1)
                  return [t3];
                for (var r3, n3, i3 = [], a3 = 0; a3 < e3; a3++) {
                  var o3 = ds(t3[a3]);
                  o3 !== 0 && (n3 === void 0 && (n3 = o3 < 0), n3 === o3 < 0 ? (r3 && i3.push(r3), r3 = [t3[a3]]) : r3.push(t3[a3]));
                }
                return r3 && i3.push(r3), i3;
              }(u2), n2 = 0; n2 < u2.length; n2++)
                for (i2 = 0; i2 < u2[n2].length; i2++)
                  p2(u2[n2][i2]);
          }
          u2.length === 1 ? u2 = u2[0] : l2 = "Multi" + l2;
          var h2 = {type: "Feature", geometry: {type: l2, coordinates: u2}, properties: this.properties};
          return "id" in this && (h2.id = this.id), h2;
        };
        var ms = vs;
        function vs(t2, e2) {
          this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t2, this._keys = [], this._values = [], this._features = [], t2.readFields(gs, this, e2), this.length = this._features.length;
        }
        function gs(t2, e2, r2) {
          t2 === 15 ? e2.version = r2.readVarint() : t2 === 1 ? e2.name = r2.readString() : t2 === 5 ? e2.extent = r2.readVarint() : t2 === 2 ? e2._features.push(r2.pos) : t2 === 3 ? e2._keys.push(r2.readString()) : t2 === 4 && e2._values.push(function(t3) {
            for (var e3 = null, r3 = t3.readVarint() + t3.pos; t3.pos < r3; ) {
              var n2 = t3.readVarint() >> 3;
              e3 = n2 === 1 ? t3.readString() : n2 === 2 ? t3.readFloat() : n2 === 3 ? t3.readDouble() : n2 === 4 ? t3.readVarint64() : n2 === 5 ? t3.readVarint() : n2 === 6 ? t3.readSVarint() : n2 === 7 ? t3.readBoolean() : null;
            }
            return e3;
          }(r2));
        }
        function xs(t2, e2, r2) {
          if (t2 === 3) {
            var n2 = new ms(r2, r2.readVarint() + r2.pos);
            n2.length && (e2[n2.name] = n2);
          }
        }
        vs.prototype.feature = function(t2) {
          if (t2 < 0 || t2 >= this._features.length)
            throw new Error("feature index out of bounds");
          this._pbf.pos = this._features[t2];
          var e2 = this._pbf.readVarint() + this._pbf.pos;
          return new hs(this._pbf, e2, this.extent, this._keys, this._values);
        };
        var bs = {VectorTile: function(t2, e2) {
          this.layers = t2.readFields(xs, {}, e2);
        }, VectorTileFeature: hs, VectorTileLayer: ms}, ws = bs.VectorTileFeature.types, _s = Math.pow(2, 13);
        function As(t2, e2, r2, n2, i2, a2, o2, s2) {
          t2.emplaceBack(e2, r2, 2 * Math.floor(n2 * _s) + o2, i2 * _s * 2, a2 * _s * 2, Math.round(s2));
        }
        var Ss = function(t2) {
          this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map(function(t3) {
            return t3.id;
          }), this.index = t2.index, this.hasPattern = false, this.layoutVertexArray = new Pi(), this.indexArray = new ji(), this.programConfigurations = new Va(t2.layers, t2.zoom), this.segments = new sa(), this.stateDependentLayerIds = this.layers.filter(function(t3) {
            return t3.isStateDependent();
          }).map(function(t3) {
            return t3.id;
          });
        };
        function ks(t2, e2) {
          return t2.x === e2.x && (t2.x < 0 || t2.x > 8192) || t2.y === e2.y && (t2.y < 0 || t2.y > 8192);
        }
        Ss.prototype.populate = function(t2, e2, r2) {
          this.features = [], this.hasPattern = as("fill-extrusion", this.layers, e2);
          for (var n2 = 0, i2 = t2; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2], o2 = a2.feature, s2 = a2.id, u2 = a2.index, l2 = a2.sourceLayerIndex, p2 = this.layers[0]._featureFilter.needGeometry, c2 = Ua(o2, p2);
            if (this.layers[0]._featureFilter.filter(new si(this.zoom), c2, r2)) {
              var h2 = {id: s2, sourceLayerIndex: l2, index: u2, geometry: p2 ? c2.geometry : Ra(o2), properties: o2.properties, type: o2.type, patterns: {}};
              this.hasPattern ? this.features.push(os("fill-extrusion", this.layers, h2, this.zoom, e2)) : this.addFeature(h2, h2.geometry, u2, r2, {}), e2.featureIndex.insert(o2, h2.geometry, u2, l2, this.index, true);
            }
          }
        }, Ss.prototype.addFeatures = function(t2, e2, r2) {
          for (var n2 = 0, i2 = this.features; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            this.addFeature(a2, a2.geometry, a2.index, e2, r2);
          }
        }, Ss.prototype.update = function(t2, e2, r2) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
        }, Ss.prototype.isEmpty = function() {
          return this.layoutVertexArray.length === 0;
        }, Ss.prototype.uploadPending = function() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }, Ss.prototype.upload = function(t2) {
          this.uploaded || (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, cs), this.indexBuffer = t2.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t2), this.uploaded = true;
        }, Ss.prototype.destroy = function() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, Ss.prototype.addFeature = function(t2, e2, r2, n2, i2) {
          for (var a2 = 0, o2 = ns(e2, 500); a2 < o2.length; a2 += 1) {
            for (var s2 = o2[a2], u2 = 0, l2 = 0, p2 = s2; l2 < p2.length; l2 += 1)
              u2 += p2[l2].length;
            for (var c2 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray), h2 = 0, f2 = s2; h2 < f2.length; h2 += 1) {
              var y2 = f2[h2];
              if (y2.length !== 0 && !((B2 = y2).every(function(t3) {
                return t3.x < 0;
              }) || B2.every(function(t3) {
                return t3.x > 8192;
              }) || B2.every(function(t3) {
                return t3.y < 0;
              }) || B2.every(function(t3) {
                return t3.y > 8192;
              })))
                for (var d2 = 0, m2 = 0; m2 < y2.length; m2++) {
                  var v2 = y2[m2];
                  if (m2 >= 1) {
                    var g2 = y2[m2 - 1];
                    if (!ks(v2, g2)) {
                      c2.vertexLength + 4 > sa.MAX_VERTEX_ARRAY_LENGTH && (c2 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));
                      var x2 = v2.sub(g2)._perp()._unit(), b2 = g2.dist(v2);
                      d2 + b2 > 32768 && (d2 = 0), As(this.layoutVertexArray, v2.x, v2.y, x2.x, x2.y, 0, 0, d2), As(this.layoutVertexArray, v2.x, v2.y, x2.x, x2.y, 0, 1, d2), As(this.layoutVertexArray, g2.x, g2.y, x2.x, x2.y, 0, 0, d2 += b2), As(this.layoutVertexArray, g2.x, g2.y, x2.x, x2.y, 0, 1, d2);
                      var w2 = c2.vertexLength;
                      this.indexArray.emplaceBack(w2, w2 + 2, w2 + 1), this.indexArray.emplaceBack(w2 + 1, w2 + 2, w2 + 3), c2.vertexLength += 4, c2.primitiveLength += 2;
                    }
                  }
                }
            }
            if (c2.vertexLength + u2 > sa.MAX_VERTEX_ARRAY_LENGTH && (c2 = this.segments.prepareSegment(u2, this.layoutVertexArray, this.indexArray)), ws[t2.type] === "Polygon") {
              for (var _2 = [], A2 = [], S2 = c2.vertexLength, k2 = 0, I2 = s2; k2 < I2.length; k2 += 1) {
                var z2 = I2[k2];
                if (z2.length !== 0) {
                  z2 !== s2[0] && A2.push(_2.length / 2);
                  for (var C2 = 0; C2 < z2.length; C2++) {
                    var E2 = z2[C2];
                    As(this.layoutVertexArray, E2.x, E2.y, 0, 0, 1, 1, 0), _2.push(E2.x), _2.push(E2.y);
                  }
                }
              }
              for (var P2 = Io(_2, A2), M2 = 0; M2 < P2.length; M2 += 3)
                this.indexArray.emplaceBack(S2 + P2[M2], S2 + P2[M2 + 2], S2 + P2[M2 + 1]);
              c2.primitiveLength += P2.length / 3, c2.vertexLength += u2;
            }
          }
          var B2;
          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, i2, n2);
        }, On("FillExtrusionBucket", Ss, {omit: ["layers", "features"]});
        var Is = {paint: new wi({"fill-extrusion-opacity": new mi(Et["paint_fill-extrusion"]["fill-extrusion-opacity"]), "fill-extrusion-color": new vi(Et["paint_fill-extrusion"]["fill-extrusion-color"]), "fill-extrusion-translate": new mi(Et["paint_fill-extrusion"]["fill-extrusion-translate"]), "fill-extrusion-translate-anchor": new mi(Et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]), "fill-extrusion-pattern": new gi(Et["paint_fill-extrusion"]["fill-extrusion-pattern"]), "fill-extrusion-height": new vi(Et["paint_fill-extrusion"]["fill-extrusion-height"]), "fill-extrusion-base": new vi(Et["paint_fill-extrusion"]["fill-extrusion-base"]), "fill-extrusion-vertical-gradient": new mi(Et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}, zs = function(t2) {
          function e2(e3) {
            t2.call(this, e3, Is);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.createBucket = function(t3) {
            return new Ss(t3);
          }, e2.prototype.queryRadius = function() {
            return eo(this.paint.get("fill-extrusion-translate"));
          }, e2.prototype.is3D = function() {
            return true;
          }, e2.prototype.queryIntersectsFeature = function(t3, e3, r2, n2, a2, o2, s2, u2) {
            var l2 = ro(t3, this.paint.get("fill-extrusion-translate"), this.paint.get("fill-extrusion-translate-anchor"), o2.angle, s2), p2 = this.paint.get("fill-extrusion-height").evaluate(e3, r2), c2 = this.paint.get("fill-extrusion-base").evaluate(e3, r2), h2 = function(t4, e4, r3, n3) {
              for (var a3 = [], o3 = 0, s3 = t4; o3 < s3.length; o3 += 1) {
                var u3 = s3[o3], l3 = [u3.x, u3.y, 0, 1];
                po(l3, l3, e4), a3.push(new i(l3[0] / l3[3], l3[1] / l3[3]));
              }
              return a3;
            }(l2, u2), f2 = function(t4, e4, r3, n3) {
              for (var a3 = [], o3 = [], s3 = n3[8] * e4, u3 = n3[9] * e4, l3 = n3[10] * e4, p3 = n3[11] * e4, c3 = n3[8] * r3, h3 = n3[9] * r3, f3 = n3[10] * r3, y2 = n3[11] * r3, d2 = 0, m2 = t4; d2 < m2.length; d2 += 1) {
                for (var v2 = [], g2 = [], x2 = 0, b2 = m2[d2]; x2 < b2.length; x2 += 1) {
                  var w2 = b2[x2], _2 = w2.x, A2 = w2.y, S2 = n3[0] * _2 + n3[4] * A2 + n3[12], k2 = n3[1] * _2 + n3[5] * A2 + n3[13], I2 = n3[2] * _2 + n3[6] * A2 + n3[14], z2 = n3[3] * _2 + n3[7] * A2 + n3[15], C2 = I2 + l3, E2 = z2 + p3, P2 = S2 + c3, M2 = k2 + h3, B2 = I2 + f3, T2 = z2 + y2, V2 = new i((S2 + s3) / E2, (k2 + u3) / E2);
                  V2.z = C2 / E2, v2.push(V2);
                  var F2 = new i(P2 / T2, M2 / T2);
                  F2.z = B2 / T2, g2.push(F2);
                }
                a3.push(v2), o3.push(g2);
              }
              return [a3, o3];
            }(n2, c2, p2, u2);
            return function(t4, e4, r3) {
              var n3 = 1 / 0;
              Ga(r3, e4) && (n3 = Es(r3, e4[0]));
              for (var i2 = 0; i2 < e4.length; i2++)
                for (var a3 = e4[i2], o3 = t4[i2], s3 = 0; s3 < a3.length - 1; s3++) {
                  var u3 = a3[s3], l3 = [u3, a3[s3 + 1], o3[s3 + 1], o3[s3], u3];
                  Na(r3, l3) && (n3 = Math.min(n3, Es(r3, l3)));
                }
              return n3 !== 1 / 0 && n3;
            }(f2[0], f2[1], h2);
          }, e2;
        }(_i);
        function Cs(t2, e2) {
          return t2.x * e2.x + t2.y * e2.y;
        }
        function Es(t2, e2) {
          if (t2.length === 1) {
            for (var r2, n2 = 0, i2 = e2[n2++]; !r2 || i2.equals(r2); )
              if (!(r2 = e2[n2++]))
                return 1 / 0;
            for (; n2 < e2.length; n2++) {
              var a2 = e2[n2], o2 = t2[0], s2 = r2.sub(i2), u2 = a2.sub(i2), l2 = o2.sub(i2), p2 = Cs(s2, s2), c2 = Cs(s2, u2), h2 = Cs(u2, u2), f2 = Cs(l2, s2), y2 = Cs(l2, u2), d2 = p2 * h2 - c2 * c2, m2 = (h2 * f2 - c2 * y2) / d2, v2 = (p2 * y2 - c2 * f2) / d2, g2 = i2.z * (1 - m2 - v2) + r2.z * m2 + a2.z * v2;
              if (isFinite(g2))
                return g2;
            }
            return 1 / 0;
          }
          for (var x2 = 1 / 0, b2 = 0, w2 = e2; b2 < w2.length; b2 += 1)
            x2 = Math.min(x2, w2[b2].z);
          return x2;
        }
        var Ps = Ii([{name: "a_pos_normal", components: 2, type: "Int16"}, {name: "a_data", components: 4, type: "Uint8"}], 4).members, Ms = Ii([{name: "a_uv_x", components: 1, type: "Float32"}, {name: "a_split_index", components: 1, type: "Float32"}]).members, Bs = bs.VectorTileFeature.types, Ts = Math.cos(Math.PI / 180 * 37.5), Vs = Math.pow(2, 14) / 0.5, Fs = function(t2) {
          var e2 = this;
          this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map(function(t3) {
            return t3.id;
          }), this.index = t2.index, this.hasPattern = false, this.patternFeatures = [], this.lineClipsArray = [], this.gradients = {}, this.layers.forEach(function(t3) {
            e2.gradients[t3.id] = {};
          }), this.layoutVertexArray = new Mi(), this.layoutVertexArray2 = new Bi(), this.indexArray = new ji(), this.programConfigurations = new Va(t2.layers, t2.zoom), this.segments = new sa(), this.maxLineLength = 0, this.stateDependentLayerIds = this.layers.filter(function(t3) {
            return t3.isStateDependent();
          }).map(function(t3) {
            return t3.id;
          });
        };
        Fs.prototype.populate = function(t2, e2, r2) {
          this.hasPattern = as("line", this.layers, e2);
          for (var n2 = this.layers[0].layout.get("line-sort-key"), i2 = [], a2 = 0, o2 = t2; a2 < o2.length; a2 += 1) {
            var s2 = o2[a2], u2 = s2.feature, l2 = s2.id, p2 = s2.index, c2 = s2.sourceLayerIndex, h2 = this.layers[0]._featureFilter.needGeometry, f2 = Ua(u2, h2);
            if (this.layers[0]._featureFilter.filter(new si(this.zoom), f2, r2)) {
              var y2 = n2 ? n2.evaluate(f2, {}, r2) : void 0, d2 = {id: l2, properties: u2.properties, type: u2.type, sourceLayerIndex: c2, index: p2, geometry: h2 ? f2.geometry : Ra(u2), patterns: {}, sortKey: y2};
              i2.push(d2);
            }
          }
          n2 && i2.sort(function(t3, e3) {
            return t3.sortKey - e3.sortKey;
          });
          for (var m2 = 0, v2 = i2; m2 < v2.length; m2 += 1) {
            var g2 = v2[m2], x2 = g2.geometry, b2 = g2.index, w2 = g2.sourceLayerIndex;
            if (this.hasPattern) {
              var _2 = os("line", this.layers, g2, this.zoom, e2);
              this.patternFeatures.push(_2);
            } else
              this.addFeature(g2, x2, b2, r2, {});
            e2.featureIndex.insert(t2[b2].feature, x2, b2, w2, this.index);
          }
        }, Fs.prototype.update = function(t2, e2, r2) {
          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t2, e2, this.stateDependentLayers, r2);
        }, Fs.prototype.addFeatures = function(t2, e2, r2) {
          for (var n2 = 0, i2 = this.patternFeatures; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            this.addFeature(a2, a2.geometry, a2.index, e2, r2);
          }
        }, Fs.prototype.isEmpty = function() {
          return this.layoutVertexArray.length === 0;
        }, Fs.prototype.uploadPending = function() {
          return !this.uploaded || this.programConfigurations.needsUpload;
        }, Fs.prototype.upload = function(t2) {
          this.uploaded || (this.layoutVertexArray2.length !== 0 && (this.layoutVertexBuffer2 = t2.createVertexBuffer(this.layoutVertexArray2, Ms)), this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, Ps), this.indexBuffer = t2.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t2), this.uploaded = true;
        }, Fs.prototype.destroy = function() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, Fs.prototype.lineFeatureClips = function(t2) {
          if (t2.properties && t2.properties.hasOwnProperty("mapbox_clip_start") && t2.properties.hasOwnProperty("mapbox_clip_end"))
            return {start: +t2.properties.mapbox_clip_start, end: +t2.properties.mapbox_clip_end};
        }, Fs.prototype.addFeature = function(t2, e2, r2, n2, i2) {
          var a2 = this.layers[0].layout, o2 = a2.get("line-join").evaluate(t2, {}), s2 = a2.get("line-cap"), u2 = a2.get("line-miter-limit"), l2 = a2.get("line-round-limit");
          this.lineClips = this.lineFeatureClips(t2);
          for (var p2 = 0, c2 = e2; p2 < c2.length; p2 += 1)
            this.addLine(c2[p2], t2, o2, s2, u2, l2);
          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t2, r2, i2, n2);
        }, Fs.prototype.addLine = function(t2, e2, r2, n2, i2, a2) {
          if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, this.lineClips) {
            this.lineClipsArray.push(this.lineClips);
            for (var o2 = 0; o2 < t2.length - 1; o2++)
              this.totalDistance += t2[o2].dist(t2[o2 + 1]);
            this.updateScaledDistance(), this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance);
          }
          for (var s2 = Bs[e2.type] === "Polygon", u2 = t2.length; u2 >= 2 && t2[u2 - 1].equals(t2[u2 - 2]); )
            u2--;
          for (var l2 = 0; l2 < u2 - 1 && t2[l2].equals(t2[l2 + 1]); )
            l2++;
          if (!(u2 < (s2 ? 3 : 2))) {
            r2 === "bevel" && (i2 = 1.05);
            var p2, c2 = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0, h2 = this.segments.prepareSegment(10 * u2, this.layoutVertexArray, this.indexArray), f2 = void 0, y2 = void 0, d2 = void 0, m2 = void 0;
            this.e1 = this.e2 = -1, s2 && (m2 = t2[l2].sub(p2 = t2[u2 - 2])._unit()._perp());
            for (var v2 = l2; v2 < u2; v2++)
              if (!(y2 = v2 === u2 - 1 ? s2 ? t2[l2 + 1] : void 0 : t2[v2 + 1]) || !t2[v2].equals(y2)) {
                m2 && (d2 = m2), p2 && (f2 = p2), p2 = t2[v2], m2 = y2 ? y2.sub(p2)._unit()._perp() : d2;
                var g2 = (d2 = d2 || m2).add(m2);
                g2.x === 0 && g2.y === 0 || g2._unit();
                var x2 = d2.x * m2.x + d2.y * m2.y, b2 = g2.x * m2.x + g2.y * m2.y, w2 = b2 !== 0 ? 1 / b2 : 1 / 0, _2 = 2 * Math.sqrt(2 - 2 * b2), A2 = b2 < Ts && f2 && y2, S2 = d2.x * m2.y - d2.y * m2.x > 0;
                if (A2 && v2 > l2) {
                  var k2 = p2.dist(f2);
                  if (k2 > 2 * c2) {
                    var I2 = p2.sub(p2.sub(f2)._mult(c2 / k2)._round());
                    this.updateDistance(f2, I2), this.addCurrentVertex(I2, d2, 0, 0, h2), f2 = I2;
                  }
                }
                var z2 = f2 && y2, C2 = z2 ? r2 : s2 ? "butt" : n2;
                if (z2 && C2 === "round" && (w2 < a2 ? C2 = "miter" : w2 <= 2 && (C2 = "fakeround")), C2 === "miter" && w2 > i2 && (C2 = "bevel"), C2 === "bevel" && (w2 > 2 && (C2 = "flipbevel"), w2 < i2 && (C2 = "miter")), f2 && this.updateDistance(f2, p2), C2 === "miter")
                  g2._mult(w2), this.addCurrentVertex(p2, g2, 0, 0, h2);
                else if (C2 === "flipbevel") {
                  if (w2 > 100)
                    g2 = m2.mult(-1);
                  else {
                    var E2 = w2 * d2.add(m2).mag() / d2.sub(m2).mag();
                    g2._perp()._mult(E2 * (S2 ? -1 : 1));
                  }
                  this.addCurrentVertex(p2, g2, 0, 0, h2), this.addCurrentVertex(p2, g2.mult(-1), 0, 0, h2);
                } else if (C2 === "bevel" || C2 === "fakeround") {
                  var P2 = -Math.sqrt(w2 * w2 - 1), M2 = S2 ? P2 : 0, B2 = S2 ? 0 : P2;
                  if (f2 && this.addCurrentVertex(p2, d2, M2, B2, h2), C2 === "fakeround")
                    for (var T2 = Math.round(180 * _2 / Math.PI / 20), V2 = 1; V2 < T2; V2++) {
                      var F2 = V2 / T2;
                      if (F2 !== 0.5) {
                        var D2 = F2 - 0.5;
                        F2 += F2 * D2 * (F2 - 1) * ((1.0904 + x2 * (x2 * (3.55645 - 1.43519 * x2) - 3.2452)) * D2 * D2 + (0.848013 + x2 * (0.215638 * x2 - 1.06021)));
                      }
                      var L2 = m2.sub(d2)._mult(F2)._add(d2)._unit()._mult(S2 ? -1 : 1);
                      this.addHalfVertex(p2, L2.x, L2.y, false, S2, 0, h2);
                    }
                  y2 && this.addCurrentVertex(p2, m2, -M2, -B2, h2);
                } else if (C2 === "butt")
                  this.addCurrentVertex(p2, g2, 0, 0, h2);
                else if (C2 === "square") {
                  var O2 = f2 ? 1 : -1;
                  this.addCurrentVertex(p2, g2, O2, O2, h2);
                } else
                  C2 === "round" && (f2 && (this.addCurrentVertex(p2, d2, 0, 0, h2), this.addCurrentVertex(p2, d2, 1, 1, h2, true)), y2 && (this.addCurrentVertex(p2, m2, -1, -1, h2, true), this.addCurrentVertex(p2, m2, 0, 0, h2)));
                if (A2 && v2 < u2 - 1) {
                  var R2 = p2.dist(y2);
                  if (R2 > 2 * c2) {
                    var U2 = p2.add(y2.sub(p2)._mult(c2 / R2)._round());
                    this.updateDistance(p2, U2), this.addCurrentVertex(U2, m2, 0, 0, h2), p2 = U2;
                  }
                }
              }
          }
        }, Fs.prototype.addCurrentVertex = function(t2, e2, r2, n2, i2, a2) {
          a2 === void 0 && (a2 = false);
          var o2 = e2.y * n2 - e2.x, s2 = -e2.y - e2.x * n2;
          this.addHalfVertex(t2, e2.x + e2.y * r2, e2.y - e2.x * r2, a2, false, r2, i2), this.addHalfVertex(t2, o2, s2, a2, true, -n2, i2), this.distance > Vs / 2 && this.totalDistance === 0 && (this.distance = 0, this.addCurrentVertex(t2, e2, r2, n2, i2, a2));
        }, Fs.prototype.addHalfVertex = function(t2, e2, r2, n2, i2, a2, o2) {
          var s2 = 0.5 * (this.lineClips ? this.scaledDistance * (Vs - 1) : this.scaledDistance);
          this.layoutVertexArray.emplaceBack((t2.x << 1) + (n2 ? 1 : 0), (t2.y << 1) + (i2 ? 1 : 0), Math.round(63 * e2) + 128, Math.round(63 * r2) + 128, 1 + (a2 === 0 ? 0 : a2 < 0 ? -1 : 1) | (63 & s2) << 2, s2 >> 6), this.lineClips && this.layoutVertexArray2.emplaceBack((this.scaledDistance - this.lineClips.start) / (this.lineClips.end - this.lineClips.start), this.lineClipsArray.length);
          var u2 = o2.vertexLength++;
          this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, u2), o2.primitiveLength++), i2 ? this.e2 = u2 : this.e1 = u2;
        }, Fs.prototype.updateScaledDistance = function() {
          this.scaledDistance = this.lineClips ? this.lineClips.start + (this.lineClips.end - this.lineClips.start) * this.distance / this.totalDistance : this.distance;
        }, Fs.prototype.updateDistance = function(t2, e2) {
          this.distance += t2.dist(e2), this.updateScaledDistance();
        }, On("LineBucket", Fs, {omit: ["layers", "patternFeatures"]});
        var Ds = new wi({"line-cap": new mi(Et.layout_line["line-cap"]), "line-join": new vi(Et.layout_line["line-join"]), "line-miter-limit": new mi(Et.layout_line["line-miter-limit"]), "line-round-limit": new mi(Et.layout_line["line-round-limit"]), "line-sort-key": new vi(Et.layout_line["line-sort-key"])}), Ls = {paint: new wi({"line-opacity": new vi(Et.paint_line["line-opacity"]), "line-color": new vi(Et.paint_line["line-color"]), "line-translate": new mi(Et.paint_line["line-translate"]), "line-translate-anchor": new mi(Et.paint_line["line-translate-anchor"]), "line-width": new vi(Et.paint_line["line-width"]), "line-gap-width": new vi(Et.paint_line["line-gap-width"]), "line-offset": new vi(Et.paint_line["line-offset"]), "line-blur": new vi(Et.paint_line["line-blur"]), "line-dasharray": new xi(Et.paint_line["line-dasharray"]), "line-pattern": new gi(Et.paint_line["line-pattern"]), "line-gradient": new bi(Et.paint_line["line-gradient"])}), layout: Ds}, Os = new (function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.possiblyEvaluate = function(e3, r2) {
            return r2 = new si(Math.floor(r2.zoom), {now: r2.now, fadeDuration: r2.fadeDuration, zoomHistory: r2.zoomHistory, transition: r2.transition}), t2.prototype.possiblyEvaluate.call(this, e3, r2);
          }, e2.prototype.evaluate = function(e3, r2, n2, i2) {
            return r2 = h({}, r2, {zoom: Math.floor(r2.zoom)}), t2.prototype.evaluate.call(this, e3, r2, n2, i2);
          }, e2;
        }(vi))(Ls.paint.properties["line-width"].specification);
        Os.useIntegerZoom = true;
        var Rs = function(t2) {
          function e2(e3) {
            t2.call(this, e3, Ls), this.gradientVersion = 0;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._handleSpecialPaintPropertyUpdate = function(t3) {
            t3 === "line-gradient" && (this.stepInterpolant = this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ne, this.gradientVersion = (this.gradientVersion + 1) % s);
          }, e2.prototype.gradientExpression = function() {
            return this._transitionablePaint._values["line-gradient"].value.expression;
          }, e2.prototype.recalculate = function(e3, r2) {
            t2.prototype.recalculate.call(this, e3, r2), this.paint._values["line-floorwidth"] = Os.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, e3);
          }, e2.prototype.createBucket = function(t3) {
            return new Fs(t3);
          }, e2.prototype.queryRadius = function(t3) {
            var e3 = t3, r2 = Us(to("line-width", this, e3), to("line-gap-width", this, e3)), n2 = to("line-offset", this, e3);
            return r2 / 2 + Math.abs(n2) + eo(this.paint.get("line-translate"));
          }, e2.prototype.queryIntersectsFeature = function(t3, e3, r2, n2, a2, o2, s2) {
            var u2 = ro(t3, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), o2.angle, s2), l2 = s2 / 2 * Us(this.paint.get("line-width").evaluate(e3, r2), this.paint.get("line-gap-width").evaluate(e3, r2)), p2 = this.paint.get("line-offset").evaluate(e3, r2);
            return p2 && (n2 = function(t4, e4) {
              for (var r3 = [], n3 = new i(0, 0), a3 = 0; a3 < t4.length; a3++) {
                for (var o3 = t4[a3], s3 = [], u3 = 0; u3 < o3.length; u3++) {
                  var l3 = o3[u3], p3 = o3[u3 + 1], c2 = u3 === 0 ? n3 : l3.sub(o3[u3 - 1])._unit()._perp(), h2 = u3 === o3.length - 1 ? n3 : p3.sub(l3)._unit()._perp(), f2 = c2._add(h2)._unit();
                  f2._mult(1 / (f2.x * h2.x + f2.y * h2.y)), s3.push(f2._mult(e4)._add(l3));
                }
                r3.push(s3);
              }
              return r3;
            }(n2, p2 * s2)), function(t4, e4, r3) {
              for (var n3 = 0; n3 < e4.length; n3++) {
                var i2 = e4[n3];
                if (t4.length >= 3) {
                  for (var a3 = 0; a3 < i2.length; a3++)
                    if (Wa(t4, i2[a3]))
                      return true;
                }
                if (Za(t4, i2, r3))
                  return true;
              }
              return false;
            }(u2, n2, l2);
          }, e2.prototype.isTileClipped = function() {
            return true;
          }, e2;
        }(_i);
        function Us(t2, e2) {
          return e2 > 0 ? e2 + 2 * t2 : t2;
        }
        var js = Ii([{name: "a_pos_offset", components: 4, type: "Int16"}, {name: "a_data", components: 4, type: "Uint16"}, {name: "a_pixeloffset", components: 4, type: "Int16"}], 4), qs = Ii([{name: "a_projected_pos", components: 3, type: "Float32"}], 4), Ns = (Ii([{name: "a_fade_opacity", components: 1, type: "Uint32"}], 4), Ii([{name: "a_placed", components: 2, type: "Uint8"}, {name: "a_shift", components: 2, type: "Float32"}])), Ks = (Ii([{type: "Int16", name: "anchorPointX"}, {type: "Int16", name: "anchorPointY"}, {type: "Int16", name: "x1"}, {type: "Int16", name: "y1"}, {type: "Int16", name: "x2"}, {type: "Int16", name: "y2"}, {type: "Uint32", name: "featureIndex"}, {type: "Uint16", name: "sourceLayerIndex"}, {type: "Uint16", name: "bucketIndex"}]), Ii([{name: "a_pos", components: 2, type: "Int16"}, {name: "a_anchor_pos", components: 2, type: "Int16"}, {name: "a_extrude", components: 2, type: "Int16"}], 4)), Gs = Ii([{name: "a_pos", components: 2, type: "Float32"}, {name: "a_radius", components: 1, type: "Float32"}, {name: "a_flags", components: 2, type: "Int16"}], 4);
        function Zs(t2, e2, r2) {
          return t2.sections.forEach(function(t3) {
            t3.text = function(t4, e3, r3) {
              var n2 = e3.layout.get("text-transform").evaluate(r3, {});
              return n2 === "uppercase" ? t4 = t4.toLocaleUpperCase() : n2 === "lowercase" && (t4 = t4.toLocaleLowerCase()), oi.applyArabicShaping && (t4 = oi.applyArabicShaping(t4)), t4;
            }(t3.text, e2, r2);
          }), t2;
        }
        Ii([{name: "triangle", components: 3, type: "Uint16"}]), Ii([{type: "Int16", name: "anchorX"}, {type: "Int16", name: "anchorY"}, {type: "Uint16", name: "glyphStartIndex"}, {type: "Uint16", name: "numGlyphs"}, {type: "Uint32", name: "vertexStartIndex"}, {type: "Uint32", name: "lineStartIndex"}, {type: "Uint32", name: "lineLength"}, {type: "Uint16", name: "segment"}, {type: "Uint16", name: "lowerSize"}, {type: "Uint16", name: "upperSize"}, {type: "Float32", name: "lineOffsetX"}, {type: "Float32", name: "lineOffsetY"}, {type: "Uint8", name: "writingMode"}, {type: "Uint8", name: "placedOrientation"}, {type: "Uint8", name: "hidden"}, {type: "Uint32", name: "crossTileID"}, {type: "Int16", name: "associatedIconIndex"}]), Ii([{type: "Int16", name: "anchorX"}, {type: "Int16", name: "anchorY"}, {type: "Int16", name: "rightJustifiedTextSymbolIndex"}, {type: "Int16", name: "centerJustifiedTextSymbolIndex"}, {type: "Int16", name: "leftJustifiedTextSymbolIndex"}, {type: "Int16", name: "verticalPlacedTextSymbolIndex"}, {type: "Int16", name: "placedIconSymbolIndex"}, {type: "Int16", name: "verticalPlacedIconSymbolIndex"}, {type: "Uint16", name: "key"}, {type: "Uint16", name: "textBoxStartIndex"}, {type: "Uint16", name: "textBoxEndIndex"}, {type: "Uint16", name: "verticalTextBoxStartIndex"}, {type: "Uint16", name: "verticalTextBoxEndIndex"}, {type: "Uint16", name: "iconBoxStartIndex"}, {type: "Uint16", name: "iconBoxEndIndex"}, {type: "Uint16", name: "verticalIconBoxStartIndex"}, {type: "Uint16", name: "verticalIconBoxEndIndex"}, {type: "Uint16", name: "featureIndex"}, {type: "Uint16", name: "numHorizontalGlyphVertices"}, {type: "Uint16", name: "numVerticalGlyphVertices"}, {type: "Uint16", name: "numIconVertices"}, {type: "Uint16", name: "numVerticalIconVertices"}, {type: "Uint16", name: "useRuntimeCollisionCircles"}, {type: "Uint32", name: "crossTileID"}, {type: "Float32", name: "textBoxScale"}, {type: "Float32", components: 2, name: "textOffset"}, {type: "Float32", name: "collisionCircleDiameter"}]), Ii([{type: "Float32", name: "offsetX"}]), Ii([{type: "Int16", name: "x"}, {type: "Int16", name: "y"}, {type: "Int16", name: "tileUnitDistanceFromAnchor"}]);
        var Xs = {"!": "︕", "#": "＃", $: "＄", "%": "％", "&": "＆", "(": "︵", ")": "︶", "*": "＊", "+": "＋", ",": "︐", "-": "︲", ".": "・", "/": "／", ":": "︓", ";": "︔", "<": "︿", "=": "＝", ">": "﹀", "?": "︖", "@": "＠", "[": "﹇", "\\": "＼", "]": "﹈", "^": "＾", _: "︳", "`": "｀", "{": "︷", "|": "―", "}": "︸", "~": "～", "¢": "￠", "£": "￡", "¥": "￥", "¦": "￤", "¬": "￢", "¯": "￣", "–": "︲", "—": "︱", "‘": "﹃", "’": "﹄", "“": "﹁", "”": "﹂", "…": "︙", "‧": "・", "₩": "￦", "、": "︑", "。": "︒", "〈": "︿", "〉": "﹀", "《": "︽", "》": "︾", "「": "﹁", "」": "﹂", "『": "﹃", "』": "﹄", "【": "︻", "】": "︼", "〔": "︹", "〕": "︺", "〖": "︗", "〗": "︘", "！": "︕", "（": "︵", "）": "︶", "，": "︐", "－": "︲", "．": "・", "：": "︓", "；": "︔", "＜": "︿", "＞": "﹀", "？": "︖", "［": "﹇", "］": "﹈", "＿": "︳", "｛": "︷", "｜": "―", "｝": "︸", "｟": "︵", "｠": "︶", "｡": "︒", "｢": "﹁", "｣": "﹂"}, Js = function(t2, e2, r2, n2, i2) {
          var a2, o2, s2 = 8 * i2 - n2 - 1, u2 = (1 << s2) - 1, l2 = u2 >> 1, p2 = -7, c2 = r2 ? i2 - 1 : 0, h2 = r2 ? -1 : 1, f2 = t2[e2 + c2];
          for (c2 += h2, a2 = f2 & (1 << -p2) - 1, f2 >>= -p2, p2 += s2; p2 > 0; a2 = 256 * a2 + t2[e2 + c2], c2 += h2, p2 -= 8)
            ;
          for (o2 = a2 & (1 << -p2) - 1, a2 >>= -p2, p2 += n2; p2 > 0; o2 = 256 * o2 + t2[e2 + c2], c2 += h2, p2 -= 8)
            ;
          if (a2 === 0)
            a2 = 1 - l2;
          else {
            if (a2 === u2)
              return o2 ? NaN : 1 / 0 * (f2 ? -1 : 1);
            o2 += Math.pow(2, n2), a2 -= l2;
          }
          return (f2 ? -1 : 1) * o2 * Math.pow(2, a2 - n2);
        }, Hs = function(t2, e2, r2, n2, i2, a2) {
          var o2, s2, u2, l2 = 8 * a2 - i2 - 1, p2 = (1 << l2) - 1, c2 = p2 >> 1, h2 = i2 === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0, f2 = n2 ? 0 : a2 - 1, y2 = n2 ? 1 : -1, d2 = e2 < 0 || e2 === 0 && 1 / e2 < 0 ? 1 : 0;
          for (e2 = Math.abs(e2), isNaN(e2) || e2 === 1 / 0 ? (s2 = isNaN(e2) ? 1 : 0, o2 = p2) : (o2 = Math.floor(Math.log(e2) / Math.LN2), e2 * (u2 = Math.pow(2, -o2)) < 1 && (o2--, u2 *= 2), (e2 += o2 + c2 >= 1 ? h2 / u2 : h2 * Math.pow(2, 1 - c2)) * u2 >= 2 && (o2++, u2 /= 2), o2 + c2 >= p2 ? (s2 = 0, o2 = p2) : o2 + c2 >= 1 ? (s2 = (e2 * u2 - 1) * Math.pow(2, i2), o2 += c2) : (s2 = e2 * Math.pow(2, c2 - 1) * Math.pow(2, i2), o2 = 0)); i2 >= 8; t2[r2 + f2] = 255 & s2, f2 += y2, s2 /= 256, i2 -= 8)
            ;
          for (o2 = o2 << i2 | s2, l2 += i2; l2 > 0; t2[r2 + f2] = 255 & o2, f2 += y2, o2 /= 256, l2 -= 8)
            ;
          t2[r2 + f2 - y2] |= 128 * d2;
        }, Ys = $s;
        function $s(t2) {
          this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t2) ? t2 : new Uint8Array(t2 || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;
        }
        $s.Varint = 0, $s.Fixed64 = 1, $s.Bytes = 2, $s.Fixed32 = 5;
        var Ws = typeof TextDecoder == "undefined" ? null : new TextDecoder("utf8");
        function Qs(t2) {
          return t2.type === $s.Bytes ? t2.readVarint() + t2.pos : t2.pos + 1;
        }
        function tu(t2, e2, r2) {
          return r2 ? 4294967296 * e2 + (t2 >>> 0) : 4294967296 * (e2 >>> 0) + (t2 >>> 0);
        }
        function eu(t2, e2, r2) {
          var n2 = e2 <= 16383 ? 1 : e2 <= 2097151 ? 2 : e2 <= 268435455 ? 3 : Math.floor(Math.log(e2) / (7 * Math.LN2));
          r2.realloc(n2);
          for (var i2 = r2.pos - 1; i2 >= t2; i2--)
            r2.buf[i2 + n2] = r2.buf[i2];
        }
        function ru(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeVarint(t2[r2]);
        }
        function nu(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeSVarint(t2[r2]);
        }
        function iu(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeFloat(t2[r2]);
        }
        function au(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeDouble(t2[r2]);
        }
        function ou(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeBoolean(t2[r2]);
        }
        function su(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeFixed32(t2[r2]);
        }
        function uu(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeSFixed32(t2[r2]);
        }
        function lu(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeFixed64(t2[r2]);
        }
        function pu(t2, e2) {
          for (var r2 = 0; r2 < t2.length; r2++)
            e2.writeSFixed64(t2[r2]);
        }
        function cu(t2, e2) {
          return (t2[e2] | t2[e2 + 1] << 8 | t2[e2 + 2] << 16) + 16777216 * t2[e2 + 3];
        }
        function hu(t2, e2, r2) {
          t2[r2] = e2, t2[r2 + 1] = e2 >>> 8, t2[r2 + 2] = e2 >>> 16, t2[r2 + 3] = e2 >>> 24;
        }
        function fu(t2, e2) {
          return (t2[e2] | t2[e2 + 1] << 8 | t2[e2 + 2] << 16) + (t2[e2 + 3] << 24);
        }
        function yu(t2, e2, r2) {
          t2 === 1 && r2.readMessage(du, e2);
        }
        function du(t2, e2, r2) {
          if (t2 === 3) {
            var n2 = r2.readMessage(mu, {}), i2 = n2.width, a2 = n2.height, o2 = n2.left, s2 = n2.top, u2 = n2.advance;
            e2.push({id: n2.id, bitmap: new go({width: i2 + 6, height: a2 + 6}, n2.bitmap), metrics: {width: i2, height: a2, left: o2, top: s2, advance: u2}});
          }
        }
        function mu(t2, e2, r2) {
          t2 === 1 ? e2.id = r2.readVarint() : t2 === 2 ? e2.bitmap = r2.readBytes() : t2 === 3 ? e2.width = r2.readVarint() : t2 === 4 ? e2.height = r2.readVarint() : t2 === 5 ? e2.left = r2.readSVarint() : t2 === 6 ? e2.top = r2.readSVarint() : t2 === 7 && (e2.advance = r2.readVarint());
        }
        function vu(t2) {
          for (var e2 = 0, r2 = 0, n2 = 0, i2 = t2; n2 < i2.length; n2 += 1) {
            var a2 = i2[n2];
            e2 += a2.w * a2.h, r2 = Math.max(r2, a2.w);
          }
          t2.sort(function(t3, e3) {
            return e3.h - t3.h;
          });
          for (var o2 = [{x: 0, y: 0, w: Math.max(Math.ceil(Math.sqrt(e2 / 0.95)), r2), h: 1 / 0}], s2 = 0, u2 = 0, l2 = 0, p2 = t2; l2 < p2.length; l2 += 1)
            for (var c2 = p2[l2], h2 = o2.length - 1; h2 >= 0; h2--) {
              var f2 = o2[h2];
              if (!(c2.w > f2.w || c2.h > f2.h)) {
                if (c2.x = f2.x, c2.y = f2.y, u2 = Math.max(u2, c2.y + c2.h), s2 = Math.max(s2, c2.x + c2.w), c2.w === f2.w && c2.h === f2.h) {
                  var y2 = o2.pop();
                  h2 < o2.length && (o2[h2] = y2);
                } else
                  c2.h === f2.h ? (f2.x += c2.w, f2.w -= c2.w) : c2.w === f2.w ? (f2.y += c2.h, f2.h -= c2.h) : (o2.push({x: f2.x + c2.w, y: f2.y, w: f2.w - c2.w, h: c2.h}), f2.y += c2.h, f2.h -= c2.h);
                break;
              }
            }
          return {w: s2, h: u2, fill: e2 / (s2 * u2) || 0};
        }
        $s.prototype = {destroy: function() {
          this.buf = null;
        }, readFields: function(t2, e2, r2) {
          for (r2 = r2 || this.length; this.pos < r2; ) {
            var n2 = this.readVarint(), i2 = n2 >> 3, a2 = this.pos;
            this.type = 7 & n2, t2(i2, e2, this), this.pos === a2 && this.skip(n2);
          }
          return e2;
        }, readMessage: function(t2, e2) {
          return this.readFields(t2, e2, this.readVarint() + this.pos);
        }, readFixed32: function() {
          var t2 = cu(this.buf, this.pos);
          return this.pos += 4, t2;
        }, readSFixed32: function() {
          var t2 = fu(this.buf, this.pos);
          return this.pos += 4, t2;
        }, readFixed64: function() {
          var t2 = cu(this.buf, this.pos) + 4294967296 * cu(this.buf, this.pos + 4);
          return this.pos += 8, t2;
        }, readSFixed64: function() {
          var t2 = cu(this.buf, this.pos) + 4294967296 * fu(this.buf, this.pos + 4);
          return this.pos += 8, t2;
        }, readFloat: function() {
          var t2 = Js(this.buf, this.pos, true, 23, 4);
          return this.pos += 4, t2;
        }, readDouble: function() {
          var t2 = Js(this.buf, this.pos, true, 52, 8);
          return this.pos += 8, t2;
        }, readVarint: function(t2) {
          var e2, r2, n2 = this.buf;
          return e2 = 127 & (r2 = n2[this.pos++]), r2 < 128 ? e2 : (e2 |= (127 & (r2 = n2[this.pos++])) << 7, r2 < 128 ? e2 : (e2 |= (127 & (r2 = n2[this.pos++])) << 14, r2 < 128 ? e2 : (e2 |= (127 & (r2 = n2[this.pos++])) << 21, r2 < 128 ? e2 : function(t3, e3, r3) {
            var n3, i2, a2 = r3.buf;
            if (n3 = (112 & (i2 = a2[r3.pos++])) >> 4, i2 < 128)
              return tu(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 3, i2 < 128)
              return tu(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 10, i2 < 128)
              return tu(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 17, i2 < 128)
              return tu(t3, n3, e3);
            if (n3 |= (127 & (i2 = a2[r3.pos++])) << 24, i2 < 128)
              return tu(t3, n3, e3);
            if (n3 |= (1 & (i2 = a2[r3.pos++])) << 31, i2 < 128)
              return tu(t3, n3, e3);
            throw new Error("Expected varint not more than 10 bytes");
          }(e2 |= (15 & (r2 = n2[this.pos])) << 28, t2, this))));
        }, readVarint64: function() {
          return this.readVarint(true);
        }, readSVarint: function() {
          var t2 = this.readVarint();
          return t2 % 2 == 1 ? (t2 + 1) / -2 : t2 / 2;
        }, readBoolean: function() {
          return Boolean(this.readVarint());
        }, readString: function() {
          var t2 = this.readVarint() + this.pos, e2 = this.pos;
          return this.pos = t2, t2 - e2 >= 12 && Ws ? function(t3, e3, r2) {
            return Ws.decode(t3.subarray(e3, r2));
          }(this.buf, e2, t2) : function(t3, e3, r2) {
            for (var n2 = "", i2 = e3; i2 < r2; ) {
              var a2, o2, s2, u2 = t3[i2], l2 = null, p2 = u2 > 239 ? 4 : u2 > 223 ? 3 : u2 > 191 ? 2 : 1;
              if (i2 + p2 > r2)
                break;
              p2 === 1 ? u2 < 128 && (l2 = u2) : p2 === 2 ? (192 & (a2 = t3[i2 + 1])) == 128 && (l2 = (31 & u2) << 6 | 63 & a2) <= 127 && (l2 = null) : p2 === 3 ? (o2 = t3[i2 + 2], (192 & (a2 = t3[i2 + 1])) == 128 && (192 & o2) == 128 && ((l2 = (15 & u2) << 12 | (63 & a2) << 6 | 63 & o2) <= 2047 || l2 >= 55296 && l2 <= 57343) && (l2 = null)) : p2 === 4 && (o2 = t3[i2 + 2], s2 = t3[i2 + 3], (192 & (a2 = t3[i2 + 1])) == 128 && (192 & o2) == 128 && (192 & s2) == 128 && ((l2 = (15 & u2) << 18 | (63 & a2) << 12 | (63 & o2) << 6 | 63 & s2) <= 65535 || l2 >= 1114112) && (l2 = null)), l2 === null ? (l2 = 65533, p2 = 1) : l2 > 65535 && (l2 -= 65536, n2 += String.fromCharCode(l2 >>> 10 & 1023 | 55296), l2 = 56320 | 1023 & l2), n2 += String.fromCharCode(l2), i2 += p2;
            }
            return n2;
          }(this.buf, e2, t2);
        }, readBytes: function() {
          var t2 = this.readVarint() + this.pos, e2 = this.buf.subarray(this.pos, t2);
          return this.pos = t2, e2;
        }, readPackedVarint: function(t2, e2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readVarint(e2));
          var r2 = Qs(this);
          for (t2 = t2 || []; this.pos < r2; )
            t2.push(this.readVarint(e2));
          return t2;
        }, readPackedSVarint: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readSVarint());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readSVarint());
          return t2;
        }, readPackedBoolean: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readBoolean());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readBoolean());
          return t2;
        }, readPackedFloat: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readFloat());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readFloat());
          return t2;
        }, readPackedDouble: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readDouble());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readDouble());
          return t2;
        }, readPackedFixed32: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readFixed32());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readFixed32());
          return t2;
        }, readPackedSFixed32: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readSFixed32());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readSFixed32());
          return t2;
        }, readPackedFixed64: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readFixed64());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readFixed64());
          return t2;
        }, readPackedSFixed64: function(t2) {
          if (this.type !== $s.Bytes)
            return t2.push(this.readSFixed64());
          var e2 = Qs(this);
          for (t2 = t2 || []; this.pos < e2; )
            t2.push(this.readSFixed64());
          return t2;
        }, skip: function(t2) {
          var e2 = 7 & t2;
          if (e2 === $s.Varint)
            for (; this.buf[this.pos++] > 127; )
              ;
          else if (e2 === $s.Bytes)
            this.pos = this.readVarint() + this.pos;
          else if (e2 === $s.Fixed32)
            this.pos += 4;
          else {
            if (e2 !== $s.Fixed64)
              throw new Error("Unimplemented type: " + e2);
            this.pos += 8;
          }
        }, writeTag: function(t2, e2) {
          this.writeVarint(t2 << 3 | e2);
        }, realloc: function(t2) {
          for (var e2 = this.length || 16; e2 < this.pos + t2; )
            e2 *= 2;
          if (e2 !== this.length) {
            var r2 = new Uint8Array(e2);
            r2.set(this.buf), this.buf = r2, this.length = e2;
          }
        }, finish: function() {
          return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length);
        }, writeFixed32: function(t2) {
          this.realloc(4), hu(this.buf, t2, this.pos), this.pos += 4;
        }, writeSFixed32: function(t2) {
          this.realloc(4), hu(this.buf, t2, this.pos), this.pos += 4;
        }, writeFixed64: function(t2) {
          this.realloc(8), hu(this.buf, -1 & t2, this.pos), hu(this.buf, Math.floor(t2 * (1 / 4294967296)), this.pos + 4), this.pos += 8;
        }, writeSFixed64: function(t2) {
          this.realloc(8), hu(this.buf, -1 & t2, this.pos), hu(this.buf, Math.floor(t2 * (1 / 4294967296)), this.pos + 4), this.pos += 8;
        }, writeVarint: function(t2) {
          (t2 = +t2 || 0) > 268435455 || t2 < 0 ? function(t3, e2) {
            var r2, n2;
            if (t3 >= 0 ? (r2 = t3 % 4294967296 | 0, n2 = t3 / 4294967296 | 0) : (n2 = ~(-t3 / 4294967296), 4294967295 ^ (r2 = ~(-t3 % 4294967296)) ? r2 = r2 + 1 | 0 : (r2 = 0, n2 = n2 + 1 | 0)), t3 >= 18446744073709552e3 || t3 < -18446744073709552e3)
              throw new Error("Given varint doesn't fit into 10 bytes");
            e2.realloc(10), function(t4, e3, r3) {
              r3.buf[r3.pos++] = 127 & t4 | 128, t4 >>>= 7, r3.buf[r3.pos++] = 127 & t4 | 128, t4 >>>= 7, r3.buf[r3.pos++] = 127 & t4 | 128, t4 >>>= 7, r3.buf[r3.pos++] = 127 & t4 | 128, r3.buf[r3.pos] = 127 & (t4 >>>= 7);
            }(r2, 0, e2), function(t4, e3) {
              var r3 = (7 & t4) << 4;
              e3.buf[e3.pos++] |= r3 | ((t4 >>>= 3) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4 | ((t4 >>>= 7) ? 128 : 0), t4 && (e3.buf[e3.pos++] = 127 & t4)))));
            }(n2, e2);
          }(t2, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t2 | (t2 > 127 ? 128 : 0), t2 <= 127 || (this.buf[this.pos++] = 127 & (t2 >>>= 7) | (t2 > 127 ? 128 : 0), t2 <= 127 || (this.buf[this.pos++] = 127 & (t2 >>>= 7) | (t2 > 127 ? 128 : 0), t2 <= 127 || (this.buf[this.pos++] = t2 >>> 7 & 127))));
        }, writeSVarint: function(t2) {
          this.writeVarint(t2 < 0 ? 2 * -t2 - 1 : 2 * t2);
        }, writeBoolean: function(t2) {
          this.writeVarint(Boolean(t2));
        }, writeString: function(t2) {
          t2 = String(t2), this.realloc(4 * t2.length), this.pos++;
          var e2 = this.pos;
          this.pos = function(t3, e3, r3) {
            for (var n2, i2, a2 = 0; a2 < e3.length; a2++) {
              if ((n2 = e3.charCodeAt(a2)) > 55295 && n2 < 57344) {
                if (!i2) {
                  n2 > 56319 || a2 + 1 === e3.length ? (t3[r3++] = 239, t3[r3++] = 191, t3[r3++] = 189) : i2 = n2;
                  continue;
                }
                if (n2 < 56320) {
                  t3[r3++] = 239, t3[r3++] = 191, t3[r3++] = 189, i2 = n2;
                  continue;
                }
                n2 = i2 - 55296 << 10 | n2 - 56320 | 65536, i2 = null;
              } else
                i2 && (t3[r3++] = 239, t3[r3++] = 191, t3[r3++] = 189, i2 = null);
              n2 < 128 ? t3[r3++] = n2 : (n2 < 2048 ? t3[r3++] = n2 >> 6 | 192 : (n2 < 65536 ? t3[r3++] = n2 >> 12 | 224 : (t3[r3++] = n2 >> 18 | 240, t3[r3++] = n2 >> 12 & 63 | 128), t3[r3++] = n2 >> 6 & 63 | 128), t3[r3++] = 63 & n2 | 128);
            }
            return r3;
          }(this.buf, t2, this.pos);
          var r2 = this.pos - e2;
          r2 >= 128 && eu(e2, r2, this), this.pos = e2 - 1, this.writeVarint(r2), this.pos += r2;
        }, writeFloat: function(t2) {
          this.realloc(4), Hs(this.buf, t2, this.pos, true, 23, 4), this.pos += 4;
        }, writeDouble: function(t2) {
          this.realloc(8), Hs(this.buf, t2, this.pos, true, 52, 8), this.pos += 8;
        }, writeBytes: function(t2) {
          var e2 = t2.length;
          this.writeVarint(e2), this.realloc(e2);
          for (var r2 = 0; r2 < e2; r2++)
            this.buf[this.pos++] = t2[r2];
        }, writeRawMessage: function(t2, e2) {
          this.pos++;
          var r2 = this.pos;
          t2(e2, this);
          var n2 = this.pos - r2;
          n2 >= 128 && eu(r2, n2, this), this.pos = r2 - 1, this.writeVarint(n2), this.pos += n2;
        }, writeMessage: function(t2, e2, r2) {
          this.writeTag(t2, $s.Bytes), this.writeRawMessage(e2, r2);
        }, writePackedVarint: function(t2, e2) {
          e2.length && this.writeMessage(t2, ru, e2);
        }, writePackedSVarint: function(t2, e2) {
          e2.length && this.writeMessage(t2, nu, e2);
        }, writePackedBoolean: function(t2, e2) {
          e2.length && this.writeMessage(t2, ou, e2);
        }, writePackedFloat: function(t2, e2) {
          e2.length && this.writeMessage(t2, iu, e2);
        }, writePackedDouble: function(t2, e2) {
          e2.length && this.writeMessage(t2, au, e2);
        }, writePackedFixed32: function(t2, e2) {
          e2.length && this.writeMessage(t2, su, e2);
        }, writePackedSFixed32: function(t2, e2) {
          e2.length && this.writeMessage(t2, uu, e2);
        }, writePackedFixed64: function(t2, e2) {
          e2.length && this.writeMessage(t2, lu, e2);
        }, writePackedSFixed64: function(t2, e2) {
          e2.length && this.writeMessage(t2, pu, e2);
        }, writeBytesField: function(t2, e2) {
          this.writeTag(t2, $s.Bytes), this.writeBytes(e2);
        }, writeFixed32Field: function(t2, e2) {
          this.writeTag(t2, $s.Fixed32), this.writeFixed32(e2);
        }, writeSFixed32Field: function(t2, e2) {
          this.writeTag(t2, $s.Fixed32), this.writeSFixed32(e2);
        }, writeFixed64Field: function(t2, e2) {
          this.writeTag(t2, $s.Fixed64), this.writeFixed64(e2);
        }, writeSFixed64Field: function(t2, e2) {
          this.writeTag(t2, $s.Fixed64), this.writeSFixed64(e2);
        }, writeVarintField: function(t2, e2) {
          this.writeTag(t2, $s.Varint), this.writeVarint(e2);
        }, writeSVarintField: function(t2, e2) {
          this.writeTag(t2, $s.Varint), this.writeSVarint(e2);
        }, writeStringField: function(t2, e2) {
          this.writeTag(t2, $s.Bytes), this.writeString(e2);
        }, writeFloatField: function(t2, e2) {
          this.writeTag(t2, $s.Fixed32), this.writeFloat(e2);
        }, writeDoubleField: function(t2, e2) {
          this.writeTag(t2, $s.Fixed64), this.writeDouble(e2);
        }, writeBooleanField: function(t2, e2) {
          this.writeVarintField(t2, Boolean(e2));
        }};
        var gu = function(t2, e2) {
          var r2 = e2.pixelRatio, n2 = e2.version, i2 = e2.stretchX, a2 = e2.stretchY, o2 = e2.content;
          this.paddedRect = t2, this.pixelRatio = r2, this.stretchX = i2, this.stretchY = a2, this.content = o2, this.version = n2;
        }, xu = {tl: {configurable: true}, br: {configurable: true}, tlbr: {configurable: true}, displaySize: {configurable: true}};
        xu.tl.get = function() {
          return [this.paddedRect.x + 1, this.paddedRect.y + 1];
        }, xu.br.get = function() {
          return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1];
        }, xu.tlbr.get = function() {
          return this.tl.concat(this.br);
        }, xu.displaySize.get = function() {
          return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio];
        }, Object.defineProperties(gu.prototype, xu);
        var bu = function(t2, e2) {
          var r2 = {}, n2 = {};
          this.haveRenderCallbacks = [];
          var i2 = [];
          this.addImages(t2, r2, i2), this.addImages(e2, n2, i2);
          var a2 = vu(i2), o2 = new xo({width: a2.w || 1, height: a2.h || 1});
          for (var s2 in t2) {
            var u2 = t2[s2], l2 = r2[s2].paddedRect;
            xo.copy(u2.data, o2, {x: 0, y: 0}, {x: l2.x + 1, y: l2.y + 1}, u2.data);
          }
          for (var p2 in e2) {
            var c2 = e2[p2], h2 = n2[p2].paddedRect, f2 = h2.x + 1, y2 = h2.y + 1, d2 = c2.data.width, m2 = c2.data.height;
            xo.copy(c2.data, o2, {x: 0, y: 0}, {x: f2, y: y2}, c2.data), xo.copy(c2.data, o2, {x: 0, y: m2 - 1}, {x: f2, y: y2 - 1}, {width: d2, height: 1}), xo.copy(c2.data, o2, {x: 0, y: 0}, {x: f2, y: y2 + m2}, {width: d2, height: 1}), xo.copy(c2.data, o2, {x: d2 - 1, y: 0}, {x: f2 - 1, y: y2}, {width: 1, height: m2}), xo.copy(c2.data, o2, {x: 0, y: 0}, {x: f2 + d2, y: y2}, {width: 1, height: m2});
          }
          this.image = o2, this.iconPositions = r2, this.patternPositions = n2;
        };
        bu.prototype.addImages = function(t2, e2, r2) {
          for (var n2 in t2) {
            var i2 = t2[n2], a2 = {x: 0, y: 0, w: i2.data.width + 2, h: i2.data.height + 2};
            r2.push(a2), e2[n2] = new gu(a2, i2), i2.hasRenderCallback && this.haveRenderCallbacks.push(n2);
          }
        }, bu.prototype.patchUpdatedImages = function(t2, e2) {
          for (var r2 in t2.dispatchRenderCallbacks(this.haveRenderCallbacks), t2.updatedImages)
            this.patchUpdatedImage(this.iconPositions[r2], t2.getImage(r2), e2), this.patchUpdatedImage(this.patternPositions[r2], t2.getImage(r2), e2);
        }, bu.prototype.patchUpdatedImage = function(t2, e2, r2) {
          if (t2 && e2 && t2.version !== e2.version) {
            t2.version = e2.version;
            var n2 = t2.tl;
            r2.update(e2.data, void 0, {x: n2[0], y: n2[1]});
          }
        }, On("ImagePosition", gu), On("ImageAtlas", bu);
        var wu = {horizontal: 1, vertical: 2, horizontalOnly: 3}, _u = function() {
          this.scale = 1, this.fontStack = "", this.imageName = null;
        };
        _u.forText = function(t2, e2) {
          var r2 = new _u();
          return r2.scale = t2 || 1, r2.fontStack = e2, r2;
        }, _u.forImage = function(t2) {
          var e2 = new _u();
          return e2.imageName = t2, e2;
        };
        var Au = function() {
          this.text = "", this.sectionIndex = [], this.sections = [], this.imageSectionID = null;
        };
        function Su(t2, e2, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2) {
          var m2, v2 = Au.fromFeature(t2, i2);
          c2 === wu.vertical && v2.verticalizePunctuation();
          var g2 = oi.processBidirectionalText, x2 = oi.processStyledBidirectionalText;
          if (g2 && v2.sections.length === 1) {
            m2 = [];
            for (var b2 = 0, w2 = g2(v2.toString(), Mu(v2, l2, a2, e2, n2, f2, y2)); b2 < w2.length; b2 += 1) {
              var _2 = w2[b2], A2 = new Au();
              A2.text = _2, A2.sections = v2.sections;
              for (var S2 = 0; S2 < _2.length; S2++)
                A2.sectionIndex.push(0);
              m2.push(A2);
            }
          } else if (x2) {
            m2 = [];
            for (var k2 = 0, I2 = x2(v2.text, v2.sectionIndex, Mu(v2, l2, a2, e2, n2, f2, y2)); k2 < I2.length; k2 += 1) {
              var z2 = I2[k2], C2 = new Au();
              C2.text = z2[0], C2.sectionIndex = z2[1], C2.sections = v2.sections, m2.push(C2);
            }
          } else
            m2 = function(t3, e3) {
              for (var r3 = [], n3 = t3.text, i3 = 0, a3 = 0, o3 = e3; a3 < o3.length; a3 += 1) {
                var s3 = o3[a3];
                r3.push(t3.substring(i3, s3)), i3 = s3;
              }
              return i3 < n3.length && r3.push(t3.substring(i3, n3.length)), r3;
            }(v2, Mu(v2, l2, a2, e2, n2, f2, y2));
          var E2 = [], P2 = {positionedLines: E2, text: v2.toString(), top: p2[1], bottom: p2[1], left: p2[0], right: p2[0], writingMode: c2, iconsInText: false, verticalizable: false};
          return function(t3, e3, r3, n3, i3, a3, o3, s3, u3, l3, p3, c3) {
            for (var h3 = 0, f3 = -17, y3 = 0, d3 = 0, m3 = s3 === "right" ? 1 : s3 === "left" ? 0 : 0.5, v3 = 0, g3 = 0, x3 = i3; g3 < x3.length; g3 += 1) {
              var b3 = x3[g3];
              b3.trim();
              var w3 = b3.getMaxScale(), _3 = 24 * (w3 - 1), A3 = {positionedGlyphs: [], lineOffset: 0};
              t3.positionedLines[v3] = A3;
              var S3 = A3.positionedGlyphs, k3 = 0;
              if (b3.length()) {
                for (var I3 = 0; I3 < b3.length(); I3++) {
                  var z3 = b3.getSection(I3), C3 = b3.getSectionIndex(I3), E3 = b3.getCharCode(I3), P3 = 0, M2 = null, B2 = null, T2 = null, V2 = 24, F2 = !(u3 === wu.horizontal || !p3 && !Xn(E3) || p3 && (ku[E3] || (K2 = E3, Gn.Arabic(K2) || Gn["Arabic Supplement"](K2) || Gn["Arabic Extended-A"](K2) || Gn["Arabic Presentation Forms-A"](K2) || Gn["Arabic Presentation Forms-B"](K2))));
                  if (z3.imageName) {
                    var D2 = n3[z3.imageName];
                    if (!D2)
                      continue;
                    T2 = z3.imageName, t3.iconsInText = t3.iconsInText || true, B2 = D2.paddedRect;
                    var L2 = D2.displaySize;
                    z3.scale = 24 * z3.scale / c3, P3 = _3 + (24 - L2[1] * z3.scale), V2 = (M2 = {width: L2[0], height: L2[1], left: 1, top: -3, advance: F2 ? L2[1] : L2[0]}).advance;
                    var O2 = F2 ? L2[0] * z3.scale - 24 * w3 : L2[1] * z3.scale - 24 * w3;
                    O2 > 0 && O2 > k3 && (k3 = O2);
                  } else {
                    var R2 = r3[z3.fontStack], U2 = R2 && R2[E3];
                    if (U2 && U2.rect)
                      B2 = U2.rect, M2 = U2.metrics;
                    else {
                      var j2 = e3[z3.fontStack], q2 = j2 && j2[E3];
                      if (!q2)
                        continue;
                      M2 = q2.metrics;
                    }
                    P3 = 24 * (w3 - z3.scale);
                  }
                  F2 ? (t3.verticalizable = true, S3.push({glyph: E3, imageName: T2, x: h3, y: f3 + P3, vertical: F2, scale: z3.scale, fontStack: z3.fontStack, sectionIndex: C3, metrics: M2, rect: B2}), h3 += V2 * z3.scale + l3) : (S3.push({glyph: E3, imageName: T2, x: h3, y: f3 + P3, vertical: F2, scale: z3.scale, fontStack: z3.fontStack, sectionIndex: C3, metrics: M2, rect: B2}), h3 += M2.advance * z3.scale + l3);
                }
                S3.length !== 0 && (y3 = Math.max(h3 - l3, y3), Tu(S3, 0, S3.length - 1, m3, k3)), h3 = 0;
                var N2 = a3 * w3 + k3;
                A3.lineOffset = Math.max(k3, _3), f3 += N2, d3 = Math.max(N2, d3), ++v3;
              } else
                f3 += a3, ++v3;
            }
            var K2, G2 = f3 - -17, Z2 = Bu(o3), X2 = Z2.horizontalAlign, J2 = Z2.verticalAlign;
            (function(t4, e4, r4, n4, i4, a4, o4, s4, u4) {
              var l4, p4 = (e4 - r4) * i4;
              l4 = a4 !== o4 ? -s4 * n4 - -17 : (-n4 * u4 + 0.5) * o4;
              for (var c4 = 0, h4 = t4; c4 < h4.length; c4 += 1)
                for (var f4 = 0, y4 = h4[c4].positionedGlyphs; f4 < y4.length; f4 += 1) {
                  var d4 = y4[f4];
                  d4.x += p4, d4.y += l4;
                }
            })(t3.positionedLines, m3, X2, J2, y3, d3, a3, G2, i3.length), t3.top += -J2 * G2, t3.bottom = t3.top + G2, t3.left += -X2 * y3, t3.right = t3.left + y3;
          }(P2, e2, r2, n2, m2, o2, s2, u2, c2, l2, h2, d2), !function(t3) {
            for (var e3 = 0, r3 = t3; e3 < r3.length; e3 += 1)
              if (r3[e3].positionedGlyphs.length !== 0)
                return false;
            return true;
          }(E2) && P2;
        }
        Au.fromFeature = function(t2, e2) {
          for (var r2 = new Au(), n2 = 0; n2 < t2.sections.length; n2++) {
            var i2 = t2.sections[n2];
            i2.image ? r2.addImageSection(i2) : r2.addTextSection(i2, e2);
          }
          return r2;
        }, Au.prototype.length = function() {
          return this.text.length;
        }, Au.prototype.getSection = function(t2) {
          return this.sections[this.sectionIndex[t2]];
        }, Au.prototype.getSectionIndex = function(t2) {
          return this.sectionIndex[t2];
        }, Au.prototype.getCharCode = function(t2) {
          return this.text.charCodeAt(t2);
        }, Au.prototype.verticalizePunctuation = function() {
          this.text = function(t2) {
            for (var e2 = "", r2 = 0; r2 < t2.length; r2++) {
              var n2 = t2.charCodeAt(r2 + 1) || null, i2 = t2.charCodeAt(r2 - 1) || null;
              e2 += n2 && Jn(n2) && !Xs[t2[r2 + 1]] || i2 && Jn(i2) && !Xs[t2[r2 - 1]] || !Xs[t2[r2]] ? t2[r2] : Xs[t2[r2]];
            }
            return e2;
          }(this.text);
        }, Au.prototype.trim = function() {
          for (var t2 = 0, e2 = 0; e2 < this.text.length && ku[this.text.charCodeAt(e2)]; e2++)
            t2++;
          for (var r2 = this.text.length, n2 = this.text.length - 1; n2 >= 0 && n2 >= t2 && ku[this.text.charCodeAt(n2)]; n2--)
            r2--;
          this.text = this.text.substring(t2, r2), this.sectionIndex = this.sectionIndex.slice(t2, r2);
        }, Au.prototype.substring = function(t2, e2) {
          var r2 = new Au();
          return r2.text = this.text.substring(t2, e2), r2.sectionIndex = this.sectionIndex.slice(t2, e2), r2.sections = this.sections, r2;
        }, Au.prototype.toString = function() {
          return this.text;
        }, Au.prototype.getMaxScale = function() {
          var t2 = this;
          return this.sectionIndex.reduce(function(e2, r2) {
            return Math.max(e2, t2.sections[r2].scale);
          }, 0);
        }, Au.prototype.addTextSection = function(t2, e2) {
          this.text += t2.text, this.sections.push(_u.forText(t2.scale, t2.fontStack || e2));
          for (var r2 = this.sections.length - 1, n2 = 0; n2 < t2.text.length; ++n2)
            this.sectionIndex.push(r2);
        }, Au.prototype.addImageSection = function(t2) {
          var e2 = t2.image ? t2.image.name : "";
          if (e2.length !== 0) {
            var r2 = this.getNextImageSectionCharCode();
            r2 ? (this.text += String.fromCharCode(r2), this.sections.push(_u.forImage(e2)), this.sectionIndex.push(this.sections.length - 1)) : A("Reached maximum number of images 6401");
          } else
            A("Can't add FormattedSection with an empty image.");
        }, Au.prototype.getNextImageSectionCharCode = function() {
          return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID);
        };
        var ku = {9: true, 10: true, 11: true, 12: true, 13: true, 32: true}, Iu = {};
        function zu(t2, e2, r2, n2, i2, a2) {
          if (e2.imageName) {
            var o2 = n2[e2.imageName];
            return o2 ? o2.displaySize[0] * e2.scale * 24 / a2 + i2 : 0;
          }
          var s2 = r2[e2.fontStack], u2 = s2 && s2[t2];
          return u2 ? u2.metrics.advance * e2.scale + i2 : 0;
        }
        function Cu(t2, e2, r2, n2) {
          var i2 = Math.pow(t2 - e2, 2);
          return n2 ? t2 < e2 ? i2 / 2 : 2 * i2 : i2 + Math.abs(r2) * r2;
        }
        function Eu(t2, e2, r2) {
          var n2 = 0;
          return t2 === 10 && (n2 -= 1e4), r2 && (n2 += 150), t2 !== 40 && t2 !== 65288 || (n2 += 50), e2 !== 41 && e2 !== 65289 || (n2 += 50), n2;
        }
        function Pu(t2, e2, r2, n2, i2, a2) {
          for (var o2 = null, s2 = Cu(e2, r2, i2, a2), u2 = 0, l2 = n2; u2 < l2.length; u2 += 1) {
            var p2 = l2[u2], c2 = Cu(e2 - p2.x, r2, i2, a2) + p2.badness;
            c2 <= s2 && (o2 = p2, s2 = c2);
          }
          return {index: t2, x: e2, priorBreak: o2, badness: s2};
        }
        function Mu(t2, e2, r2, n2, i2, a2, o2) {
          if (a2 !== "point")
            return [];
          if (!t2)
            return [];
          for (var s2, u2 = [], l2 = function(t3, e3, r3, n3, i3, a3) {
            for (var o3 = 0, s3 = 0; s3 < t3.length(); s3++) {
              var u3 = t3.getSection(s3);
              o3 += zu(t3.getCharCode(s3), u3, n3, i3, e3, a3);
            }
            return o3 / Math.max(1, Math.ceil(o3 / r3));
          }(t2, e2, r2, n2, i2, o2), p2 = t2.text.indexOf("​") >= 0, c2 = 0, h2 = 0; h2 < t2.length(); h2++) {
            var f2 = t2.getSection(h2), y2 = t2.getCharCode(h2);
            if (ku[y2] || (c2 += zu(y2, f2, n2, i2, e2, o2)), h2 < t2.length() - 1) {
              var d2 = !((s2 = y2) < 11904 || !(Gn["Bopomofo Extended"](s2) || Gn.Bopomofo(s2) || Gn["CJK Compatibility Forms"](s2) || Gn["CJK Compatibility Ideographs"](s2) || Gn["CJK Compatibility"](s2) || Gn["CJK Radicals Supplement"](s2) || Gn["CJK Strokes"](s2) || Gn["CJK Symbols and Punctuation"](s2) || Gn["CJK Unified Ideographs Extension A"](s2) || Gn["CJK Unified Ideographs"](s2) || Gn["Enclosed CJK Letters and Months"](s2) || Gn["Halfwidth and Fullwidth Forms"](s2) || Gn.Hiragana(s2) || Gn["Ideographic Description Characters"](s2) || Gn["Kangxi Radicals"](s2) || Gn["Katakana Phonetic Extensions"](s2) || Gn.Katakana(s2) || Gn["Vertical Forms"](s2) || Gn["Yi Radicals"](s2) || Gn["Yi Syllables"](s2)));
              (Iu[y2] || d2 || f2.imageName) && u2.push(Pu(h2 + 1, c2, l2, u2, Eu(y2, t2.getCharCode(h2 + 1), d2 && p2), false));
            }
          }
          return function t3(e3) {
            return e3 ? t3(e3.priorBreak).concat(e3.index) : [];
          }(Pu(t2.length(), c2, l2, u2, 0, true));
        }
        function Bu(t2) {
          var e2 = 0.5, r2 = 0.5;
          switch (t2) {
            case "right":
            case "top-right":
            case "bottom-right":
              e2 = 1;
              break;
            case "left":
            case "top-left":
            case "bottom-left":
              e2 = 0;
          }
          switch (t2) {
            case "bottom":
            case "bottom-right":
            case "bottom-left":
              r2 = 1;
              break;
            case "top":
            case "top-right":
            case "top-left":
              r2 = 0;
          }
          return {horizontalAlign: e2, verticalAlign: r2};
        }
        function Tu(t2, e2, r2, n2, i2) {
          if (n2 || i2)
            for (var a2 = t2[r2], o2 = (t2[r2].x + a2.metrics.advance * a2.scale) * n2, s2 = e2; s2 <= r2; s2++)
              t2[s2].x -= o2, t2[s2].y += i2;
        }
        function Vu(t2, e2, r2, n2, i2, a2) {
          var o2, s2 = t2.image;
          if (s2.content) {
            var u2 = s2.content, l2 = s2.pixelRatio || 1;
            o2 = [u2[0] / l2, u2[1] / l2, s2.displaySize[0] - u2[2] / l2, s2.displaySize[1] - u2[3] / l2];
          }
          var p2, c2, h2, f2, y2 = e2.left * a2, d2 = e2.right * a2;
          r2 === "width" || r2 === "both" ? (f2 = i2[0] + y2 - n2[3], c2 = i2[0] + d2 + n2[1]) : c2 = (f2 = i2[0] + (y2 + d2 - s2.displaySize[0]) / 2) + s2.displaySize[0];
          var m2 = e2.top * a2, v2 = e2.bottom * a2;
          return r2 === "height" || r2 === "both" ? (p2 = i2[1] + m2 - n2[0], h2 = i2[1] + v2 + n2[2]) : h2 = (p2 = i2[1] + (m2 + v2 - s2.displaySize[1]) / 2) + s2.displaySize[1], {image: s2, top: p2, right: c2, bottom: h2, left: f2, collisionPadding: o2};
        }
        Iu[10] = true, Iu[32] = true, Iu[38] = true, Iu[40] = true, Iu[41] = true, Iu[43] = true, Iu[45] = true, Iu[47] = true, Iu[173] = true, Iu[183] = true, Iu[8203] = true, Iu[8208] = true, Iu[8211] = true, Iu[8231] = true;
        var Fu = function(t2) {
          function e2(e3, r2, n2, i2) {
            t2.call(this, e3, r2), this.angle = n2, i2 !== void 0 && (this.segment = i2);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.clone = function() {
            return new e2(this.x, this.y, this.angle, this.segment);
          }, e2;
        }(i);
        function Du(t2, e2) {
          var r2 = e2.expression;
          if (r2.kind === "constant")
            return {kind: "constant", layoutSize: r2.evaluate(new si(t2 + 1))};
          if (r2.kind === "source")
            return {kind: "source"};
          for (var n2 = r2.zoomStops, i2 = r2.interpolationType, a2 = 0; a2 < n2.length && n2[a2] <= t2; )
            a2++;
          for (var o2 = a2 = Math.max(0, a2 - 1); o2 < n2.length && n2[o2] < t2 + 1; )
            o2++;
          o2 = Math.min(n2.length - 1, o2);
          var s2 = n2[a2], u2 = n2[o2];
          return r2.kind === "composite" ? {kind: "composite", minZoom: s2, maxZoom: u2, interpolationType: i2} : {kind: "camera", minZoom: s2, maxZoom: u2, minSize: r2.evaluate(new si(s2)), maxSize: r2.evaluate(new si(u2)), interpolationType: i2};
        }
        function Lu(t2, e2, r2) {
          var n2 = e2.uSize, i2 = r2.lowerSize;
          return t2.kind === "source" ? i2 / 128 : t2.kind === "composite" ? Ke(i2 / 128, r2.upperSize / 128, e2.uSizeT) : n2;
        }
        function Ou(t2, e2) {
          var r2 = 0, n2 = 0;
          if (t2.kind === "constant")
            n2 = t2.layoutSize;
          else if (t2.kind !== "source") {
            var i2 = t2.interpolationType, a2 = i2 ? p(ar.interpolationFactor(i2, e2, t2.minZoom, t2.maxZoom), 0, 1) : 0;
            t2.kind === "camera" ? n2 = Ke(t2.minSize, t2.maxSize, a2) : r2 = a2;
          }
          return {uSizeT: r2, uSize: n2};
        }
        On("Anchor", Fu);
        var Ru = Object.freeze({__proto__: null, getSizeData: Du, evaluateSizeForFeature: Lu, evaluateSizeForZoom: Ou, SIZE_PACK_FACTOR: 128});
        function Uu(t2, e2, r2, n2, i2) {
          if (e2.segment === void 0)
            return true;
          for (var a2 = e2, o2 = e2.segment + 1, s2 = 0; s2 > -r2 / 2; ) {
            if (--o2 < 0)
              return false;
            s2 -= t2[o2].dist(a2), a2 = t2[o2];
          }
          s2 += t2[o2].dist(t2[o2 + 1]), o2++;
          for (var u2 = [], l2 = 0; s2 < r2 / 2; ) {
            var p2 = t2[o2], c2 = t2[o2 + 1];
            if (!c2)
              return false;
            var h2 = t2[o2 - 1].angleTo(p2) - p2.angleTo(c2);
            for (h2 = Math.abs((h2 + 3 * Math.PI) % (2 * Math.PI) - Math.PI), u2.push({distance: s2, angleDelta: h2}), l2 += h2; s2 - u2[0].distance > n2; )
              l2 -= u2.shift().angleDelta;
            if (l2 > i2)
              return false;
            o2++, s2 += p2.dist(c2);
          }
          return true;
        }
        function ju(t2) {
          for (var e2 = 0, r2 = 0; r2 < t2.length - 1; r2++)
            e2 += t2[r2].dist(t2[r2 + 1]);
          return e2;
        }
        function qu(t2, e2, r2) {
          return t2 ? 0.6 * e2 * r2 : 0;
        }
        function Nu(t2, e2) {
          return Math.max(t2 ? t2.right - t2.left : 0, e2 ? e2.right - e2.left : 0);
        }
        function Ku(t2, e2, r2, n2, i2, a2) {
          for (var o2 = qu(r2, i2, a2), s2 = Nu(r2, n2) * a2, u2 = 0, l2 = ju(t2) / 2, p2 = 0; p2 < t2.length - 1; p2++) {
            var c2 = t2[p2], h2 = t2[p2 + 1], f2 = c2.dist(h2);
            if (u2 + f2 > l2) {
              var y2 = (l2 - u2) / f2, d2 = Ke(c2.x, h2.x, y2), m2 = Ke(c2.y, h2.y, y2), v2 = new Fu(d2, m2, h2.angleTo(c2), p2);
              return v2._round(), !o2 || Uu(t2, v2, s2, o2, e2) ? v2 : void 0;
            }
            u2 += f2;
          }
        }
        function Gu(t2, e2, r2, n2, i2, a2, o2, s2, u2) {
          var l2 = qu(n2, a2, o2), p2 = Nu(n2, i2), c2 = p2 * o2, h2 = t2[0].x === 0 || t2[0].x === u2 || t2[0].y === 0 || t2[0].y === u2;
          return e2 - c2 < e2 / 4 && (e2 = c2 + e2 / 4), function t3(e3, r3, n3, i3, a3, o3, s3, u3, l3) {
            for (var p3 = o3 / 2, c3 = ju(e3), h3 = 0, f2 = r3 - n3, y2 = [], d2 = 0; d2 < e3.length - 1; d2++) {
              for (var m2 = e3[d2], v2 = e3[d2 + 1], g2 = m2.dist(v2), x2 = v2.angleTo(m2); f2 + n3 < h3 + g2; ) {
                var b2 = ((f2 += n3) - h3) / g2, w2 = Ke(m2.x, v2.x, b2), _2 = Ke(m2.y, v2.y, b2);
                if (w2 >= 0 && w2 < l3 && _2 >= 0 && _2 < l3 && f2 - p3 >= 0 && f2 + p3 <= c3) {
                  var A2 = new Fu(w2, _2, x2, d2);
                  A2._round(), i3 && !Uu(e3, A2, o3, i3, a3) || y2.push(A2);
                }
              }
              h3 += g2;
            }
            return u3 || y2.length || s3 || (y2 = t3(e3, h3 / 2, n3, i3, a3, o3, s3, true, l3)), y2;
          }(t2, h2 ? e2 / 2 * s2 % e2 : (p2 / 2 + 2 * a2) * o2 * s2 % e2, e2, l2, r2, c2, h2, false, u2);
        }
        function Zu(t2, e2, r2, n2, a2) {
          for (var o2 = [], s2 = 0; s2 < t2.length; s2++)
            for (var u2 = t2[s2], l2 = void 0, p2 = 0; p2 < u2.length - 1; p2++) {
              var c2 = u2[p2], h2 = u2[p2 + 1];
              c2.x < e2 && h2.x < e2 || (c2.x < e2 ? c2 = new i(e2, c2.y + (e2 - c2.x) / (h2.x - c2.x) * (h2.y - c2.y))._round() : h2.x < e2 && (h2 = new i(e2, c2.y + (e2 - c2.x) / (h2.x - c2.x) * (h2.y - c2.y))._round()), c2.y < r2 && h2.y < r2 || (c2.y < r2 ? c2 = new i(c2.x + (r2 - c2.y) / (h2.y - c2.y) * (h2.x - c2.x), r2)._round() : h2.y < r2 && (h2 = new i(c2.x + (r2 - c2.y) / (h2.y - c2.y) * (h2.x - c2.x), r2)._round()), c2.x >= n2 && h2.x >= n2 || (c2.x >= n2 ? c2 = new i(n2, c2.y + (n2 - c2.x) / (h2.x - c2.x) * (h2.y - c2.y))._round() : h2.x >= n2 && (h2 = new i(n2, c2.y + (n2 - c2.x) / (h2.x - c2.x) * (h2.y - c2.y))._round()), c2.y >= a2 && h2.y >= a2 || (c2.y >= a2 ? c2 = new i(c2.x + (a2 - c2.y) / (h2.y - c2.y) * (h2.x - c2.x), a2)._round() : h2.y >= a2 && (h2 = new i(c2.x + (a2 - c2.y) / (h2.y - c2.y) * (h2.x - c2.x), a2)._round()), l2 && c2.equals(l2[l2.length - 1]) || o2.push(l2 = [c2]), l2.push(h2)))));
            }
          return o2;
        }
        function Xu(t2, e2, r2, n2) {
          var a2 = [], o2 = t2.image, s2 = o2.pixelRatio, u2 = o2.paddedRect.w - 2, l2 = o2.paddedRect.h - 2, p2 = t2.right - t2.left, c2 = t2.bottom - t2.top, h2 = o2.stretchX || [[0, u2]], f2 = o2.stretchY || [[0, l2]], y2 = function(t3, e3) {
            return t3 + e3[1] - e3[0];
          }, d2 = h2.reduce(y2, 0), m2 = f2.reduce(y2, 0), v2 = u2 - d2, g2 = l2 - m2, x2 = 0, b2 = d2, w2 = 0, _2 = m2, A2 = 0, S2 = v2, k2 = 0, I2 = g2;
          if (o2.content && n2) {
            var z2 = o2.content;
            x2 = Ju(h2, 0, z2[0]), w2 = Ju(f2, 0, z2[1]), b2 = Ju(h2, z2[0], z2[2]), _2 = Ju(f2, z2[1], z2[3]), A2 = z2[0] - x2, k2 = z2[1] - w2, S2 = z2[2] - z2[0] - b2, I2 = z2[3] - z2[1] - _2;
          }
          var C2 = function(n3, a3, u3, l3) {
            var h3 = Yu(n3.stretch - x2, b2, p2, t2.left), f3 = $u(n3.fixed - A2, S2, n3.stretch, d2), y3 = Yu(a3.stretch - w2, _2, c2, t2.top), v3 = $u(a3.fixed - k2, I2, a3.stretch, m2), g3 = Yu(u3.stretch - x2, b2, p2, t2.left), z3 = $u(u3.fixed - A2, S2, u3.stretch, d2), C3 = Yu(l3.stretch - w2, _2, c2, t2.top), E3 = $u(l3.fixed - k2, I2, l3.stretch, m2), P3 = new i(h3, y3), M3 = new i(g3, y3), B3 = new i(g3, C3), T3 = new i(h3, C3), V3 = new i(f3 / s2, v3 / s2), F2 = new i(z3 / s2, E3 / s2), D2 = e2 * Math.PI / 180;
            if (D2) {
              var L2 = Math.sin(D2), O2 = Math.cos(D2), R2 = [O2, -L2, L2, O2];
              P3._matMult(R2), M3._matMult(R2), T3._matMult(R2), B3._matMult(R2);
            }
            var U2 = n3.stretch + n3.fixed, j2 = a3.stretch + a3.fixed;
            return {tl: P3, tr: M3, bl: T3, br: B3, tex: {x: o2.paddedRect.x + 1 + U2, y: o2.paddedRect.y + 1 + j2, w: u3.stretch + u3.fixed - U2, h: l3.stretch + l3.fixed - j2}, writingMode: void 0, glyphOffset: [0, 0], sectionIndex: 0, pixelOffsetTL: V3, pixelOffsetBR: F2, minFontScaleX: S2 / s2 / p2, minFontScaleY: I2 / s2 / c2, isSDF: r2};
          };
          if (n2 && (o2.stretchX || o2.stretchY))
            for (var E2 = Hu(h2, v2, d2), P2 = Hu(f2, g2, m2), M2 = 0; M2 < E2.length - 1; M2++)
              for (var B2 = E2[M2], T2 = E2[M2 + 1], V2 = 0; V2 < P2.length - 1; V2++)
                a2.push(C2(B2, P2[V2], T2, P2[V2 + 1]));
          else
            a2.push(C2({fixed: 0, stretch: -1}, {fixed: 0, stretch: -1}, {fixed: 0, stretch: u2 + 1}, {fixed: 0, stretch: l2 + 1}));
          return a2;
        }
        function Ju(t2, e2, r2) {
          for (var n2 = 0, i2 = 0, a2 = t2; i2 < a2.length; i2 += 1) {
            var o2 = a2[i2];
            n2 += Math.max(e2, Math.min(r2, o2[1])) - Math.max(e2, Math.min(r2, o2[0]));
          }
          return n2;
        }
        function Hu(t2, e2, r2) {
          for (var n2 = [{fixed: -1, stretch: 0}], i2 = 0, a2 = t2; i2 < a2.length; i2 += 1) {
            var o2 = a2[i2], s2 = o2[0], u2 = o2[1], l2 = n2[n2.length - 1];
            n2.push({fixed: s2 - l2.stretch, stretch: l2.stretch}), n2.push({fixed: s2 - l2.stretch, stretch: l2.stretch + (u2 - s2)});
          }
          return n2.push({fixed: e2 + 1, stretch: r2}), n2;
        }
        function Yu(t2, e2, r2, n2) {
          return t2 / e2 * r2 + n2;
        }
        function $u(t2, e2, r2, n2) {
          return t2 - e2 * r2 / n2;
        }
        var Wu = function(t2, e2, r2, n2, a2, o2, s2, u2, l2, p2) {
          if (this.boxStartIndex = t2.length, l2) {
            var c2 = o2.top, h2 = o2.bottom, f2 = o2.collisionPadding;
            f2 && (c2 -= f2[1], h2 += f2[3]);
            var y2 = h2 - c2;
            y2 > 0 && (y2 = Math.max(10, y2), this.circleDiameter = y2);
          } else {
            var d2 = o2.top * s2 - u2, m2 = o2.bottom * s2 + u2, v2 = o2.left * s2 - u2, g2 = o2.right * s2 + u2, x2 = o2.collisionPadding;
            if (x2 && (v2 -= x2[0] * s2, d2 -= x2[1] * s2, g2 += x2[2] * s2, m2 += x2[3] * s2), p2) {
              var b2 = new i(v2, d2), w2 = new i(g2, d2), _2 = new i(v2, m2), A2 = new i(g2, m2), S2 = p2 * Math.PI / 180;
              b2._rotate(S2), w2._rotate(S2), _2._rotate(S2), A2._rotate(S2), v2 = Math.min(b2.x, w2.x, _2.x, A2.x), g2 = Math.max(b2.x, w2.x, _2.x, A2.x), d2 = Math.min(b2.y, w2.y, _2.y, A2.y), m2 = Math.max(b2.y, w2.y, _2.y, A2.y);
            }
            t2.emplaceBack(e2.x, e2.y, v2, d2, g2, m2, r2, n2, a2);
          }
          this.boxEndIndex = t2.length;
        }, Qu = function(t2, e2) {
          if (t2 === void 0 && (t2 = []), e2 === void 0 && (e2 = tl), this.data = t2, this.length = this.data.length, this.compare = e2, this.length > 0)
            for (var r2 = (this.length >> 1) - 1; r2 >= 0; r2--)
              this._down(r2);
        };
        function tl(t2, e2) {
          return t2 < e2 ? -1 : t2 > e2 ? 1 : 0;
        }
        function el(t2, e2, r2) {
          e2 === void 0 && (e2 = 1), r2 === void 0 && (r2 = false);
          for (var n2 = 1 / 0, a2 = 1 / 0, o2 = -1 / 0, s2 = -1 / 0, u2 = t2[0], l2 = 0; l2 < u2.length; l2++) {
            var p2 = u2[l2];
            (!l2 || p2.x < n2) && (n2 = p2.x), (!l2 || p2.y < a2) && (a2 = p2.y), (!l2 || p2.x > o2) && (o2 = p2.x), (!l2 || p2.y > s2) && (s2 = p2.y);
          }
          var c2 = Math.min(o2 - n2, s2 - a2), h2 = c2 / 2, f2 = new Qu([], rl);
          if (c2 === 0)
            return new i(n2, a2);
          for (var y2 = n2; y2 < o2; y2 += c2)
            for (var d2 = a2; d2 < s2; d2 += c2)
              f2.push(new nl(y2 + h2, d2 + h2, h2, t2));
          for (var m2 = function(t3) {
            for (var e3 = 0, r3 = 0, n3 = 0, i2 = t3[0], a3 = 0, o3 = i2.length, s3 = o3 - 1; a3 < o3; s3 = a3++) {
              var u3 = i2[a3], l3 = i2[s3], p3 = u3.x * l3.y - l3.x * u3.y;
              r3 += (u3.x + l3.x) * p3, n3 += (u3.y + l3.y) * p3, e3 += 3 * p3;
            }
            return new nl(r3 / e3, n3 / e3, 0, t3);
          }(t2), v2 = f2.length; f2.length; ) {
            var g2 = f2.pop();
            (g2.d > m2.d || !m2.d) && (m2 = g2, r2 && console.log("found best %d after %d probes", Math.round(1e4 * g2.d) / 1e4, v2)), g2.max - m2.d <= e2 || (f2.push(new nl(g2.p.x - (h2 = g2.h / 2), g2.p.y - h2, h2, t2)), f2.push(new nl(g2.p.x + h2, g2.p.y - h2, h2, t2)), f2.push(new nl(g2.p.x - h2, g2.p.y + h2, h2, t2)), f2.push(new nl(g2.p.x + h2, g2.p.y + h2, h2, t2)), v2 += 4);
          }
          return r2 && (console.log("num probes: " + v2), console.log("best distance: " + m2.d)), m2.p;
        }
        function rl(t2, e2) {
          return e2.max - t2.max;
        }
        function nl(t2, e2, r2, n2) {
          this.p = new i(t2, e2), this.h = r2, this.d = function(t3, e3) {
            for (var r3 = false, n3 = 1 / 0, i2 = 0; i2 < e3.length; i2++)
              for (var a2 = e3[i2], o2 = 0, s2 = a2.length, u2 = s2 - 1; o2 < s2; u2 = o2++) {
                var l2 = a2[o2], p2 = a2[u2];
                l2.y > t3.y != p2.y > t3.y && t3.x < (p2.x - l2.x) * (t3.y - l2.y) / (p2.y - l2.y) + l2.x && (r3 = !r3), n3 = Math.min(n3, Ya(t3, l2, p2));
              }
            return (r3 ? 1 : -1) * Math.sqrt(n3);
          }(this.p, n2), this.max = this.d + this.h * Math.SQRT2;
        }
        Qu.prototype.push = function(t2) {
          this.data.push(t2), this.length++, this._up(this.length - 1);
        }, Qu.prototype.pop = function() {
          if (this.length !== 0) {
            var t2 = this.data[0], e2 = this.data.pop();
            return this.length--, this.length > 0 && (this.data[0] = e2, this._down(0)), t2;
          }
        }, Qu.prototype.peek = function() {
          return this.data[0];
        }, Qu.prototype._up = function(t2) {
          for (var e2 = this.data, r2 = this.compare, n2 = e2[t2]; t2 > 0; ) {
            var i2 = t2 - 1 >> 1, a2 = e2[i2];
            if (r2(n2, a2) >= 0)
              break;
            e2[t2] = a2, t2 = i2;
          }
          e2[t2] = n2;
        }, Qu.prototype._down = function(t2) {
          for (var e2 = this.data, r2 = this.compare, n2 = this.length >> 1, i2 = e2[t2]; t2 < n2; ) {
            var a2 = 1 + (t2 << 1), o2 = e2[a2], s2 = a2 + 1;
            if (s2 < this.length && r2(e2[s2], o2) < 0 && (a2 = s2, o2 = e2[s2]), r2(o2, i2) >= 0)
              break;
            e2[t2] = o2, t2 = a2;
          }
          e2[t2] = i2;
        };
        var il = Number.POSITIVE_INFINITY;
        function al(t2, e2) {
          return e2[1] !== il ? function(t3, e3, r2) {
            var n2 = 0, i2 = 0;
            switch (e3 = Math.abs(e3), r2 = Math.abs(r2), t3) {
              case "top-right":
              case "top-left":
              case "top":
                i2 = r2 - 7;
                break;
              case "bottom-right":
              case "bottom-left":
              case "bottom":
                i2 = 7 - r2;
            }
            switch (t3) {
              case "top-right":
              case "bottom-right":
              case "right":
                n2 = -e3;
                break;
              case "top-left":
              case "bottom-left":
              case "left":
                n2 = e3;
            }
            return [n2, i2];
          }(t2, e2[0], e2[1]) : function(t3, e3) {
            var r2 = 0, n2 = 0;
            e3 < 0 && (e3 = 0);
            var i2 = e3 / Math.sqrt(2);
            switch (t3) {
              case "top-right":
              case "top-left":
                n2 = i2 - 7;
                break;
              case "bottom-right":
              case "bottom-left":
                n2 = 7 - i2;
                break;
              case "bottom":
                n2 = 7 - e3;
                break;
              case "top":
                n2 = e3 - 7;
            }
            switch (t3) {
              case "top-right":
              case "bottom-right":
                r2 = -i2;
                break;
              case "top-left":
              case "bottom-left":
                r2 = i2;
                break;
              case "left":
                r2 = e3;
                break;
              case "right":
                r2 = -e3;
            }
            return [r2, n2];
          }(t2, e2[0]);
        }
        function ol(t2) {
          switch (t2) {
            case "right":
            case "top-right":
            case "bottom-right":
              return "right";
            case "left":
            case "top-left":
            case "bottom-left":
              return "left";
          }
          return "center";
        }
        function sl(t2, e2, r2, n2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2) {
          var m2 = function(t3, e3, r3, n3, a3, o3, s3, u3) {
            for (var l3 = n3.layout.get("text-rotate").evaluate(o3, {}) * Math.PI / 180, p3 = [], c3 = 0, h3 = e3.positionedLines; c3 < h3.length; c3 += 1)
              for (var f3 = h3[c3], y3 = 0, d3 = f3.positionedGlyphs; y3 < d3.length; y3 += 1) {
                var m3 = d3[y3];
                if (m3.rect) {
                  var v3 = m3.rect || {}, g3 = 4, x3 = true, b3 = 1, w2 = 0, _2 = (a3 || u3) && m3.vertical, A2 = m3.metrics.advance * m3.scale / 2;
                  if (u3 && e3.verticalizable && (w2 = f3.lineOffset / 2 - (m3.imageName ? -(24 - m3.metrics.width * m3.scale) / 2 : 24 * (m3.scale - 1))), m3.imageName) {
                    var S2 = s3[m3.imageName];
                    x3 = S2.sdf, g3 = 1 / (b3 = S2.pixelRatio);
                  }
                  var k2 = a3 ? [m3.x + A2, m3.y] : [0, 0], I2 = a3 ? [0, 0] : [m3.x + A2 + r3[0], m3.y + r3[1] - w2], z2 = [0, 0];
                  _2 && (z2 = I2, I2 = [0, 0]);
                  var C2 = (m3.metrics.left - g3) * m3.scale - A2 + I2[0], E2 = (-m3.metrics.top - g3) * m3.scale + I2[1], P2 = C2 + v3.w * m3.scale / b3, M2 = E2 + v3.h * m3.scale / b3, B2 = new i(C2, E2), T2 = new i(P2, E2), V2 = new i(C2, M2), F2 = new i(P2, M2);
                  if (_2) {
                    var D2 = new i(-A2, A2 - -17), L2 = -Math.PI / 2, O2 = 12 - A2, R2 = new i(22 - O2, -(m3.imageName ? O2 : 0)), U2 = new (Function.prototype.bind.apply(i, [null].concat(z2)))();
                    B2._rotateAround(L2, D2)._add(R2)._add(U2), T2._rotateAround(L2, D2)._add(R2)._add(U2), V2._rotateAround(L2, D2)._add(R2)._add(U2), F2._rotateAround(L2, D2)._add(R2)._add(U2);
                  }
                  if (l3) {
                    var j2 = Math.sin(l3), q2 = Math.cos(l3), N2 = [q2, -j2, j2, q2];
                    B2._matMult(N2), T2._matMult(N2), V2._matMult(N2), F2._matMult(N2);
                  }
                  var K2 = new i(0, 0), G2 = new i(0, 0);
                  p3.push({tl: B2, tr: T2, bl: V2, br: F2, tex: v3, writingMode: e3.writingMode, glyphOffset: k2, sectionIndex: m3.sectionIndex, isSDF: x3, pixelOffsetTL: K2, pixelOffsetBR: G2, minFontScaleX: 0, minFontScaleY: 0});
                }
              }
            return p3;
          }(0, r2, u2, a2, o2, s2, n2, t2.allowVerticalPlacement), v2 = t2.textSizeData, g2 = null;
          v2.kind === "source" ? (g2 = [128 * a2.layout.get("text-size").evaluate(s2, {})])[0] > 32640 && A(t2.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".') : v2.kind === "composite" && ((g2 = [128 * y2.compositeTextSizes[0].evaluate(s2, {}, d2), 128 * y2.compositeTextSizes[1].evaluate(s2, {}, d2)])[0] > 32640 || g2[1] > 32640) && A(t2.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".'), t2.addSymbols(t2.text, m2, g2, u2, o2, s2, p2, e2, l2.lineStartIndex, l2.lineLength, f2, d2);
          for (var x2 = 0, b2 = c2; x2 < b2.length; x2 += 1)
            h2[b2[x2]] = t2.text.placedSymbolArray.length - 1;
          return 4 * m2.length;
        }
        function ul(t2) {
          for (var e2 in t2)
            return t2[e2];
          return null;
        }
        function ll(t2, e2, r2, n2) {
          var i2 = t2.compareText;
          if (e2 in i2) {
            for (var a2 = i2[e2], o2 = a2.length - 1; o2 >= 0; o2--)
              if (n2.dist(a2[o2]) < r2)
                return true;
          } else
            i2[e2] = [];
          return i2[e2].push(n2), false;
        }
        var pl = bs.VectorTileFeature.types, cl = [{name: "a_fade_opacity", components: 1, type: "Uint8", offset: 0}];
        function hl(t2, e2, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2, h2) {
          var f2 = s2 ? Math.min(32640, Math.round(s2[0])) : 0, y2 = s2 ? Math.min(32640, Math.round(s2[1])) : 0;
          t2.emplaceBack(e2, r2, Math.round(32 * n2), Math.round(32 * i2), a2, o2, (f2 << 1) + (u2 ? 1 : 0), y2, 16 * l2, 16 * p2, 256 * c2, 256 * h2);
        }
        function fl(t2, e2, r2) {
          t2.emplaceBack(e2.x, e2.y, r2), t2.emplaceBack(e2.x, e2.y, r2), t2.emplaceBack(e2.x, e2.y, r2), t2.emplaceBack(e2.x, e2.y, r2);
        }
        function yl(t2) {
          for (var e2 = 0, r2 = t2.sections; e2 < r2.length; e2 += 1)
            if ($n(r2[e2].text))
              return true;
          return false;
        }
        var dl = function(t2) {
          this.layoutVertexArray = new Vi(), this.indexArray = new ji(), this.programConfigurations = t2, this.segments = new sa(), this.dynamicLayoutVertexArray = new Fi(), this.opacityVertexArray = new Di(), this.placedSymbolArray = new Qi();
        };
        dl.prototype.isEmpty = function() {
          return this.layoutVertexArray.length === 0 && this.indexArray.length === 0 && this.dynamicLayoutVertexArray.length === 0 && this.opacityVertexArray.length === 0;
        }, dl.prototype.upload = function(t2, e2, r2, n2) {
          this.isEmpty() || (r2 && (this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, js.members), this.indexBuffer = t2.createIndexBuffer(this.indexArray, e2), this.dynamicLayoutVertexBuffer = t2.createVertexBuffer(this.dynamicLayoutVertexArray, qs.members, true), this.opacityVertexBuffer = t2.createVertexBuffer(this.opacityVertexArray, cl, true), this.opacityVertexBuffer.itemSize = 1), (r2 || n2) && this.programConfigurations.upload(t2));
        }, dl.prototype.destroy = function() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy());
        }, On("SymbolBuffers", dl);
        var ml = function(t2, e2, r2) {
          this.layoutVertexArray = new t2(), this.layoutAttributes = e2, this.indexArray = new r2(), this.segments = new sa(), this.collisionVertexArray = new Ui();
        };
        ml.prototype.upload = function(t2) {
          this.layoutVertexBuffer = t2.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t2.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t2.createVertexBuffer(this.collisionVertexArray, Ns.members, true);
        }, ml.prototype.destroy = function() {
          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy());
        }, On("CollisionBuffers", ml);
        var vl = function(t2) {
          this.collisionBoxArray = t2.collisionBoxArray, this.zoom = t2.zoom, this.overscaling = t2.overscaling, this.layers = t2.layers, this.layerIds = this.layers.map(function(t3) {
            return t3.id;
          }), this.index = t2.index, this.pixelRatio = t2.pixelRatio, this.sourceLayerIndex = t2.sourceLayerIndex, this.hasPattern = false, this.hasRTLText = false, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = oo([]), this.placementViewportMatrix = oo([]);
          var e2 = this.layers[0]._unevaluatedLayout._values;
          this.textSizeData = Du(this.zoom, e2["text-size"]), this.iconSizeData = Du(this.zoom, e2["icon-size"]);
          var r2 = this.layers[0].layout, n2 = r2.get("symbol-sort-key"), i2 = r2.get("symbol-z-order");
          this.canOverlap = r2.get("text-allow-overlap") || r2.get("icon-allow-overlap") || r2.get("text-ignore-placement") || r2.get("icon-ignore-placement"), this.sortFeaturesByKey = i2 !== "viewport-y" && n2.constantOr(1) !== void 0, this.sortFeaturesByY = (i2 === "viewport-y" || i2 === "auto" && !this.sortFeaturesByKey) && this.canOverlap, r2.get("symbol-placement") === "point" && (this.writingModes = r2.get("text-writing-mode").map(function(t3) {
            return wu[t3];
          })), this.stateDependentLayerIds = this.layers.filter(function(t3) {
            return t3.isStateDependent();
          }).map(function(t3) {
            return t3.id;
          }), this.sourceID = t2.sourceID;
        };
        vl.prototype.createArrays = function() {
          this.text = new dl(new Va(this.layers, this.zoom, function(t2) {
            return /^text/.test(t2);
          })), this.icon = new dl(new Va(this.layers, this.zoom, function(t2) {
            return /^icon/.test(t2);
          })), this.glyphOffsetArray = new ra(), this.lineVertexArray = new na(), this.symbolInstances = new ea();
        }, vl.prototype.calculateGlyphDependencies = function(t2, e2, r2, n2, i2) {
          for (var a2 = 0; a2 < t2.length; a2++)
            if (e2[t2.charCodeAt(a2)] = true, (r2 || n2) && i2) {
              var o2 = Xs[t2.charAt(a2)];
              o2 && (e2[o2.charCodeAt(0)] = true);
            }
        }, vl.prototype.populate = function(t2, e2, r2) {
          var n2 = this.layers[0], i2 = n2.layout, a2 = i2.get("text-font"), o2 = i2.get("text-field"), s2 = i2.get("icon-image"), u2 = (o2.value.kind !== "constant" || o2.value.value instanceof ne && !o2.value.value.isEmpty() || o2.value.value.toString().length > 0) && (a2.value.kind !== "constant" || a2.value.value.length > 0), l2 = s2.value.kind !== "constant" || !!s2.value.value || Object.keys(s2.parameters).length > 0, p2 = i2.get("symbol-sort-key");
          if (this.features = [], u2 || l2) {
            for (var c2 = e2.iconDependencies, h2 = e2.glyphDependencies, f2 = e2.availableImages, y2 = new si(this.zoom), d2 = 0, m2 = t2; d2 < m2.length; d2 += 1) {
              var v2 = m2[d2], g2 = v2.feature, x2 = v2.id, b2 = v2.index, w2 = v2.sourceLayerIndex, _2 = n2._featureFilter.needGeometry, A2 = Ua(g2, _2);
              if (n2._featureFilter.filter(y2, A2, r2)) {
                _2 || (A2.geometry = Ra(g2));
                var S2 = void 0;
                if (u2) {
                  var k2 = n2.getValueAndResolveTokens("text-field", A2, r2, f2), I2 = ne.factory(k2);
                  yl(I2) && (this.hasRTLText = true), (!this.hasRTLText || ii() === "unavailable" || this.hasRTLText && oi.isParsed()) && (S2 = Zs(I2, n2, A2));
                }
                var z2 = void 0;
                if (l2) {
                  var C2 = n2.getValueAndResolveTokens("icon-image", A2, r2, f2);
                  z2 = C2 instanceof ie ? C2 : ie.fromString(C2);
                }
                if (S2 || z2) {
                  var E2 = this.sortFeaturesByKey ? p2.evaluate(A2, {}, r2) : void 0;
                  if (this.features.push({id: x2, text: S2, icon: z2, index: b2, sourceLayerIndex: w2, geometry: A2.geometry, properties: g2.properties, type: pl[g2.type], sortKey: E2}), z2 && (c2[z2.name] = true), S2) {
                    var P2 = a2.evaluate(A2, {}, r2).join(","), M2 = i2.get("text-rotation-alignment") === "map" && i2.get("symbol-placement") !== "point";
                    this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(wu.vertical) >= 0;
                    for (var B2 = 0, T2 = S2.sections; B2 < T2.length; B2 += 1) {
                      var V2 = T2[B2];
                      if (V2.image)
                        c2[V2.image.name] = true;
                      else {
                        var F2 = Zn(S2.toString()), D2 = V2.fontStack || P2, L2 = h2[D2] = h2[D2] || {};
                        this.calculateGlyphDependencies(V2.text, L2, M2, this.allowVerticalPlacement, F2);
                      }
                    }
                  }
                }
              }
            }
            i2.get("symbol-placement") === "line" && (this.features = function(t3) {
              var e3 = {}, r3 = {}, n3 = [], i3 = 0;
              function a3(e4) {
                n3.push(t3[e4]), i3++;
              }
              function o3(t4, e4, i4) {
                var a4 = r3[t4];
                return delete r3[t4], r3[e4] = a4, n3[a4].geometry[0].pop(), n3[a4].geometry[0] = n3[a4].geometry[0].concat(i4[0]), a4;
              }
              function s3(t4, r4, i4) {
                var a4 = e3[r4];
                return delete e3[r4], e3[t4] = a4, n3[a4].geometry[0].shift(), n3[a4].geometry[0] = i4[0].concat(n3[a4].geometry[0]), a4;
              }
              function u3(t4, e4, r4) {
                var n4 = r4 ? e4[0][e4[0].length - 1] : e4[0][0];
                return t4 + ":" + n4.x + ":" + n4.y;
              }
              for (var l3 = 0; l3 < t3.length; l3++) {
                var p3 = t3[l3], c3 = p3.geometry, h3 = p3.text ? p3.text.toString() : null;
                if (h3) {
                  var f3 = u3(h3, c3), y3 = u3(h3, c3, true);
                  if (f3 in r3 && y3 in e3 && r3[f3] !== e3[y3]) {
                    var d3 = s3(f3, y3, c3), m3 = o3(f3, y3, n3[d3].geometry);
                    delete e3[f3], delete r3[y3], r3[u3(h3, n3[m3].geometry, true)] = m3, n3[d3].geometry = null;
                  } else
                    f3 in r3 ? o3(f3, y3, c3) : y3 in e3 ? s3(f3, y3, c3) : (a3(l3), e3[f3] = i3 - 1, r3[y3] = i3 - 1);
                } else
                  a3(l3);
              }
              return n3.filter(function(t4) {
                return t4.geometry;
              });
            }(this.features)), this.sortFeaturesByKey && this.features.sort(function(t3, e3) {
              return t3.sortKey - e3.sortKey;
            });
          }
        }, vl.prototype.update = function(t2, e2, r2) {
          this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t2, e2, this.layers, r2), this.icon.programConfigurations.updatePaintArrays(t2, e2, this.layers, r2));
        }, vl.prototype.isEmpty = function() {
          return this.symbolInstances.length === 0 && !this.hasRTLText;
        }, vl.prototype.uploadPending = function() {
          return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload;
        }, vl.prototype.upload = function(t2) {
          !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t2), this.iconCollisionBox.upload(t2)), this.text.upload(t2, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t2, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = true;
        }, vl.prototype.destroyDebugData = function() {
          this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();
        }, vl.prototype.destroy = function() {
          this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();
        }, vl.prototype.addToLineVertexArray = function(t2, e2) {
          var r2 = this.lineVertexArray.length;
          if (t2.segment !== void 0) {
            for (var n2 = t2.dist(e2[t2.segment + 1]), i2 = t2.dist(e2[t2.segment]), a2 = {}, o2 = t2.segment + 1; o2 < e2.length; o2++)
              a2[o2] = {x: e2[o2].x, y: e2[o2].y, tileUnitDistanceFromAnchor: n2}, o2 < e2.length - 1 && (n2 += e2[o2 + 1].dist(e2[o2]));
            for (var s2 = t2.segment || 0; s2 >= 0; s2--)
              a2[s2] = {x: e2[s2].x, y: e2[s2].y, tileUnitDistanceFromAnchor: i2}, s2 > 0 && (i2 += e2[s2 - 1].dist(e2[s2]));
            for (var u2 = 0; u2 < e2.length; u2++) {
              var l2 = a2[u2];
              this.lineVertexArray.emplaceBack(l2.x, l2.y, l2.tileUnitDistanceFromAnchor);
            }
          }
          return {lineStartIndex: r2, lineLength: this.lineVertexArray.length - r2};
        }, vl.prototype.addSymbols = function(t2, e2, r2, n2, i2, a2, o2, s2, u2, l2, p2, c2) {
          for (var h2 = t2.indexArray, f2 = t2.layoutVertexArray, y2 = t2.segments.prepareSegment(4 * e2.length, f2, h2, this.canOverlap ? a2.sortKey : void 0), d2 = this.glyphOffsetArray.length, m2 = y2.vertexLength, v2 = this.allowVerticalPlacement && o2 === wu.vertical ? Math.PI / 2 : 0, g2 = a2.text && a2.text.sections, x2 = 0; x2 < e2.length; x2++) {
            var b2 = e2[x2], w2 = b2.tl, _2 = b2.tr, A2 = b2.bl, S2 = b2.br, k2 = b2.tex, I2 = b2.pixelOffsetTL, z2 = b2.pixelOffsetBR, C2 = b2.minFontScaleX, E2 = b2.minFontScaleY, P2 = b2.glyphOffset, M2 = b2.isSDF, B2 = b2.sectionIndex, T2 = y2.vertexLength, V2 = P2[1];
            hl(f2, s2.x, s2.y, w2.x, V2 + w2.y, k2.x, k2.y, r2, M2, I2.x, I2.y, C2, E2), hl(f2, s2.x, s2.y, _2.x, V2 + _2.y, k2.x + k2.w, k2.y, r2, M2, z2.x, I2.y, C2, E2), hl(f2, s2.x, s2.y, A2.x, V2 + A2.y, k2.x, k2.y + k2.h, r2, M2, I2.x, z2.y, C2, E2), hl(f2, s2.x, s2.y, S2.x, V2 + S2.y, k2.x + k2.w, k2.y + k2.h, r2, M2, z2.x, z2.y, C2, E2), fl(t2.dynamicLayoutVertexArray, s2, v2), h2.emplaceBack(T2, T2 + 1, T2 + 2), h2.emplaceBack(T2 + 1, T2 + 2, T2 + 3), y2.vertexLength += 4, y2.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(P2[0]), x2 !== e2.length - 1 && B2 === e2[x2 + 1].sectionIndex || t2.programConfigurations.populatePaintArrays(f2.length, a2, a2.index, {}, c2, g2 && g2[B2]);
          }
          t2.placedSymbolArray.emplaceBack(s2.x, s2.y, d2, this.glyphOffsetArray.length - d2, m2, u2, l2, s2.segment, r2 ? r2[0] : 0, r2 ? r2[1] : 0, n2[0], n2[1], o2, 0, false, 0, p2);
        }, vl.prototype._addCollisionDebugVertex = function(t2, e2, r2, n2, i2, a2) {
          return e2.emplaceBack(0, 0), t2.emplaceBack(r2.x, r2.y, n2, i2, Math.round(a2.x), Math.round(a2.y));
        }, vl.prototype.addCollisionDebugVertices = function(t2, e2, r2, n2, a2, o2, s2) {
          var u2 = a2.segments.prepareSegment(4, a2.layoutVertexArray, a2.indexArray), l2 = u2.vertexLength, p2 = a2.layoutVertexArray, c2 = a2.collisionVertexArray, h2 = s2.anchorX, f2 = s2.anchorY;
          this._addCollisionDebugVertex(p2, c2, o2, h2, f2, new i(t2, e2)), this._addCollisionDebugVertex(p2, c2, o2, h2, f2, new i(r2, e2)), this._addCollisionDebugVertex(p2, c2, o2, h2, f2, new i(r2, n2)), this._addCollisionDebugVertex(p2, c2, o2, h2, f2, new i(t2, n2)), u2.vertexLength += 4;
          var y2 = a2.indexArray;
          y2.emplaceBack(l2, l2 + 1), y2.emplaceBack(l2 + 1, l2 + 2), y2.emplaceBack(l2 + 2, l2 + 3), y2.emplaceBack(l2 + 3, l2), u2.primitiveLength += 4;
        }, vl.prototype.addDebugCollisionBoxes = function(t2, e2, r2, n2) {
          for (var i2 = t2; i2 < e2; i2++) {
            var a2 = this.collisionBoxArray.get(i2);
            this.addCollisionDebugVertices(a2.x1, a2.y1, a2.x2, a2.y2, n2 ? this.textCollisionBox : this.iconCollisionBox, a2.anchorPoint, r2);
          }
        }, vl.prototype.generateCollisionDebugBuffers = function() {
          this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new ml(Oi, Ks.members, Xi), this.iconCollisionBox = new ml(Oi, Ks.members, Xi);
          for (var t2 = 0; t2 < this.symbolInstances.length; t2++) {
            var e2 = this.symbolInstances.get(t2);
            this.addDebugCollisionBoxes(e2.textBoxStartIndex, e2.textBoxEndIndex, e2, true), this.addDebugCollisionBoxes(e2.verticalTextBoxStartIndex, e2.verticalTextBoxEndIndex, e2, true), this.addDebugCollisionBoxes(e2.iconBoxStartIndex, e2.iconBoxEndIndex, e2, false), this.addDebugCollisionBoxes(e2.verticalIconBoxStartIndex, e2.verticalIconBoxEndIndex, e2, false);
          }
        }, vl.prototype._deserializeCollisionBoxesForSymbol = function(t2, e2, r2, n2, i2, a2, o2, s2, u2) {
          for (var l2 = {}, p2 = e2; p2 < r2; p2++) {
            var c2 = t2.get(p2);
            l2.textBox = {x1: c2.x1, y1: c2.y1, x2: c2.x2, y2: c2.y2, anchorPointX: c2.anchorPointX, anchorPointY: c2.anchorPointY}, l2.textFeatureIndex = c2.featureIndex;
            break;
          }
          for (var h2 = n2; h2 < i2; h2++) {
            var f2 = t2.get(h2);
            l2.verticalTextBox = {x1: f2.x1, y1: f2.y1, x2: f2.x2, y2: f2.y2, anchorPointX: f2.anchorPointX, anchorPointY: f2.anchorPointY}, l2.verticalTextFeatureIndex = f2.featureIndex;
            break;
          }
          for (var y2 = a2; y2 < o2; y2++) {
            var d2 = t2.get(y2);
            l2.iconBox = {x1: d2.x1, y1: d2.y1, x2: d2.x2, y2: d2.y2, anchorPointX: d2.anchorPointX, anchorPointY: d2.anchorPointY}, l2.iconFeatureIndex = d2.featureIndex;
            break;
          }
          for (var m2 = s2; m2 < u2; m2++) {
            var v2 = t2.get(m2);
            l2.verticalIconBox = {x1: v2.x1, y1: v2.y1, x2: v2.x2, y2: v2.y2, anchorPointX: v2.anchorPointX, anchorPointY: v2.anchorPointY}, l2.verticalIconFeatureIndex = v2.featureIndex;
            break;
          }
          return l2;
        }, vl.prototype.deserializeCollisionBoxes = function(t2) {
          this.collisionArrays = [];
          for (var e2 = 0; e2 < this.symbolInstances.length; e2++) {
            var r2 = this.symbolInstances.get(e2);
            this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t2, r2.textBoxStartIndex, r2.textBoxEndIndex, r2.verticalTextBoxStartIndex, r2.verticalTextBoxEndIndex, r2.iconBoxStartIndex, r2.iconBoxEndIndex, r2.verticalIconBoxStartIndex, r2.verticalIconBoxEndIndex));
          }
        }, vl.prototype.hasTextData = function() {
          return this.text.segments.get().length > 0;
        }, vl.prototype.hasIconData = function() {
          return this.icon.segments.get().length > 0;
        }, vl.prototype.hasDebugData = function() {
          return this.textCollisionBox && this.iconCollisionBox;
        }, vl.prototype.hasTextCollisionBoxData = function() {
          return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0;
        }, vl.prototype.hasIconCollisionBoxData = function() {
          return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0;
        }, vl.prototype.addIndicesForPlacedSymbol = function(t2, e2) {
          for (var r2 = t2.placedSymbolArray.get(e2), n2 = r2.vertexStartIndex + 4 * r2.numGlyphs, i2 = r2.vertexStartIndex; i2 < n2; i2 += 4)
            t2.indexArray.emplaceBack(i2, i2 + 1, i2 + 2), t2.indexArray.emplaceBack(i2 + 1, i2 + 2, i2 + 3);
        }, vl.prototype.getSortedSymbolIndexes = function(t2) {
          if (this.sortedAngle === t2 && this.symbolInstanceIndexes !== void 0)
            return this.symbolInstanceIndexes;
          for (var e2 = Math.sin(t2), r2 = Math.cos(t2), n2 = [], i2 = [], a2 = [], o2 = 0; o2 < this.symbolInstances.length; ++o2) {
            a2.push(o2);
            var s2 = this.symbolInstances.get(o2);
            n2.push(0 | Math.round(e2 * s2.anchorX + r2 * s2.anchorY)), i2.push(s2.featureIndex);
          }
          return a2.sort(function(t3, e3) {
            return n2[t3] - n2[e3] || i2[e3] - i2[t3];
          }), a2;
        }, vl.prototype.addToSortKeyRanges = function(t2, e2) {
          var r2 = this.sortKeyRanges[this.sortKeyRanges.length - 1];
          r2 && r2.sortKey === e2 ? r2.symbolInstanceEnd = t2 + 1 : this.sortKeyRanges.push({sortKey: e2, symbolInstanceStart: t2, symbolInstanceEnd: t2 + 1});
        }, vl.prototype.sortFeatures = function(t2) {
          var e2 = this;
          if (this.sortFeaturesByY && this.sortedAngle !== t2 && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
            this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t2), this.sortedAngle = t2, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];
            for (var r2 = 0, n2 = this.symbolInstanceIndexes; r2 < n2.length; r2 += 1) {
              var i2 = this.symbolInstances.get(n2[r2]);
              this.featureSortOrder.push(i2.featureIndex), [i2.rightJustifiedTextSymbolIndex, i2.centerJustifiedTextSymbolIndex, i2.leftJustifiedTextSymbolIndex].forEach(function(t3, r3, n3) {
                t3 >= 0 && n3.indexOf(t3) === r3 && e2.addIndicesForPlacedSymbol(e2.text, t3);
              }), i2.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, i2.verticalPlacedTextSymbolIndex), i2.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, i2.placedIconSymbolIndex), i2.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, i2.verticalPlacedIconSymbolIndex);
            }
            this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);
          }
        }, On("SymbolBucket", vl, {omit: ["layers", "collisionBoxArray", "features", "compareText"]}), vl.MAX_GLYPHS = 65535, vl.addDynamicAttributes = fl;
        var gl = new wi({"symbol-placement": new mi(Et.layout_symbol["symbol-placement"]), "symbol-spacing": new mi(Et.layout_symbol["symbol-spacing"]), "symbol-avoid-edges": new mi(Et.layout_symbol["symbol-avoid-edges"]), "symbol-sort-key": new vi(Et.layout_symbol["symbol-sort-key"]), "symbol-z-order": new mi(Et.layout_symbol["symbol-z-order"]), "icon-allow-overlap": new mi(Et.layout_symbol["icon-allow-overlap"]), "icon-ignore-placement": new mi(Et.layout_symbol["icon-ignore-placement"]), "icon-optional": new mi(Et.layout_symbol["icon-optional"]), "icon-rotation-alignment": new mi(Et.layout_symbol["icon-rotation-alignment"]), "icon-size": new vi(Et.layout_symbol["icon-size"]), "icon-text-fit": new mi(Et.layout_symbol["icon-text-fit"]), "icon-text-fit-padding": new mi(Et.layout_symbol["icon-text-fit-padding"]), "icon-image": new vi(Et.layout_symbol["icon-image"]), "icon-rotate": new vi(Et.layout_symbol["icon-rotate"]), "icon-padding": new mi(Et.layout_symbol["icon-padding"]), "icon-keep-upright": new mi(Et.layout_symbol["icon-keep-upright"]), "icon-offset": new vi(Et.layout_symbol["icon-offset"]), "icon-anchor": new vi(Et.layout_symbol["icon-anchor"]), "icon-pitch-alignment": new mi(Et.layout_symbol["icon-pitch-alignment"]), "text-pitch-alignment": new mi(Et.layout_symbol["text-pitch-alignment"]), "text-rotation-alignment": new mi(Et.layout_symbol["text-rotation-alignment"]), "text-field": new vi(Et.layout_symbol["text-field"]), "text-font": new vi(Et.layout_symbol["text-font"]), "text-size": new vi(Et.layout_symbol["text-size"]), "text-max-width": new vi(Et.layout_symbol["text-max-width"]), "text-line-height": new mi(Et.layout_symbol["text-line-height"]), "text-letter-spacing": new vi(Et.layout_symbol["text-letter-spacing"]), "text-justify": new vi(Et.layout_symbol["text-justify"]), "text-radial-offset": new vi(Et.layout_symbol["text-radial-offset"]), "text-variable-anchor": new mi(Et.layout_symbol["text-variable-anchor"]), "text-anchor": new vi(Et.layout_symbol["text-anchor"]), "text-max-angle": new mi(Et.layout_symbol["text-max-angle"]), "text-writing-mode": new mi(Et.layout_symbol["text-writing-mode"]), "text-rotate": new vi(Et.layout_symbol["text-rotate"]), "text-padding": new mi(Et.layout_symbol["text-padding"]), "text-keep-upright": new mi(Et.layout_symbol["text-keep-upright"]), "text-transform": new vi(Et.layout_symbol["text-transform"]), "text-offset": new vi(Et.layout_symbol["text-offset"]), "text-allow-overlap": new mi(Et.layout_symbol["text-allow-overlap"]), "text-ignore-placement": new mi(Et.layout_symbol["text-ignore-placement"]), "text-optional": new mi(Et.layout_symbol["text-optional"])}), xl = {paint: new wi({"icon-opacity": new vi(Et.paint_symbol["icon-opacity"]), "icon-color": new vi(Et.paint_symbol["icon-color"]), "icon-halo-color": new vi(Et.paint_symbol["icon-halo-color"]), "icon-halo-width": new vi(Et.paint_symbol["icon-halo-width"]), "icon-halo-blur": new vi(Et.paint_symbol["icon-halo-blur"]), "icon-translate": new mi(Et.paint_symbol["icon-translate"]), "icon-translate-anchor": new mi(Et.paint_symbol["icon-translate-anchor"]), "text-opacity": new vi(Et.paint_symbol["text-opacity"]), "text-color": new vi(Et.paint_symbol["text-color"], {runtimeType: jt, getOverride: function(t2) {
          return t2.textColor;
        }, hasOverride: function(t2) {
          return !!t2.textColor;
        }}), "text-halo-color": new vi(Et.paint_symbol["text-halo-color"]), "text-halo-width": new vi(Et.paint_symbol["text-halo-width"]), "text-halo-blur": new vi(Et.paint_symbol["text-halo-blur"]), "text-translate": new mi(Et.paint_symbol["text-translate"]), "text-translate-anchor": new mi(Et.paint_symbol["text-translate-anchor"])}), layout: gl}, bl = function(t2) {
          this.type = t2.property.overrides ? t2.property.overrides.runtimeType : Lt, this.defaultValue = t2;
        };
        bl.prototype.evaluate = function(t2) {
          if (t2.formattedSection) {
            var e2 = this.defaultValue.property.overrides;
            if (e2 && e2.hasOverride(t2.formattedSection))
              return e2.getOverride(t2.formattedSection);
          }
          return t2.feature && t2.featureState ? this.defaultValue.evaluate(t2.feature, t2.featureState) : this.defaultValue.property.specification.default;
        }, bl.prototype.eachChild = function(t2) {
          this.defaultValue.isConstant() || t2(this.defaultValue.value._styleExpression.expression);
        }, bl.prototype.outputDefined = function() {
          return false;
        }, bl.prototype.serialize = function() {
          return null;
        }, On("FormatSectionOverride", bl, {omit: ["defaultValue"]});
        var wl = function(t2) {
          function e2(e3) {
            t2.call(this, e3, xl);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.recalculate = function(e3, r2) {
            if (t2.prototype.recalculate.call(this, e3, r2), this.layout.get("icon-rotation-alignment") === "auto" && (this.layout._values["icon-rotation-alignment"] = this.layout.get("symbol-placement") !== "point" ? "map" : "viewport"), this.layout.get("text-rotation-alignment") === "auto" && (this.layout._values["text-rotation-alignment"] = this.layout.get("symbol-placement") !== "point" ? "map" : "viewport"), this.layout.get("text-pitch-alignment") === "auto" && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")), this.layout.get("icon-pitch-alignment") === "auto" && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")), this.layout.get("symbol-placement") === "point") {
              var n2 = this.layout.get("text-writing-mode");
              if (n2) {
                for (var i2 = [], a2 = 0, o2 = n2; a2 < o2.length; a2 += 1) {
                  var s2 = o2[a2];
                  i2.indexOf(s2) < 0 && i2.push(s2);
                }
                this.layout._values["text-writing-mode"] = i2;
              } else
                this.layout._values["text-writing-mode"] = ["horizontal"];
            }
            this._setPaintOverrides();
          }, e2.prototype.getValueAndResolveTokens = function(t3, e3, r2, n2) {
            var i2 = this.layout.get(t3).evaluate(e3, {}, r2, n2), a2 = this._unevaluatedLayout._values[t3];
            return a2.isDataDriven() || Gr(a2.value) || !i2 ? i2 : function(t4, e4) {
              return e4.replace(/{([^{}]+)}/g, function(e5, r3) {
                return r3 in t4 ? String(t4[r3]) : "";
              });
            }(e3.properties, i2);
          }, e2.prototype.createBucket = function(t3) {
            return new vl(t3);
          }, e2.prototype.queryRadius = function() {
            return 0;
          }, e2.prototype.queryIntersectsFeature = function() {
            return false;
          }, e2.prototype._setPaintOverrides = function() {
            for (var t3 = 0, r2 = xl.paint.overridableProperties; t3 < r2.length; t3 += 1) {
              var n2 = r2[t3];
              if (e2.hasPaintOverride(this.layout, n2)) {
                var i2, a2 = this.paint.get(n2), o2 = new bl(a2), s2 = new Kr(o2, a2.property.specification);
                i2 = a2.value.kind === "constant" || a2.value.kind === "source" ? new Xr("source", s2) : new Jr("composite", s2, a2.value.zoomStops, a2.value._interpolationType), this.paint._values[n2] = new yi(a2.property, i2, a2.parameters);
              }
            }
          }, e2.prototype._handleOverridablePaintPropertyUpdate = function(t3, r2, n2) {
            return !(!this.layout || r2.isDataDriven() || n2.isDataDriven()) && e2.hasPaintOverride(this.layout, t3);
          }, e2.hasPaintOverride = function(t3, e3) {
            var r2 = t3.get("text-field"), n2 = xl.paint.properties[e3], i2 = false, a2 = function(t4) {
              for (var e4 = 0, r3 = t4; e4 < r3.length; e4 += 1)
                if (n2.overrides && n2.overrides.hasOverride(r3[e4]))
                  return void (i2 = true);
            };
            if (r2.value.kind === "constant" && r2.value.value instanceof ne)
              a2(r2.value.value.sections);
            else if (r2.value.kind === "source") {
              var o2 = function(t4) {
                i2 || (t4 instanceof le && se(t4.value) === Gt ? a2(t4.value.sections) : t4 instanceof fe ? a2(t4.sections) : t4.eachChild(o2));
              }, s2 = r2.value;
              s2._styleExpression && o2(s2._styleExpression.expression);
            }
            return i2;
          }, e2;
        }(_i), _l = {paint: new wi({"background-color": new mi(Et.paint_background["background-color"]), "background-pattern": new xi(Et.paint_background["background-pattern"]), "background-opacity": new mi(Et.paint_background["background-opacity"])})}, Al = function(t2) {
          function e2(e3) {
            t2.call(this, e3, _l);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2;
        }(_i), Sl = {paint: new wi({"raster-opacity": new mi(Et.paint_raster["raster-opacity"]), "raster-hue-rotate": new mi(Et.paint_raster["raster-hue-rotate"]), "raster-brightness-min": new mi(Et.paint_raster["raster-brightness-min"]), "raster-brightness-max": new mi(Et.paint_raster["raster-brightness-max"]), "raster-saturation": new mi(Et.paint_raster["raster-saturation"]), "raster-contrast": new mi(Et.paint_raster["raster-contrast"]), "raster-resampling": new mi(Et.paint_raster["raster-resampling"]), "raster-fade-duration": new mi(Et.paint_raster["raster-fade-duration"])})}, kl = function(t2) {
          function e2(e3) {
            t2.call(this, e3, Sl);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2;
        }(_i), Il = function(t2) {
          function e2(e3) {
            t2.call(this, e3, {}), this.implementation = e3;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.is3D = function() {
            return this.implementation.renderingMode === "3d";
          }, e2.prototype.hasOffscreenPass = function() {
            return this.implementation.prerender !== void 0;
          }, e2.prototype.recalculate = function() {
          }, e2.prototype.updateTransitions = function() {
          }, e2.prototype.hasTransition = function() {
          }, e2.prototype.serialize = function() {
          }, e2.prototype.onAdd = function(t3) {
            this.implementation.onAdd && this.implementation.onAdd(t3, t3.painter.context.gl);
          }, e2.prototype.onRemove = function(t3) {
            this.implementation.onRemove && this.implementation.onRemove(t3, t3.painter.context.gl);
          }, e2;
        }(_i), zl = {circle: co, heatmap: _o, hillshade: So, fill: ps, "fill-extrusion": zs, line: Rs, symbol: wl, background: Al, raster: kl}, Cl = o.HTMLImageElement, El = o.HTMLCanvasElement, Pl = o.HTMLVideoElement, Ml = o.ImageData, Bl = o.ImageBitmap, Tl = function(t2, e2, r2, n2) {
          this.context = t2, this.format = r2, this.texture = t2.gl.createTexture(), this.update(e2, n2);
        };
        Tl.prototype.update = function(t2, e2, r2) {
          var n2 = t2.width, i2 = t2.height, a2 = !(this.size && this.size[0] === n2 && this.size[1] === i2 || r2), o2 = this.context, s2 = o2.gl;
          if (this.useMipmap = Boolean(e2 && e2.useMipmap), s2.bindTexture(s2.TEXTURE_2D, this.texture), o2.pixelStoreUnpackFlipY.set(false), o2.pixelStoreUnpack.set(1), o2.pixelStoreUnpackPremultiplyAlpha.set(this.format === s2.RGBA && (!e2 || e2.premultiply !== false)), a2)
            this.size = [n2, i2], t2 instanceof Cl || t2 instanceof El || t2 instanceof Pl || t2 instanceof Ml || Bl && t2 instanceof Bl ? s2.texImage2D(s2.TEXTURE_2D, 0, this.format, this.format, s2.UNSIGNED_BYTE, t2) : s2.texImage2D(s2.TEXTURE_2D, 0, this.format, n2, i2, 0, this.format, s2.UNSIGNED_BYTE, t2.data);
          else {
            var u2 = r2 || {x: 0, y: 0}, l2 = u2.x, p2 = u2.y;
            t2 instanceof Cl || t2 instanceof El || t2 instanceof Pl || t2 instanceof Ml || Bl && t2 instanceof Bl ? s2.texSubImage2D(s2.TEXTURE_2D, 0, l2, p2, s2.RGBA, s2.UNSIGNED_BYTE, t2) : s2.texSubImage2D(s2.TEXTURE_2D, 0, l2, p2, n2, i2, s2.RGBA, s2.UNSIGNED_BYTE, t2.data);
          }
          this.useMipmap && this.isSizePowerOfTwo() && s2.generateMipmap(s2.TEXTURE_2D);
        }, Tl.prototype.bind = function(t2, e2, r2) {
          var n2 = this.context.gl;
          n2.bindTexture(n2.TEXTURE_2D, this.texture), r2 !== n2.LINEAR_MIPMAP_NEAREST || this.isSizePowerOfTwo() || (r2 = n2.LINEAR), t2 !== this.filter && (n2.texParameteri(n2.TEXTURE_2D, n2.TEXTURE_MAG_FILTER, t2), n2.texParameteri(n2.TEXTURE_2D, n2.TEXTURE_MIN_FILTER, r2 || t2), this.filter = t2), e2 !== this.wrap && (n2.texParameteri(n2.TEXTURE_2D, n2.TEXTURE_WRAP_S, e2), n2.texParameteri(n2.TEXTURE_2D, n2.TEXTURE_WRAP_T, e2), this.wrap = e2);
        }, Tl.prototype.isSizePowerOfTwo = function() {
          return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0;
        }, Tl.prototype.destroy = function() {
          this.context.gl.deleteTexture(this.texture), this.texture = null;
        };
        var Vl = function(t2) {
          var e2 = this;
          this._callback = t2, this._triggered = false, typeof MessageChannel != "undefined" && (this._channel = new MessageChannel(), this._channel.port2.onmessage = function() {
            e2._triggered = false, e2._callback();
          });
        };
        Vl.prototype.trigger = function() {
          var t2 = this;
          this._triggered || (this._triggered = true, this._channel ? this._channel.port1.postMessage(true) : setTimeout(function() {
            t2._triggered = false, t2._callback();
          }, 0));
        }, Vl.prototype.remove = function() {
          delete this._channel, this._callback = function() {
          };
        };
        var Fl = function(t2, e2, r2) {
          this.target = t2, this.parent = e2, this.mapId = r2, this.callbacks = {}, this.tasks = {}, this.taskQueue = [], this.cancelCallbacks = {}, v(["receive", "process"], this), this.invoker = new Vl(this.process), this.target.addEventListener("message", this.receive, false), this.globalScope = I() ? t2 : o;
        };
        function Dl(t2, e2, r2) {
          var n2 = 2 * Math.PI * 6378137 / 256 / Math.pow(2, r2);
          return [t2 * n2 - 2 * Math.PI * 6378137 / 2, e2 * n2 - 2 * Math.PI * 6378137 / 2];
        }
        Fl.prototype.send = function(t2, e2, r2, n2, i2) {
          var a2 = this;
          i2 === void 0 && (i2 = false);
          var o2 = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
          r2 && (this.callbacks[o2] = r2);
          var s2 = E(this.globalScope) ? void 0 : [];
          return this.target.postMessage({id: o2, type: t2, hasCallback: !!r2, targetMapId: n2, mustQueue: i2, sourceMapId: this.mapId, data: qn(e2, s2)}, s2), {cancel: function() {
            r2 && delete a2.callbacks[o2], a2.target.postMessage({id: o2, type: "<cancel>", targetMapId: n2, sourceMapId: a2.mapId});
          }};
        }, Fl.prototype.receive = function(t2) {
          var e2 = t2.data, r2 = e2.id;
          if (r2 && (!e2.targetMapId || this.mapId === e2.targetMapId))
            if (e2.type === "<cancel>") {
              delete this.tasks[r2];
              var n2 = this.cancelCallbacks[r2];
              delete this.cancelCallbacks[r2], n2 && n2();
            } else
              I() || e2.mustQueue ? (this.tasks[r2] = e2, this.taskQueue.push(r2), this.invoker.trigger()) : this.processTask(r2, e2);
        }, Fl.prototype.process = function() {
          if (this.taskQueue.length) {
            var t2 = this.taskQueue.shift(), e2 = this.tasks[t2];
            delete this.tasks[t2], this.taskQueue.length && this.invoker.trigger(), e2 && this.processTask(t2, e2);
          }
        }, Fl.prototype.processTask = function(t2, e2) {
          var r2 = this;
          if (e2.type === "<response>") {
            var n2 = this.callbacks[t2];
            delete this.callbacks[t2], n2 && (e2.error ? n2(Nn(e2.error)) : n2(null, Nn(e2.data)));
          } else {
            var i2 = false, a2 = E(this.globalScope) ? void 0 : [], o2 = e2.hasCallback ? function(e3, n3) {
              i2 = true, delete r2.cancelCallbacks[t2], r2.target.postMessage({id: t2, type: "<response>", sourceMapId: r2.mapId, error: e3 ? qn(e3) : null, data: qn(n3, a2)}, a2);
            } : function(t3) {
              i2 = true;
            }, s2 = null, u2 = Nn(e2.data);
            if (this.parent[e2.type])
              s2 = this.parent[e2.type](e2.sourceMapId, u2, o2);
            else if (this.parent.getWorkerSource) {
              var l2 = e2.type.split(".");
              s2 = this.parent.getWorkerSource(e2.sourceMapId, l2[0], u2.source)[l2[1]](u2, o2);
            } else
              o2(new Error("Could not find function " + e2.type));
            !i2 && s2 && s2.cancel && (this.cancelCallbacks[t2] = s2.cancel);
          }
        }, Fl.prototype.remove = function() {
          this.invoker.remove(), this.target.removeEventListener("message", this.receive, false);
        };
        var Ll = function(t2, e2) {
          t2 && (e2 ? this.setSouthWest(t2).setNorthEast(e2) : t2.length === 4 ? this.setSouthWest([t2[0], t2[1]]).setNorthEast([t2[2], t2[3]]) : this.setSouthWest(t2[0]).setNorthEast(t2[1]));
        };
        Ll.prototype.setNorthEast = function(t2) {
          return this._ne = t2 instanceof Ol ? new Ol(t2.lng, t2.lat) : Ol.convert(t2), this;
        }, Ll.prototype.setSouthWest = function(t2) {
          return this._sw = t2 instanceof Ol ? new Ol(t2.lng, t2.lat) : Ol.convert(t2), this;
        }, Ll.prototype.extend = function(t2) {
          var e2, r2, n2 = this._sw, i2 = this._ne;
          if (t2 instanceof Ol)
            e2 = t2, r2 = t2;
          else {
            if (!(t2 instanceof Ll))
              return Array.isArray(t2) ? t2.length === 4 || t2.every(Array.isArray) ? this.extend(Ll.convert(t2)) : this.extend(Ol.convert(t2)) : this;
            if (r2 = t2._ne, !(e2 = t2._sw) || !r2)
              return this;
          }
          return n2 || i2 ? (n2.lng = Math.min(e2.lng, n2.lng), n2.lat = Math.min(e2.lat, n2.lat), i2.lng = Math.max(r2.lng, i2.lng), i2.lat = Math.max(r2.lat, i2.lat)) : (this._sw = new Ol(e2.lng, e2.lat), this._ne = new Ol(r2.lng, r2.lat)), this;
        }, Ll.prototype.getCenter = function() {
          return new Ol((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);
        }, Ll.prototype.getSouthWest = function() {
          return this._sw;
        }, Ll.prototype.getNorthEast = function() {
          return this._ne;
        }, Ll.prototype.getNorthWest = function() {
          return new Ol(this.getWest(), this.getNorth());
        }, Ll.prototype.getSouthEast = function() {
          return new Ol(this.getEast(), this.getSouth());
        }, Ll.prototype.getWest = function() {
          return this._sw.lng;
        }, Ll.prototype.getSouth = function() {
          return this._sw.lat;
        }, Ll.prototype.getEast = function() {
          return this._ne.lng;
        }, Ll.prototype.getNorth = function() {
          return this._ne.lat;
        }, Ll.prototype.toArray = function() {
          return [this._sw.toArray(), this._ne.toArray()];
        }, Ll.prototype.toString = function() {
          return "LngLatBounds(" + this._sw.toString() + ", " + this._ne.toString() + ")";
        }, Ll.prototype.isEmpty = function() {
          return !(this._sw && this._ne);
        }, Ll.prototype.contains = function(t2) {
          var e2 = Ol.convert(t2), r2 = e2.lng, n2 = e2.lat, i2 = this._sw.lng <= r2 && r2 <= this._ne.lng;
          return this._sw.lng > this._ne.lng && (i2 = this._sw.lng >= r2 && r2 >= this._ne.lng), this._sw.lat <= n2 && n2 <= this._ne.lat && i2;
        }, Ll.convert = function(t2) {
          return !t2 || t2 instanceof Ll ? t2 : new Ll(t2);
        };
        var Ol = function(t2, e2) {
          if (isNaN(t2) || isNaN(e2))
            throw new Error("Invalid LngLat object: (" + t2 + ", " + e2 + ")");
          if (this.lng = +t2, this.lat = +e2, this.lat > 90 || this.lat < -90)
            throw new Error("Invalid LngLat latitude value: must be between -90 and 90");
        };
        Ol.prototype.wrap = function() {
          return new Ol(c(this.lng, -180, 180), this.lat);
        }, Ol.prototype.toArray = function() {
          return [this.lng, this.lat];
        }, Ol.prototype.toString = function() {
          return "LngLat(" + this.lng + ", " + this.lat + ")";
        }, Ol.prototype.distanceTo = function(t2) {
          var e2 = Math.PI / 180, r2 = this.lat * e2, n2 = t2.lat * e2, i2 = Math.sin(r2) * Math.sin(n2) + Math.cos(r2) * Math.cos(n2) * Math.cos((t2.lng - this.lng) * e2);
          return 63710088e-1 * Math.acos(Math.min(i2, 1));
        }, Ol.prototype.toBounds = function(t2) {
          t2 === void 0 && (t2 = 0);
          var e2 = 360 * t2 / 40075017, r2 = e2 / Math.cos(Math.PI / 180 * this.lat);
          return new Ll(new Ol(this.lng - r2, this.lat - e2), new Ol(this.lng + r2, this.lat + e2));
        }, Ol.convert = function(t2) {
          if (t2 instanceof Ol)
            return t2;
          if (Array.isArray(t2) && (t2.length === 2 || t2.length === 3))
            return new Ol(Number(t2[0]), Number(t2[1]));
          if (!Array.isArray(t2) && typeof t2 == "object" && t2 !== null)
            return new Ol(Number("lng" in t2 ? t2.lng : t2.lon), Number(t2.lat));
          throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");
        };
        var Rl = 2 * Math.PI * 63710088e-1;
        function Ul(t2) {
          return Rl * Math.cos(t2 * Math.PI / 180);
        }
        function jl(t2) {
          return (180 + t2) / 360;
        }
        function ql(t2) {
          return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t2 * Math.PI / 360))) / 360;
        }
        function Nl(t2, e2) {
          return t2 / Ul(e2);
        }
        function Kl(t2) {
          return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t2) * Math.PI / 180)) - 90;
        }
        var Gl = function(t2, e2, r2) {
          r2 === void 0 && (r2 = 0), this.x = +t2, this.y = +e2, this.z = +r2;
        };
        Gl.fromLngLat = function(t2, e2) {
          e2 === void 0 && (e2 = 0);
          var r2 = Ol.convert(t2);
          return new Gl(jl(r2.lng), ql(r2.lat), Nl(e2, r2.lat));
        }, Gl.prototype.toLngLat = function() {
          return new Ol(360 * this.x - 180, Kl(this.y));
        }, Gl.prototype.toAltitude = function() {
          return this.z * Ul(Kl(this.y));
        }, Gl.prototype.meterInMercatorCoordinateUnits = function() {
          return 1 / Rl * (t2 = Kl(this.y), 1 / Math.cos(t2 * Math.PI / 180));
          var t2;
        };
        var Zl = function(t2, e2, r2) {
          this.z = t2, this.x = e2, this.y = r2, this.key = Hl(0, t2, t2, e2, r2);
        };
        Zl.prototype.equals = function(t2) {
          return this.z === t2.z && this.x === t2.x && this.y === t2.y;
        }, Zl.prototype.url = function(t2, e2) {
          var r2, n2, i2, a2, o2, s2 = (n2 = this.y, i2 = this.z, a2 = Dl(256 * (r2 = this.x), 256 * (n2 = Math.pow(2, i2) - n2 - 1), i2), o2 = Dl(256 * (r2 + 1), 256 * (n2 + 1), i2), a2[0] + "," + a2[1] + "," + o2[0] + "," + o2[1]), u2 = function(t3, e3, r3) {
            for (var n3, i3 = "", a3 = t3; a3 > 0; a3--)
              i3 += (e3 & (n3 = 1 << a3 - 1) ? 1 : 0) + (r3 & n3 ? 2 : 0);
            return i3;
          }(this.z, this.x, this.y);
          return t2[(this.x + this.y) % t2.length].replace("{prefix}", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace("{z}", String(this.z)).replace("{x}", String(this.x)).replace("{y}", String(e2 === "tms" ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace("{quadkey}", u2).replace("{bbox-epsg-3857}", s2);
        }, Zl.prototype.getTilePoint = function(t2) {
          var e2 = Math.pow(2, this.z);
          return new i(8192 * (t2.x * e2 - this.x), 8192 * (t2.y * e2 - this.y));
        }, Zl.prototype.toString = function() {
          return this.z + "/" + this.x + "/" + this.y;
        };
        var Xl = function(t2, e2) {
          this.wrap = t2, this.canonical = e2, this.key = Hl(t2, e2.z, e2.z, e2.x, e2.y);
        }, Jl = function(t2, e2, r2, n2, i2) {
          this.overscaledZ = t2, this.wrap = e2, this.canonical = new Zl(r2, +n2, +i2), this.key = Hl(e2, t2, r2, n2, i2);
        };
        function Hl(t2, e2, r2, n2, i2) {
          (t2 *= 2) < 0 && (t2 = -1 * t2 - 1);
          var a2 = 1 << r2;
          return (a2 * a2 * t2 + a2 * i2 + n2).toString(36) + r2.toString(36) + e2.toString(36);
        }
        Jl.prototype.equals = function(t2) {
          return this.overscaledZ === t2.overscaledZ && this.wrap === t2.wrap && this.canonical.equals(t2.canonical);
        }, Jl.prototype.scaledTo = function(t2) {
          var e2 = this.canonical.z - t2;
          return t2 > this.canonical.z ? new Jl(t2, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y) : new Jl(t2, this.wrap, t2, this.canonical.x >> e2, this.canonical.y >> e2);
        }, Jl.prototype.calculateScaledKey = function(t2, e2) {
          var r2 = this.canonical.z - t2;
          return t2 > this.canonical.z ? Hl(this.wrap * +e2, t2, this.canonical.z, this.canonical.x, this.canonical.y) : Hl(this.wrap * +e2, t2, t2, this.canonical.x >> r2, this.canonical.y >> r2);
        }, Jl.prototype.isChildOf = function(t2) {
          if (t2.wrap !== this.wrap)
            return false;
          var e2 = this.canonical.z - t2.canonical.z;
          return t2.overscaledZ === 0 || t2.overscaledZ < this.overscaledZ && t2.canonical.x === this.canonical.x >> e2 && t2.canonical.y === this.canonical.y >> e2;
        }, Jl.prototype.children = function(t2) {
          if (this.overscaledZ >= t2)
            return [new Jl(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y)];
          var e2 = this.canonical.z + 1, r2 = 2 * this.canonical.x, n2 = 2 * this.canonical.y;
          return [new Jl(e2, this.wrap, e2, r2, n2), new Jl(e2, this.wrap, e2, r2 + 1, n2), new Jl(e2, this.wrap, e2, r2, n2 + 1), new Jl(e2, this.wrap, e2, r2 + 1, n2 + 1)];
        }, Jl.prototype.isLessThan = function(t2) {
          return this.wrap < t2.wrap || !(this.wrap > t2.wrap) && (this.overscaledZ < t2.overscaledZ || !(this.overscaledZ > t2.overscaledZ) && (this.canonical.x < t2.canonical.x || !(this.canonical.x > t2.canonical.x) && this.canonical.y < t2.canonical.y));
        }, Jl.prototype.wrapped = function() {
          return new Jl(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y);
        }, Jl.prototype.unwrapTo = function(t2) {
          return new Jl(this.overscaledZ, t2, this.canonical.z, this.canonical.x, this.canonical.y);
        }, Jl.prototype.overscaleFactor = function() {
          return Math.pow(2, this.overscaledZ - this.canonical.z);
        }, Jl.prototype.toUnwrapped = function() {
          return new Xl(this.wrap, this.canonical);
        }, Jl.prototype.toString = function() {
          return this.overscaledZ + "/" + this.canonical.x + "/" + this.canonical.y;
        }, Jl.prototype.getTilePoint = function(t2) {
          return this.canonical.getTilePoint(new Gl(t2.x - this.wrap, t2.y));
        }, On("CanonicalTileID", Zl), On("OverscaledTileID", Jl, {omit: ["posMatrix"]});
        var Yl = function(t2, e2, r2) {
          if (this.uid = t2, e2.height !== e2.width)
            throw new RangeError("DEM tiles must be square");
          if (r2 && r2 !== "mapbox" && r2 !== "terrarium")
            return A('"' + r2 + '" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');
          this.stride = e2.height;
          var n2 = this.dim = e2.height - 2;
          this.data = new Uint32Array(e2.data.buffer), this.encoding = r2 || "mapbox";
          for (var i2 = 0; i2 < n2; i2++)
            this.data[this._idx(-1, i2)] = this.data[this._idx(0, i2)], this.data[this._idx(n2, i2)] = this.data[this._idx(n2 - 1, i2)], this.data[this._idx(i2, -1)] = this.data[this._idx(i2, 0)], this.data[this._idx(i2, n2)] = this.data[this._idx(i2, n2 - 1)];
          this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)], this.data[this._idx(n2, -1)] = this.data[this._idx(n2 - 1, 0)], this.data[this._idx(-1, n2)] = this.data[this._idx(0, n2 - 1)], this.data[this._idx(n2, n2)] = this.data[this._idx(n2 - 1, n2 - 1)];
        };
        Yl.prototype.get = function(t2, e2) {
          var r2 = new Uint8Array(this.data.buffer), n2 = 4 * this._idx(t2, e2);
          return (this.encoding === "terrarium" ? this._unpackTerrarium : this._unpackMapbox)(r2[n2], r2[n2 + 1], r2[n2 + 2]);
        }, Yl.prototype.getUnpackVector = function() {
          return this.encoding === "terrarium" ? [256, 1, 1 / 256, 32768] : [6553.6, 25.6, 0.1, 1e4];
        }, Yl.prototype._idx = function(t2, e2) {
          if (t2 < -1 || t2 >= this.dim + 1 || e2 < -1 || e2 >= this.dim + 1)
            throw new RangeError("out of range source coordinates for DEM data");
          return (e2 + 1) * this.stride + (t2 + 1);
        }, Yl.prototype._unpackMapbox = function(t2, e2, r2) {
          return (256 * t2 * 256 + 256 * e2 + r2) / 10 - 1e4;
        }, Yl.prototype._unpackTerrarium = function(t2, e2, r2) {
          return 256 * t2 + e2 + r2 / 256 - 32768;
        }, Yl.prototype.getPixels = function() {
          return new xo({width: this.stride, height: this.stride}, new Uint8Array(this.data.buffer));
        }, Yl.prototype.backfillBorder = function(t2, e2, r2) {
          if (this.dim !== t2.dim)
            throw new Error("dem dimension mismatch");
          var n2 = e2 * this.dim, i2 = e2 * this.dim + this.dim, a2 = r2 * this.dim, o2 = r2 * this.dim + this.dim;
          switch (e2) {
            case -1:
              n2 = i2 - 1;
              break;
            case 1:
              i2 = n2 + 1;
          }
          switch (r2) {
            case -1:
              a2 = o2 - 1;
              break;
            case 1:
              o2 = a2 + 1;
          }
          for (var s2 = -e2 * this.dim, u2 = -r2 * this.dim, l2 = a2; l2 < o2; l2++)
            for (var p2 = n2; p2 < i2; p2++)
              this.data[this._idx(p2, l2)] = t2.data[this._idx(p2 + s2, l2 + u2)];
        }, On("DEMData", Yl);
        var $l = function(t2) {
          this._stringToNumber = {}, this._numberToString = [];
          for (var e2 = 0; e2 < t2.length; e2++) {
            var r2 = t2[e2];
            this._stringToNumber[r2] = e2, this._numberToString[e2] = r2;
          }
        };
        $l.prototype.encode = function(t2) {
          return this._stringToNumber[t2];
        }, $l.prototype.decode = function(t2) {
          return this._numberToString[t2];
        };
        var Wl = function(t2, e2, r2, n2, i2) {
          this.type = "Feature", this._vectorTileFeature = t2, t2._z = e2, t2._x = r2, t2._y = n2, this.properties = t2.properties, this.id = i2;
        }, Ql = {geometry: {configurable: true}};
        Ql.geometry.get = function() {
          return this._geometry === void 0 && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z).geometry), this._geometry;
        }, Ql.geometry.set = function(t2) {
          this._geometry = t2;
        }, Wl.prototype.toJSON = function() {
          var t2 = {geometry: this.geometry};
          for (var e2 in this)
            e2 !== "_geometry" && e2 !== "_vectorTileFeature" && (t2[e2] = this[e2]);
          return t2;
        }, Object.defineProperties(Wl.prototype, Ql);
        var tp = function() {
          this.state = {}, this.stateChanges = {}, this.deletedStates = {};
        };
        tp.prototype.updateState = function(t2, e2, r2) {
          var n2 = String(e2);
          if (this.stateChanges[t2] = this.stateChanges[t2] || {}, this.stateChanges[t2][n2] = this.stateChanges[t2][n2] || {}, h(this.stateChanges[t2][n2], r2), this.deletedStates[t2] === null)
            for (var i2 in this.deletedStates[t2] = {}, this.state[t2])
              i2 !== n2 && (this.deletedStates[t2][i2] = null);
          else if (this.deletedStates[t2] && this.deletedStates[t2][n2] === null)
            for (var a2 in this.deletedStates[t2][n2] = {}, this.state[t2][n2])
              r2[a2] || (this.deletedStates[t2][n2][a2] = null);
          else
            for (var o2 in r2)
              this.deletedStates[t2] && this.deletedStates[t2][n2] && this.deletedStates[t2][n2][o2] === null && delete this.deletedStates[t2][n2][o2];
        }, tp.prototype.removeFeatureState = function(t2, e2, r2) {
          if (this.deletedStates[t2] !== null) {
            var n2 = String(e2);
            if (this.deletedStates[t2] = this.deletedStates[t2] || {}, r2 && e2 !== void 0)
              this.deletedStates[t2][n2] !== null && (this.deletedStates[t2][n2] = this.deletedStates[t2][n2] || {}, this.deletedStates[t2][n2][r2] = null);
            else if (e2 !== void 0)
              if (this.stateChanges[t2] && this.stateChanges[t2][n2])
                for (r2 in this.deletedStates[t2][n2] = {}, this.stateChanges[t2][n2])
                  this.deletedStates[t2][n2][r2] = null;
              else
                this.deletedStates[t2][n2] = null;
            else
              this.deletedStates[t2] = null;
          }
        }, tp.prototype.getState = function(t2, e2) {
          var r2 = String(e2), n2 = h({}, (this.state[t2] || {})[r2], (this.stateChanges[t2] || {})[r2]);
          if (this.deletedStates[t2] === null)
            return {};
          if (this.deletedStates[t2]) {
            var i2 = this.deletedStates[t2][e2];
            if (i2 === null)
              return {};
            for (var a2 in i2)
              delete n2[a2];
          }
          return n2;
        }, tp.prototype.initializeTileState = function(t2, e2) {
          t2.setFeatureState(this.state, e2);
        }, tp.prototype.coalesceChanges = function(t2, e2) {
          var r2 = {};
          for (var n2 in this.stateChanges) {
            this.state[n2] = this.state[n2] || {};
            var i2 = {};
            for (var a2 in this.stateChanges[n2])
              this.state[n2][a2] || (this.state[n2][a2] = {}), h(this.state[n2][a2], this.stateChanges[n2][a2]), i2[a2] = this.state[n2][a2];
            r2[n2] = i2;
          }
          for (var o2 in this.deletedStates) {
            this.state[o2] = this.state[o2] || {};
            var s2 = {};
            if (this.deletedStates[o2] === null)
              for (var u2 in this.state[o2])
                s2[u2] = {}, this.state[o2][u2] = {};
            else
              for (var l2 in this.deletedStates[o2]) {
                if (this.deletedStates[o2][l2] === null)
                  this.state[o2][l2] = {};
                else
                  for (var p2 = 0, c2 = Object.keys(this.deletedStates[o2][l2]); p2 < c2.length; p2 += 1)
                    delete this.state[o2][l2][c2[p2]];
                s2[l2] = this.state[o2][l2];
              }
            r2[o2] = r2[o2] || {}, h(r2[o2], s2);
          }
          if (this.stateChanges = {}, this.deletedStates = {}, Object.keys(r2).length !== 0)
            for (var f2 in t2)
              t2[f2].setFeatureState(r2, e2);
        };
        var ep = function(t2, e2) {
          this.tileID = t2, this.x = t2.canonical.x, this.y = t2.canonical.y, this.z = t2.canonical.z, this.grid = new Tn(8192, 16, 0), this.grid3D = new Tn(8192, 16, 0), this.featureIndexArray = new aa(), this.promoteId = e2;
        };
        function rp(t2, e2, r2, n2, i2) {
          return x(t2, function(t3, a2) {
            var o2 = e2 instanceof di ? e2.get(a2) : null;
            return o2 && o2.evaluate ? o2.evaluate(r2, n2, i2) : o2;
          });
        }
        function np(t2) {
          for (var e2 = 1 / 0, r2 = 1 / 0, n2 = -1 / 0, i2 = -1 / 0, a2 = 0, o2 = t2; a2 < o2.length; a2 += 1) {
            var s2 = o2[a2];
            e2 = Math.min(e2, s2.x), r2 = Math.min(r2, s2.y), n2 = Math.max(n2, s2.x), i2 = Math.max(i2, s2.y);
          }
          return {minX: e2, minY: r2, maxX: n2, maxY: i2};
        }
        function ip(t2, e2) {
          return e2 - t2;
        }
        ep.prototype.insert = function(t2, e2, r2, n2, i2, a2) {
          var o2 = this.featureIndexArray.length;
          this.featureIndexArray.emplaceBack(r2, n2, i2);
          for (var s2 = a2 ? this.grid3D : this.grid, u2 = 0; u2 < e2.length; u2++) {
            for (var l2 = e2[u2], p2 = [1 / 0, 1 / 0, -1 / 0, -1 / 0], c2 = 0; c2 < l2.length; c2++) {
              var h2 = l2[c2];
              p2[0] = Math.min(p2[0], h2.x), p2[1] = Math.min(p2[1], h2.y), p2[2] = Math.max(p2[2], h2.x), p2[3] = Math.max(p2[3], h2.y);
            }
            p2[0] < 8192 && p2[1] < 8192 && p2[2] >= 0 && p2[3] >= 0 && s2.insert(o2, p2[0], p2[1], p2[2], p2[3]);
          }
        }, ep.prototype.loadVTLayers = function() {
          return this.vtLayers || (this.vtLayers = new bs.VectorTile(new Ys(this.rawTileData)).layers, this.sourceLayerCoder = new $l(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"])), this.vtLayers;
        }, ep.prototype.query = function(t2, e2, r2, n2) {
          var a2 = this;
          this.loadVTLayers();
          for (var o2 = t2.params || {}, s2 = 8192 / t2.tileSize / t2.scale, u2 = on(o2.filter), l2 = t2.queryGeometry, p2 = t2.queryPadding * s2, c2 = np(l2), h2 = this.grid.query(c2.minX - p2, c2.minY - p2, c2.maxX + p2, c2.maxY + p2), f2 = np(t2.cameraQueryGeometry), y2 = this.grid3D.query(f2.minX - p2, f2.minY - p2, f2.maxX + p2, f2.maxY + p2, function(e3, r3, n3, a3) {
            return function(t3, e4, r4, n4, a4) {
              for (var o3 = 0, s3 = t3; o3 < s3.length; o3 += 1) {
                var u3 = s3[o3];
                if (e4 <= u3.x && r4 <= u3.y && n4 >= u3.x && a4 >= u3.y)
                  return true;
              }
              var l3 = [new i(e4, r4), new i(e4, a4), new i(n4, a4), new i(n4, r4)];
              if (t3.length > 2) {
                for (var p3 = 0, c3 = l3; p3 < c3.length; p3 += 1)
                  if (Wa(t3, c3[p3]))
                    return true;
              }
              for (var h3 = 0; h3 < t3.length - 1; h3++)
                if (Qa(t3[h3], t3[h3 + 1], l3))
                  return true;
              return false;
            }(t2.cameraQueryGeometry, e3 - p2, r3 - p2, n3 + p2, a3 + p2);
          }), d2 = 0, m2 = y2; d2 < m2.length; d2 += 1)
            h2.push(m2[d2]);
          h2.sort(ip);
          for (var v2, g2 = {}, x2 = function(i2) {
            var p3 = h2[i2];
            if (p3 !== v2) {
              v2 = p3;
              var c3 = a2.featureIndexArray.get(p3), f3 = null;
              a2.loadMatchingFeature(g2, c3.bucketIndex, c3.sourceLayerIndex, c3.featureIndex, u2, o2.layers, o2.availableImages, e2, r2, n2, function(e3, r3, n3) {
                return f3 || (f3 = Ra(e3)), r3.queryIntersectsFeature(l2, e3, n3, f3, a2.z, t2.transform, s2, t2.pixelPosMatrix);
              });
            }
          }, b2 = 0; b2 < h2.length; b2++)
            x2(b2);
          return g2;
        }, ep.prototype.loadMatchingFeature = function(t2, e2, r2, n2, i2, a2, o2, s2, u2, l2, p2) {
          var c2 = this.bucketLayerIDs[e2];
          if (!a2 || function(t3, e3) {
            for (var r3 = 0; r3 < t3.length; r3++)
              if (e3.indexOf(t3[r3]) >= 0)
                return true;
            return false;
          }(a2, c2)) {
            var f2 = this.sourceLayerCoder.decode(r2), y2 = this.vtLayers[f2].feature(n2);
            if (i2.needGeometry) {
              var d2 = Ua(y2, true);
              if (!i2.filter(new si(this.tileID.overscaledZ), d2, this.tileID.canonical))
                return;
            } else if (!i2.filter(new si(this.tileID.overscaledZ), y2))
              return;
            for (var m2 = this.getId(y2, f2), v2 = 0; v2 < c2.length; v2++) {
              var g2 = c2[v2];
              if (!(a2 && a2.indexOf(g2) < 0)) {
                var x2 = s2[g2];
                if (x2) {
                  var b2 = {};
                  m2 !== void 0 && l2 && (b2 = l2.getState(x2.sourceLayer || "_geojsonTileLayer", m2));
                  var w2 = h({}, u2[g2]);
                  w2.paint = rp(w2.paint, x2.paint, y2, b2, o2), w2.layout = rp(w2.layout, x2.layout, y2, b2, o2);
                  var _2 = !p2 || p2(y2, x2, b2);
                  if (_2) {
                    var A2 = new Wl(y2, this.z, this.x, this.y, m2);
                    A2.layer = w2;
                    var S2 = t2[g2];
                    S2 === void 0 && (S2 = t2[g2] = []), S2.push({featureIndex: n2, feature: A2, intersectionZ: _2});
                  }
                }
              }
            }
          }
        }, ep.prototype.lookupSymbolFeatures = function(t2, e2, r2, n2, i2, a2, o2, s2) {
          var u2 = {};
          this.loadVTLayers();
          for (var l2 = on(i2), p2 = 0, c2 = t2; p2 < c2.length; p2 += 1)
            this.loadMatchingFeature(u2, r2, n2, c2[p2], l2, a2, o2, s2, e2);
          return u2;
        }, ep.prototype.hasLayer = function(t2) {
          for (var e2 = 0, r2 = this.bucketLayerIDs; e2 < r2.length; e2 += 1)
            for (var n2 = 0, i2 = r2[e2]; n2 < i2.length; n2 += 1)
              if (t2 === i2[n2])
                return true;
          return false;
        }, ep.prototype.getId = function(t2, e2) {
          var r2 = t2.id;
          return this.promoteId && typeof (r2 = t2.properties[typeof this.promoteId == "string" ? this.promoteId : this.promoteId[e2]]) == "boolean" && (r2 = Number(r2)), r2;
        }, On("FeatureIndex", ep, {omit: ["rawTileData", "sourceLayerCoder"]});
        var ap = function(t2, e2) {
          this.tileID = t2, this.uid = y(), this.uses = 0, this.tileSize = e2, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = false, this.hasRTLText = false, this.dependencies = {}, this.expiredRequestCount = 0, this.state = "loading";
        };
        ap.prototype.registerFadeDuration = function(t2) {
          var e2 = t2 + this.timeAdded;
          e2 < O.now() || this.fadeEndTime && e2 < this.fadeEndTime || (this.fadeEndTime = e2);
        }, ap.prototype.wasRequested = function() {
          return this.state === "errored" || this.state === "loaded" || this.state === "reloading";
        }, ap.prototype.loadVectorData = function(t2, e2, r2) {
          if (this.hasData() && this.unloadVectorData(), this.state = "loaded", t2) {
            for (var n2 in t2.featureIndex && (this.latestFeatureIndex = t2.featureIndex, t2.rawTileData ? (this.latestRawTileData = t2.rawTileData, this.latestFeatureIndex.rawTileData = t2.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = t2.collisionBoxArray, this.buckets = function(t3, e3) {
              var r3 = {};
              if (!e3)
                return r3;
              for (var n3 = function() {
                var t4 = a3[i3], n4 = t4.layerIds.map(function(t5) {
                  return e3.getLayer(t5);
                }).filter(Boolean);
                if (n4.length !== 0) {
                  t4.layers = n4, t4.stateDependentLayerIds && (t4.stateDependentLayers = t4.stateDependentLayerIds.map(function(t5) {
                    return n4.filter(function(e4) {
                      return e4.id === t5;
                    })[0];
                  }));
                  for (var o3 = 0, s3 = n4; o3 < s3.length; o3 += 1)
                    r3[s3[o3].id] = t4;
                }
              }, i3 = 0, a3 = t3; i3 < a3.length; i3 += 1)
                n3();
              return r3;
            }(t2.buckets, e2.style), this.hasSymbolBuckets = false, this.buckets) {
              var i2 = this.buckets[n2];
              if (i2 instanceof vl) {
                if (this.hasSymbolBuckets = true, !r2)
                  break;
                i2.justReloaded = true;
              }
            }
            if (this.hasRTLText = false, this.hasSymbolBuckets)
              for (var a2 in this.buckets) {
                var o2 = this.buckets[a2];
                if (o2 instanceof vl && o2.hasRTLText) {
                  this.hasRTLText = true, oi.isLoading() || oi.isLoaded() || ii() !== "deferred" || ai();
                  break;
                }
              }
            for (var s2 in this.queryPadding = 0, this.buckets) {
              var u2 = this.buckets[s2];
              this.queryPadding = Math.max(this.queryPadding, e2.style.getLayer(s2).queryRadius(u2));
            }
            t2.imageAtlas && (this.imageAtlas = t2.imageAtlas), t2.glyphAtlasImage && (this.glyphAtlasImage = t2.glyphAtlasImage);
          } else
            this.collisionBoxArray = new $i();
        }, ap.prototype.unloadVectorData = function() {
          for (var t2 in this.buckets)
            this.buckets[t2].destroy();
          this.buckets = {}, this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.imageAtlas && (this.imageAtlas = null), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.latestFeatureIndex = null, this.state = "unloaded";
        }, ap.prototype.getBucket = function(t2) {
          return this.buckets[t2.id];
        }, ap.prototype.upload = function(t2) {
          for (var e2 in this.buckets) {
            var r2 = this.buckets[e2];
            r2.uploadPending() && r2.upload(t2);
          }
          var n2 = t2.gl;
          this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new Tl(t2, this.imageAtlas.image, n2.RGBA), this.imageAtlas.uploaded = true), this.glyphAtlasImage && (this.glyphAtlasTexture = new Tl(t2, this.glyphAtlasImage, n2.ALPHA), this.glyphAtlasImage = null);
        }, ap.prototype.prepare = function(t2) {
          this.imageAtlas && this.imageAtlas.patchUpdatedImages(t2, this.imageAtlasTexture);
        }, ap.prototype.queryRenderedFeatures = function(t2, e2, r2, n2, i2, a2, o2, s2, u2, l2) {
          return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({queryGeometry: n2, cameraQueryGeometry: i2, scale: a2, tileSize: this.tileSize, pixelPosMatrix: l2, transform: s2, params: o2, queryPadding: this.queryPadding * u2}, t2, e2, r2) : {};
        }, ap.prototype.querySourceFeatures = function(t2, e2) {
          var r2 = this.latestFeatureIndex;
          if (r2 && r2.rawTileData) {
            var n2 = r2.loadVTLayers(), i2 = e2 ? e2.sourceLayer : "", a2 = n2._geojsonTileLayer || n2[i2];
            if (a2)
              for (var o2 = on(e2 && e2.filter), s2 = this.tileID.canonical, u2 = s2.z, l2 = s2.x, p2 = s2.y, c2 = {z: u2, x: l2, y: p2}, h2 = 0; h2 < a2.length; h2++) {
                var f2 = a2.feature(h2);
                if (o2.needGeometry) {
                  var y2 = Ua(f2, true);
                  if (!o2.filter(new si(this.tileID.overscaledZ), y2, this.tileID.canonical))
                    continue;
                } else if (!o2.filter(new si(this.tileID.overscaledZ), f2))
                  continue;
                var d2 = r2.getId(f2, i2), m2 = new Wl(f2, u2, l2, p2, d2);
                m2.tile = c2, t2.push(m2);
              }
          }
        }, ap.prototype.hasData = function() {
          return this.state === "loaded" || this.state === "reloading" || this.state === "expired";
        }, ap.prototype.patternsLoaded = function() {
          return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length;
        }, ap.prototype.setExpiryData = function(t2) {
          var e2 = this.expirationTime;
          if (t2.cacheControl) {
            var r2 = z(t2.cacheControl);
            r2["max-age"] && (this.expirationTime = Date.now() + 1e3 * r2["max-age"]);
          } else
            t2.expires && (this.expirationTime = new Date(t2.expires).getTime());
          if (this.expirationTime) {
            var n2 = Date.now(), i2 = false;
            if (this.expirationTime > n2)
              i2 = false;
            else if (e2)
              if (this.expirationTime < e2)
                i2 = true;
              else {
                var a2 = this.expirationTime - e2;
                a2 ? this.expirationTime = n2 + Math.max(a2, 3e4) : i2 = true;
              }
            else
              i2 = true;
            i2 ? (this.expiredRequestCount++, this.state = "expired") : this.expiredRequestCount = 0;
          }
        }, ap.prototype.getExpiryTimeout = function() {
          if (this.expirationTime)
            return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - new Date().getTime(), Math.pow(2, 31) - 1);
        }, ap.prototype.setFeatureState = function(t2, e2) {
          if (this.latestFeatureIndex && this.latestFeatureIndex.rawTileData && Object.keys(t2).length !== 0) {
            var r2 = this.latestFeatureIndex.loadVTLayers();
            for (var n2 in this.buckets)
              if (e2.style.hasLayer(n2)) {
                var i2 = this.buckets[n2], a2 = i2.layers[0].sourceLayer || "_geojsonTileLayer", o2 = r2[a2], s2 = t2[a2];
                if (o2 && s2 && Object.keys(s2).length !== 0) {
                  i2.update(s2, o2, this.imageAtlas && this.imageAtlas.patternPositions || {});
                  var u2 = e2 && e2.style && e2.style.getLayer(n2);
                  u2 && (this.queryPadding = Math.max(this.queryPadding, u2.queryRadius(i2)));
                }
              }
          }
        }, ap.prototype.holdingForFade = function() {
          return this.symbolFadeHoldUntil !== void 0;
        }, ap.prototype.symbolFadeFinished = function() {
          return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < O.now();
        }, ap.prototype.clearFadeHold = function() {
          this.symbolFadeHoldUntil = void 0;
        }, ap.prototype.setHoldDuration = function(t2) {
          this.symbolFadeHoldUntil = O.now() + t2;
        }, ap.prototype.setDependencies = function(t2, e2) {
          for (var r2 = {}, n2 = 0, i2 = e2; n2 < i2.length; n2 += 1)
            r2[i2[n2]] = true;
          this.dependencies[t2] = r2;
        }, ap.prototype.hasDependency = function(t2, e2) {
          for (var r2 = 0, n2 = t2; r2 < n2.length; r2 += 1) {
            var i2 = this.dependencies[n2[r2]];
            if (i2) {
              for (var a2 = 0, o2 = e2; a2 < o2.length; a2 += 1)
                if (i2[o2[a2]])
                  return true;
            }
          }
          return false;
        };
        var op = o.performance, sp = function(t2) {
          this._marks = {start: [t2.url, "start"].join("#"), end: [t2.url, "end"].join("#"), measure: t2.url.toString()}, op.mark(this._marks.start);
        };
        sp.prototype.finish = function() {
          op.mark(this._marks.end);
          var t2 = op.getEntriesByName(this._marks.measure);
          return t2.length === 0 && (op.measure(this._marks.measure, this._marks.start, this._marks.end), t2 = op.getEntriesByName(this._marks.measure), op.clearMarks(this._marks.start), op.clearMarks(this._marks.end), op.clearMeasures(this._marks.measure)), t2;
        }, t.Actor = Fl, t.AlphaImage = go, t.CanonicalTileID = Zl, t.CollisionBoxArray = $i, t.Color = te, t.DEMData = Yl, t.DataConstantProperty = mi, t.DictionaryCoder = $l, t.EXTENT = 8192, t.ErrorEvent = zt, t.EvaluationParameters = si, t.Event = It, t.Evented = Ct, t.FeatureIndex = ep, t.FillBucket = ss, t.FillExtrusionBucket = Ss, t.ImageAtlas = bu, t.ImagePosition = gu, t.LineBucket = Fs, t.LngLat = Ol, t.LngLatBounds = Ll, t.MercatorCoordinate = Gl, t.ONE_EM = 24, t.OverscaledTileID = Jl, t.Point = i, t.Point$1 = i, t.Properties = wi, t.Protobuf = Ys, t.RGBAImage = xo, t.RequestManager = G, t.RequestPerformance = sp, t.ResourceType = yt, t.SegmentVector = sa, t.SourceFeatureState = tp, t.StructArrayLayout1ui2 = Ji, t.StructArrayLayout2f1f2i16 = Ri, t.StructArrayLayout2i4 = Ci, t.StructArrayLayout3ui6 = ji, t.StructArrayLayout4i8 = Ei, t.SymbolBucket = vl, t.Texture = Tl, t.Tile = ap, t.Transitionable = pi, t.Uniform1f = ba, t.Uniform1i = xa, t.Uniform2f = wa, t.Uniform3f = _a, t.Uniform4f = Aa, t.UniformColor = Sa, t.UniformMatrix4f = Ia, t.UnwrappedTileID = Xl, t.ValidationError = Pt, t.WritingMode = wu, t.ZoomHistory = Kn, t.add = function(t2, e2, r2) {
          return t2[0] = e2[0] + r2[0], t2[1] = e2[1] + r2[1], t2[2] = e2[2] + r2[2], t2;
        }, t.addDynamicAttributes = fl, t.asyncAll = function(t2, e2, r2) {
          if (!t2.length)
            return r2(null, []);
          var n2 = t2.length, i2 = new Array(t2.length), a2 = null;
          t2.forEach(function(t3, o2) {
            e2(t3, function(t4, e3) {
              t4 && (a2 = t4), i2[o2] = e3, --n2 == 0 && r2(a2, i2);
            });
          });
        }, t.bezier = u, t.bindAll = v, t.browser = O, t.cacheEntryPossiblyAdded = function(t2) {
          ++ht > ut && (t2.getActor().send("enforceCacheSizeLimit", st), ht = 0);
        }, t.clamp = p, t.clearTileCache = function(t2) {
          var e2 = o.caches.delete("mapbox-tiles");
          t2 && e2.catch(t2).then(function() {
            return t2();
          });
        }, t.clipLine = Zu, t.clone = function(t2) {
          var e2 = new ao(16);
          return e2[0] = t2[0], e2[1] = t2[1], e2[2] = t2[2], e2[3] = t2[3], e2[4] = t2[4], e2[5] = t2[5], e2[6] = t2[6], e2[7] = t2[7], e2[8] = t2[8], e2[9] = t2[9], e2[10] = t2[10], e2[11] = t2[11], e2[12] = t2[12], e2[13] = t2[13], e2[14] = t2[14], e2[15] = t2[15], e2;
        }, t.clone$1 = w, t.clone$2 = function(t2) {
          var e2 = new ao(3);
          return e2[0] = t2[0], e2[1] = t2[1], e2[2] = t2[2], e2;
        }, t.collisionCircleLayout = Gs, t.config = R, t.create = function() {
          var t2 = new ao(16);
          return ao != Float32Array && (t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0), t2[0] = 1, t2[5] = 1, t2[10] = 1, t2[15] = 1, t2;
        }, t.create$1 = function() {
          var t2 = new ao(9);
          return ao != Float32Array && (t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[5] = 0, t2[6] = 0, t2[7] = 0), t2[0] = 1, t2[4] = 1, t2[8] = 1, t2;
        }, t.create$2 = function() {
          var t2 = new ao(4);
          return ao != Float32Array && (t2[1] = 0, t2[2] = 0), t2[0] = 1, t2[3] = 1, t2;
        }, t.createCommonjsModule = e, t.createExpression = Zr, t.createLayout = Ii, t.createStyleLayer = function(t2) {
          return t2.type === "custom" ? new Il(t2) : new zl[t2.type](t2);
        }, t.cross = function(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], o2 = r2[0], s2 = r2[1], u2 = r2[2];
          return t2[0] = i2 * u2 - a2 * s2, t2[1] = a2 * o2 - n2 * u2, t2[2] = n2 * s2 - i2 * o2, t2;
        }, t.deepEqual = function t2(e2, r2) {
          if (Array.isArray(e2)) {
            if (!Array.isArray(r2) || e2.length !== r2.length)
              return false;
            for (var n2 = 0; n2 < e2.length; n2++)
              if (!t2(e2[n2], r2[n2]))
                return false;
            return true;
          }
          if (typeof e2 == "object" && e2 !== null && r2 !== null) {
            if (typeof r2 != "object")
              return false;
            if (Object.keys(e2).length !== Object.keys(r2).length)
              return false;
            for (var i2 in e2)
              if (!t2(e2[i2], r2[i2]))
                return false;
            return true;
          }
          return e2 === r2;
        }, t.dot = function(t2, e2) {
          return t2[0] * e2[0] + t2[1] * e2[1] + t2[2] * e2[2];
        }, t.dot$1 = function(t2, e2) {
          return t2[0] * e2[0] + t2[1] * e2[1] + t2[2] * e2[2] + t2[3] * e2[3];
        }, t.ease = l, t.emitValidationErrors = Bn, t.endsWith = g, t.enforceCacheSizeLimit = function(t2) {
          lt(), tt && tt.then(function(e2) {
            e2.keys().then(function(r2) {
              for (var n2 = 0; n2 < r2.length - t2; n2++)
                e2.delete(r2[n2]);
            });
          });
        }, t.evaluateSizeForFeature = Lu, t.evaluateSizeForZoom = Ou, t.evaluateVariableOffset = al, t.evented = ni, t.extend = h, t.featureFilter = on, t.filterObject = b, t.fromRotation = function(t2, e2) {
          var r2 = Math.sin(e2), n2 = Math.cos(e2);
          return t2[0] = n2, t2[1] = r2, t2[2] = 0, t2[3] = -r2, t2[4] = n2, t2[5] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 1, t2;
        }, t.getAnchorAlignment = Bu, t.getAnchorJustification = ol, t.getArrayBuffer = bt, t.getImage = At, t.getJSON = function(t2, e2) {
          return xt(h(t2, {type: "json"}), e2);
        }, t.getRTLTextPluginStatus = ii, t.getReferrer = mt, t.getVideo = function(t2, e2) {
          var r2, n2, i2 = o.document.createElement("video");
          i2.muted = true, i2.onloadstart = function() {
            e2(null, i2);
          };
          for (var a2 = 0; a2 < t2.length; a2++) {
            var s2 = o.document.createElement("source");
            r2 = t2[a2], n2 = void 0, (n2 = o.document.createElement("a")).href = r2, (n2.protocol !== o.document.location.protocol || n2.host !== o.document.location.host) && (i2.crossOrigin = "Anonymous"), s2.src = t2[a2], i2.appendChild(s2);
          }
          return {cancel: function() {
          }};
        }, t.identity = oo, t.invert = function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = e2[2], a2 = e2[3], o2 = e2[4], s2 = e2[5], u2 = e2[6], l2 = e2[7], p2 = e2[8], c2 = e2[9], h2 = e2[10], f2 = e2[11], y2 = e2[12], d2 = e2[13], m2 = e2[14], v2 = e2[15], g2 = r2 * s2 - n2 * o2, x2 = r2 * u2 - i2 * o2, b2 = r2 * l2 - a2 * o2, w2 = n2 * u2 - i2 * s2, _2 = n2 * l2 - a2 * s2, A2 = i2 * l2 - a2 * u2, S2 = p2 * d2 - c2 * y2, k2 = p2 * m2 - h2 * y2, I2 = p2 * v2 - f2 * y2, z2 = c2 * m2 - h2 * d2, C2 = c2 * v2 - f2 * d2, E2 = h2 * v2 - f2 * m2, P2 = g2 * E2 - x2 * C2 + b2 * z2 + w2 * I2 - _2 * k2 + A2 * S2;
          return P2 ? (t2[0] = (s2 * E2 - u2 * C2 + l2 * z2) * (P2 = 1 / P2), t2[1] = (i2 * C2 - n2 * E2 - a2 * z2) * P2, t2[2] = (d2 * A2 - m2 * _2 + v2 * w2) * P2, t2[3] = (h2 * _2 - c2 * A2 - f2 * w2) * P2, t2[4] = (u2 * I2 - o2 * E2 - l2 * k2) * P2, t2[5] = (r2 * E2 - i2 * I2 + a2 * k2) * P2, t2[6] = (m2 * b2 - y2 * A2 - v2 * x2) * P2, t2[7] = (p2 * A2 - h2 * b2 + f2 * x2) * P2, t2[8] = (o2 * C2 - s2 * I2 + l2 * S2) * P2, t2[9] = (n2 * I2 - r2 * C2 - a2 * S2) * P2, t2[10] = (y2 * _2 - d2 * b2 + v2 * g2) * P2, t2[11] = (c2 * b2 - p2 * _2 - f2 * g2) * P2, t2[12] = (s2 * k2 - o2 * z2 - u2 * S2) * P2, t2[13] = (r2 * z2 - n2 * k2 + i2 * S2) * P2, t2[14] = (d2 * x2 - y2 * w2 - m2 * g2) * P2, t2[15] = (p2 * w2 - c2 * x2 + h2 * g2) * P2, t2) : null;
        }, t.isChar = Gn, t.isMapboxURL = Z, t.keysDifference = function(t2, e2) {
          var r2 = [];
          for (var n2 in t2)
            n2 in e2 || r2.push(n2);
          return r2;
        }, t.makeRequest = xt, t.mapObject = x, t.mercatorXfromLng = jl, t.mercatorYfromLat = ql, t.mercatorZfromAltitude = Nl, t.mul = lo, t.multiply = so, t.mvt = bs, t.nextPowerOfTwo = function(t2) {
          return t2 <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(t2) / Math.LN2));
        }, t.normalize = function(t2, e2) {
          var r2 = e2[0], n2 = e2[1], i2 = e2[2], a2 = r2 * r2 + n2 * n2 + i2 * i2;
          return a2 > 0 && (a2 = 1 / Math.sqrt(a2)), t2[0] = e2[0] * a2, t2[1] = e2[1] * a2, t2[2] = e2[2] * a2, t2;
        }, t.number = Ke, t.offscreenCanvasSupported = ft, t.ortho = function(t2, e2, r2, n2, i2, a2, o2) {
          var s2 = 1 / (e2 - r2), u2 = 1 / (n2 - i2), l2 = 1 / (a2 - o2);
          return t2[0] = -2 * s2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = -2 * u2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 2 * l2, t2[11] = 0, t2[12] = (e2 + r2) * s2, t2[13] = (i2 + n2) * u2, t2[14] = (o2 + a2) * l2, t2[15] = 1, t2;
        }, t.parseGlyphPBF = function(t2) {
          return new Ys(t2).readFields(yu, []);
        }, t.pbf = Ys, t.performSymbolLayout = function(t2, e2, r2, n2, i2, a2, o2) {
          t2.createArrays(), t2.tilePixelRatio = 8192 / (512 * t2.overscaling), t2.compareText = {}, t2.iconsNeedLinear = false;
          var s2 = t2.layers[0].layout, u2 = t2.layers[0]._unevaluatedLayout._values, l2 = {};
          if (t2.textSizeData.kind === "composite") {
            var p2 = t2.textSizeData, c2 = p2.maxZoom;
            l2.compositeTextSizes = [u2["text-size"].possiblyEvaluate(new si(p2.minZoom), o2), u2["text-size"].possiblyEvaluate(new si(c2), o2)];
          }
          if (t2.iconSizeData.kind === "composite") {
            var h2 = t2.iconSizeData, f2 = h2.maxZoom;
            l2.compositeIconSizes = [u2["icon-size"].possiblyEvaluate(new si(h2.minZoom), o2), u2["icon-size"].possiblyEvaluate(new si(f2), o2)];
          }
          l2.layoutTextSize = u2["text-size"].possiblyEvaluate(new si(t2.zoom + 1), o2), l2.layoutIconSize = u2["icon-size"].possiblyEvaluate(new si(t2.zoom + 1), o2), l2.textMaxSize = u2["text-size"].possiblyEvaluate(new si(18));
          for (var y2 = 24 * s2.get("text-line-height"), d2 = s2.get("text-rotation-alignment") === "map" && s2.get("symbol-placement") !== "point", m2 = s2.get("text-keep-upright"), v2 = s2.get("text-size"), g2 = function() {
            var a3 = b2[x2], u3 = s2.get("text-font").evaluate(a3, {}, o2).join(","), p3 = v2.evaluate(a3, {}, o2), c3 = l2.layoutTextSize.evaluate(a3, {}, o2), h3 = l2.layoutIconSize.evaluate(a3, {}, o2), f3 = {horizontal: {}, vertical: void 0}, g3 = a3.text, w2 = [0, 0];
            if (g3) {
              var _2 = g3.toString(), S2 = 24 * s2.get("text-letter-spacing").evaluate(a3, {}, o2), k2 = function(t3) {
                for (var e3 = 0, r3 = t3; e3 < r3.length; e3 += 1)
                  if (n3 = r3[e3].charCodeAt(0), Gn.Arabic(n3) || Gn["Arabic Supplement"](n3) || Gn["Arabic Extended-A"](n3) || Gn["Arabic Presentation Forms-A"](n3) || Gn["Arabic Presentation Forms-B"](n3))
                    return false;
                var n3;
                return true;
              }(_2) ? S2 : 0, I2 = s2.get("text-anchor").evaluate(a3, {}, o2), z2 = s2.get("text-variable-anchor");
              if (!z2) {
                var C2 = s2.get("text-radial-offset").evaluate(a3, {}, o2);
                w2 = C2 ? al(I2, [24 * C2, il]) : s2.get("text-offset").evaluate(a3, {}, o2).map(function(t3) {
                  return 24 * t3;
                });
              }
              var E2 = d2 ? "center" : s2.get("text-justify").evaluate(a3, {}, o2), P2 = s2.get("symbol-placement"), M2 = P2 === "point" ? 24 * s2.get("text-max-width").evaluate(a3, {}, o2) : 0, B2 = function() {
                t2.allowVerticalPlacement && Zn(_2) && (f3.vertical = Su(g3, e2, r2, i2, u3, M2, y2, I2, "left", k2, w2, wu.vertical, true, P2, c3, p3));
              };
              if (!d2 && z2) {
                for (var T2 = E2 === "auto" ? z2.map(function(t3) {
                  return ol(t3);
                }) : [E2], V2 = false, F2 = 0; F2 < T2.length; F2++) {
                  var D2 = T2[F2];
                  if (!f3.horizontal[D2])
                    if (V2)
                      f3.horizontal[D2] = f3.horizontal[0];
                    else {
                      var L2 = Su(g3, e2, r2, i2, u3, M2, y2, "center", D2, k2, w2, wu.horizontal, false, P2, c3, p3);
                      L2 && (f3.horizontal[D2] = L2, V2 = L2.positionedLines.length === 1);
                    }
                }
                B2();
              } else {
                E2 === "auto" && (E2 = ol(I2));
                var O2 = Su(g3, e2, r2, i2, u3, M2, y2, I2, E2, k2, w2, wu.horizontal, false, P2, c3, p3);
                O2 && (f3.horizontal[E2] = O2), B2(), Zn(_2) && d2 && m2 && (f3.vertical = Su(g3, e2, r2, i2, u3, M2, y2, I2, E2, k2, w2, wu.vertical, false, P2, c3, p3));
              }
            }
            var R2 = void 0, U2 = false;
            if (a3.icon && a3.icon.name) {
              var j2 = n2[a3.icon.name];
              j2 && (R2 = function(t3, e3, r3) {
                var n3 = Bu(r3), i3 = e3[0] - t3.displaySize[0] * n3.horizontalAlign, a4 = e3[1] - t3.displaySize[1] * n3.verticalAlign;
                return {image: t3, top: a4, bottom: a4 + t3.displaySize[1], left: i3, right: i3 + t3.displaySize[0]};
              }(i2[a3.icon.name], s2.get("icon-offset").evaluate(a3, {}, o2), s2.get("icon-anchor").evaluate(a3, {}, o2)), U2 = j2.sdf, t2.sdfIcons === void 0 ? t2.sdfIcons = j2.sdf : t2.sdfIcons !== j2.sdf && A("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"), (j2.pixelRatio !== t2.pixelRatio || s2.get("icon-rotate").constantOr(1) !== 0) && (t2.iconsNeedLinear = true));
            }
            var q2 = ul(f3.horizontal) || f3.vertical;
            t2.iconsInText = !!q2 && q2.iconsInText, (q2 || R2) && function(t3, e3, r3, n3, i3, a4, o3, s3, u4, l3, p4) {
              var c4 = a4.textMaxSize.evaluate(e3, {});
              c4 === void 0 && (c4 = o3);
              var h4, f4 = t3.layers[0].layout, y3 = f4.get("icon-offset").evaluate(e3, {}, p4), d3 = ul(r3.horizontal), m3 = o3 / 24, v3 = t3.tilePixelRatio * m3, g4 = t3.tilePixelRatio * c4 / 24, x3 = t3.tilePixelRatio * s3, b3 = t3.tilePixelRatio * f4.get("symbol-spacing"), w3 = f4.get("text-padding") * t3.tilePixelRatio, _3 = f4.get("icon-padding") * t3.tilePixelRatio, S3 = f4.get("text-max-angle") / 180 * Math.PI, k3 = f4.get("text-rotation-alignment") === "map" && f4.get("symbol-placement") !== "point", I3 = f4.get("icon-rotation-alignment") === "map" && f4.get("symbol-placement") !== "point", z3 = f4.get("symbol-placement"), C3 = b3 / 2, E3 = f4.get("icon-text-fit");
              n3 && E3 !== "none" && (t3.allowVerticalPlacement && r3.vertical && (h4 = Vu(n3, r3.vertical, E3, f4.get("icon-text-fit-padding"), y3, m3)), d3 && (n3 = Vu(n3, d3, E3, f4.get("icon-text-fit-padding"), y3, m3)));
              var P3 = function(s4, c5) {
                c5.x < 0 || c5.x >= 8192 || c5.y < 0 || c5.y >= 8192 || function(t4, e4, r4, n4, i4, a5, o4, s5, u5, l4, p5, c6, h5, f5, y4, d4, m4, v4, g5, x4, b4, w4, _4, S4, k4) {
                  var I4, z4, C4, E4, P4, M4 = t4.addToLineVertexArray(e4, r4), B4 = 0, T4 = 0, V4 = 0, F4 = 0, D4 = -1, L4 = -1, O4 = {}, R4 = ha(""), U4 = 0, j4 = 0;
                  if (s5._unevaluatedLayout.getValue("text-radial-offset") === void 0 ? (U4 = (I4 = s5.layout.get("text-offset").evaluate(b4, {}, S4).map(function(t5) {
                    return 24 * t5;
                  }))[0], j4 = I4[1]) : (U4 = 24 * s5.layout.get("text-radial-offset").evaluate(b4, {}, S4), j4 = il), t4.allowVerticalPlacement && n4.vertical) {
                    var q4 = s5.layout.get("text-rotate").evaluate(b4, {}, S4) + 90;
                    E4 = new Wu(u5, e4, l4, p5, c6, n4.vertical, h5, f5, y4, q4), o4 && (P4 = new Wu(u5, e4, l4, p5, c6, o4, m4, v4, y4, q4));
                  }
                  if (i4) {
                    var N3 = s5.layout.get("icon-rotate").evaluate(b4, {}), K3 = s5.layout.get("icon-text-fit") !== "none", G3 = Xu(i4, N3, _4, K3), Z3 = o4 ? Xu(o4, N3, _4, K3) : void 0;
                    C4 = new Wu(u5, e4, l4, p5, c6, i4, m4, v4, false, N3), B4 = 4 * G3.length;
                    var X3 = t4.iconSizeData, J3 = null;
                    X3.kind === "source" ? (J3 = [128 * s5.layout.get("icon-size").evaluate(b4, {})])[0] > 32640 && A(t4.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".') : X3.kind === "composite" && ((J3 = [128 * w4.compositeIconSizes[0].evaluate(b4, {}, S4), 128 * w4.compositeIconSizes[1].evaluate(b4, {}, S4)])[0] > 32640 || J3[1] > 32640) && A(t4.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".'), t4.addSymbols(t4.icon, G3, J3, x4, g5, b4, false, e4, M4.lineStartIndex, M4.lineLength, -1, S4), D4 = t4.icon.placedSymbolArray.length - 1, Z3 && (T4 = 4 * Z3.length, t4.addSymbols(t4.icon, Z3, J3, x4, g5, b4, wu.vertical, e4, M4.lineStartIndex, M4.lineLength, -1, S4), L4 = t4.icon.placedSymbolArray.length - 1);
                  }
                  for (var H3 in n4.horizontal) {
                    var Y3 = n4.horizontal[H3];
                    if (!z4) {
                      R4 = ha(Y3.text);
                      var $3 = s5.layout.get("text-rotate").evaluate(b4, {}, S4);
                      z4 = new Wu(u5, e4, l4, p5, c6, Y3, h5, f5, y4, $3);
                    }
                    var W3 = Y3.positionedLines.length === 1;
                    if (V4 += sl(t4, e4, Y3, a5, s5, y4, b4, d4, M4, n4.vertical ? wu.horizontal : wu.horizontalOnly, W3 ? Object.keys(n4.horizontal) : [H3], O4, D4, w4, S4), W3)
                      break;
                  }
                  n4.vertical && (F4 += sl(t4, e4, n4.vertical, a5, s5, y4, b4, d4, M4, wu.vertical, ["vertical"], O4, L4, w4, S4));
                  var Q2 = z4 ? z4.boxStartIndex : t4.collisionBoxArray.length, tt2 = z4 ? z4.boxEndIndex : t4.collisionBoxArray.length, et2 = E4 ? E4.boxStartIndex : t4.collisionBoxArray.length, rt2 = E4 ? E4.boxEndIndex : t4.collisionBoxArray.length, nt2 = C4 ? C4.boxStartIndex : t4.collisionBoxArray.length, it2 = C4 ? C4.boxEndIndex : t4.collisionBoxArray.length, at2 = P4 ? P4.boxStartIndex : t4.collisionBoxArray.length, ot2 = P4 ? P4.boxEndIndex : t4.collisionBoxArray.length, st2 = -1, ut2 = function(t5, e5) {
                    return t5 && t5.circleDiameter ? Math.max(t5.circleDiameter, e5) : e5;
                  };
                  st2 = ut2(z4, st2), st2 = ut2(E4, st2), st2 = ut2(C4, st2);
                  var lt2 = (st2 = ut2(P4, st2)) > -1 ? 1 : 0;
                  lt2 && (st2 *= k4 / 24), t4.glyphOffsetArray.length >= vl.MAX_GLYPHS && A("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"), b4.sortKey !== void 0 && t4.addToSortKeyRanges(t4.symbolInstances.length, b4.sortKey), t4.symbolInstances.emplaceBack(e4.x, e4.y, O4.right >= 0 ? O4.right : -1, O4.center >= 0 ? O4.center : -1, O4.left >= 0 ? O4.left : -1, O4.vertical || -1, D4, L4, R4, Q2, tt2, et2, rt2, nt2, it2, at2, ot2, l4, V4, F4, B4, T4, lt2, 0, h5, U4, j4, st2);
                }(t3, c5, s4, r3, n3, i3, h4, t3.layers[0], t3.collisionBoxArray, e3.index, e3.sourceLayerIndex, t3.index, v3, w3, k3, u4, x3, _3, I3, y3, e3, a4, l3, p4, o3);
              };
              if (z3 === "line")
                for (var M3 = 0, B3 = Zu(e3.geometry, 0, 0, 8192, 8192); M3 < B3.length; M3 += 1)
                  for (var T3 = B3[M3], V3 = 0, F3 = Gu(T3, b3, S3, r3.vertical || d3, n3, 24, g4, t3.overscaling, 8192); V3 < F3.length; V3 += 1) {
                    var D3 = F3[V3];
                    d3 && ll(t3, d3.text, C3, D3) || P3(T3, D3);
                  }
              else if (z3 === "line-center")
                for (var L3 = 0, O3 = e3.geometry; L3 < O3.length; L3 += 1) {
                  var R3 = O3[L3];
                  if (R3.length > 1) {
                    var U3 = Ku(R3, S3, r3.vertical || d3, n3, 24, g4);
                    U3 && P3(R3, U3);
                  }
                }
              else if (e3.type === "Polygon")
                for (var j3 = 0, q3 = ns(e3.geometry, 0); j3 < q3.length; j3 += 1) {
                  var N2 = q3[j3], K2 = el(N2, 16);
                  P3(N2[0], new Fu(K2.x, K2.y, 0));
                }
              else if (e3.type === "LineString")
                for (var G2 = 0, Z2 = e3.geometry; G2 < Z2.length; G2 += 1) {
                  var X2 = Z2[G2];
                  P3(X2, new Fu(X2[0].x, X2[0].y, 0));
                }
              else if (e3.type === "Point")
                for (var J2 = 0, H2 = e3.geometry; J2 < H2.length; J2 += 1)
                  for (var Y2 = 0, $2 = H2[J2]; Y2 < $2.length; Y2 += 1) {
                    var W2 = $2[Y2];
                    P3([W2], new Fu(W2.x, W2.y, 0));
                  }
            }(t2, a3, f3, R2, n2, l2, c3, h3, w2, U2, o2);
          }, x2 = 0, b2 = t2.features; x2 < b2.length; x2 += 1)
            g2();
          a2 && t2.generateCollisionDebugBuffers();
        }, t.perspective = function(t2, e2, r2, n2, i2) {
          var a2, o2 = 1 / Math.tan(e2 / 2);
          return t2[0] = o2 / r2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = o2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[11] = -1, t2[12] = 0, t2[13] = 0, t2[15] = 0, i2 != null && i2 !== 1 / 0 ? (t2[10] = (i2 + n2) * (a2 = 1 / (n2 - i2)), t2[14] = 2 * i2 * n2 * a2) : (t2[10] = -1, t2[14] = -2 * n2), t2;
        }, t.pick = function(t2, e2) {
          for (var r2 = {}, n2 = 0; n2 < e2.length; n2++) {
            var i2 = e2[n2];
            i2 in t2 && (r2[i2] = t2[i2]);
          }
          return r2;
        }, t.plugin = oi, t.polygonIntersectsPolygon = Na, t.postMapLoadEvent = ot, t.postTurnstileEvent = it, t.potpack = vu, t.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"], t.register = On, t.registerForPluginStateChange = function(t2) {
          return t2({pluginStatus: Qn, pluginURL: ti}), ni.on("pluginStateChange", t2), t2;
        }, t.renderColorRamp = wo, t.rotate = function(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2], o2 = e2[3], s2 = Math.sin(r2), u2 = Math.cos(r2);
          return t2[0] = n2 * u2 + a2 * s2, t2[1] = i2 * u2 + o2 * s2, t2[2] = n2 * -s2 + a2 * u2, t2[3] = i2 * -s2 + o2 * u2, t2;
        }, t.rotateX = function(t2, e2, r2) {
          var n2 = Math.sin(r2), i2 = Math.cos(r2), a2 = e2[4], o2 = e2[5], s2 = e2[6], u2 = e2[7], l2 = e2[8], p2 = e2[9], c2 = e2[10], h2 = e2[11];
          return e2 !== t2 && (t2[0] = e2[0], t2[1] = e2[1], t2[2] = e2[2], t2[3] = e2[3], t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15]), t2[4] = a2 * i2 + l2 * n2, t2[5] = o2 * i2 + p2 * n2, t2[6] = s2 * i2 + c2 * n2, t2[7] = u2 * i2 + h2 * n2, t2[8] = l2 * i2 - a2 * n2, t2[9] = p2 * i2 - o2 * n2, t2[10] = c2 * i2 - s2 * n2, t2[11] = h2 * i2 - u2 * n2, t2;
        }, t.rotateZ = function(t2, e2, r2) {
          var n2 = Math.sin(r2), i2 = Math.cos(r2), a2 = e2[0], o2 = e2[1], s2 = e2[2], u2 = e2[3], l2 = e2[4], p2 = e2[5], c2 = e2[6], h2 = e2[7];
          return e2 !== t2 && (t2[8] = e2[8], t2[9] = e2[9], t2[10] = e2[10], t2[11] = e2[11], t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15]), t2[0] = a2 * i2 + l2 * n2, t2[1] = o2 * i2 + p2 * n2, t2[2] = s2 * i2 + c2 * n2, t2[3] = u2 * i2 + h2 * n2, t2[4] = l2 * i2 - a2 * n2, t2[5] = p2 * i2 - o2 * n2, t2[6] = c2 * i2 - s2 * n2, t2[7] = h2 * i2 - u2 * n2, t2;
        }, t.scale = function(t2, e2, r2) {
          var n2 = r2[0], i2 = r2[1], a2 = r2[2];
          return t2[0] = e2[0] * n2, t2[1] = e2[1] * n2, t2[2] = e2[2] * n2, t2[3] = e2[3] * n2, t2[4] = e2[4] * i2, t2[5] = e2[5] * i2, t2[6] = e2[6] * i2, t2[7] = e2[7] * i2, t2[8] = e2[8] * a2, t2[9] = e2[9] * a2, t2[10] = e2[10] * a2, t2[11] = e2[11] * a2, t2[12] = e2[12], t2[13] = e2[13], t2[14] = e2[14], t2[15] = e2[15], t2;
        }, t.scale$1 = function(t2, e2, r2) {
          return t2[0] = e2[0] * r2, t2[1] = e2[1] * r2, t2[2] = e2[2] * r2, t2[3] = e2[3] * r2, t2;
        }, t.scale$2 = function(t2, e2, r2) {
          return t2[0] = e2[0] * r2, t2[1] = e2[1] * r2, t2[2] = e2[2] * r2, t2;
        }, t.setCacheLimits = function(t2, e2) {
          st = t2, ut = e2;
        }, t.setRTLTextPlugin = function(t2, e2, r2) {
          if (r2 === void 0 && (r2 = false), Qn === "deferred" || Qn === "loading" || Qn === "loaded")
            throw new Error("setRTLTextPlugin cannot be called multiple times.");
          ti = O.resolveURL(t2), Qn = "deferred", Wn = e2, ri(), r2 || ai();
        }, t.sphericalToCartesian = function(t2) {
          var e2 = t2[0], r2 = t2[1], n2 = t2[2];
          return r2 += 90, r2 *= Math.PI / 180, n2 *= Math.PI / 180, {x: e2 * Math.cos(r2) * Math.sin(n2), y: e2 * Math.sin(r2) * Math.sin(n2), z: e2 * Math.cos(n2)};
        }, t.sqrLen = function(t2) {
          var e2 = t2[0], r2 = t2[1];
          return e2 * e2 + r2 * r2;
        }, t.styleSpec = Et, t.sub = function(t2, e2, r2) {
          return t2[0] = e2[0] - r2[0], t2[1] = e2[1] - r2[1], t2[2] = e2[2] - r2[2], t2;
        }, t.symbolSize = Ru, t.transformMat3 = function(t2, e2, r2) {
          var n2 = e2[0], i2 = e2[1], a2 = e2[2];
          return t2[0] = n2 * r2[0] + i2 * r2[3] + a2 * r2[6], t2[1] = n2 * r2[1] + i2 * r2[4] + a2 * r2[7], t2[2] = n2 * r2[2] + i2 * r2[5] + a2 * r2[8], t2;
        }, t.transformMat4 = po, t.translate = function(t2, e2, r2) {
          var n2, i2, a2, o2, s2, u2, l2, p2, c2, h2, f2, y2, d2 = r2[0], m2 = r2[1], v2 = r2[2];
          return e2 === t2 ? (t2[12] = e2[0] * d2 + e2[4] * m2 + e2[8] * v2 + e2[12], t2[13] = e2[1] * d2 + e2[5] * m2 + e2[9] * v2 + e2[13], t2[14] = e2[2] * d2 + e2[6] * m2 + e2[10] * v2 + e2[14], t2[15] = e2[3] * d2 + e2[7] * m2 + e2[11] * v2 + e2[15]) : (i2 = e2[1], a2 = e2[2], o2 = e2[3], s2 = e2[4], u2 = e2[5], l2 = e2[6], p2 = e2[7], c2 = e2[8], h2 = e2[9], f2 = e2[10], y2 = e2[11], t2[0] = n2 = e2[0], t2[1] = i2, t2[2] = a2, t2[3] = o2, t2[4] = s2, t2[5] = u2, t2[6] = l2, t2[7] = p2, t2[8] = c2, t2[9] = h2, t2[10] = f2, t2[11] = y2, t2[12] = n2 * d2 + s2 * m2 + c2 * v2 + e2[12], t2[13] = i2 * d2 + u2 * m2 + h2 * v2 + e2[13], t2[14] = a2 * d2 + l2 * m2 + f2 * v2 + e2[14], t2[15] = o2 * d2 + p2 * m2 + y2 * v2 + e2[15]), t2;
        }, t.triggerPluginCompletionEvent = ei, t.uniqueId = y, t.validateCustomStyleLayer = function(t2) {
          var e2 = [], r2 = t2.id;
          return r2 === void 0 && e2.push({message: "layers." + r2 + ': missing required property "id"'}), t2.render === void 0 && e2.push({message: "layers." + r2 + ': missing required method "render"'}), t2.renderingMode && t2.renderingMode !== "2d" && t2.renderingMode !== "3d" && e2.push({message: "layers." + r2 + ': property "renderingMode" must be either "2d" or "3d"'}), e2;
        }, t.validateLight = En, t.validateStyle = Cn, t.values = function(t2) {
          var e2 = [];
          for (var r2 in t2)
            e2.push(t2[r2]);
          return e2;
        }, t.vectorTile = bs, t.version = "1.13.0-rc.5", t.warnOnce = A, t.webpSupported = U, t.window = o, t.wrap = c;
      });
      define2(["./shared"], function(e) {
        "use strict";
        function t(e2) {
          var r2 = typeof e2;
          if (r2 === "number" || r2 === "boolean" || r2 === "string" || e2 == null)
            return JSON.stringify(e2);
          if (Array.isArray(e2)) {
            for (var i2 = "[", o2 = 0, n2 = e2; o2 < n2.length; o2 += 1)
              i2 += t(n2[o2]) + ",";
            return i2 + "]";
          }
          for (var s2 = Object.keys(e2).sort(), a2 = "{", l2 = 0; l2 < s2.length; l2++)
            a2 += JSON.stringify(s2[l2]) + ":" + t(e2[s2[l2]]) + ",";
          return a2 + "}";
        }
        function r(r2) {
          for (var i2 = "", o2 = 0, n2 = e.refProperties; o2 < n2.length; o2 += 1)
            i2 += "/" + t(r2[n2[o2]]);
          return i2;
        }
        var i = function(e2) {
          this.keyCache = {}, e2 && this.replace(e2);
        };
        i.prototype.replace = function(e2) {
          this._layerConfigs = {}, this._layers = {}, this.update(e2, []);
        }, i.prototype.update = function(t2, i2) {
          for (var o2 = this, n2 = 0, s2 = t2; n2 < s2.length; n2 += 1) {
            var a2 = s2[n2];
            this._layerConfigs[a2.id] = a2;
            var l2 = this._layers[a2.id] = e.createStyleLayer(a2);
            l2._featureFilter = e.featureFilter(l2.filter), this.keyCache[a2.id] && delete this.keyCache[a2.id];
          }
          for (var u2 = 0, h2 = i2; u2 < h2.length; u2 += 1) {
            var c2 = h2[u2];
            delete this.keyCache[c2], delete this._layerConfigs[c2], delete this._layers[c2];
          }
          this.familiesBySource = {};
          for (var p2 = 0, f2 = function(e2, t3) {
            for (var i3 = {}, o3 = 0; o3 < e2.length; o3++) {
              var n3 = t3 && t3[e2[o3].id] || r(e2[o3]);
              t3 && (t3[e2[o3].id] = n3);
              var s3 = i3[n3];
              s3 || (s3 = i3[n3] = []), s3.push(e2[o3]);
            }
            var a3 = [];
            for (var l3 in i3)
              a3.push(i3[l3]);
            return a3;
          }(e.values(this._layerConfigs), this.keyCache); p2 < f2.length; p2 += 1) {
            var d2 = f2[p2].map(function(e2) {
              return o2._layers[e2.id];
            }), g2 = d2[0];
            if (g2.visibility !== "none") {
              var v2 = g2.source || "", m2 = this.familiesBySource[v2];
              m2 || (m2 = this.familiesBySource[v2] = {});
              var y2 = g2.sourceLayer || "_geojsonTileLayer", x2 = m2[y2];
              x2 || (x2 = m2[y2] = []), x2.push(d2);
            }
          }
        };
        var o = function(t2) {
          var r2 = {}, i2 = [];
          for (var o2 in t2) {
            var n2 = t2[o2], s2 = r2[o2] = {};
            for (var a2 in n2) {
              var l2 = n2[+a2];
              if (l2 && l2.bitmap.width !== 0 && l2.bitmap.height !== 0) {
                var u2 = {x: 0, y: 0, w: l2.bitmap.width + 2, h: l2.bitmap.height + 2};
                i2.push(u2), s2[a2] = {rect: u2, metrics: l2.metrics};
              }
            }
          }
          var h2 = e.potpack(i2), c2 = new e.AlphaImage({width: h2.w || 1, height: h2.h || 1});
          for (var p2 in t2) {
            var f2 = t2[p2];
            for (var d2 in f2) {
              var g2 = f2[+d2];
              if (g2 && g2.bitmap.width !== 0 && g2.bitmap.height !== 0) {
                var v2 = r2[p2][d2].rect;
                e.AlphaImage.copy(g2.bitmap, c2, {x: 0, y: 0}, {x: v2.x + 1, y: v2.y + 1}, g2.bitmap);
              }
            }
          }
          this.image = c2, this.positions = r2;
        };
        e.register("GlyphAtlas", o);
        var n = function(t2) {
          this.tileID = new e.OverscaledTileID(t2.tileID.overscaledZ, t2.tileID.wrap, t2.tileID.canonical.z, t2.tileID.canonical.x, t2.tileID.canonical.y), this.uid = t2.uid, this.zoom = t2.zoom, this.pixelRatio = t2.pixelRatio, this.tileSize = t2.tileSize, this.source = t2.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t2.showCollisionBoxes, this.collectResourceTiming = !!t2.collectResourceTiming, this.returnDependencies = !!t2.returnDependencies, this.promoteId = t2.promoteId;
        };
        function s(t2, r2, i2) {
          for (var o2 = new e.EvaluationParameters(r2), n2 = 0, s2 = t2; n2 < s2.length; n2 += 1)
            s2[n2].recalculate(o2, i2);
        }
        function a(t2, r2) {
          var i2 = e.getArrayBuffer(t2.request, function(t3, i3, o2, n2) {
            t3 ? r2(t3) : i3 && r2(null, {vectorTile: new e.vectorTile.VectorTile(new e.pbf(i3)), rawData: i3, cacheControl: o2, expires: n2});
          });
          return function() {
            i2.cancel(), r2();
          };
        }
        n.prototype.parse = function(t2, r2, i2, n2, a2) {
          var l2 = this;
          this.status = "parsing", this.data = t2, this.collisionBoxArray = new e.CollisionBoxArray();
          var u2 = new e.DictionaryCoder(Object.keys(t2.layers).sort()), h2 = new e.FeatureIndex(this.tileID, this.promoteId);
          h2.bucketLayerIDs = [];
          var c2, p2, f2, d2, g2 = {}, v2 = {featureIndex: h2, iconDependencies: {}, patternDependencies: {}, glyphDependencies: {}, availableImages: i2}, m2 = r2.familiesBySource[this.source];
          for (var y2 in m2) {
            var x2 = t2.layers[y2];
            if (x2) {
              x2.version === 1 && e.warnOnce('Vector tile source "' + this.source + '" layer "' + y2 + '" does not use vector tile spec v2 and therefore may have some rendering errors.');
              for (var w2 = u2.encode(y2), S2 = [], I2 = 0; I2 < x2.length; I2++) {
                var M2 = x2.feature(I2), b2 = h2.getId(M2, y2);
                S2.push({feature: M2, id: b2, index: I2, sourceLayerIndex: w2});
              }
              for (var _2 = 0, k2 = m2[y2]; _2 < k2.length; _2 += 1) {
                var P2 = k2[_2], T2 = P2[0];
                T2.minzoom && this.zoom < Math.floor(T2.minzoom) || T2.maxzoom && this.zoom >= T2.maxzoom || T2.visibility !== "none" && (s(P2, this.zoom, i2), (g2[T2.id] = T2.createBucket({index: h2.bucketLayerIDs.length, layers: P2, zoom: this.zoom, pixelRatio: this.pixelRatio, overscaling: this.overscaling, collisionBoxArray: this.collisionBoxArray, sourceLayerIndex: w2, sourceID: this.source})).populate(S2, v2, this.tileID.canonical), h2.bucketLayerIDs.push(P2.map(function(e2) {
                  return e2.id;
                })));
              }
            }
          }
          var C2 = e.mapObject(v2.glyphDependencies, function(e2) {
            return Object.keys(e2).map(Number);
          });
          Object.keys(C2).length ? n2.send("getGlyphs", {uid: this.uid, stacks: C2}, function(e2, t3) {
            c2 || (c2 = e2, p2 = t3, z2.call(l2));
          }) : p2 = {};
          var D2 = Object.keys(v2.iconDependencies);
          D2.length ? n2.send("getImages", {icons: D2, source: this.source, tileID: this.tileID, type: "icons"}, function(e2, t3) {
            c2 || (c2 = e2, f2 = t3, z2.call(l2));
          }) : f2 = {};
          var L2 = Object.keys(v2.patternDependencies);
          function z2() {
            if (c2)
              return a2(c2);
            if (p2 && f2 && d2) {
              var t3 = new o(p2), r3 = new e.ImageAtlas(f2, d2);
              for (var n3 in g2) {
                var l3 = g2[n3];
                l3 instanceof e.SymbolBucket ? (s(l3.layers, this.zoom, i2), e.performSymbolLayout(l3, p2, t3.positions, f2, r3.iconPositions, this.showCollisionBoxes, this.tileID.canonical)) : l3.hasPattern && (l3 instanceof e.LineBucket || l3 instanceof e.FillBucket || l3 instanceof e.FillExtrusionBucket) && (s(l3.layers, this.zoom, i2), l3.addFeatures(v2, this.tileID.canonical, r3.patternPositions));
              }
              this.status = "done", a2(null, {buckets: e.values(g2).filter(function(e2) {
                return !e2.isEmpty();
              }), featureIndex: h2, collisionBoxArray: this.collisionBoxArray, glyphAtlasImage: t3.image, imageAtlas: r3, glyphMap: this.returnDependencies ? p2 : null, iconMap: this.returnDependencies ? f2 : null, glyphPositions: this.returnDependencies ? t3.positions : null});
            }
          }
          L2.length ? n2.send("getImages", {icons: L2, source: this.source, tileID: this.tileID, type: "patterns"}, function(e2, t3) {
            c2 || (c2 = e2, d2 = t3, z2.call(l2));
          }) : d2 = {}, z2.call(this);
        };
        var l = function(e2, t2, r2, i2) {
          this.actor = e2, this.layerIndex = t2, this.availableImages = r2, this.loadVectorData = i2 || a, this.loading = {}, this.loaded = {};
        };
        l.prototype.loadTile = function(t2, r2) {
          var i2 = this, o2 = t2.uid;
          this.loading || (this.loading = {});
          var s2 = !!(t2 && t2.request && t2.request.collectResourceTiming) && new e.RequestPerformance(t2.request), a2 = this.loading[o2] = new n(t2);
          a2.abort = this.loadVectorData(t2, function(t3, n2) {
            if (delete i2.loading[o2], t3 || !n2)
              return a2.status = "done", i2.loaded[o2] = a2, r2(t3);
            var l2 = n2.rawData, u2 = {};
            n2.expires && (u2.expires = n2.expires), n2.cacheControl && (u2.cacheControl = n2.cacheControl);
            var h2 = {};
            if (s2) {
              var c2 = s2.finish();
              c2 && (h2.resourceTiming = JSON.parse(JSON.stringify(c2)));
            }
            a2.vectorTile = n2.vectorTile, a2.parse(n2.vectorTile, i2.layerIndex, i2.availableImages, i2.actor, function(t4, i3) {
              if (t4 || !i3)
                return r2(t4);
              r2(null, e.extend({rawTileData: l2.slice(0)}, i3, u2, h2));
            }), i2.loaded = i2.loaded || {}, i2.loaded[o2] = a2;
          });
        }, l.prototype.reloadTile = function(e2, t2) {
          var r2 = this, i2 = this.loaded, o2 = e2.uid, n2 = this;
          if (i2 && i2[o2]) {
            var s2 = i2[o2];
            s2.showCollisionBoxes = e2.showCollisionBoxes;
            var a2 = function(e3, i3) {
              var o3 = s2.reloadCallback;
              o3 && (delete s2.reloadCallback, s2.parse(s2.vectorTile, n2.layerIndex, r2.availableImages, n2.actor, o3)), t2(e3, i3);
            };
            s2.status === "parsing" ? s2.reloadCallback = a2 : s2.status === "done" && (s2.vectorTile ? s2.parse(s2.vectorTile, this.layerIndex, this.availableImages, this.actor, a2) : a2());
          }
        }, l.prototype.abortTile = function(e2, t2) {
          var r2 = this.loading, i2 = e2.uid;
          r2 && r2[i2] && r2[i2].abort && (r2[i2].abort(), delete r2[i2]), t2();
        }, l.prototype.removeTile = function(e2, t2) {
          var r2 = this.loaded, i2 = e2.uid;
          r2 && r2[i2] && delete r2[i2], t2();
        };
        var u = e.window.ImageBitmap, h = function() {
          this.loaded = {};
        };
        function c(e2, t2) {
          if (e2.length !== 0) {
            p(e2[0], t2);
            for (var r2 = 1; r2 < e2.length; r2++)
              p(e2[r2], !t2);
          }
        }
        function p(e2, t2) {
          for (var r2 = 0, i2 = 0, o2 = e2.length, n2 = o2 - 1; i2 < o2; n2 = i2++)
            r2 += (e2[i2][0] - e2[n2][0]) * (e2[n2][1] + e2[i2][1]);
          r2 >= 0 != !!t2 && e2.reverse();
        }
        h.prototype.loadTile = function(t2, r2) {
          var i2 = t2.uid, o2 = t2.encoding, n2 = t2.rawImageData, s2 = u && n2 instanceof u ? this.getImageData(n2) : n2, a2 = new e.DEMData(i2, s2, o2);
          this.loaded = this.loaded || {}, this.loaded[i2] = a2, r2(null, a2);
        }, h.prototype.getImageData = function(t2) {
          this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t2.width, t2.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")), this.offscreenCanvas.width = t2.width, this.offscreenCanvas.height = t2.height, this.offscreenCanvasContext.drawImage(t2, 0, 0, t2.width, t2.height);
          var r2 = this.offscreenCanvasContext.getImageData(-1, -1, t2.width + 2, t2.height + 2);
          return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), new e.RGBAImage({width: r2.width, height: r2.height}, r2.data);
        }, h.prototype.removeTile = function(e2) {
          var t2 = this.loaded, r2 = e2.uid;
          t2 && t2[r2] && delete t2[r2];
        };
        var f = e.vectorTile.VectorTileFeature.prototype.toGeoJSON, d = function(t2) {
          this._feature = t2, this.extent = e.EXTENT, this.type = t2.type, this.properties = t2.tags, "id" in t2 && !isNaN(t2.id) && (this.id = parseInt(t2.id, 10));
        };
        d.prototype.loadGeometry = function() {
          if (this._feature.type === 1) {
            for (var t2 = [], r2 = 0, i2 = this._feature.geometry; r2 < i2.length; r2 += 1) {
              var o2 = i2[r2];
              t2.push([new e.Point$1(o2[0], o2[1])]);
            }
            return t2;
          }
          for (var n2 = [], s2 = 0, a2 = this._feature.geometry; s2 < a2.length; s2 += 1) {
            for (var l2 = [], u2 = 0, h2 = a2[s2]; u2 < h2.length; u2 += 1) {
              var c2 = h2[u2];
              l2.push(new e.Point$1(c2[0], c2[1]));
            }
            n2.push(l2);
          }
          return n2;
        }, d.prototype.toGeoJSON = function(e2, t2, r2) {
          return f.call(this, e2, t2, r2);
        };
        var g = function(t2) {
          this.layers = {_geojsonTileLayer: this}, this.name = "_geojsonTileLayer", this.extent = e.EXTENT, this.length = t2.length, this._features = t2;
        };
        g.prototype.feature = function(e2) {
          return new d(this._features[e2]);
        };
        var v = e.vectorTile.VectorTileFeature, m = y;
        function y(e2, t2) {
          this.options = t2 || {}, this.features = e2, this.length = e2.length;
        }
        function x(e2, t2) {
          this.id = typeof e2.id == "number" ? e2.id : void 0, this.type = e2.type, this.rawGeometry = e2.type === 1 ? [e2.geometry] : e2.geometry, this.properties = e2.tags, this.extent = t2 || 4096;
        }
        y.prototype.feature = function(e2) {
          return new x(this.features[e2], this.options.extent);
        }, x.prototype.loadGeometry = function() {
          var t2 = this.rawGeometry;
          this.geometry = [];
          for (var r2 = 0; r2 < t2.length; r2++) {
            for (var i2 = t2[r2], o2 = [], n2 = 0; n2 < i2.length; n2++)
              o2.push(new e.Point$1(i2[n2][0], i2[n2][1]));
            this.geometry.push(o2);
          }
          return this.geometry;
        }, x.prototype.bbox = function() {
          this.geometry || this.loadGeometry();
          for (var e2 = this.geometry, t2 = 1 / 0, r2 = -1 / 0, i2 = 1 / 0, o2 = -1 / 0, n2 = 0; n2 < e2.length; n2++)
            for (var s2 = e2[n2], a2 = 0; a2 < s2.length; a2++) {
              var l2 = s2[a2];
              t2 = Math.min(t2, l2.x), r2 = Math.max(r2, l2.x), i2 = Math.min(i2, l2.y), o2 = Math.max(o2, l2.y);
            }
          return [t2, i2, r2, o2];
        }, x.prototype.toGeoJSON = v.prototype.toGeoJSON;
        var w = I, S = m;
        function I(t2) {
          var r2 = new e.pbf();
          return function(e2, t3) {
            for (var r3 in e2.layers)
              t3.writeMessage(3, M, e2.layers[r3]);
          }(t2, r2), r2.finish();
        }
        function M(e2, t2) {
          var r2;
          t2.writeVarintField(15, e2.version || 1), t2.writeStringField(1, e2.name || ""), t2.writeVarintField(5, e2.extent || 4096);
          var i2 = {keys: [], values: [], keycache: {}, valuecache: {}};
          for (r2 = 0; r2 < e2.length; r2++)
            i2.feature = e2.feature(r2), t2.writeMessage(2, b, i2);
          var o2 = i2.keys;
          for (r2 = 0; r2 < o2.length; r2++)
            t2.writeStringField(3, o2[r2]);
          var n2 = i2.values;
          for (r2 = 0; r2 < n2.length; r2++)
            t2.writeMessage(4, C, n2[r2]);
        }
        function b(e2, t2) {
          var r2 = e2.feature;
          r2.id !== void 0 && t2.writeVarintField(1, r2.id), t2.writeMessage(2, _, e2), t2.writeVarintField(3, r2.type), t2.writeMessage(4, T, r2);
        }
        function _(e2, t2) {
          var r2 = e2.feature, i2 = e2.keys, o2 = e2.values, n2 = e2.keycache, s2 = e2.valuecache;
          for (var a2 in r2.properties) {
            var l2 = n2[a2];
            l2 === void 0 && (i2.push(a2), n2[a2] = l2 = i2.length - 1), t2.writeVarint(l2);
            var u2 = r2.properties[a2], h2 = typeof u2;
            h2 !== "string" && h2 !== "boolean" && h2 !== "number" && (u2 = JSON.stringify(u2));
            var c2 = h2 + ":" + u2, p2 = s2[c2];
            p2 === void 0 && (o2.push(u2), s2[c2] = p2 = o2.length - 1), t2.writeVarint(p2);
          }
        }
        function k(e2, t2) {
          return (t2 << 3) + (7 & e2);
        }
        function P(e2) {
          return e2 << 1 ^ e2 >> 31;
        }
        function T(e2, t2) {
          for (var r2 = e2.loadGeometry(), i2 = e2.type, o2 = 0, n2 = 0, s2 = r2.length, a2 = 0; a2 < s2; a2++) {
            var l2 = r2[a2], u2 = 1;
            i2 === 1 && (u2 = l2.length), t2.writeVarint(k(1, u2));
            for (var h2 = i2 === 3 ? l2.length - 1 : l2.length, c2 = 0; c2 < h2; c2++) {
              c2 === 1 && i2 !== 1 && t2.writeVarint(k(2, h2 - 1));
              var p2 = l2[c2].x - o2, f2 = l2[c2].y - n2;
              t2.writeVarint(P(p2)), t2.writeVarint(P(f2)), o2 += p2, n2 += f2;
            }
            i2 === 3 && t2.writeVarint(k(7, 1));
          }
        }
        function C(e2, t2) {
          var r2 = typeof e2;
          r2 === "string" ? t2.writeStringField(1, e2) : r2 === "boolean" ? t2.writeBooleanField(7, e2) : r2 === "number" && (e2 % 1 != 0 ? t2.writeDoubleField(3, e2) : e2 < 0 ? t2.writeSVarintField(6, e2) : t2.writeVarintField(5, e2));
        }
        function D(e2, t2, r2, i2) {
          L(e2, r2, i2), L(t2, 2 * r2, 2 * i2), L(t2, 2 * r2 + 1, 2 * i2 + 1);
        }
        function L(e2, t2, r2) {
          var i2 = e2[t2];
          e2[t2] = e2[r2], e2[r2] = i2;
        }
        function z(e2, t2, r2, i2) {
          var o2 = e2 - r2, n2 = t2 - i2;
          return o2 * o2 + n2 * n2;
        }
        w.fromVectorTileJs = I, w.fromGeojsonVt = function(e2, t2) {
          t2 = t2 || {};
          var r2 = {};
          for (var i2 in e2)
            r2[i2] = new m(e2[i2].features, t2), r2[i2].name = i2, r2[i2].version = t2.version, r2[i2].extent = t2.extent;
          return I({layers: r2});
        }, w.GeoJSONWrapper = S;
        var O = function(e2) {
          return e2[0];
        }, E = function(e2) {
          return e2[1];
        }, F = function(e2, t2, r2, i2, o2) {
          t2 === void 0 && (t2 = O), r2 === void 0 && (r2 = E), i2 === void 0 && (i2 = 64), o2 === void 0 && (o2 = Float64Array), this.nodeSize = i2, this.points = e2;
          for (var n2 = e2.length < 65536 ? Uint16Array : Uint32Array, s2 = this.ids = new n2(e2.length), a2 = this.coords = new o2(2 * e2.length), l2 = 0; l2 < e2.length; l2++)
            s2[l2] = l2, a2[2 * l2] = t2(e2[l2]), a2[2 * l2 + 1] = r2(e2[l2]);
          !function e3(t3, r3, i3, o3, n3, s3) {
            if (!(n3 - o3 <= i3)) {
              var a3 = o3 + n3 >> 1;
              !function e4(t4, r4, i4, o4, n4, s4) {
                for (; n4 > o4; ) {
                  if (n4 - o4 > 600) {
                    var a4 = n4 - o4 + 1, l3 = i4 - o4 + 1, u2 = Math.log(a4), h2 = 0.5 * Math.exp(2 * u2 / 3), c2 = 0.5 * Math.sqrt(u2 * h2 * (a4 - h2) / a4) * (l3 - a4 / 2 < 0 ? -1 : 1);
                    e4(t4, r4, i4, Math.max(o4, Math.floor(i4 - l3 * h2 / a4 + c2)), Math.min(n4, Math.floor(i4 + (a4 - l3) * h2 / a4 + c2)), s4);
                  }
                  var p2 = r4[2 * i4 + s4], f2 = o4, d2 = n4;
                  for (D(t4, r4, o4, i4), r4[2 * n4 + s4] > p2 && D(t4, r4, o4, n4); f2 < d2; ) {
                    for (D(t4, r4, f2, d2), f2++, d2--; r4[2 * f2 + s4] < p2; )
                      f2++;
                    for (; r4[2 * d2 + s4] > p2; )
                      d2--;
                  }
                  r4[2 * o4 + s4] === p2 ? D(t4, r4, o4, d2) : D(t4, r4, ++d2, n4), d2 <= i4 && (o4 = d2 + 1), i4 <= d2 && (n4 = d2 - 1);
                }
              }(t3, r3, a3, o3, n3, s3 % 2), e3(t3, r3, i3, o3, a3 - 1, s3 + 1), e3(t3, r3, i3, a3 + 1, n3, s3 + 1);
            }
          }(s2, a2, i2, 0, s2.length - 1, 0);
        };
        F.prototype.range = function(e2, t2, r2, i2) {
          return function(e3, t3, r3, i3, o2, n2, s2) {
            for (var a2, l2, u2 = [0, e3.length - 1, 0], h2 = []; u2.length; ) {
              var c2 = u2.pop(), p2 = u2.pop(), f2 = u2.pop();
              if (p2 - f2 <= s2)
                for (var d2 = f2; d2 <= p2; d2++)
                  l2 = t3[2 * d2 + 1], (a2 = t3[2 * d2]) >= r3 && a2 <= o2 && l2 >= i3 && l2 <= n2 && h2.push(e3[d2]);
              else {
                var g2 = Math.floor((f2 + p2) / 2);
                l2 = t3[2 * g2 + 1], (a2 = t3[2 * g2]) >= r3 && a2 <= o2 && l2 >= i3 && l2 <= n2 && h2.push(e3[g2]);
                var v2 = (c2 + 1) % 2;
                (c2 === 0 ? r3 <= a2 : i3 <= l2) && (u2.push(f2), u2.push(g2 - 1), u2.push(v2)), (c2 === 0 ? o2 >= a2 : n2 >= l2) && (u2.push(g2 + 1), u2.push(p2), u2.push(v2));
              }
            }
            return h2;
          }(this.ids, this.coords, e2, t2, r2, i2, this.nodeSize);
        }, F.prototype.within = function(e2, t2, r2) {
          return function(e3, t3, r3, i2, o2, n2) {
            for (var s2 = [0, e3.length - 1, 0], a2 = [], l2 = o2 * o2; s2.length; ) {
              var u2 = s2.pop(), h2 = s2.pop(), c2 = s2.pop();
              if (h2 - c2 <= n2)
                for (var p2 = c2; p2 <= h2; p2++)
                  z(t3[2 * p2], t3[2 * p2 + 1], r3, i2) <= l2 && a2.push(e3[p2]);
              else {
                var f2 = Math.floor((c2 + h2) / 2), d2 = t3[2 * f2], g2 = t3[2 * f2 + 1];
                z(d2, g2, r3, i2) <= l2 && a2.push(e3[f2]);
                var v2 = (u2 + 1) % 2;
                (u2 === 0 ? r3 - o2 <= d2 : i2 - o2 <= g2) && (s2.push(c2), s2.push(f2 - 1), s2.push(v2)), (u2 === 0 ? r3 + o2 >= d2 : i2 + o2 >= g2) && (s2.push(f2 + 1), s2.push(h2), s2.push(v2));
              }
            }
            return a2;
          }(this.ids, this.coords, e2, t2, r2, this.nodeSize);
        };
        var N = {minZoom: 0, maxZoom: 16, minPoints: 2, radius: 40, extent: 512, nodeSize: 64, log: false, generateId: false, reduce: null, map: function(e2) {
          return e2;
        }}, J = function(e2) {
          this.options = V(Object.create(N), e2), this.trees = new Array(this.options.maxZoom + 1);
        };
        function Z(e2, t2, r2, i2, o2) {
          return {x: e2, y: t2, zoom: 1 / 0, id: r2, parentId: -1, numPoints: i2, properties: o2};
        }
        function A(e2, t2) {
          var r2 = e2.geometry.coordinates, i2 = r2[1];
          return {x: Y(r2[0]), y: j(i2), zoom: 1 / 0, index: t2, parentId: -1};
        }
        function B(e2) {
          return {type: "Feature", id: e2.id, properties: G(e2), geometry: {type: "Point", coordinates: [(i2 = e2.x, 360 * (i2 - 0.5)), (t2 = e2.y, r2 = (180 - 360 * t2) * Math.PI / 180, 360 * Math.atan(Math.exp(r2)) / Math.PI - 90)]}};
          var t2, r2, i2;
        }
        function G(e2) {
          var t2 = e2.numPoints, r2 = t2 >= 1e4 ? Math.round(t2 / 1e3) + "k" : t2 >= 1e3 ? Math.round(t2 / 100) / 10 + "k" : t2;
          return V(V({}, e2.properties), {cluster: true, cluster_id: e2.id, point_count: t2, point_count_abbreviated: r2});
        }
        function Y(e2) {
          return e2 / 360 + 0.5;
        }
        function j(e2) {
          var t2 = Math.sin(e2 * Math.PI / 180), r2 = 0.5 - 0.25 * Math.log((1 + t2) / (1 - t2)) / Math.PI;
          return r2 < 0 ? 0 : r2 > 1 ? 1 : r2;
        }
        function V(e2, t2) {
          for (var r2 in t2)
            e2[r2] = t2[r2];
          return e2;
        }
        function X(e2) {
          return e2.x;
        }
        function W(e2) {
          return e2.y;
        }
        function R(e2, t2, r2, i2, o2, n2) {
          var s2 = o2 - r2, a2 = n2 - i2;
          if (s2 !== 0 || a2 !== 0) {
            var l2 = ((e2 - r2) * s2 + (t2 - i2) * a2) / (s2 * s2 + a2 * a2);
            l2 > 1 ? (r2 = o2, i2 = n2) : l2 > 0 && (r2 += s2 * l2, i2 += a2 * l2);
          }
          return (s2 = e2 - r2) * s2 + (a2 = t2 - i2) * a2;
        }
        function q(e2, t2, r2, i2) {
          var o2 = {id: e2 === void 0 ? null : e2, type: t2, geometry: r2, tags: i2, minX: 1 / 0, minY: 1 / 0, maxX: -1 / 0, maxY: -1 / 0};
          return function(e3) {
            var t3 = e3.geometry, r3 = e3.type;
            if (r3 === "Point" || r3 === "MultiPoint" || r3 === "LineString")
              U(e3, t3);
            else if (r3 === "Polygon" || r3 === "MultiLineString")
              for (var i3 = 0; i3 < t3.length; i3++)
                U(e3, t3[i3]);
            else if (r3 === "MultiPolygon")
              for (i3 = 0; i3 < t3.length; i3++)
                for (var o3 = 0; o3 < t3[i3].length; o3++)
                  U(e3, t3[i3][o3]);
          }(o2), o2;
        }
        function U(e2, t2) {
          for (var r2 = 0; r2 < t2.length; r2 += 3)
            e2.minX = Math.min(e2.minX, t2[r2]), e2.minY = Math.min(e2.minY, t2[r2 + 1]), e2.maxX = Math.max(e2.maxX, t2[r2]), e2.maxY = Math.max(e2.maxY, t2[r2 + 1]);
        }
        function $(e2, t2, r2, i2) {
          if (t2.geometry) {
            var o2 = t2.geometry.coordinates, n2 = t2.geometry.type, s2 = Math.pow(r2.tolerance / ((1 << r2.maxZoom) * r2.extent), 2), a2 = [], l2 = t2.id;
            if (r2.promoteId ? l2 = t2.properties[r2.promoteId] : r2.generateId && (l2 = i2 || 0), n2 === "Point")
              H(o2, a2);
            else if (n2 === "MultiPoint")
              for (var u2 = 0; u2 < o2.length; u2++)
                H(o2[u2], a2);
            else if (n2 === "LineString")
              K(o2, a2, s2, false);
            else if (n2 === "MultiLineString") {
              if (r2.lineMetrics) {
                for (u2 = 0; u2 < o2.length; u2++)
                  K(o2[u2], a2 = [], s2, false), e2.push(q(l2, "LineString", a2, t2.properties));
                return;
              }
              Q(o2, a2, s2, false);
            } else if (n2 === "Polygon")
              Q(o2, a2, s2, true);
            else {
              if (n2 !== "MultiPolygon") {
                if (n2 === "GeometryCollection") {
                  for (u2 = 0; u2 < t2.geometry.geometries.length; u2++)
                    $(e2, {id: l2, geometry: t2.geometry.geometries[u2], properties: t2.properties}, r2, i2);
                  return;
                }
                throw new Error("Input data is not a valid GeoJSON object.");
              }
              for (u2 = 0; u2 < o2.length; u2++) {
                var h2 = [];
                Q(o2[u2], h2, s2, true), a2.push(h2);
              }
            }
            e2.push(q(l2, n2, a2, t2.properties));
          }
        }
        function H(e2, t2) {
          t2.push(ee(e2[0])), t2.push(te(e2[1])), t2.push(0);
        }
        function K(e2, t2, r2, i2) {
          for (var o2, n2, s2 = 0, a2 = 0; a2 < e2.length; a2++) {
            var l2 = ee(e2[a2][0]), u2 = te(e2[a2][1]);
            t2.push(l2), t2.push(u2), t2.push(0), a2 > 0 && (s2 += i2 ? (o2 * u2 - l2 * n2) / 2 : Math.sqrt(Math.pow(l2 - o2, 2) + Math.pow(u2 - n2, 2))), o2 = l2, n2 = u2;
          }
          var h2 = t2.length - 3;
          t2[2] = 1, function e3(t3, r3, i3, o3) {
            for (var n3, s3 = o3, a3 = i3 - r3 >> 1, l3 = i3 - r3, u3 = t3[r3], h3 = t3[r3 + 1], c2 = t3[i3], p2 = t3[i3 + 1], f2 = r3 + 3; f2 < i3; f2 += 3) {
              var d2 = R(t3[f2], t3[f2 + 1], u3, h3, c2, p2);
              if (d2 > s3)
                n3 = f2, s3 = d2;
              else if (d2 === s3) {
                var g2 = Math.abs(f2 - a3);
                g2 < l3 && (n3 = f2, l3 = g2);
              }
            }
            s3 > o3 && (n3 - r3 > 3 && e3(t3, r3, n3, o3), t3[n3 + 2] = s3, i3 - n3 > 3 && e3(t3, n3, i3, o3));
          }(t2, 0, h2, r2), t2[h2 + 2] = 1, t2.size = Math.abs(s2), t2.start = 0, t2.end = t2.size;
        }
        function Q(e2, t2, r2, i2) {
          for (var o2 = 0; o2 < e2.length; o2++) {
            var n2 = [];
            K(e2[o2], n2, r2, i2), t2.push(n2);
          }
        }
        function ee(e2) {
          return e2 / 360 + 0.5;
        }
        function te(e2) {
          var t2 = Math.sin(e2 * Math.PI / 180), r2 = 0.5 - 0.25 * Math.log((1 + t2) / (1 - t2)) / Math.PI;
          return r2 < 0 ? 0 : r2 > 1 ? 1 : r2;
        }
        function re(e2, t2, r2, i2, o2, n2, s2, a2) {
          if (i2 /= t2, n2 >= (r2 /= t2) && s2 < i2)
            return e2;
          if (s2 < r2 || n2 >= i2)
            return null;
          for (var l2 = [], u2 = 0; u2 < e2.length; u2++) {
            var h2 = e2[u2], c2 = h2.geometry, p2 = h2.type, f2 = o2 === 0 ? h2.minX : h2.minY, d2 = o2 === 0 ? h2.maxX : h2.maxY;
            if (f2 >= r2 && d2 < i2)
              l2.push(h2);
            else if (!(d2 < r2 || f2 >= i2)) {
              var g2 = [];
              if (p2 === "Point" || p2 === "MultiPoint")
                ie(c2, g2, r2, i2, o2);
              else if (p2 === "LineString")
                oe(c2, g2, r2, i2, o2, false, a2.lineMetrics);
              else if (p2 === "MultiLineString")
                se(c2, g2, r2, i2, o2, false);
              else if (p2 === "Polygon")
                se(c2, g2, r2, i2, o2, true);
              else if (p2 === "MultiPolygon")
                for (var v2 = 0; v2 < c2.length; v2++) {
                  var m2 = [];
                  se(c2[v2], m2, r2, i2, o2, true), m2.length && g2.push(m2);
                }
              if (g2.length) {
                if (a2.lineMetrics && p2 === "LineString") {
                  for (v2 = 0; v2 < g2.length; v2++)
                    l2.push(q(h2.id, p2, g2[v2], h2.tags));
                  continue;
                }
                p2 !== "LineString" && p2 !== "MultiLineString" || (g2.length === 1 ? (p2 = "LineString", g2 = g2[0]) : p2 = "MultiLineString"), p2 !== "Point" && p2 !== "MultiPoint" || (p2 = g2.length === 3 ? "Point" : "MultiPoint"), l2.push(q(h2.id, p2, g2, h2.tags));
              }
            }
          }
          return l2.length ? l2 : null;
        }
        function ie(e2, t2, r2, i2, o2) {
          for (var n2 = 0; n2 < e2.length; n2 += 3) {
            var s2 = e2[n2 + o2];
            s2 >= r2 && s2 <= i2 && (t2.push(e2[n2]), t2.push(e2[n2 + 1]), t2.push(e2[n2 + 2]));
          }
        }
        function oe(e2, t2, r2, i2, o2, n2, s2) {
          for (var a2, l2, u2 = ne(e2), h2 = o2 === 0 ? le : ue, c2 = e2.start, p2 = 0; p2 < e2.length - 3; p2 += 3) {
            var f2 = e2[p2], d2 = e2[p2 + 1], g2 = e2[p2 + 2], v2 = e2[p2 + 3], m2 = e2[p2 + 4], y2 = o2 === 0 ? f2 : d2, x2 = o2 === 0 ? v2 : m2, w2 = false;
            s2 && (a2 = Math.sqrt(Math.pow(f2 - v2, 2) + Math.pow(d2 - m2, 2))), y2 < r2 ? x2 > r2 && (l2 = h2(u2, f2, d2, v2, m2, r2), s2 && (u2.start = c2 + a2 * l2)) : y2 > i2 ? x2 < i2 && (l2 = h2(u2, f2, d2, v2, m2, i2), s2 && (u2.start = c2 + a2 * l2)) : ae(u2, f2, d2, g2), x2 < r2 && y2 >= r2 && (l2 = h2(u2, f2, d2, v2, m2, r2), w2 = true), x2 > i2 && y2 <= i2 && (l2 = h2(u2, f2, d2, v2, m2, i2), w2 = true), !n2 && w2 && (s2 && (u2.end = c2 + a2 * l2), t2.push(u2), u2 = ne(e2)), s2 && (c2 += a2);
          }
          var S2 = e2.length - 3;
          f2 = e2[S2], d2 = e2[S2 + 1], g2 = e2[S2 + 2], (y2 = o2 === 0 ? f2 : d2) >= r2 && y2 <= i2 && ae(u2, f2, d2, g2), S2 = u2.length - 3, n2 && S2 >= 3 && (u2[S2] !== u2[0] || u2[S2 + 1] !== u2[1]) && ae(u2, u2[0], u2[1], u2[2]), u2.length && t2.push(u2);
        }
        function ne(e2) {
          var t2 = [];
          return t2.size = e2.size, t2.start = e2.start, t2.end = e2.end, t2;
        }
        function se(e2, t2, r2, i2, o2, n2) {
          for (var s2 = 0; s2 < e2.length; s2++)
            oe(e2[s2], t2, r2, i2, o2, n2, false);
        }
        function ae(e2, t2, r2, i2) {
          e2.push(t2), e2.push(r2), e2.push(i2);
        }
        function le(e2, t2, r2, i2, o2, n2) {
          var s2 = (n2 - t2) / (i2 - t2);
          return e2.push(n2), e2.push(r2 + (o2 - r2) * s2), e2.push(1), s2;
        }
        function ue(e2, t2, r2, i2, o2, n2) {
          var s2 = (n2 - r2) / (o2 - r2);
          return e2.push(t2 + (i2 - t2) * s2), e2.push(n2), e2.push(1), s2;
        }
        function he(e2, t2) {
          for (var r2 = [], i2 = 0; i2 < e2.length; i2++) {
            var o2, n2 = e2[i2], s2 = n2.type;
            if (s2 === "Point" || s2 === "MultiPoint" || s2 === "LineString")
              o2 = ce(n2.geometry, t2);
            else if (s2 === "MultiLineString" || s2 === "Polygon") {
              o2 = [];
              for (var a2 = 0; a2 < n2.geometry.length; a2++)
                o2.push(ce(n2.geometry[a2], t2));
            } else if (s2 === "MultiPolygon")
              for (o2 = [], a2 = 0; a2 < n2.geometry.length; a2++) {
                for (var l2 = [], u2 = 0; u2 < n2.geometry[a2].length; u2++)
                  l2.push(ce(n2.geometry[a2][u2], t2));
                o2.push(l2);
              }
            r2.push(q(n2.id, s2, o2, n2.tags));
          }
          return r2;
        }
        function ce(e2, t2) {
          var r2 = [];
          r2.size = e2.size, e2.start !== void 0 && (r2.start = e2.start, r2.end = e2.end);
          for (var i2 = 0; i2 < e2.length; i2 += 3)
            r2.push(e2[i2] + t2, e2[i2 + 1], e2[i2 + 2]);
          return r2;
        }
        function pe(e2, t2) {
          if (e2.transformed)
            return e2;
          var r2, i2, o2, n2 = 1 << e2.z, s2 = e2.x, a2 = e2.y;
          for (r2 = 0; r2 < e2.features.length; r2++) {
            var l2 = e2.features[r2], u2 = l2.geometry, h2 = l2.type;
            if (l2.geometry = [], h2 === 1)
              for (i2 = 0; i2 < u2.length; i2 += 2)
                l2.geometry.push(fe(u2[i2], u2[i2 + 1], t2, n2, s2, a2));
            else
              for (i2 = 0; i2 < u2.length; i2++) {
                var c2 = [];
                for (o2 = 0; o2 < u2[i2].length; o2 += 2)
                  c2.push(fe(u2[i2][o2], u2[i2][o2 + 1], t2, n2, s2, a2));
                l2.geometry.push(c2);
              }
          }
          return e2.transformed = true, e2;
        }
        function fe(e2, t2, r2, i2, o2, n2) {
          return [Math.round(r2 * (e2 * i2 - o2)), Math.round(r2 * (t2 * i2 - n2))];
        }
        function de(e2, t2, r2, i2, o2) {
          for (var n2 = t2 === o2.maxZoom ? 0 : o2.tolerance / ((1 << t2) * o2.extent), s2 = {features: [], numPoints: 0, numSimplified: 0, numFeatures: 0, source: null, x: r2, y: i2, z: t2, transformed: false, minX: 2, minY: 1, maxX: -1, maxY: 0}, a2 = 0; a2 < e2.length; a2++) {
            s2.numFeatures++, ge(s2, e2[a2], n2, o2);
            var l2 = e2[a2].minX, u2 = e2[a2].minY, h2 = e2[a2].maxX, c2 = e2[a2].maxY;
            l2 < s2.minX && (s2.minX = l2), u2 < s2.minY && (s2.minY = u2), h2 > s2.maxX && (s2.maxX = h2), c2 > s2.maxY && (s2.maxY = c2);
          }
          return s2;
        }
        function ge(e2, t2, r2, i2) {
          var o2 = t2.geometry, n2 = t2.type, s2 = [];
          if (n2 === "Point" || n2 === "MultiPoint")
            for (var a2 = 0; a2 < o2.length; a2 += 3)
              s2.push(o2[a2]), s2.push(o2[a2 + 1]), e2.numPoints++, e2.numSimplified++;
          else if (n2 === "LineString")
            ve(s2, o2, e2, r2, false, false);
          else if (n2 === "MultiLineString" || n2 === "Polygon")
            for (a2 = 0; a2 < o2.length; a2++)
              ve(s2, o2[a2], e2, r2, n2 === "Polygon", a2 === 0);
          else if (n2 === "MultiPolygon")
            for (var l2 = 0; l2 < o2.length; l2++) {
              var u2 = o2[l2];
              for (a2 = 0; a2 < u2.length; a2++)
                ve(s2, u2[a2], e2, r2, true, a2 === 0);
            }
          if (s2.length) {
            var h2 = t2.tags || null;
            if (n2 === "LineString" && i2.lineMetrics) {
              for (var c2 in h2 = {}, t2.tags)
                h2[c2] = t2.tags[c2];
              h2.mapbox_clip_start = o2.start / o2.size, h2.mapbox_clip_end = o2.end / o2.size;
            }
            var p2 = {geometry: s2, type: n2 === "Polygon" || n2 === "MultiPolygon" ? 3 : n2 === "LineString" || n2 === "MultiLineString" ? 2 : 1, tags: h2};
            t2.id !== null && (p2.id = t2.id), e2.features.push(p2);
          }
        }
        function ve(e2, t2, r2, i2, o2, n2) {
          var s2 = i2 * i2;
          if (i2 > 0 && t2.size < (o2 ? s2 : i2))
            r2.numPoints += t2.length / 3;
          else {
            for (var a2 = [], l2 = 0; l2 < t2.length; l2 += 3)
              (i2 === 0 || t2[l2 + 2] > s2) && (r2.numSimplified++, a2.push(t2[l2]), a2.push(t2[l2 + 1])), r2.numPoints++;
            o2 && function(e3, t3) {
              for (var r3 = 0, i3 = 0, o3 = e3.length, n3 = o3 - 2; i3 < o3; n3 = i3, i3 += 2)
                r3 += (e3[i3] - e3[n3]) * (e3[i3 + 1] + e3[n3 + 1]);
              if (r3 > 0 === t3)
                for (i3 = 0, o3 = e3.length; i3 < o3 / 2; i3 += 2) {
                  var s3 = e3[i3], a3 = e3[i3 + 1];
                  e3[i3] = e3[o3 - 2 - i3], e3[i3 + 1] = e3[o3 - 1 - i3], e3[o3 - 2 - i3] = s3, e3[o3 - 1 - i3] = a3;
                }
            }(a2, n2), e2.push(a2);
          }
        }
        function me(e2, t2) {
          var r2 = (t2 = this.options = function(e3, t3) {
            for (var r3 in t3)
              e3[r3] = t3[r3];
            return e3;
          }(Object.create(this.options), t2)).debug;
          if (r2 && console.time("preprocess data"), t2.maxZoom < 0 || t2.maxZoom > 24)
            throw new Error("maxZoom should be in the 0-24 range");
          if (t2.promoteId && t2.generateId)
            throw new Error("promoteId and generateId cannot be used together.");
          var i2 = function(e3, t3) {
            var r3 = [];
            if (e3.type === "FeatureCollection")
              for (var i3 = 0; i3 < e3.features.length; i3++)
                $(r3, e3.features[i3], t3, i3);
            else
              $(r3, e3.type === "Feature" ? e3 : {geometry: e3}, t3);
            return r3;
          }(e2, t2);
          this.tiles = {}, this.tileCoords = [], r2 && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t2.indexMaxZoom, t2.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), (i2 = function(e3, t3) {
            var r3 = t3.buffer / t3.extent, i3 = e3, o2 = re(e3, 1, -1 - r3, r3, 0, -1, 2, t3), n2 = re(e3, 1, 1 - r3, 2 + r3, 0, -1, 2, t3);
            return (o2 || n2) && (i3 = re(e3, 1, -r3, 1 + r3, 0, -1, 2, t3) || [], o2 && (i3 = he(o2, 1).concat(i3)), n2 && (i3 = i3.concat(he(n2, -1)))), i3;
          }(i2, t2)).length && this.splitTile(i2, 0, 0, 0), r2 && (i2.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
        }
        function ye(e2, t2, r2) {
          return 32 * ((1 << e2) * r2 + t2) + e2;
        }
        function xe(e2, t2) {
          var r2 = e2.tileID.canonical;
          if (!this._geoJSONIndex)
            return t2(null, null);
          var i2 = this._geoJSONIndex.getTile(r2.z, r2.x, r2.y);
          if (!i2)
            return t2(null, null);
          var o2 = new g(i2.features), n2 = w(o2);
          n2.byteOffset === 0 && n2.byteLength === n2.buffer.byteLength || (n2 = new Uint8Array(n2)), t2(null, {vectorTile: o2, rawData: n2.buffer});
        }
        J.prototype.load = function(e2) {
          var t2 = this.options, r2 = t2.log, i2 = t2.minZoom, o2 = t2.maxZoom, n2 = t2.nodeSize;
          r2 && console.time("total time");
          var s2 = "prepare " + e2.length + " points";
          r2 && console.time(s2), this.points = e2;
          for (var a2 = [], l2 = 0; l2 < e2.length; l2++)
            e2[l2].geometry && a2.push(A(e2[l2], l2));
          this.trees[o2 + 1] = new F(a2, X, W, n2, Float32Array), r2 && console.timeEnd(s2);
          for (var u2 = o2; u2 >= i2; u2--) {
            var h2 = +Date.now();
            a2 = this._cluster(a2, u2), this.trees[u2] = new F(a2, X, W, n2, Float32Array), r2 && console.log("z%d: %d clusters in %dms", u2, a2.length, +Date.now() - h2);
          }
          return r2 && console.timeEnd("total time"), this;
        }, J.prototype.getClusters = function(e2, t2) {
          var r2 = ((e2[0] + 180) % 360 + 360) % 360 - 180, i2 = Math.max(-90, Math.min(90, e2[1])), o2 = e2[2] === 180 ? 180 : ((e2[2] + 180) % 360 + 360) % 360 - 180, n2 = Math.max(-90, Math.min(90, e2[3]));
          if (e2[2] - e2[0] >= 360)
            r2 = -180, o2 = 180;
          else if (r2 > o2) {
            var s2 = this.getClusters([r2, i2, 180, n2], t2), a2 = this.getClusters([-180, i2, o2, n2], t2);
            return s2.concat(a2);
          }
          for (var l2 = this.trees[this._limitZoom(t2)], u2 = [], h2 = 0, c2 = l2.range(Y(r2), j(n2), Y(o2), j(i2)); h2 < c2.length; h2 += 1) {
            var p2 = l2.points[c2[h2]];
            u2.push(p2.numPoints ? B(p2) : this.points[p2.index]);
          }
          return u2;
        }, J.prototype.getChildren = function(e2) {
          var t2 = this._getOriginId(e2), r2 = this._getOriginZoom(e2), i2 = "No cluster with the specified id.", o2 = this.trees[r2];
          if (!o2)
            throw new Error(i2);
          var n2 = o2.points[t2];
          if (!n2)
            throw new Error(i2);
          for (var s2 = this.options.radius / (this.options.extent * Math.pow(2, r2 - 1)), a2 = [], l2 = 0, u2 = o2.within(n2.x, n2.y, s2); l2 < u2.length; l2 += 1) {
            var h2 = o2.points[u2[l2]];
            h2.parentId === e2 && a2.push(h2.numPoints ? B(h2) : this.points[h2.index]);
          }
          if (a2.length === 0)
            throw new Error(i2);
          return a2;
        }, J.prototype.getLeaves = function(e2, t2, r2) {
          var i2 = [];
          return this._appendLeaves(i2, e2, t2 = t2 || 10, r2 = r2 || 0, 0), i2;
        }, J.prototype.getTile = function(e2, t2, r2) {
          var i2 = this.trees[this._limitZoom(e2)], o2 = Math.pow(2, e2), n2 = this.options, s2 = n2.radius / n2.extent, a2 = (r2 - s2) / o2, l2 = (r2 + 1 + s2) / o2, u2 = {features: []};
          return this._addTileFeatures(i2.range((t2 - s2) / o2, a2, (t2 + 1 + s2) / o2, l2), i2.points, t2, r2, o2, u2), t2 === 0 && this._addTileFeatures(i2.range(1 - s2 / o2, a2, 1, l2), i2.points, o2, r2, o2, u2), t2 === o2 - 1 && this._addTileFeatures(i2.range(0, a2, s2 / o2, l2), i2.points, -1, r2, o2, u2), u2.features.length ? u2 : null;
        }, J.prototype.getClusterExpansionZoom = function(e2) {
          for (var t2 = this._getOriginZoom(e2) - 1; t2 <= this.options.maxZoom; ) {
            var r2 = this.getChildren(e2);
            if (t2++, r2.length !== 1)
              break;
            e2 = r2[0].properties.cluster_id;
          }
          return t2;
        }, J.prototype._appendLeaves = function(e2, t2, r2, i2, o2) {
          for (var n2 = 0, s2 = this.getChildren(t2); n2 < s2.length; n2 += 1) {
            var a2 = s2[n2], l2 = a2.properties;
            if (l2 && l2.cluster ? o2 + l2.point_count <= i2 ? o2 += l2.point_count : o2 = this._appendLeaves(e2, l2.cluster_id, r2, i2, o2) : o2 < i2 ? o2++ : e2.push(a2), e2.length === r2)
              break;
          }
          return o2;
        }, J.prototype._addTileFeatures = function(e2, t2, r2, i2, o2, n2) {
          for (var s2 = 0, a2 = e2; s2 < a2.length; s2 += 1) {
            var l2 = t2[a2[s2]], u2 = l2.numPoints, h2 = {type: 1, geometry: [[Math.round(this.options.extent * (l2.x * o2 - r2)), Math.round(this.options.extent * (l2.y * o2 - i2))]], tags: u2 ? G(l2) : this.points[l2.index].properties}, c2 = void 0;
            u2 ? c2 = l2.id : this.options.generateId ? c2 = l2.index : this.points[l2.index].id && (c2 = this.points[l2.index].id), c2 !== void 0 && (h2.id = c2), n2.features.push(h2);
          }
        }, J.prototype._limitZoom = function(e2) {
          return Math.max(this.options.minZoom, Math.min(+e2, this.options.maxZoom + 1));
        }, J.prototype._cluster = function(e2, t2) {
          for (var r2 = [], i2 = this.options, o2 = i2.reduce, n2 = i2.minPoints, s2 = i2.radius / (i2.extent * Math.pow(2, t2)), a2 = 0; a2 < e2.length; a2++) {
            var l2 = e2[a2];
            if (!(l2.zoom <= t2)) {
              l2.zoom = t2;
              for (var u2 = this.trees[t2 + 1], h2 = u2.within(l2.x, l2.y, s2), c2 = l2.numPoints || 1, p2 = c2, f2 = 0, d2 = h2; f2 < d2.length; f2 += 1) {
                var g2 = u2.points[d2[f2]];
                g2.zoom > t2 && (p2 += g2.numPoints || 1);
              }
              if (p2 >= n2) {
                for (var v2 = l2.x * c2, m2 = l2.y * c2, y2 = o2 && c2 > 1 ? this._map(l2, true) : null, x2 = (a2 << 5) + (t2 + 1) + this.points.length, w2 = 0, S2 = h2; w2 < S2.length; w2 += 1) {
                  var I2 = u2.points[S2[w2]];
                  if (!(I2.zoom <= t2)) {
                    I2.zoom = t2;
                    var M2 = I2.numPoints || 1;
                    v2 += I2.x * M2, m2 += I2.y * M2, I2.parentId = x2, o2 && (y2 || (y2 = this._map(l2, true)), o2(y2, this._map(I2)));
                  }
                }
                l2.parentId = x2, r2.push(Z(v2 / p2, m2 / p2, x2, p2, y2));
              } else if (r2.push(l2), p2 > 1)
                for (var b2 = 0, _2 = h2; b2 < _2.length; b2 += 1) {
                  var k2 = u2.points[_2[b2]];
                  k2.zoom <= t2 || (k2.zoom = t2, r2.push(k2));
                }
            }
          }
          return r2;
        }, J.prototype._getOriginId = function(e2) {
          return e2 - this.points.length >> 5;
        }, J.prototype._getOriginZoom = function(e2) {
          return (e2 - this.points.length) % 32;
        }, J.prototype._map = function(e2, t2) {
          if (e2.numPoints)
            return t2 ? V({}, e2.properties) : e2.properties;
          var r2 = this.points[e2.index].properties, i2 = this.options.map(r2);
          return t2 && i2 === r2 ? V({}, i2) : i2;
        }, me.prototype.options = {maxZoom: 14, indexMaxZoom: 5, indexMaxPoints: 1e5, tolerance: 3, extent: 4096, buffer: 64, lineMetrics: false, promoteId: null, generateId: false, debug: 0}, me.prototype.splitTile = function(e2, t2, r2, i2, o2, n2, s2) {
          for (var a2 = [e2, t2, r2, i2], l2 = this.options, u2 = l2.debug; a2.length; ) {
            i2 = a2.pop(), r2 = a2.pop(), t2 = a2.pop(), e2 = a2.pop();
            var h2 = 1 << t2, c2 = ye(t2, r2, i2), p2 = this.tiles[c2];
            if (!p2 && (u2 > 1 && console.time("creation"), p2 = this.tiles[c2] = de(e2, t2, r2, i2, l2), this.tileCoords.push({z: t2, x: r2, y: i2}), u2)) {
              u2 > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t2, r2, i2, p2.numFeatures, p2.numPoints, p2.numSimplified), console.timeEnd("creation"));
              var f2 = "z" + t2;
              this.stats[f2] = (this.stats[f2] || 0) + 1, this.total++;
            }
            if (p2.source = e2, o2) {
              if (t2 === l2.maxZoom || t2 === o2)
                continue;
              var d2 = 1 << o2 - t2;
              if (r2 !== Math.floor(n2 / d2) || i2 !== Math.floor(s2 / d2))
                continue;
            } else if (t2 === l2.indexMaxZoom || p2.numPoints <= l2.indexMaxPoints)
              continue;
            if (p2.source = null, e2.length !== 0) {
              u2 > 1 && console.time("clipping");
              var g2, v2, m2, y2, x2, w2, S2 = 0.5 * l2.buffer / l2.extent, I2 = 0.5 - S2, M2 = 0.5 + S2, b2 = 1 + S2;
              g2 = v2 = m2 = y2 = null, x2 = re(e2, h2, r2 - S2, r2 + M2, 0, p2.minX, p2.maxX, l2), w2 = re(e2, h2, r2 + I2, r2 + b2, 0, p2.minX, p2.maxX, l2), e2 = null, x2 && (g2 = re(x2, h2, i2 - S2, i2 + M2, 1, p2.minY, p2.maxY, l2), v2 = re(x2, h2, i2 + I2, i2 + b2, 1, p2.minY, p2.maxY, l2), x2 = null), w2 && (m2 = re(w2, h2, i2 - S2, i2 + M2, 1, p2.minY, p2.maxY, l2), y2 = re(w2, h2, i2 + I2, i2 + b2, 1, p2.minY, p2.maxY, l2), w2 = null), u2 > 1 && console.timeEnd("clipping"), a2.push(g2 || [], t2 + 1, 2 * r2, 2 * i2), a2.push(v2 || [], t2 + 1, 2 * r2, 2 * i2 + 1), a2.push(m2 || [], t2 + 1, 2 * r2 + 1, 2 * i2), a2.push(y2 || [], t2 + 1, 2 * r2 + 1, 2 * i2 + 1);
            }
          }
        }, me.prototype.getTile = function(e2, t2, r2) {
          var i2 = this.options, o2 = i2.extent, n2 = i2.debug;
          if (e2 < 0 || e2 > 24)
            return null;
          var s2 = 1 << e2, a2 = ye(e2, t2 = (t2 % s2 + s2) % s2, r2);
          if (this.tiles[a2])
            return pe(this.tiles[a2], o2);
          n2 > 1 && console.log("drilling down to z%d-%d-%d", e2, t2, r2);
          for (var l2, u2 = e2, h2 = t2, c2 = r2; !l2 && u2 > 0; )
            u2--, h2 = Math.floor(h2 / 2), c2 = Math.floor(c2 / 2), l2 = this.tiles[ye(u2, h2, c2)];
          return l2 && l2.source ? (n2 > 1 && console.log("found parent tile z%d-%d-%d", u2, h2, c2), n2 > 1 && console.time("drilling down"), this.splitTile(l2.source, u2, h2, c2, e2, t2, r2), n2 > 1 && console.timeEnd("drilling down"), this.tiles[a2] ? pe(this.tiles[a2], o2) : null) : null;
        };
        var we = function(t2) {
          function r2(e2, r3, i2, o2) {
            t2.call(this, e2, r3, i2, xe), o2 && (this.loadGeoJSON = o2);
          }
          return t2 && (r2.__proto__ = t2), (r2.prototype = Object.create(t2 && t2.prototype)).constructor = r2, r2.prototype.loadData = function(e2, t3) {
            this._pendingCallback && this._pendingCallback(null, {abandoned: true}), this._pendingCallback = t3, this._pendingLoadDataParams = e2, this._state && this._state !== "Idle" ? this._state = "NeedsLoadData" : (this._state = "Coalescing", this._loadData());
          }, r2.prototype._loadData = function() {
            var t3 = this;
            if (this._pendingCallback && this._pendingLoadDataParams) {
              var r3 = this._pendingCallback, i2 = this._pendingLoadDataParams;
              delete this._pendingCallback, delete this._pendingLoadDataParams;
              var o2 = !!(i2 && i2.request && i2.request.collectResourceTiming) && new e.RequestPerformance(i2.request);
              this.loadGeoJSON(i2, function(n2, s2) {
                if (n2 || !s2)
                  return r3(n2);
                if (typeof s2 != "object")
                  return r3(new Error("Input data given to '" + i2.source + "' is not a valid GeoJSON object."));
                !function e2(t4, r4) {
                  var i3, o3 = t4 && t4.type;
                  if (o3 === "FeatureCollection")
                    for (i3 = 0; i3 < t4.features.length; i3++)
                      e2(t4.features[i3], r4);
                  else if (o3 === "GeometryCollection")
                    for (i3 = 0; i3 < t4.geometries.length; i3++)
                      e2(t4.geometries[i3], r4);
                  else if (o3 === "Feature")
                    e2(t4.geometry, r4);
                  else if (o3 === "Polygon")
                    c(t4.coordinates, r4);
                  else if (o3 === "MultiPolygon")
                    for (i3 = 0; i3 < t4.coordinates.length; i3++)
                      c(t4.coordinates[i3], r4);
                  return t4;
                }(s2, true);
                try {
                  if (i2.filter) {
                    var a2 = e.createExpression(i2.filter, {type: "boolean", "property-type": "data-driven", overridable: false, transition: false});
                    if (a2.result === "error")
                      throw new Error(a2.value.map(function(e2) {
                        return e2.key + ": " + e2.message;
                      }).join(", "));
                    var l2 = s2.features.filter(function(e2) {
                      return a2.value.evaluate({zoom: 0}, e2);
                    });
                    s2 = {type: "FeatureCollection", features: l2};
                  }
                  t3._geoJSONIndex = i2.cluster ? new J(function(t4) {
                    var r4 = t4.superclusterOptions, i3 = t4.clusterProperties;
                    if (!i3 || !r4)
                      return r4;
                    for (var o3 = {}, n3 = {}, s3 = {accumulated: null, zoom: 0}, a3 = {properties: null}, l3 = Object.keys(i3), u3 = 0, h3 = l3; u3 < h3.length; u3 += 1) {
                      var c2 = h3[u3], p2 = i3[c2], f2 = p2[0], d2 = e.createExpression(p2[1]), g2 = e.createExpression(typeof f2 == "string" ? [f2, ["accumulated"], ["get", c2]] : f2);
                      o3[c2] = d2.value, n3[c2] = g2.value;
                    }
                    return r4.map = function(e2) {
                      a3.properties = e2;
                      for (var t5 = {}, r5 = 0, i4 = l3; r5 < i4.length; r5 += 1) {
                        var n4 = i4[r5];
                        t5[n4] = o3[n4].evaluate(s3, a3);
                      }
                      return t5;
                    }, r4.reduce = function(e2, t5) {
                      a3.properties = t5;
                      for (var r5 = 0, i4 = l3; r5 < i4.length; r5 += 1) {
                        var o4 = i4[r5];
                        s3.accumulated = e2[o4], e2[o4] = n3[o4].evaluate(s3, a3);
                      }
                    }, r4;
                  }(i2)).load(s2.features) : function(e2, t4) {
                    return new me(e2, t4);
                  }(s2, i2.geojsonVtOptions);
                } catch (n3) {
                  return r3(n3);
                }
                t3.loaded = {};
                var u2 = {};
                if (o2) {
                  var h2 = o2.finish();
                  h2 && (u2.resourceTiming = {}, u2.resourceTiming[i2.source] = JSON.parse(JSON.stringify(h2)));
                }
                r3(null, u2);
              });
            }
          }, r2.prototype.coalesce = function() {
            this._state === "Coalescing" ? this._state = "Idle" : this._state === "NeedsLoadData" && (this._state = "Coalescing", this._loadData());
          }, r2.prototype.reloadTile = function(e2, r3) {
            var i2 = this.loaded;
            return i2 && i2[e2.uid] ? t2.prototype.reloadTile.call(this, e2, r3) : this.loadTile(e2, r3);
          }, r2.prototype.loadGeoJSON = function(t3, r3) {
            if (t3.request)
              e.getJSON(t3.request, r3);
            else {
              if (typeof t3.data != "string")
                return r3(new Error("Input data given to '" + t3.source + "' is not a valid GeoJSON object."));
              try {
                return r3(null, JSON.parse(t3.data));
              } catch (e2) {
                return r3(new Error("Input data given to '" + t3.source + "' is not a valid GeoJSON object."));
              }
            }
          }, r2.prototype.removeSource = function(e2, t3) {
            this._pendingCallback && this._pendingCallback(null, {abandoned: true}), t3();
          }, r2.prototype.getClusterExpansionZoom = function(e2, t3) {
            try {
              t3(null, this._geoJSONIndex.getClusterExpansionZoom(e2.clusterId));
            } catch (e3) {
              t3(e3);
            }
          }, r2.prototype.getClusterChildren = function(e2, t3) {
            try {
              t3(null, this._geoJSONIndex.getChildren(e2.clusterId));
            } catch (e3) {
              t3(e3);
            }
          }, r2.prototype.getClusterLeaves = function(e2, t3) {
            try {
              t3(null, this._geoJSONIndex.getLeaves(e2.clusterId, e2.limit, e2.offset));
            } catch (e3) {
              t3(e3);
            }
          }, r2;
        }(l), Se = function(t2) {
          var r2 = this;
          this.self = t2, this.actor = new e.Actor(t2, this), this.layerIndexes = {}, this.availableImages = {}, this.workerSourceTypes = {vector: l, geojson: we}, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = function(e2, t3) {
            if (r2.workerSourceTypes[e2])
              throw new Error('Worker source with name "' + e2 + '" already registered.');
            r2.workerSourceTypes[e2] = t3;
          }, this.self.registerRTLTextPlugin = function(t3) {
            if (e.plugin.isParsed())
              throw new Error("RTL text plugin already registered.");
            e.plugin.applyArabicShaping = t3.applyArabicShaping, e.plugin.processBidirectionalText = t3.processBidirectionalText, e.plugin.processStyledBidirectionalText = t3.processStyledBidirectionalText;
          };
        };
        return Se.prototype.setReferrer = function(e2, t2) {
          this.referrer = t2;
        }, Se.prototype.setImages = function(e2, t2, r2) {
          for (var i2 in this.availableImages[e2] = t2, this.workerSources[e2]) {
            var o2 = this.workerSources[e2][i2];
            for (var n2 in o2)
              o2[n2].availableImages = t2;
          }
          r2();
        }, Se.prototype.setLayers = function(e2, t2, r2) {
          this.getLayerIndex(e2).replace(t2), r2();
        }, Se.prototype.updateLayers = function(e2, t2, r2) {
          this.getLayerIndex(e2).update(t2.layers, t2.removedIds), r2();
        }, Se.prototype.loadTile = function(e2, t2, r2) {
          this.getWorkerSource(e2, t2.type, t2.source).loadTile(t2, r2);
        }, Se.prototype.loadDEMTile = function(e2, t2, r2) {
          this.getDEMWorkerSource(e2, t2.source).loadTile(t2, r2);
        }, Se.prototype.reloadTile = function(e2, t2, r2) {
          this.getWorkerSource(e2, t2.type, t2.source).reloadTile(t2, r2);
        }, Se.prototype.abortTile = function(e2, t2, r2) {
          this.getWorkerSource(e2, t2.type, t2.source).abortTile(t2, r2);
        }, Se.prototype.removeTile = function(e2, t2, r2) {
          this.getWorkerSource(e2, t2.type, t2.source).removeTile(t2, r2);
        }, Se.prototype.removeDEMTile = function(e2, t2) {
          this.getDEMWorkerSource(e2, t2.source).removeTile(t2);
        }, Se.prototype.removeSource = function(e2, t2, r2) {
          if (this.workerSources[e2] && this.workerSources[e2][t2.type] && this.workerSources[e2][t2.type][t2.source]) {
            var i2 = this.workerSources[e2][t2.type][t2.source];
            delete this.workerSources[e2][t2.type][t2.source], i2.removeSource !== void 0 ? i2.removeSource(t2, r2) : r2();
          }
        }, Se.prototype.loadWorkerSource = function(e2, t2, r2) {
          try {
            this.self.importScripts(t2.url), r2();
          } catch (e3) {
            r2(e3.toString());
          }
        }, Se.prototype.syncRTLPluginState = function(t2, r2, i2) {
          try {
            e.plugin.setState(r2);
            var o2 = e.plugin.getPluginURL();
            if (e.plugin.isLoaded() && !e.plugin.isParsed() && o2 != null) {
              this.self.importScripts(o2);
              var n2 = e.plugin.isParsed();
              i2(n2 ? void 0 : new Error("RTL Text Plugin failed to import scripts from " + o2), n2);
            }
          } catch (e2) {
            i2(e2.toString());
          }
        }, Se.prototype.getAvailableImages = function(e2) {
          var t2 = this.availableImages[e2];
          return t2 || (t2 = []), t2;
        }, Se.prototype.getLayerIndex = function(e2) {
          var t2 = this.layerIndexes[e2];
          return t2 || (t2 = this.layerIndexes[e2] = new i()), t2;
        }, Se.prototype.getWorkerSource = function(e2, t2, r2) {
          var i2 = this;
          return this.workerSources[e2] || (this.workerSources[e2] = {}), this.workerSources[e2][t2] || (this.workerSources[e2][t2] = {}), this.workerSources[e2][t2][r2] || (this.workerSources[e2][t2][r2] = new this.workerSourceTypes[t2]({send: function(t3, r3, o2) {
            i2.actor.send(t3, r3, o2, e2);
          }}, this.getLayerIndex(e2), this.getAvailableImages(e2))), this.workerSources[e2][t2][r2];
        }, Se.prototype.getDEMWorkerSource = function(e2, t2) {
          return this.demWorkerSources[e2] || (this.demWorkerSources[e2] = {}), this.demWorkerSources[e2][t2] || (this.demWorkerSources[e2][t2] = new h()), this.demWorkerSources[e2][t2];
        }, Se.prototype.enforceCacheSizeLimit = function(t2, r2) {
          e.enforceCacheSizeLimit(r2);
        }, typeof WorkerGlobalScope != "undefined" && typeof self != "undefined" && self instanceof WorkerGlobalScope && (self.worker = new Se(self)), Se;
      });
      define2(["./shared"], function(t) {
        "use strict";
        var e = t.createCommonjsModule(function(t2) {
          function e2(t3) {
            return !i2(t3);
          }
          function i2(t3) {
            return typeof window == "undefined" || typeof document == "undefined" ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON" in window && "parse" in JSON && "stringify" in JSON ? function() {
              if (!("Worker" in window && "Blob" in window && "URL" in window))
                return false;
              var t4, e3, i4 = new Blob([""], {type: "text/javascript"}), o3 = URL.createObjectURL(i4);
              try {
                e3 = new Worker(o3), t4 = true;
              } catch (e4) {
                t4 = false;
              }
              return e3 && e3.terminate(), URL.revokeObjectURL(o3), t4;
            }() ? "Uint8ClampedArray" in window ? ArrayBuffer.isView ? function() {
              var t4 = document.createElement("canvas");
              t4.width = t4.height = 1;
              var e3 = t4.getContext("2d");
              if (!e3)
                return false;
              var i4 = e3.getImageData(0, 0, 1, 1);
              return i4 && i4.width === t4.width;
            }() ? (o2[i3 = t3 && t3.failIfMajorPerformanceCaveat] === void 0 && (o2[i3] = function(t4) {
              var i4 = function(t5) {
                var i5 = document.createElement("canvas"), o4 = Object.create(e2.webGLContextAttributes);
                return o4.failIfMajorPerformanceCaveat = t5, i5.probablySupportsContext ? i5.probablySupportsContext("webgl", o4) || i5.probablySupportsContext("experimental-webgl", o4) : i5.supportsContext ? i5.supportsContext("webgl", o4) || i5.supportsContext("experimental-webgl", o4) : i5.getContext("webgl", o4) || i5.getContext("experimental-webgl", o4);
              }(t4);
              if (!i4)
                return false;
              var o3 = i4.createShader(i4.VERTEX_SHADER);
              return !(!o3 || i4.isContextLost()) && (i4.shaderSource(o3, "void main() {}"), i4.compileShader(o3), i4.getShaderParameter(o3, i4.COMPILE_STATUS) === true);
            }(i3)), o2[i3] ? void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
            var i3;
          }
          t2.exports ? t2.exports = e2 : window && (window.mapboxgl = window.mapboxgl || {}, window.mapboxgl.supported = e2, window.mapboxgl.notSupportedReason = i2);
          var o2 = {};
          e2.webGLContextAttributes = {antialias: false, alpha: true, stencil: true, depth: true};
        }), i = {create: function(e2, i2, o2) {
          var r2 = t.window.document.createElement(e2);
          return i2 !== void 0 && (r2.className = i2), o2 && o2.appendChild(r2), r2;
        }, createNS: function(e2, i2) {
          return t.window.document.createElementNS(e2, i2);
        }}, o = t.window.document && t.window.document.documentElement.style;
        function r(t2) {
          if (!o)
            return t2[0];
          for (var e2 = 0; e2 < t2.length; e2++)
            if (t2[e2] in o)
              return t2[e2];
          return t2[0];
        }
        var a, n = r(["userSelect", "MozUserSelect", "WebkitUserSelect", "msUserSelect"]);
        i.disableDrag = function() {
          o && n && (a = o[n], o[n] = "none");
        }, i.enableDrag = function() {
          o && n && (o[n] = a);
        };
        var s = r(["transform", "WebkitTransform"]);
        i.setTransform = function(t2, e2) {
          t2.style[s] = e2;
        };
        var l = false;
        try {
          var c = Object.defineProperty({}, "passive", {get: function() {
            l = true;
          }});
          t.window.addEventListener("test", c, c), t.window.removeEventListener("test", c, c);
        } catch (t2) {
          l = false;
        }
        i.addEventListener = function(t2, e2, i2, o2) {
          o2 === void 0 && (o2 = {}), t2.addEventListener(e2, i2, "passive" in o2 && l ? o2 : o2.capture);
        }, i.removeEventListener = function(t2, e2, i2, o2) {
          o2 === void 0 && (o2 = {}), t2.removeEventListener(e2, i2, "passive" in o2 && l ? o2 : o2.capture);
        };
        var u = function(e2) {
          e2.preventDefault(), e2.stopPropagation(), t.window.removeEventListener("click", u, true);
        };
        function h(t2) {
          var e2 = t2.userImage;
          return !!(e2 && e2.render && e2.render()) && (t2.data.replace(new Uint8Array(e2.data.buffer)), true);
        }
        i.suppressClick = function() {
          t.window.addEventListener("click", u, true), t.window.setTimeout(function() {
            t.window.removeEventListener("click", u, true);
          }, 0);
        }, i.mousePos = function(e2, i2) {
          var o2 = e2.getBoundingClientRect();
          return new t.Point(i2.clientX - o2.left - e2.clientLeft, i2.clientY - o2.top - e2.clientTop);
        }, i.touchPos = function(e2, i2) {
          for (var o2 = e2.getBoundingClientRect(), r2 = [], a2 = 0; a2 < i2.length; a2++)
            r2.push(new t.Point(i2[a2].clientX - o2.left - e2.clientLeft, i2[a2].clientY - o2.top - e2.clientTop));
          return r2;
        }, i.mouseButton = function(e2) {
          return t.window.InstallTrigger !== void 0 && e2.button === 2 && e2.ctrlKey && t.window.navigator.platform.toUpperCase().indexOf("MAC") >= 0 ? 0 : e2.button;
        }, i.remove = function(t2) {
          t2.parentNode && t2.parentNode.removeChild(t2);
        };
        var p = function(e2) {
          function i2() {
            e2.call(this), this.images = {}, this.updatedImages = {}, this.callbackDispatchedThisFrame = {}, this.loaded = false, this.requestors = [], this.patterns = {}, this.atlasImage = new t.RGBAImage({width: 1, height: 1}), this.dirty = true;
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.isLoaded = function() {
            return this.loaded;
          }, i2.prototype.setLoaded = function(t2) {
            if (this.loaded !== t2 && (this.loaded = t2, t2)) {
              for (var e3 = 0, i3 = this.requestors; e3 < i3.length; e3 += 1) {
                var o2 = i3[e3];
                this._notify(o2.ids, o2.callback);
              }
              this.requestors = [];
            }
          }, i2.prototype.getImage = function(t2) {
            return this.images[t2];
          }, i2.prototype.addImage = function(t2, e3) {
            this._validate(t2, e3) && (this.images[t2] = e3);
          }, i2.prototype._validate = function(e3, i3) {
            var o2 = true;
            return this._validateStretch(i3.stretchX, i3.data && i3.data.width) || (this.fire(new t.ErrorEvent(new Error('Image "' + e3 + '" has invalid "stretchX" value'))), o2 = false), this._validateStretch(i3.stretchY, i3.data && i3.data.height) || (this.fire(new t.ErrorEvent(new Error('Image "' + e3 + '" has invalid "stretchY" value'))), o2 = false), this._validateContent(i3.content, i3) || (this.fire(new t.ErrorEvent(new Error('Image "' + e3 + '" has invalid "content" value'))), o2 = false), o2;
          }, i2.prototype._validateStretch = function(t2, e3) {
            if (!t2)
              return true;
            for (var i3 = 0, o2 = 0, r2 = t2; o2 < r2.length; o2 += 1) {
              var a2 = r2[o2];
              if (a2[0] < i3 || a2[1] < a2[0] || e3 < a2[1])
                return false;
              i3 = a2[1];
            }
            return true;
          }, i2.prototype._validateContent = function(t2, e3) {
            return !(t2 && (t2.length !== 4 || t2[0] < 0 || e3.data.width < t2[0] || t2[1] < 0 || e3.data.height < t2[1] || t2[2] < 0 || e3.data.width < t2[2] || t2[3] < 0 || e3.data.height < t2[3] || t2[2] < t2[0] || t2[3] < t2[1]));
          }, i2.prototype.updateImage = function(t2, e3) {
            e3.version = this.images[t2].version + 1, this.images[t2] = e3, this.updatedImages[t2] = true;
          }, i2.prototype.removeImage = function(t2) {
            var e3 = this.images[t2];
            delete this.images[t2], delete this.patterns[t2], e3.userImage && e3.userImage.onRemove && e3.userImage.onRemove();
          }, i2.prototype.listImages = function() {
            return Object.keys(this.images);
          }, i2.prototype.getImages = function(t2, e3) {
            var i3 = true;
            if (!this.isLoaded())
              for (var o2 = 0, r2 = t2; o2 < r2.length; o2 += 1)
                this.images[r2[o2]] || (i3 = false);
            this.isLoaded() || i3 ? this._notify(t2, e3) : this.requestors.push({ids: t2, callback: e3});
          }, i2.prototype._notify = function(e3, i3) {
            for (var o2 = {}, r2 = 0, a2 = e3; r2 < a2.length; r2 += 1) {
              var n2 = a2[r2];
              this.images[n2] || this.fire(new t.Event("styleimagemissing", {id: n2}));
              var s2 = this.images[n2];
              s2 ? o2[n2] = {data: s2.data.clone(), pixelRatio: s2.pixelRatio, sdf: s2.sdf, version: s2.version, stretchX: s2.stretchX, stretchY: s2.stretchY, content: s2.content, hasRenderCallback: Boolean(s2.userImage && s2.userImage.render)} : t.warnOnce('Image "' + n2 + '" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.');
            }
            i3(null, o2);
          }, i2.prototype.getPixelSize = function() {
            var t2 = this.atlasImage;
            return {width: t2.width, height: t2.height};
          }, i2.prototype.getPattern = function(e3) {
            var i3 = this.patterns[e3], o2 = this.getImage(e3);
            if (!o2)
              return null;
            if (i3 && i3.position.version === o2.version)
              return i3.position;
            if (i3)
              i3.position.version = o2.version;
            else {
              var r2 = {w: o2.data.width + 2, h: o2.data.height + 2, x: 0, y: 0}, a2 = new t.ImagePosition(r2, o2);
              this.patterns[e3] = {bin: r2, position: a2};
            }
            return this._updatePatternAtlas(), this.patterns[e3].position;
          }, i2.prototype.bind = function(e3) {
            var i3 = e3.gl;
            this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = false) : this.atlasTexture = new t.Texture(e3, this.atlasImage, i3.RGBA), this.atlasTexture.bind(i3.LINEAR, i3.CLAMP_TO_EDGE);
          }, i2.prototype._updatePatternAtlas = function() {
            var e3 = [];
            for (var i3 in this.patterns)
              e3.push(this.patterns[i3].bin);
            var o2 = t.potpack(e3), r2 = o2.w, a2 = o2.h, n2 = this.atlasImage;
            for (var s2 in n2.resize({width: r2 || 1, height: a2 || 1}), this.patterns) {
              var l2 = this.patterns[s2].bin, c2 = l2.x + 1, u2 = l2.y + 1, h2 = this.images[s2].data, p2 = h2.width, d2 = h2.height;
              t.RGBAImage.copy(h2, n2, {x: 0, y: 0}, {x: c2, y: u2}, {width: p2, height: d2}), t.RGBAImage.copy(h2, n2, {x: 0, y: d2 - 1}, {x: c2, y: u2 - 1}, {width: p2, height: 1}), t.RGBAImage.copy(h2, n2, {x: 0, y: 0}, {x: c2, y: u2 + d2}, {width: p2, height: 1}), t.RGBAImage.copy(h2, n2, {x: p2 - 1, y: 0}, {x: c2 - 1, y: u2}, {width: 1, height: d2}), t.RGBAImage.copy(h2, n2, {x: 0, y: 0}, {x: c2 + p2, y: u2}, {width: 1, height: d2});
            }
            this.dirty = true;
          }, i2.prototype.beginFrame = function() {
            this.callbackDispatchedThisFrame = {};
          }, i2.prototype.dispatchRenderCallbacks = function(t2) {
            for (var e3 = 0, i3 = t2; e3 < i3.length; e3 += 1) {
              var o2 = i3[e3];
              if (!this.callbackDispatchedThisFrame[o2]) {
                this.callbackDispatchedThisFrame[o2] = true;
                var r2 = this.images[o2];
                h(r2) && this.updateImage(o2, r2);
              }
            }
          }, i2;
        }(t.Evented), d = m, _ = m, f = 1e20;
        function m(t2, e2, i2, o2, r2, a2) {
          this.fontSize = t2 || 24, this.buffer = e2 === void 0 ? 3 : e2, this.cutoff = o2 || 0.25, this.fontFamily = r2 || "sans-serif", this.fontWeight = a2 || "normal", this.radius = i2 || 8;
          var n2 = this.size = this.fontSize + 2 * this.buffer;
          this.canvas = document.createElement("canvas"), this.canvas.width = this.canvas.height = n2, this.ctx = this.canvas.getContext("2d"), this.ctx.font = this.fontWeight + " " + this.fontSize + "px " + this.fontFamily, this.ctx.textBaseline = "middle", this.ctx.fillStyle = "black", this.gridOuter = new Float64Array(n2 * n2), this.gridInner = new Float64Array(n2 * n2), this.f = new Float64Array(n2), this.d = new Float64Array(n2), this.z = new Float64Array(n2 + 1), this.v = new Int16Array(n2), this.middle = Math.round(n2 / 2 * (navigator.userAgent.indexOf("Gecko/") >= 0 ? 1.2 : 1));
        }
        function g(t2, e2, i2, o2, r2, a2, n2) {
          for (var s2 = 0; s2 < e2; s2++) {
            for (var l2 = 0; l2 < i2; l2++)
              o2[l2] = t2[l2 * e2 + s2];
            for (v(o2, r2, a2, n2, i2), l2 = 0; l2 < i2; l2++)
              t2[l2 * e2 + s2] = r2[l2];
          }
          for (l2 = 0; l2 < i2; l2++) {
            for (s2 = 0; s2 < e2; s2++)
              o2[s2] = t2[l2 * e2 + s2];
            for (v(o2, r2, a2, n2, e2), s2 = 0; s2 < e2; s2++)
              t2[l2 * e2 + s2] = Math.sqrt(r2[s2]);
          }
        }
        function v(t2, e2, i2, o2, r2) {
          i2[0] = 0, o2[0] = -f, o2[1] = +f;
          for (var a2 = 1, n2 = 0; a2 < r2; a2++) {
            for (var s2 = (t2[a2] + a2 * a2 - (t2[i2[n2]] + i2[n2] * i2[n2])) / (2 * a2 - 2 * i2[n2]); s2 <= o2[n2]; )
              n2--, s2 = (t2[a2] + a2 * a2 - (t2[i2[n2]] + i2[n2] * i2[n2])) / (2 * a2 - 2 * i2[n2]);
            i2[++n2] = a2, o2[n2] = s2, o2[n2 + 1] = +f;
          }
          for (a2 = 0, n2 = 0; a2 < r2; a2++) {
            for (; o2[n2 + 1] < a2; )
              n2++;
            e2[a2] = (a2 - i2[n2]) * (a2 - i2[n2]) + t2[i2[n2]];
          }
        }
        m.prototype.draw = function(t2) {
          this.ctx.clearRect(0, 0, this.size, this.size), this.ctx.fillText(t2, this.buffer, this.middle);
          for (var e2 = this.ctx.getImageData(0, 0, this.size, this.size), i2 = new Uint8ClampedArray(this.size * this.size), o2 = 0; o2 < this.size * this.size; o2++) {
            var r2 = e2.data[4 * o2 + 3] / 255;
            this.gridOuter[o2] = r2 === 1 ? 0 : r2 === 0 ? f : Math.pow(Math.max(0, 0.5 - r2), 2), this.gridInner[o2] = r2 === 1 ? f : r2 === 0 ? 0 : Math.pow(Math.max(0, r2 - 0.5), 2);
          }
          for (g(this.gridOuter, this.size, this.size, this.f, this.d, this.v, this.z), g(this.gridInner, this.size, this.size, this.f, this.d, this.v, this.z), o2 = 0; o2 < this.size * this.size; o2++)
            i2[o2] = Math.max(0, Math.min(255, Math.round(255 - 255 * ((this.gridOuter[o2] - this.gridInner[o2]) / this.radius + this.cutoff))));
          return i2;
        }, d.default = _;
        var y = function(t2, e2) {
          this.requestManager = t2, this.localIdeographFontFamily = e2, this.entries = {};
        };
        y.prototype.setURL = function(t2) {
          this.url = t2;
        }, y.prototype.getGlyphs = function(e2, i2) {
          var o2 = this, r2 = [];
          for (var a2 in e2)
            for (var n2 = 0, s2 = e2[a2]; n2 < s2.length; n2 += 1)
              r2.push({stack: a2, id: s2[n2]});
          t.asyncAll(r2, function(t2, e3) {
            var i3 = t2.stack, r3 = t2.id, a3 = o2.entries[i3];
            a3 || (a3 = o2.entries[i3] = {glyphs: {}, requests: {}, ranges: {}});
            var n3 = a3.glyphs[r3];
            if (n3 === void 0) {
              if (n3 = o2._tinySDF(a3, i3, r3))
                return a3.glyphs[r3] = n3, void e3(null, {stack: i3, id: r3, glyph: n3});
              var s3 = Math.floor(r3 / 256);
              if (256 * s3 > 65535)
                e3(new Error("glyphs > 65535 not supported"));
              else if (a3.ranges[s3])
                e3(null, {stack: i3, id: r3, glyph: n3});
              else {
                var l2 = a3.requests[s3];
                l2 || (l2 = a3.requests[s3] = [], y.loadGlyphRange(i3, s3, o2.url, o2.requestManager, function(t3, e4) {
                  if (e4) {
                    for (var i4 in e4)
                      o2._doesCharSupportLocalGlyph(+i4) || (a3.glyphs[+i4] = e4[+i4]);
                    a3.ranges[s3] = true;
                  }
                  for (var r4 = 0, n4 = l2; r4 < n4.length; r4 += 1)
                    (0, n4[r4])(t3, e4);
                  delete a3.requests[s3];
                })), l2.push(function(t3, o3) {
                  t3 ? e3(t3) : o3 && e3(null, {stack: i3, id: r3, glyph: o3[r3] || null});
                });
              }
            } else
              e3(null, {stack: i3, id: r3, glyph: n3});
          }, function(t2, e3) {
            if (t2)
              i2(t2);
            else if (e3) {
              for (var o3 = {}, r3 = 0, a3 = e3; r3 < a3.length; r3 += 1) {
                var n3 = a3[r3], s3 = n3.stack, l2 = n3.id, c2 = n3.glyph;
                (o3[s3] || (o3[s3] = {}))[l2] = c2 && {id: c2.id, bitmap: c2.bitmap.clone(), metrics: c2.metrics};
              }
              i2(null, o3);
            }
          });
        }, y.prototype._doesCharSupportLocalGlyph = function(e2) {
          return !!this.localIdeographFontFamily && (t.isChar["CJK Unified Ideographs"](e2) || t.isChar["Hangul Syllables"](e2) || t.isChar.Hiragana(e2) || t.isChar.Katakana(e2));
        }, y.prototype._tinySDF = function(e2, i2, o2) {
          var r2 = this.localIdeographFontFamily;
          if (r2 && this._doesCharSupportLocalGlyph(o2)) {
            var a2 = e2.tinySDF;
            if (!a2) {
              var n2 = "400";
              /bold/i.test(i2) ? n2 = "900" : /medium/i.test(i2) ? n2 = "500" : /light/i.test(i2) && (n2 = "200"), a2 = e2.tinySDF = new y.TinySDF(24, 3, 8, 0.25, r2, n2);
            }
            return {id: o2, bitmap: new t.AlphaImage({width: 30, height: 30}, a2.draw(String.fromCharCode(o2))), metrics: {width: 24, height: 24, left: 0, top: -8, advance: 24}};
          }
        }, y.loadGlyphRange = function(e2, i2, o2, r2, a2) {
          var n2 = 256 * i2, s2 = n2 + 255, l2 = r2.transformRequest(r2.normalizeGlyphsURL(o2).replace("{fontstack}", e2).replace("{range}", n2 + "-" + s2), t.ResourceType.Glyphs);
          t.getArrayBuffer(l2, function(e3, i3) {
            if (e3)
              a2(e3);
            else if (i3) {
              for (var o3 = {}, r3 = 0, n3 = t.parseGlyphPBF(i3); r3 < n3.length; r3 += 1) {
                var s3 = n3[r3];
                o3[s3.id] = s3;
              }
              a2(null, o3);
            }
          });
        }, y.TinySDF = d;
        var x = function() {
          this.specification = t.styleSpec.light.position;
        };
        x.prototype.possiblyEvaluate = function(e2, i2) {
          return t.sphericalToCartesian(e2.expression.evaluate(i2));
        }, x.prototype.interpolate = function(e2, i2, o2) {
          return {x: t.number(e2.x, i2.x, o2), y: t.number(e2.y, i2.y, o2), z: t.number(e2.z, i2.z, o2)};
        };
        var b = new t.Properties({anchor: new t.DataConstantProperty(t.styleSpec.light.anchor), position: new x(), color: new t.DataConstantProperty(t.styleSpec.light.color), intensity: new t.DataConstantProperty(t.styleSpec.light.intensity)}), w = function(e2) {
          function i2(i3) {
            e2.call(this), this._transitionable = new t.Transitionable(b), this.setLight(i3), this._transitioning = this._transitionable.untransitioned();
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.getLight = function() {
            return this._transitionable.serialize();
          }, i2.prototype.setLight = function(e3, i3) {
            if (i3 === void 0 && (i3 = {}), !this._validate(t.validateLight, e3, i3))
              for (var o2 in e3) {
                var r2 = e3[o2];
                t.endsWith(o2, "-transition") ? this._transitionable.setTransition(o2.slice(0, -"-transition".length), r2) : this._transitionable.setValue(o2, r2);
              }
          }, i2.prototype.updateTransitions = function(t2) {
            this._transitioning = this._transitionable.transitioned(t2, this._transitioning);
          }, i2.prototype.hasTransition = function() {
            return this._transitioning.hasTransition();
          }, i2.prototype.recalculate = function(t2) {
            this.properties = this._transitioning.possiblyEvaluate(t2);
          }, i2.prototype._validate = function(e3, i3, o2) {
            return (!o2 || o2.validate !== false) && t.emitValidationErrors(this, e3.call(t.validateStyle, t.extend({value: i3, style: {glyphs: true, sprite: true}, styleSpec: t.styleSpec})));
          }, i2;
        }(t.Evented), T = function(t2, e2) {
          this.width = t2, this.height = e2, this.nextRow = 0, this.data = new Uint8Array(this.width * this.height), this.dashEntry = {};
        };
        T.prototype.getDash = function(t2, e2) {
          var i2 = t2.join(",") + String(e2);
          return this.dashEntry[i2] || (this.dashEntry[i2] = this.addDash(t2, e2)), this.dashEntry[i2];
        }, T.prototype.getDashRanges = function(t2, e2, i2) {
          var o2 = [], r2 = t2.length % 2 == 1 ? -t2[t2.length - 1] * i2 : 0, a2 = t2[0] * i2, n2 = true;
          o2.push({left: r2, right: a2, isDash: n2, zeroLength: t2[0] === 0});
          for (var s2 = t2[0], l2 = 1; l2 < t2.length; l2++) {
            var c2 = t2[l2];
            o2.push({left: r2 = s2 * i2, right: a2 = (s2 += c2) * i2, isDash: n2 = !n2, zeroLength: c2 === 0});
          }
          return o2;
        }, T.prototype.addRoundDash = function(t2, e2, i2) {
          for (var o2 = e2 / 2, r2 = -i2; r2 <= i2; r2++)
            for (var a2 = this.width * (this.nextRow + i2 + r2), n2 = 0, s2 = t2[n2], l2 = 0; l2 < this.width; l2++) {
              l2 / s2.right > 1 && (s2 = t2[++n2]);
              var c2 = Math.abs(l2 - s2.left), u2 = Math.abs(l2 - s2.right), h2 = Math.min(c2, u2), p2 = void 0, d2 = r2 / i2 * (o2 + 1);
              if (s2.isDash) {
                var _2 = o2 - Math.abs(d2);
                p2 = Math.sqrt(h2 * h2 + _2 * _2);
              } else
                p2 = o2 - Math.sqrt(h2 * h2 + d2 * d2);
              this.data[a2 + l2] = Math.max(0, Math.min(255, p2 + 128));
            }
        }, T.prototype.addRegularDash = function(t2) {
          for (var e2 = t2.length - 1; e2 >= 0; --e2) {
            var i2 = t2[e2], o2 = t2[e2 + 1];
            i2.zeroLength ? t2.splice(e2, 1) : o2 && o2.isDash === i2.isDash && (o2.left = i2.left, t2.splice(e2, 1));
          }
          var r2 = t2[0], a2 = t2[t2.length - 1];
          r2.isDash === a2.isDash && (r2.left = a2.left - this.width, a2.right = r2.right + this.width);
          for (var n2 = this.width * this.nextRow, s2 = 0, l2 = t2[s2], c2 = 0; c2 < this.width; c2++) {
            c2 / l2.right > 1 && (l2 = t2[++s2]);
            var u2 = Math.abs(c2 - l2.left), h2 = Math.abs(c2 - l2.right), p2 = Math.min(u2, h2);
            this.data[n2 + c2] = Math.max(0, Math.min(255, (l2.isDash ? p2 : -p2) + 128));
          }
        }, T.prototype.addDash = function(e2, i2) {
          var o2 = i2 ? 7 : 0, r2 = 2 * o2 + 1;
          if (this.nextRow + r2 > this.height)
            return t.warnOnce("LineAtlas out of space"), null;
          for (var a2 = 0, n2 = 0; n2 < e2.length; n2++)
            a2 += e2[n2];
          if (a2 !== 0) {
            var s2 = this.width / a2, l2 = this.getDashRanges(e2, this.width, s2);
            i2 ? this.addRoundDash(l2, s2, o2) : this.addRegularDash(l2);
          }
          var c2 = {y: (this.nextRow + o2 + 0.5) / this.height, height: 2 * o2 / this.height, width: a2};
          return this.nextRow += r2, this.dirty = true, c2;
        }, T.prototype.bind = function(t2) {
          var e2 = t2.gl;
          this.texture ? (e2.bindTexture(e2.TEXTURE_2D, this.texture), this.dirty && (this.dirty = false, e2.texSubImage2D(e2.TEXTURE_2D, 0, 0, 0, this.width, this.height, e2.ALPHA, e2.UNSIGNED_BYTE, this.data))) : (this.texture = e2.createTexture(), e2.bindTexture(e2.TEXTURE_2D, this.texture), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_WRAP_S, e2.REPEAT), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_WRAP_T, e2.REPEAT), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_MIN_FILTER, e2.LINEAR), e2.texParameteri(e2.TEXTURE_2D, e2.TEXTURE_MAG_FILTER, e2.LINEAR), e2.texImage2D(e2.TEXTURE_2D, 0, e2.ALPHA, this.width, this.height, 0, e2.ALPHA, e2.UNSIGNED_BYTE, this.data));
        };
        var E = function e2(i2, o2) {
          this.workerPool = i2, this.actors = [], this.currentActor = 0, this.id = t.uniqueId();
          for (var r2 = this.workerPool.acquire(this.id), a2 = 0; a2 < r2.length; a2++) {
            var n2 = new e2.Actor(r2[a2], o2, this.id);
            n2.name = "Worker " + a2, this.actors.push(n2);
          }
        };
        function I(e2, i2, o2) {
          var r2 = function(r3, a2) {
            if (r3)
              return o2(r3);
            if (a2) {
              var n2 = t.pick(t.extend(a2, e2), ["tiles", "minzoom", "maxzoom", "attribution", "mapbox_logo", "bounds", "scheme", "tileSize", "encoding"]);
              a2.vector_layers && (n2.vectorLayers = a2.vector_layers, n2.vectorLayerIds = n2.vectorLayers.map(function(t2) {
                return t2.id;
              })), n2.tiles = i2.canonicalizeTileset(n2, e2.url), o2(null, n2);
            }
          };
          return e2.url ? t.getJSON(i2.transformRequest(i2.normalizeSourceURL(e2.url), t.ResourceType.Source), r2) : t.browser.frame(function() {
            return r2(null, e2);
          });
        }
        E.prototype.broadcast = function(e2, i2, o2) {
          t.asyncAll(this.actors, function(t2, o3) {
            t2.send(e2, i2, o3);
          }, o2 = o2 || function() {
          });
        }, E.prototype.getActor = function() {
          return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor];
        }, E.prototype.remove = function() {
          this.actors.forEach(function(t2) {
            t2.remove();
          }), this.actors = [], this.workerPool.release(this.id);
        }, E.Actor = t.Actor;
        var P = function(e2, i2, o2) {
          this.bounds = t.LngLatBounds.convert(this.validateBounds(e2)), this.minzoom = i2 || 0, this.maxzoom = o2 || 24;
        };
        P.prototype.validateBounds = function(t2) {
          return Array.isArray(t2) && t2.length === 4 ? [Math.max(-180, t2[0]), Math.max(-90, t2[1]), Math.min(180, t2[2]), Math.min(90, t2[3])] : [-180, -90, 180, 90];
        }, P.prototype.contains = function(e2) {
          var i2 = Math.pow(2, e2.z), o2 = Math.floor(t.mercatorXfromLng(this.bounds.getWest()) * i2), r2 = Math.floor(t.mercatorYfromLat(this.bounds.getNorth()) * i2), a2 = Math.ceil(t.mercatorXfromLng(this.bounds.getEast()) * i2), n2 = Math.ceil(t.mercatorYfromLat(this.bounds.getSouth()) * i2);
          return e2.x >= o2 && e2.x < a2 && e2.y >= r2 && e2.y < n2;
        };
        var S = function(e2) {
          function i2(i3, o2, r2, a2) {
            if (e2.call(this), this.id = i3, this.dispatcher = r2, this.type = "vector", this.minzoom = 0, this.maxzoom = 22, this.scheme = "xyz", this.tileSize = 512, this.reparseOverscaled = true, this.isTileClipped = true, this._loaded = false, t.extend(this, t.pick(o2, ["url", "scheme", "tileSize", "promoteId"])), this._options = t.extend({type: "vector"}, o2), this._collectResourceTiming = o2.collectResourceTiming, this.tileSize !== 512)
              throw new Error("vector tile sources must have a tileSize of 512");
            this.setEventedParent(a2);
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.load = function() {
            var e3 = this;
            this._loaded = false, this.fire(new t.Event("dataloading", {dataType: "source"})), this._tileJSONRequest = I(this._options, this.map._requestManager, function(i3, o2) {
              e3._tileJSONRequest = null, e3._loaded = true, i3 ? e3.fire(new t.ErrorEvent(i3)) : o2 && (t.extend(e3, o2), o2.bounds && (e3.tileBounds = new P(o2.bounds, e3.minzoom, e3.maxzoom)), t.postTurnstileEvent(o2.tiles, e3.map._requestManager._customAccessToken), t.postMapLoadEvent(o2.tiles, e3.map._getMapId(), e3.map._requestManager._skuToken, e3.map._requestManager._customAccessToken), e3.fire(new t.Event("data", {dataType: "source", sourceDataType: "metadata"})), e3.fire(new t.Event("data", {dataType: "source", sourceDataType: "content"})));
            });
          }, i2.prototype.loaded = function() {
            return this._loaded;
          }, i2.prototype.hasTile = function(t2) {
            return !this.tileBounds || this.tileBounds.contains(t2.canonical);
          }, i2.prototype.onAdd = function(t2) {
            this.map = t2, this.load();
          }, i2.prototype.setSourceProperty = function(t2) {
            this._tileJSONRequest && this._tileJSONRequest.cancel(), t2(), this.map.style.sourceCaches[this.id].clearTiles(), this.load();
          }, i2.prototype.setTiles = function(t2) {
            var e3 = this;
            return this.setSourceProperty(function() {
              e3._options.tiles = t2;
            }), this;
          }, i2.prototype.setUrl = function(t2) {
            var e3 = this;
            return this.setSourceProperty(function() {
              e3.url = t2, e3._options.url = t2;
            }), this;
          }, i2.prototype.onRemove = function() {
            this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
          }, i2.prototype.serialize = function() {
            return t.extend({}, this._options);
          }, i2.prototype.loadTile = function(e3, i3) {
            var o2 = this.map._requestManager.normalizeTileURL(e3.tileID.canonical.url(this.tiles, this.scheme)), r2 = {request: this.map._requestManager.transformRequest(o2, t.ResourceType.Tile), uid: e3.uid, tileID: e3.tileID, zoom: e3.tileID.overscaledZ, tileSize: this.tileSize * e3.tileID.overscaleFactor(), type: this.type, source: this.id, pixelRatio: t.browser.devicePixelRatio, showCollisionBoxes: this.map.showCollisionBoxes, promoteId: this.promoteId};
            function a2(o3, r3) {
              return delete e3.request, e3.aborted ? i3(null) : o3 && o3.status !== 404 ? i3(o3) : (r3 && r3.resourceTiming && (e3.resourceTiming = r3.resourceTiming), this.map._refreshExpiredTiles && r3 && e3.setExpiryData(r3), e3.loadVectorData(r3, this.map.painter), t.cacheEntryPossiblyAdded(this.dispatcher), i3(null), void (e3.reloadCallback && (this.loadTile(e3, e3.reloadCallback), e3.reloadCallback = null)));
            }
            r2.request.collectResourceTiming = this._collectResourceTiming, e3.actor && e3.state !== "expired" ? e3.state === "loading" ? e3.reloadCallback = i3 : e3.request = e3.actor.send("reloadTile", r2, a2.bind(this)) : (e3.actor = this.dispatcher.getActor(), e3.request = e3.actor.send("loadTile", r2, a2.bind(this)));
          }, i2.prototype.abortTile = function(t2) {
            t2.request && (t2.request.cancel(), delete t2.request), t2.actor && t2.actor.send("abortTile", {uid: t2.uid, type: this.type, source: this.id}, void 0);
          }, i2.prototype.unloadTile = function(t2) {
            t2.unloadVectorData(), t2.actor && t2.actor.send("removeTile", {uid: t2.uid, type: this.type, source: this.id}, void 0);
          }, i2.prototype.hasTransition = function() {
            return false;
          }, i2;
        }(t.Evented), C = function(e2) {
          function i2(i3, o2, r2, a2) {
            e2.call(this), this.id = i3, this.dispatcher = r2, this.setEventedParent(a2), this.type = "raster", this.minzoom = 0, this.maxzoom = 22, this.roundZoom = true, this.scheme = "xyz", this.tileSize = 512, this._loaded = false, this._options = t.extend({type: "raster"}, o2), t.extend(this, t.pick(o2, ["url", "scheme", "tileSize"]));
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.load = function() {
            var e3 = this;
            this._loaded = false, this.fire(new t.Event("dataloading", {dataType: "source"})), this._tileJSONRequest = I(this._options, this.map._requestManager, function(i3, o2) {
              e3._tileJSONRequest = null, e3._loaded = true, i3 ? e3.fire(new t.ErrorEvent(i3)) : o2 && (t.extend(e3, o2), o2.bounds && (e3.tileBounds = new P(o2.bounds, e3.minzoom, e3.maxzoom)), t.postTurnstileEvent(o2.tiles), t.postMapLoadEvent(o2.tiles, e3.map._getMapId(), e3.map._requestManager._skuToken), e3.fire(new t.Event("data", {dataType: "source", sourceDataType: "metadata"})), e3.fire(new t.Event("data", {dataType: "source", sourceDataType: "content"})));
            });
          }, i2.prototype.loaded = function() {
            return this._loaded;
          }, i2.prototype.onAdd = function(t2) {
            this.map = t2, this.load();
          }, i2.prototype.onRemove = function() {
            this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
          }, i2.prototype.serialize = function() {
            return t.extend({}, this._options);
          }, i2.prototype.hasTile = function(t2) {
            return !this.tileBounds || this.tileBounds.contains(t2.canonical);
          }, i2.prototype.loadTile = function(e3, i3) {
            var o2 = this, r2 = this.map._requestManager.normalizeTileURL(e3.tileID.canonical.url(this.tiles, this.scheme), this.tileSize);
            e3.request = t.getImage(this.map._requestManager.transformRequest(r2, t.ResourceType.Tile), function(r3, a2) {
              if (delete e3.request, e3.aborted)
                e3.state = "unloaded", i3(null);
              else if (r3)
                e3.state = "errored", i3(r3);
              else if (a2) {
                o2.map._refreshExpiredTiles && e3.setExpiryData(a2), delete a2.cacheControl, delete a2.expires;
                var n2 = o2.map.painter.context, s2 = n2.gl;
                e3.texture = o2.map.painter.getTileTexture(a2.width), e3.texture ? e3.texture.update(a2, {useMipmap: true}) : (e3.texture = new t.Texture(n2, a2, s2.RGBA, {useMipmap: true}), e3.texture.bind(s2.LINEAR, s2.CLAMP_TO_EDGE, s2.LINEAR_MIPMAP_NEAREST), n2.extTextureFilterAnisotropic && s2.texParameterf(s2.TEXTURE_2D, n2.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, n2.extTextureFilterAnisotropicMax)), e3.state = "loaded", t.cacheEntryPossiblyAdded(o2.dispatcher), i3(null);
              }
            });
          }, i2.prototype.abortTile = function(t2, e3) {
            t2.request && (t2.request.cancel(), delete t2.request), e3();
          }, i2.prototype.unloadTile = function(t2, e3) {
            t2.texture && this.map.painter.saveTileTexture(t2.texture), e3();
          }, i2.prototype.hasTransition = function() {
            return false;
          }, i2;
        }(t.Evented), z = function(e2) {
          function i2(i3, o2, r2, a2) {
            e2.call(this, i3, o2, r2, a2), this.type = "raster-dem", this.maxzoom = 22, this._options = t.extend({type: "raster-dem"}, o2), this.encoding = o2.encoding || "mapbox";
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.serialize = function() {
            return {type: "raster-dem", url: this.url, tileSize: this.tileSize, tiles: this.tiles, bounds: this.bounds, encoding: this.encoding};
          }, i2.prototype.loadTile = function(e3, i3) {
            var o2 = this.map._requestManager.normalizeTileURL(e3.tileID.canonical.url(this.tiles, this.scheme), this.tileSize);
            function r2(t2, o3) {
              t2 && (e3.state = "errored", i3(t2)), o3 && (e3.dem = o3, e3.needsHillshadePrepare = true, e3.state = "loaded", i3(null));
            }
            e3.request = t.getImage(this.map._requestManager.transformRequest(o2, t.ResourceType.Tile), function(o3, a2) {
              if (delete e3.request, e3.aborted)
                e3.state = "unloaded", i3(null);
              else if (o3)
                e3.state = "errored", i3(o3);
              else if (a2) {
                this.map._refreshExpiredTiles && e3.setExpiryData(a2), delete a2.cacheControl, delete a2.expires;
                var n2 = t.window.ImageBitmap && a2 instanceof t.window.ImageBitmap && t.offscreenCanvasSupported() ? a2 : t.browser.getImageData(a2, 1), s2 = {uid: e3.uid, coord: e3.tileID, source: this.id, rawImageData: n2, encoding: this.encoding};
                e3.actor && e3.state !== "expired" || (e3.actor = this.dispatcher.getActor(), e3.actor.send("loadDEMTile", s2, r2.bind(this)));
              }
            }.bind(this)), e3.neighboringTiles = this._getNeighboringTiles(e3.tileID);
          }, i2.prototype._getNeighboringTiles = function(e3) {
            var i3 = e3.canonical, o2 = Math.pow(2, i3.z), r2 = (i3.x - 1 + o2) % o2, a2 = i3.x === 0 ? e3.wrap - 1 : e3.wrap, n2 = (i3.x + 1 + o2) % o2, s2 = i3.x + 1 === o2 ? e3.wrap + 1 : e3.wrap, l2 = {};
            return l2[new t.OverscaledTileID(e3.overscaledZ, a2, i3.z, r2, i3.y).key] = {backfilled: false}, l2[new t.OverscaledTileID(e3.overscaledZ, s2, i3.z, n2, i3.y).key] = {backfilled: false}, i3.y > 0 && (l2[new t.OverscaledTileID(e3.overscaledZ, a2, i3.z, r2, i3.y - 1).key] = {backfilled: false}, l2[new t.OverscaledTileID(e3.overscaledZ, e3.wrap, i3.z, i3.x, i3.y - 1).key] = {backfilled: false}, l2[new t.OverscaledTileID(e3.overscaledZ, s2, i3.z, n2, i3.y - 1).key] = {backfilled: false}), i3.y + 1 < o2 && (l2[new t.OverscaledTileID(e3.overscaledZ, a2, i3.z, r2, i3.y + 1).key] = {backfilled: false}, l2[new t.OverscaledTileID(e3.overscaledZ, e3.wrap, i3.z, i3.x, i3.y + 1).key] = {backfilled: false}, l2[new t.OverscaledTileID(e3.overscaledZ, s2, i3.z, n2, i3.y + 1).key] = {backfilled: false}), l2;
          }, i2.prototype.unloadTile = function(t2) {
            t2.demTexture && this.map.painter.saveTileTexture(t2.demTexture), t2.fbo && (t2.fbo.destroy(), delete t2.fbo), t2.dem && delete t2.dem, delete t2.neighboringTiles, t2.state = "unloaded", t2.actor && t2.actor.send("removeDEMTile", {uid: t2.uid, source: this.id});
          }, i2;
        }(C), D = function(e2) {
          function i2(i3, o2, r2, a2) {
            e2.call(this), this.id = i3, this.type = "geojson", this.minzoom = 0, this.maxzoom = 18, this.tileSize = 512, this.isTileClipped = true, this.reparseOverscaled = true, this._removed = false, this._loaded = false, this.actor = r2.getActor(), this.setEventedParent(a2), this._data = o2.data, this._options = t.extend({}, o2), this._collectResourceTiming = o2.collectResourceTiming, this._resourceTiming = [], o2.maxzoom !== void 0 && (this.maxzoom = o2.maxzoom), o2.type && (this.type = o2.type), o2.attribution && (this.attribution = o2.attribution), this.promoteId = o2.promoteId;
            var n2 = t.EXTENT / this.tileSize;
            this.workerOptions = t.extend({source: this.id, cluster: o2.cluster || false, geojsonVtOptions: {buffer: (o2.buffer !== void 0 ? o2.buffer : 128) * n2, tolerance: (o2.tolerance !== void 0 ? o2.tolerance : 0.375) * n2, extent: t.EXTENT, maxZoom: this.maxzoom, lineMetrics: o2.lineMetrics || false, generateId: o2.generateId || false}, superclusterOptions: {maxZoom: o2.clusterMaxZoom !== void 0 ? Math.min(o2.clusterMaxZoom, this.maxzoom - 1) : this.maxzoom - 1, minPoints: Math.max(2, o2.clusterMinPoints || 2), extent: t.EXTENT, radius: (o2.clusterRadius || 50) * n2, log: false, generateId: o2.generateId || false}, clusterProperties: o2.clusterProperties, filter: o2.filter}, o2.workerOptions);
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.load = function() {
            var e3 = this;
            this.fire(new t.Event("dataloading", {dataType: "source"})), this._updateWorkerData(function(i3) {
              if (i3)
                e3.fire(new t.ErrorEvent(i3));
              else {
                var o2 = {dataType: "source", sourceDataType: "metadata"};
                e3._collectResourceTiming && e3._resourceTiming && e3._resourceTiming.length > 0 && (o2.resourceTiming = e3._resourceTiming, e3._resourceTiming = []), e3.fire(new t.Event("data", o2));
              }
            });
          }, i2.prototype.onAdd = function(t2) {
            this.map = t2, this.load();
          }, i2.prototype.setData = function(e3) {
            var i3 = this;
            return this._data = e3, this.fire(new t.Event("dataloading", {dataType: "source"})), this._updateWorkerData(function(e4) {
              if (e4)
                i3.fire(new t.ErrorEvent(e4));
              else {
                var o2 = {dataType: "source", sourceDataType: "content"};
                i3._collectResourceTiming && i3._resourceTiming && i3._resourceTiming.length > 0 && (o2.resourceTiming = i3._resourceTiming, i3._resourceTiming = []), i3.fire(new t.Event("data", o2));
              }
            }), this;
          }, i2.prototype.getClusterExpansionZoom = function(t2, e3) {
            return this.actor.send("geojson.getClusterExpansionZoom", {clusterId: t2, source: this.id}, e3), this;
          }, i2.prototype.getClusterChildren = function(t2, e3) {
            return this.actor.send("geojson.getClusterChildren", {clusterId: t2, source: this.id}, e3), this;
          }, i2.prototype.getClusterLeaves = function(t2, e3, i3, o2) {
            return this.actor.send("geojson.getClusterLeaves", {source: this.id, clusterId: t2, limit: e3, offset: i3}, o2), this;
          }, i2.prototype._updateWorkerData = function(e3) {
            var i3 = this;
            this._loaded = false;
            var o2 = t.extend({}, this.workerOptions), r2 = this._data;
            typeof r2 == "string" ? (o2.request = this.map._requestManager.transformRequest(t.browser.resolveURL(r2), t.ResourceType.Source), o2.request.collectResourceTiming = this._collectResourceTiming) : o2.data = JSON.stringify(r2), this.actor.send(this.type + ".loadData", o2, function(t2, r3) {
              i3._removed || r3 && r3.abandoned || (i3._loaded = true, r3 && r3.resourceTiming && r3.resourceTiming[i3.id] && (i3._resourceTiming = r3.resourceTiming[i3.id].slice(0)), i3.actor.send(i3.type + ".coalesce", {source: o2.source}, null), e3(t2));
            });
          }, i2.prototype.loaded = function() {
            return this._loaded;
          }, i2.prototype.loadTile = function(e3, i3) {
            var o2 = this, r2 = e3.actor ? "reloadTile" : "loadTile";
            e3.actor = this.actor, e3.request = this.actor.send(r2, {type: this.type, uid: e3.uid, tileID: e3.tileID, zoom: e3.tileID.overscaledZ, maxZoom: this.maxzoom, tileSize: this.tileSize, source: this.id, pixelRatio: t.browser.devicePixelRatio, showCollisionBoxes: this.map.showCollisionBoxes, promoteId: this.promoteId}, function(t2, a2) {
              return delete e3.request, e3.unloadVectorData(), e3.aborted ? i3(null) : t2 ? i3(t2) : (e3.loadVectorData(a2, o2.map.painter, r2 === "reloadTile"), i3(null));
            });
          }, i2.prototype.abortTile = function(t2) {
            t2.request && (t2.request.cancel(), delete t2.request), t2.aborted = true;
          }, i2.prototype.unloadTile = function(t2) {
            t2.unloadVectorData(), this.actor.send("removeTile", {uid: t2.uid, type: this.type, source: this.id});
          }, i2.prototype.onRemove = function() {
            this._removed = true, this.actor.send("removeSource", {type: this.type, source: this.id});
          }, i2.prototype.serialize = function() {
            return t.extend({}, this._options, {type: this.type, data: this._data});
          }, i2.prototype.hasTransition = function() {
            return false;
          }, i2;
        }(t.Evented), A = t.createLayout([{name: "a_pos", type: "Int16", components: 2}, {name: "a_texture_pos", type: "Int16", components: 2}]), M = function(e2) {
          function i2(t2, i3, o2, r2) {
            e2.call(this), this.id = t2, this.dispatcher = o2, this.coordinates = i3.coordinates, this.type = "image", this.minzoom = 0, this.maxzoom = 22, this.tileSize = 512, this.tiles = {}, this._loaded = false, this.setEventedParent(r2), this.options = i3;
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.load = function(e3, i3) {
            var o2 = this;
            this._loaded = false, this.fire(new t.Event("dataloading", {dataType: "source"})), this.url = this.options.url, t.getImage(this.map._requestManager.transformRequest(this.url, t.ResourceType.Image), function(r2, a2) {
              o2._loaded = true, r2 ? o2.fire(new t.ErrorEvent(r2)) : a2 && (o2.image = a2, e3 && (o2.coordinates = e3), i3 && i3(), o2._finishLoading());
            });
          }, i2.prototype.loaded = function() {
            return this._loaded;
          }, i2.prototype.updateImage = function(t2) {
            var e3 = this;
            return this.image && t2.url ? (this.options.url = t2.url, this.load(t2.coordinates, function() {
              e3.texture = null;
            }), this) : this;
          }, i2.prototype._finishLoading = function() {
            this.map && (this.setCoordinates(this.coordinates), this.fire(new t.Event("data", {dataType: "source", sourceDataType: "metadata"})));
          }, i2.prototype.onAdd = function(t2) {
            this.map = t2, this.load();
          }, i2.prototype.setCoordinates = function(e3) {
            var i3 = this;
            this.coordinates = e3;
            var o2 = e3.map(t.MercatorCoordinate.fromLngLat);
            this.tileID = function(e4) {
              for (var i4 = 1 / 0, o3 = 1 / 0, r3 = -1 / 0, a2 = -1 / 0, n2 = 0, s2 = e4; n2 < s2.length; n2 += 1) {
                var l2 = s2[n2];
                i4 = Math.min(i4, l2.x), o3 = Math.min(o3, l2.y), r3 = Math.max(r3, l2.x), a2 = Math.max(a2, l2.y);
              }
              var c2 = Math.max(r3 - i4, a2 - o3), u2 = Math.max(0, Math.floor(-Math.log(c2) / Math.LN2)), h2 = Math.pow(2, u2);
              return new t.CanonicalTileID(u2, Math.floor((i4 + r3) / 2 * h2), Math.floor((o3 + a2) / 2 * h2));
            }(o2), this.minzoom = this.maxzoom = this.tileID.z;
            var r2 = o2.map(function(t2) {
              return i3.tileID.getTilePoint(t2)._round();
            });
            return this._boundsArray = new t.StructArrayLayout4i8(), this._boundsArray.emplaceBack(r2[0].x, r2[0].y, 0, 0), this._boundsArray.emplaceBack(r2[1].x, r2[1].y, t.EXTENT, 0), this._boundsArray.emplaceBack(r2[3].x, r2[3].y, 0, t.EXTENT), this._boundsArray.emplaceBack(r2[2].x, r2[2].y, t.EXTENT, t.EXTENT), this.boundsBuffer && (this.boundsBuffer.destroy(), delete this.boundsBuffer), this.fire(new t.Event("data", {dataType: "source", sourceDataType: "content"})), this;
          }, i2.prototype.prepare = function() {
            if (Object.keys(this.tiles).length !== 0 && this.image) {
              var e3 = this.map.painter.context, i3 = e3.gl;
              for (var o2 in this.boundsBuffer || (this.boundsBuffer = e3.createVertexBuffer(this._boundsArray, A.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture || (this.texture = new t.Texture(e3, this.image, i3.RGBA), this.texture.bind(i3.LINEAR, i3.CLAMP_TO_EDGE)), this.tiles) {
                var r2 = this.tiles[o2];
                r2.state !== "loaded" && (r2.state = "loaded", r2.texture = this.texture);
              }
            }
          }, i2.prototype.loadTile = function(t2, e3) {
            this.tileID && this.tileID.equals(t2.tileID.canonical) ? (this.tiles[String(t2.tileID.wrap)] = t2, t2.buckets = {}, e3(null)) : (t2.state = "errored", e3(null));
          }, i2.prototype.serialize = function() {
            return {type: "image", url: this.options.url, coordinates: this.coordinates};
          }, i2.prototype.hasTransition = function() {
            return false;
          }, i2;
        }(t.Evented), L = function(e2) {
          function i2(t2, i3, o2, r2) {
            e2.call(this, t2, i3, o2, r2), this.roundZoom = true, this.type = "video", this.options = i3;
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.load = function() {
            var e3 = this;
            this._loaded = false;
            var i3 = this.options;
            this.urls = [];
            for (var o2 = 0, r2 = i3.urls; o2 < r2.length; o2 += 1)
              this.urls.push(this.map._requestManager.transformRequest(r2[o2], t.ResourceType.Source).url);
            t.getVideo(this.urls, function(i4, o3) {
              e3._loaded = true, i4 ? e3.fire(new t.ErrorEvent(i4)) : o3 && (e3.video = o3, e3.video.loop = true, e3.video.addEventListener("playing", function() {
                e3.map.triggerRepaint();
              }), e3.map && e3.video.play(), e3._finishLoading());
            });
          }, i2.prototype.pause = function() {
            this.video && this.video.pause();
          }, i2.prototype.play = function() {
            this.video && this.video.play();
          }, i2.prototype.seek = function(e3) {
            if (this.video) {
              var i3 = this.video.seekable;
              e3 < i3.start(0) || e3 > i3.end(0) ? this.fire(new t.ErrorEvent(new t.ValidationError("sources." + this.id, null, "Playback for this video can be set only between the " + i3.start(0) + " and " + i3.end(0) + "-second mark."))) : this.video.currentTime = e3;
            }
          }, i2.prototype.getVideo = function() {
            return this.video;
          }, i2.prototype.onAdd = function(t2) {
            this.map || (this.map = t2, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)));
          }, i2.prototype.prepare = function() {
            if (!(Object.keys(this.tiles).length === 0 || this.video.readyState < 2)) {
              var e3 = this.map.painter.context, i3 = e3.gl;
              for (var o2 in this.boundsBuffer || (this.boundsBuffer = e3.createVertexBuffer(this._boundsArray, A.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? this.video.paused || (this.texture.bind(i3.LINEAR, i3.CLAMP_TO_EDGE), i3.texSubImage2D(i3.TEXTURE_2D, 0, 0, 0, i3.RGBA, i3.UNSIGNED_BYTE, this.video)) : (this.texture = new t.Texture(e3, this.video, i3.RGBA), this.texture.bind(i3.LINEAR, i3.CLAMP_TO_EDGE)), this.tiles) {
                var r2 = this.tiles[o2];
                r2.state !== "loaded" && (r2.state = "loaded", r2.texture = this.texture);
              }
            }
          }, i2.prototype.serialize = function() {
            return {type: "video", urls: this.urls, coordinates: this.coordinates};
          }, i2.prototype.hasTransition = function() {
            return this.video && !this.video.paused;
          }, i2;
        }(M), R = function(e2) {
          function i2(i3, o2, r2, a2) {
            e2.call(this, i3, o2, r2, a2), o2.coordinates ? Array.isArray(o2.coordinates) && o2.coordinates.length === 4 && !o2.coordinates.some(function(t2) {
              return !Array.isArray(t2) || t2.length !== 2 || t2.some(function(t3) {
                return typeof t3 != "number";
              });
            }) || this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i3, null, '"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i3, null, 'missing required property "coordinates"'))), o2.animate && typeof o2.animate != "boolean" && this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i3, null, 'optional "animate" property must be a boolean value'))), o2.canvas ? typeof o2.canvas == "string" || o2.canvas instanceof t.window.HTMLCanvasElement || this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i3, null, '"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i3, null, 'missing required property "canvas"'))), this.options = o2, this.animate = o2.animate === void 0 || o2.animate;
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.load = function() {
            this._loaded = true, this.canvas || (this.canvas = this.options.canvas instanceof t.window.HTMLCanvasElement ? this.options.canvas : t.window.document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function() {
              this._playing = true, this.map.triggerRepaint();
            }, this.pause = function() {
              this._playing && (this.prepare(), this._playing = false);
            }, this._finishLoading());
          }, i2.prototype.getCanvas = function() {
            return this.canvas;
          }, i2.prototype.onAdd = function(t2) {
            this.map = t2, this.load(), this.canvas && this.animate && this.play();
          }, i2.prototype.onRemove = function() {
            this.pause();
          }, i2.prototype.prepare = function() {
            var e3 = false;
            if (this.canvas.width !== this.width && (this.width = this.canvas.width, e3 = true), this.canvas.height !== this.height && (this.height = this.canvas.height, e3 = true), !this._hasInvalidDimensions() && Object.keys(this.tiles).length !== 0) {
              var i3 = this.map.painter.context, o2 = i3.gl;
              for (var r2 in this.boundsBuffer || (this.boundsBuffer = i3.createVertexBuffer(this._boundsArray, A.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? (e3 || this._playing) && this.texture.update(this.canvas, {premultiply: true}) : this.texture = new t.Texture(i3, this.canvas, o2.RGBA, {premultiply: true}), this.tiles) {
                var a2 = this.tiles[r2];
                a2.state !== "loaded" && (a2.state = "loaded", a2.texture = this.texture);
              }
            }
          }, i2.prototype.serialize = function() {
            return {type: "canvas", coordinates: this.coordinates};
          }, i2.prototype.hasTransition = function() {
            return this._playing;
          }, i2.prototype._hasInvalidDimensions = function() {
            for (var t2 = 0, e3 = [this.canvas.width, this.canvas.height]; t2 < e3.length; t2 += 1) {
              var i3 = e3[t2];
              if (isNaN(i3) || i3 <= 0)
                return true;
            }
            return false;
          }, i2;
        }(M), k = {vector: S, raster: C, "raster-dem": z, geojson: D, video: L, image: M, canvas: R};
        function B(e2, i2) {
          var o2 = t.identity([]);
          return t.translate(o2, o2, [1, 1, 0]), t.scale(o2, o2, [0.5 * e2.width, 0.5 * e2.height, 1]), t.multiply(o2, o2, e2.calculatePosMatrix(i2.toUnwrapped()));
        }
        function O(t2, e2, i2, o2, r2, a2) {
          var n2 = function(t3, e3, i3) {
            if (t3)
              for (var o3 = 0, r3 = t3; o3 < r3.length; o3 += 1) {
                var a3 = e3[r3[o3]];
                if (a3 && a3.source === i3 && a3.type === "fill-extrusion")
                  return true;
              }
            else
              for (var n3 in e3) {
                var s3 = e3[n3];
                if (s3.source === i3 && s3.type === "fill-extrusion")
                  return true;
              }
            return false;
          }(r2 && r2.layers, e2, t2.id), s2 = a2.maxPitchScaleFactor(), l2 = t2.tilesIn(o2, s2, n2);
          l2.sort(F);
          for (var c2 = [], u2 = 0, h2 = l2; u2 < h2.length; u2 += 1) {
            var p2 = h2[u2];
            c2.push({wrappedTileID: p2.tileID.wrapped().key, queryResults: p2.tile.queryRenderedFeatures(e2, i2, t2._state, p2.queryGeometry, p2.cameraQueryGeometry, p2.scale, r2, a2, s2, B(t2.transform, p2.tileID))});
          }
          var d2 = function(t3) {
            for (var e3 = {}, i3 = {}, o3 = 0, r3 = t3; o3 < r3.length; o3 += 1) {
              var a3 = r3[o3], n3 = a3.queryResults, s3 = a3.wrappedTileID, l3 = i3[s3] = i3[s3] || {};
              for (var c3 in n3)
                for (var u3 = n3[c3], h3 = l3[c3] = l3[c3] || {}, p3 = e3[c3] = e3[c3] || [], d3 = 0, _3 = u3; d3 < _3.length; d3 += 1) {
                  var f2 = _3[d3];
                  h3[f2.featureIndex] || (h3[f2.featureIndex] = true, p3.push(f2));
                }
            }
            return e3;
          }(c2);
          for (var _2 in d2)
            d2[_2].forEach(function(e3) {
              var i3 = e3.feature, o3 = t2.getFeatureState(i3.layer["source-layer"], i3.id);
              i3.source = i3.layer.source, i3.layer["source-layer"] && (i3.sourceLayer = i3.layer["source-layer"]), i3.state = o3;
            });
          return d2;
        }
        function F(t2, e2) {
          var i2 = t2.tileID, o2 = e2.tileID;
          return i2.overscaledZ - o2.overscaledZ || i2.canonical.y - o2.canonical.y || i2.wrap - o2.wrap || i2.canonical.x - o2.canonical.x;
        }
        var U = function(t2, e2) {
          this.max = t2, this.onRemove = e2, this.reset();
        };
        U.prototype.reset = function() {
          for (var t2 in this.data)
            for (var e2 = 0, i2 = this.data[t2]; e2 < i2.length; e2 += 1) {
              var o2 = i2[e2];
              o2.timeout && clearTimeout(o2.timeout), this.onRemove(o2.value);
            }
          return this.data = {}, this.order = [], this;
        }, U.prototype.add = function(t2, e2, i2) {
          var o2 = this, r2 = t2.wrapped().key;
          this.data[r2] === void 0 && (this.data[r2] = []);
          var a2 = {value: e2, timeout: void 0};
          if (i2 !== void 0 && (a2.timeout = setTimeout(function() {
            o2.remove(t2, a2);
          }, i2)), this.data[r2].push(a2), this.order.push(r2), this.order.length > this.max) {
            var n2 = this._getAndRemoveByKey(this.order[0]);
            n2 && this.onRemove(n2);
          }
          return this;
        }, U.prototype.has = function(t2) {
          return t2.wrapped().key in this.data;
        }, U.prototype.getAndRemove = function(t2) {
          return this.has(t2) ? this._getAndRemoveByKey(t2.wrapped().key) : null;
        }, U.prototype._getAndRemoveByKey = function(t2) {
          var e2 = this.data[t2].shift();
          return e2.timeout && clearTimeout(e2.timeout), this.data[t2].length === 0 && delete this.data[t2], this.order.splice(this.order.indexOf(t2), 1), e2.value;
        }, U.prototype.getByKey = function(t2) {
          var e2 = this.data[t2];
          return e2 ? e2[0].value : null;
        }, U.prototype.get = function(t2) {
          return this.has(t2) ? this.data[t2.wrapped().key][0].value : null;
        }, U.prototype.remove = function(t2, e2) {
          if (!this.has(t2))
            return this;
          var i2 = t2.wrapped().key, o2 = e2 === void 0 ? 0 : this.data[i2].indexOf(e2), r2 = this.data[i2][o2];
          return this.data[i2].splice(o2, 1), r2.timeout && clearTimeout(r2.timeout), this.data[i2].length === 0 && delete this.data[i2], this.onRemove(r2.value), this.order.splice(this.order.indexOf(i2), 1), this;
        }, U.prototype.setMaxSize = function(t2) {
          for (this.max = t2; this.order.length > this.max; ) {
            var e2 = this._getAndRemoveByKey(this.order[0]);
            e2 && this.onRemove(e2);
          }
          return this;
        }, U.prototype.filter = function(t2) {
          var e2 = [];
          for (var i2 in this.data)
            for (var o2 = 0, r2 = this.data[i2]; o2 < r2.length; o2 += 1) {
              var a2 = r2[o2];
              t2(a2.value) || e2.push(a2);
            }
          for (var n2 = 0, s2 = e2; n2 < s2.length; n2 += 1) {
            var l2 = s2[n2];
            this.remove(l2.value.tileID, l2);
          }
        };
        var N = function(t2, e2, i2) {
          this.context = t2;
          var o2 = t2.gl;
          this.buffer = o2.createBuffer(), this.dynamicDraw = Boolean(i2), this.context.unbindVAO(), t2.bindElementBuffer.set(this.buffer), o2.bufferData(o2.ELEMENT_ARRAY_BUFFER, e2.arrayBuffer, this.dynamicDraw ? o2.DYNAMIC_DRAW : o2.STATIC_DRAW), this.dynamicDraw || delete e2.arrayBuffer;
        };
        N.prototype.bind = function() {
          this.context.bindElementBuffer.set(this.buffer);
        }, N.prototype.updateData = function(t2) {
          var e2 = this.context.gl;
          this.context.unbindVAO(), this.bind(), e2.bufferSubData(e2.ELEMENT_ARRAY_BUFFER, 0, t2.arrayBuffer);
        }, N.prototype.destroy = function() {
          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        };
        var Z = {Int8: "BYTE", Uint8: "UNSIGNED_BYTE", Int16: "SHORT", Uint16: "UNSIGNED_SHORT", Int32: "INT", Uint32: "UNSIGNED_INT", Float32: "FLOAT"}, q = function(t2, e2, i2, o2) {
          this.length = e2.length, this.attributes = i2, this.itemSize = e2.bytesPerElement, this.dynamicDraw = o2, this.context = t2;
          var r2 = t2.gl;
          this.buffer = r2.createBuffer(), t2.bindVertexBuffer.set(this.buffer), r2.bufferData(r2.ARRAY_BUFFER, e2.arrayBuffer, this.dynamicDraw ? r2.DYNAMIC_DRAW : r2.STATIC_DRAW), this.dynamicDraw || delete e2.arrayBuffer;
        };
        q.prototype.bind = function() {
          this.context.bindVertexBuffer.set(this.buffer);
        }, q.prototype.updateData = function(t2) {
          var e2 = this.context.gl;
          this.bind(), e2.bufferSubData(e2.ARRAY_BUFFER, 0, t2.arrayBuffer);
        }, q.prototype.enableAttributes = function(t2, e2) {
          for (var i2 = 0; i2 < this.attributes.length; i2++) {
            var o2 = e2.attributes[this.attributes[i2].name];
            o2 !== void 0 && t2.enableVertexAttribArray(o2);
          }
        }, q.prototype.setVertexAttribPointers = function(t2, e2, i2) {
          for (var o2 = 0; o2 < this.attributes.length; o2++) {
            var r2 = this.attributes[o2], a2 = e2.attributes[r2.name];
            a2 !== void 0 && t2.vertexAttribPointer(a2, r2.components, t2[Z[r2.type]], false, this.itemSize, r2.offset + this.itemSize * (i2 || 0));
          }
        }, q.prototype.destroy = function() {
          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        };
        var j = function(t2) {
          this.gl = t2.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = false;
        };
        j.prototype.get = function() {
          return this.current;
        }, j.prototype.set = function(t2) {
        }, j.prototype.getDefault = function() {
          return this.default;
        }, j.prototype.setDefault = function() {
          this.set(this.default);
        };
        var V = function(e2) {
          function i2() {
            e2.apply(this, arguments);
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.getDefault = function() {
            return t.Color.transparent;
          }, i2.prototype.set = function(t2) {
            var e3 = this.current;
            (t2.r !== e3.r || t2.g !== e3.g || t2.b !== e3.b || t2.a !== e3.a || this.dirty) && (this.gl.clearColor(t2.r, t2.g, t2.b, t2.a), this.current = t2, this.dirty = false);
          }, i2;
        }(j), G = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return 1;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.clearDepth(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), W = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return 0;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.clearStencil(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), X = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return [true, true, true, true];
          }, e2.prototype.set = function(t3) {
            var e3 = this.current;
            (t3[0] !== e3[0] || t3[1] !== e3[1] || t3[2] !== e3[2] || t3[3] !== e3[3] || this.dirty) && (this.gl.colorMask(t3[0], t3[1], t3[2], t3[3]), this.current = t3, this.dirty = false);
          }, e2;
        }(j), H = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return true;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.depthMask(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), K = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return 255;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.stencilMask(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), Y = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return {func: this.gl.ALWAYS, ref: 0, mask: 255};
          }, e2.prototype.set = function(t3) {
            var e3 = this.current;
            (t3.func !== e3.func || t3.ref !== e3.ref || t3.mask !== e3.mask || this.dirty) && (this.gl.stencilFunc(t3.func, t3.ref, t3.mask), this.current = t3, this.dirty = false);
          }, e2;
        }(j), J = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            var t3 = this.gl;
            return [t3.KEEP, t3.KEEP, t3.KEEP];
          }, e2.prototype.set = function(t3) {
            var e3 = this.current;
            (t3[0] !== e3[0] || t3[1] !== e3[1] || t3[2] !== e3[2] || this.dirty) && (this.gl.stencilOp(t3[0], t3[1], t3[2]), this.current = t3, this.dirty = false);
          }, e2;
        }(j), Q = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return false;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              t3 ? e3.enable(e3.STENCIL_TEST) : e3.disable(e3.STENCIL_TEST), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), $ = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return [0, 1];
          }, e2.prototype.set = function(t3) {
            var e3 = this.current;
            (t3[0] !== e3[0] || t3[1] !== e3[1] || this.dirty) && (this.gl.depthRange(t3[0], t3[1]), this.current = t3, this.dirty = false);
          }, e2;
        }(j), tt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return false;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              t3 ? e3.enable(e3.DEPTH_TEST) : e3.disable(e3.DEPTH_TEST), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), et = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return this.gl.LESS;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.depthFunc(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), it = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return false;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              t3 ? e3.enable(e3.BLEND) : e3.disable(e3.BLEND), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), ot = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            var t3 = this.gl;
            return [t3.ONE, t3.ZERO];
          }, e2.prototype.set = function(t3) {
            var e3 = this.current;
            (t3[0] !== e3[0] || t3[1] !== e3[1] || this.dirty) && (this.gl.blendFunc(t3[0], t3[1]), this.current = t3, this.dirty = false);
          }, e2;
        }(j), rt = function(e2) {
          function i2() {
            e2.apply(this, arguments);
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.getDefault = function() {
            return t.Color.transparent;
          }, i2.prototype.set = function(t2) {
            var e3 = this.current;
            (t2.r !== e3.r || t2.g !== e3.g || t2.b !== e3.b || t2.a !== e3.a || this.dirty) && (this.gl.blendColor(t2.r, t2.g, t2.b, t2.a), this.current = t2, this.dirty = false);
          }, i2;
        }(j), at = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return this.gl.FUNC_ADD;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.blendEquation(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), nt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return false;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              t3 ? e3.enable(e3.CULL_FACE) : e3.disable(e3.CULL_FACE), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), st = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return this.gl.BACK;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.cullFace(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), lt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return this.gl.CCW;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.frontFace(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), ct = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.useProgram(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), ut = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return this.gl.TEXTURE0;
          }, e2.prototype.set = function(t3) {
            (t3 !== this.current || this.dirty) && (this.gl.activeTexture(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), ht = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            var t3 = this.gl;
            return [0, 0, t3.drawingBufferWidth, t3.drawingBufferHeight];
          }, e2.prototype.set = function(t3) {
            var e3 = this.current;
            (t3[0] !== e3[0] || t3[1] !== e3[1] || t3[2] !== e3[2] || t3[3] !== e3[3] || this.dirty) && (this.gl.viewport(t3[0], t3[1], t3[2], t3[3]), this.current = t3, this.dirty = false);
          }, e2;
        }(j), pt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.bindFramebuffer(e3.FRAMEBUFFER, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), dt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.bindRenderbuffer(e3.RENDERBUFFER, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), _t = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.bindTexture(e3.TEXTURE_2D, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), ft = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.bindBuffer(e3.ARRAY_BUFFER, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), mt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            var e3 = this.gl;
            e3.bindBuffer(e3.ELEMENT_ARRAY_BUFFER, t3), this.current = t3, this.dirty = false;
          }, e2;
        }(j), gt = function(t2) {
          function e2(e3) {
            t2.call(this, e3), this.vao = e3.extVertexArrayObject;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2.prototype.set = function(t3) {
            this.vao && (t3 !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(t3), this.current = t3, this.dirty = false);
          }, e2;
        }(j), vt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return 4;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.pixelStorei(e3.UNPACK_ALIGNMENT, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), yt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return false;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.pixelStorei(e3.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), xt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return false;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              var e3 = this.gl;
              e3.pixelStorei(e3.UNPACK_FLIP_Y_WEBGL, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(j), bt = function(t2) {
          function e2(e3, i2) {
            t2.call(this, e3), this.context = e3, this.parent = i2;
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.getDefault = function() {
            return null;
          }, e2;
        }(j), wt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.setDirty = function() {
            this.dirty = true;
          }, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              this.context.bindFramebuffer.set(this.parent);
              var e3 = this.gl;
              e3.framebufferTexture2D(e3.FRAMEBUFFER, e3.COLOR_ATTACHMENT0, e3.TEXTURE_2D, t3, 0), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(bt), Tt = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.set = function(t3) {
            if (t3 !== this.current || this.dirty) {
              this.context.bindFramebuffer.set(this.parent);
              var e3 = this.gl;
              e3.framebufferRenderbuffer(e3.FRAMEBUFFER, e3.DEPTH_ATTACHMENT, e3.RENDERBUFFER, t3), this.current = t3, this.dirty = false;
            }
          }, e2;
        }(bt), Et = function(t2, e2, i2, o2) {
          this.context = t2, this.width = e2, this.height = i2;
          var r2 = this.framebuffer = t2.gl.createFramebuffer();
          this.colorAttachment = new wt(t2, r2), o2 && (this.depthAttachment = new Tt(t2, r2));
        };
        Et.prototype.destroy = function() {
          var t2 = this.context.gl, e2 = this.colorAttachment.get();
          if (e2 && t2.deleteTexture(e2), this.depthAttachment) {
            var i2 = this.depthAttachment.get();
            i2 && t2.deleteRenderbuffer(i2);
          }
          t2.deleteFramebuffer(this.framebuffer);
        };
        var It = function(t2, e2, i2) {
          this.func = t2, this.mask = e2, this.range = i2;
        };
        It.ReadOnly = false, It.ReadWrite = true, It.disabled = new It(519, It.ReadOnly, [0, 1]);
        var Pt = function(t2, e2, i2, o2, r2, a2) {
          this.test = t2, this.ref = e2, this.mask = i2, this.fail = o2, this.depthFail = r2, this.pass = a2;
        };
        Pt.disabled = new Pt({func: 519, mask: 0}, 0, 0, 7680, 7680, 7680);
        var St = function(t2, e2, i2) {
          this.blendFunction = t2, this.blendColor = e2, this.mask = i2;
        };
        St.disabled = new St(St.Replace = [1, 0], t.Color.transparent, [false, false, false, false]), St.unblended = new St(St.Replace, t.Color.transparent, [true, true, true, true]), St.alphaBlended = new St([1, 771], t.Color.transparent, [true, true, true, true]);
        var Ct = function(t2, e2, i2) {
          this.enable = t2, this.mode = e2, this.frontFace = i2;
        };
        Ct.disabled = new Ct(false, 1029, 2305), Ct.backCCW = new Ct(true, 1029, 2305);
        var zt = function(t2) {
          this.gl = t2, this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"), this.clearColor = new V(this), this.clearDepth = new G(this), this.clearStencil = new W(this), this.colorMask = new X(this), this.depthMask = new H(this), this.stencilMask = new K(this), this.stencilFunc = new Y(this), this.stencilOp = new J(this), this.stencilTest = new Q(this), this.depthRange = new $(this), this.depthTest = new tt(this), this.depthFunc = new et(this), this.blend = new it(this), this.blendFunc = new ot(this), this.blendColor = new rt(this), this.blendEquation = new at(this), this.cullFace = new nt(this), this.cullFaceSide = new st(this), this.frontFace = new lt(this), this.program = new ct(this), this.activeTexture = new ut(this), this.viewport = new ht(this), this.bindFramebuffer = new pt(this), this.bindRenderbuffer = new dt(this), this.bindTexture = new _t(this), this.bindVertexBuffer = new ft(this), this.bindElementBuffer = new mt(this), this.bindVertexArrayOES = this.extVertexArrayObject && new gt(this), this.pixelStoreUnpack = new vt(this), this.pixelStoreUnpackPremultiplyAlpha = new yt(this), this.pixelStoreUnpackFlipY = new xt(this), this.extTextureFilterAnisotropic = t2.getExtension("EXT_texture_filter_anisotropic") || t2.getExtension("MOZ_EXT_texture_filter_anisotropic") || t2.getExtension("WEBKIT_EXT_texture_filter_anisotropic"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = t2.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureHalfFloat = t2.getExtension("OES_texture_half_float"), this.extTextureHalfFloat && (t2.getExtension("OES_texture_half_float_linear"), this.extRenderToTextureHalfFloat = t2.getExtension("EXT_color_buffer_half_float")), this.extTimerQuery = t2.getExtension("EXT_disjoint_timer_query"), this.maxTextureSize = t2.getParameter(t2.MAX_TEXTURE_SIZE);
        };
        zt.prototype.setDefault = function() {
          this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault();
        }, zt.prototype.setDirty = function() {
          this.clearColor.dirty = true, this.clearDepth.dirty = true, this.clearStencil.dirty = true, this.colorMask.dirty = true, this.depthMask.dirty = true, this.stencilMask.dirty = true, this.stencilFunc.dirty = true, this.stencilOp.dirty = true, this.stencilTest.dirty = true, this.depthRange.dirty = true, this.depthTest.dirty = true, this.depthFunc.dirty = true, this.blend.dirty = true, this.blendFunc.dirty = true, this.blendColor.dirty = true, this.blendEquation.dirty = true, this.cullFace.dirty = true, this.cullFaceSide.dirty = true, this.frontFace.dirty = true, this.program.dirty = true, this.activeTexture.dirty = true, this.viewport.dirty = true, this.bindFramebuffer.dirty = true, this.bindRenderbuffer.dirty = true, this.bindTexture.dirty = true, this.bindVertexBuffer.dirty = true, this.bindElementBuffer.dirty = true, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = true), this.pixelStoreUnpack.dirty = true, this.pixelStoreUnpackPremultiplyAlpha.dirty = true, this.pixelStoreUnpackFlipY.dirty = true;
        }, zt.prototype.createIndexBuffer = function(t2, e2) {
          return new N(this, t2, e2);
        }, zt.prototype.createVertexBuffer = function(t2, e2, i2) {
          return new q(this, t2, e2, i2);
        }, zt.prototype.createRenderbuffer = function(t2, e2, i2) {
          var o2 = this.gl, r2 = o2.createRenderbuffer();
          return this.bindRenderbuffer.set(r2), o2.renderbufferStorage(o2.RENDERBUFFER, t2, e2, i2), this.bindRenderbuffer.set(null), r2;
        }, zt.prototype.createFramebuffer = function(t2, e2, i2) {
          return new Et(this, t2, e2, i2);
        }, zt.prototype.clear = function(t2) {
          var e2 = t2.color, i2 = t2.depth, o2 = this.gl, r2 = 0;
          e2 && (r2 |= o2.COLOR_BUFFER_BIT, this.clearColor.set(e2), this.colorMask.set([true, true, true, true])), i2 !== void 0 && (r2 |= o2.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(i2), this.depthMask.set(true)), o2.clear(r2);
        }, zt.prototype.setCullFace = function(t2) {
          t2.enable === false ? this.cullFace.set(false) : (this.cullFace.set(true), this.cullFaceSide.set(t2.mode), this.frontFace.set(t2.frontFace));
        }, zt.prototype.setDepthMode = function(t2) {
          t2.func !== this.gl.ALWAYS || t2.mask ? (this.depthTest.set(true), this.depthFunc.set(t2.func), this.depthMask.set(t2.mask), this.depthRange.set(t2.range)) : this.depthTest.set(false);
        }, zt.prototype.setStencilMode = function(t2) {
          t2.test.func !== this.gl.ALWAYS || t2.mask ? (this.stencilTest.set(true), this.stencilMask.set(t2.mask), this.stencilOp.set([t2.fail, t2.depthFail, t2.pass]), this.stencilFunc.set({func: t2.test.func, ref: t2.ref, mask: t2.test.mask})) : this.stencilTest.set(false);
        }, zt.prototype.setColorMode = function(e2) {
          t.deepEqual(e2.blendFunction, St.Replace) ? this.blend.set(false) : (this.blend.set(true), this.blendFunc.set(e2.blendFunction), this.blendColor.set(e2.blendColor)), this.colorMask.set(e2.mask);
        }, zt.prototype.unbindVAO = function() {
          this.extVertexArrayObject && this.bindVertexArrayOES.set(null);
        };
        var Dt = function(e2) {
          function i2(i3, o2, r2) {
            var a2 = this;
            e2.call(this), this.id = i3, this.dispatcher = r2, this.on("data", function(t2) {
              t2.dataType === "source" && t2.sourceDataType === "metadata" && (a2._sourceLoaded = true), a2._sourceLoaded && !a2._paused && t2.dataType === "source" && t2.sourceDataType === "content" && (a2.reload(), a2.transform && a2.update(a2.transform));
            }), this.on("error", function() {
              a2._sourceErrored = true;
            }), this._source = function(e3, i4, o3, r3) {
              var a3 = new k[i4.type](e3, i4, o3, r3);
              if (a3.id !== e3)
                throw new Error("Expected Source id to be " + e3 + " instead of " + a3.id);
              return t.bindAll(["load", "abort", "unload", "serialize", "prepare"], a3), a3;
            }(i3, o2, r2, this), this._tiles = {}, this._cache = new U(0, this._unloadTile.bind(this)), this._timers = {}, this._cacheTimers = {}, this._maxTileCacheSize = null, this._loadedParentTiles = {}, this._coveredTiles = {}, this._state = new t.SourceFeatureState();
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.onAdd = function(t2) {
            this.map = t2, this._maxTileCacheSize = t2 ? t2._maxTileCacheSize : null, this._source && this._source.onAdd && this._source.onAdd(t2);
          }, i2.prototype.onRemove = function(t2) {
            this._source && this._source.onRemove && this._source.onRemove(t2);
          }, i2.prototype.loaded = function() {
            if (this._sourceErrored)
              return true;
            if (!this._sourceLoaded)
              return false;
            if (!this._source.loaded())
              return false;
            for (var t2 in this._tiles) {
              var e3 = this._tiles[t2];
              if (e3.state !== "loaded" && e3.state !== "errored")
                return false;
            }
            return true;
          }, i2.prototype.getSource = function() {
            return this._source;
          }, i2.prototype.pause = function() {
            this._paused = true;
          }, i2.prototype.resume = function() {
            if (this._paused) {
              var t2 = this._shouldReloadOnResume;
              this._paused = false, this._shouldReloadOnResume = false, t2 && this.reload(), this.transform && this.update(this.transform);
            }
          }, i2.prototype._loadTile = function(t2, e3) {
            return this._source.loadTile(t2, e3);
          }, i2.prototype._unloadTile = function(t2) {
            if (this._source.unloadTile)
              return this._source.unloadTile(t2, function() {
              });
          }, i2.prototype._abortTile = function(t2) {
            if (this._source.abortTile)
              return this._source.abortTile(t2, function() {
              });
          }, i2.prototype.serialize = function() {
            return this._source.serialize();
          }, i2.prototype.prepare = function(t2) {
            for (var e3 in this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null), this._tiles) {
              var i3 = this._tiles[e3];
              i3.upload(t2), i3.prepare(this.map.style.imageManager);
            }
          }, i2.prototype.getIds = function() {
            return t.values(this._tiles).map(function(t2) {
              return t2.tileID;
            }).sort(At).map(function(t2) {
              return t2.key;
            });
          }, i2.prototype.getRenderableIds = function(e3) {
            var i3 = this, o2 = [];
            for (var r2 in this._tiles)
              this._isIdRenderable(r2, e3) && o2.push(this._tiles[r2]);
            return e3 ? o2.sort(function(e4, o3) {
              var r3 = e4.tileID, a2 = o3.tileID, n2 = new t.Point(r3.canonical.x, r3.canonical.y)._rotate(i3.transform.angle), s2 = new t.Point(a2.canonical.x, a2.canonical.y)._rotate(i3.transform.angle);
              return r3.overscaledZ - a2.overscaledZ || s2.y - n2.y || s2.x - n2.x;
            }).map(function(t2) {
              return t2.tileID.key;
            }) : o2.map(function(t2) {
              return t2.tileID;
            }).sort(At).map(function(t2) {
              return t2.key;
            });
          }, i2.prototype.hasRenderableParent = function(t2) {
            var e3 = this.findLoadedParent(t2, 0);
            return !!e3 && this._isIdRenderable(e3.tileID.key);
          }, i2.prototype._isIdRenderable = function(t2, e3) {
            return this._tiles[t2] && this._tiles[t2].hasData() && !this._coveredTiles[t2] && (e3 || !this._tiles[t2].holdingForFade());
          }, i2.prototype.reload = function() {
            if (this._paused)
              this._shouldReloadOnResume = true;
            else
              for (var t2 in this._cache.reset(), this._tiles)
                this._tiles[t2].state !== "errored" && this._reloadTile(t2, "reloading");
          }, i2.prototype._reloadTile = function(t2, e3) {
            var i3 = this._tiles[t2];
            i3 && (i3.state !== "loading" && (i3.state = e3), this._loadTile(i3, this._tileLoaded.bind(this, i3, t2, e3)));
          }, i2.prototype._tileLoaded = function(e3, i3, o2, r2) {
            if (r2)
              return e3.state = "errored", void (r2.status !== 404 ? this._source.fire(new t.ErrorEvent(r2, {tile: e3})) : this.update(this.transform));
            e3.timeAdded = t.browser.now(), o2 === "expired" && (e3.refreshedUponExpiration = true), this._setTileReloadTimer(i3, e3), this.getSource().type === "raster-dem" && e3.dem && this._backfillDEM(e3), this._state.initializeTileState(e3, this.map ? this.map.painter : null), this._source.fire(new t.Event("data", {dataType: "source", tile: e3, coord: e3.tileID}));
          }, i2.prototype._backfillDEM = function(t2) {
            for (var e3 = this.getRenderableIds(), i3 = 0; i3 < e3.length; i3++) {
              var o2 = e3[i3];
              if (t2.neighboringTiles && t2.neighboringTiles[o2]) {
                var r2 = this.getTileByID(o2);
                a2(t2, r2), a2(r2, t2);
              }
            }
            function a2(t3, e4) {
              t3.needsHillshadePrepare = true;
              var i4 = e4.tileID.canonical.x - t3.tileID.canonical.x, o3 = e4.tileID.canonical.y - t3.tileID.canonical.y, r3 = Math.pow(2, t3.tileID.canonical.z), a3 = e4.tileID.key;
              i4 === 0 && o3 === 0 || Math.abs(o3) > 1 || (Math.abs(i4) > 1 && (Math.abs(i4 + r3) === 1 ? i4 += r3 : Math.abs(i4 - r3) === 1 && (i4 -= r3)), e4.dem && t3.dem && (t3.dem.backfillBorder(e4.dem, i4, o3), t3.neighboringTiles && t3.neighboringTiles[a3] && (t3.neighboringTiles[a3].backfilled = true)));
            }
          }, i2.prototype.getTile = function(t2) {
            return this.getTileByID(t2.key);
          }, i2.prototype.getTileByID = function(t2) {
            return this._tiles[t2];
          }, i2.prototype._retainLoadedChildren = function(t2, e3, i3, o2) {
            for (var r2 in this._tiles) {
              var a2 = this._tiles[r2];
              if (!(o2[r2] || !a2.hasData() || a2.tileID.overscaledZ <= e3 || a2.tileID.overscaledZ > i3)) {
                for (var n2 = a2.tileID; a2 && a2.tileID.overscaledZ > e3 + 1; ) {
                  var s2 = a2.tileID.scaledTo(a2.tileID.overscaledZ - 1);
                  (a2 = this._tiles[s2.key]) && a2.hasData() && (n2 = s2);
                }
                for (var l2 = n2; l2.overscaledZ > e3; )
                  if (t2[(l2 = l2.scaledTo(l2.overscaledZ - 1)).key]) {
                    o2[n2.key] = n2;
                    break;
                  }
              }
            }
          }, i2.prototype.findLoadedParent = function(t2, e3) {
            if (t2.key in this._loadedParentTiles) {
              var i3 = this._loadedParentTiles[t2.key];
              return i3 && i3.tileID.overscaledZ >= e3 ? i3 : null;
            }
            for (var o2 = t2.overscaledZ - 1; o2 >= e3; o2--) {
              var r2 = t2.scaledTo(o2), a2 = this._getLoadedTile(r2);
              if (a2)
                return a2;
            }
          }, i2.prototype._getLoadedTile = function(t2) {
            var e3 = this._tiles[t2.key];
            return e3 && e3.hasData() ? e3 : this._cache.getByKey(t2.wrapped().key);
          }, i2.prototype.updateCacheSize = function(t2) {
            var e3 = Math.ceil(t2.width / this._source.tileSize) + 1, i3 = Math.ceil(t2.height / this._source.tileSize) + 1, o2 = Math.floor(e3 * i3 * 5), r2 = typeof this._maxTileCacheSize == "number" ? Math.min(this._maxTileCacheSize, o2) : o2;
            this._cache.setMaxSize(r2);
          }, i2.prototype.handleWrapJump = function(t2) {
            var e3 = Math.round((t2 - (this._prevLng === void 0 ? t2 : this._prevLng)) / 360);
            if (this._prevLng = t2, e3) {
              var i3 = {};
              for (var o2 in this._tiles) {
                var r2 = this._tiles[o2];
                r2.tileID = r2.tileID.unwrapTo(r2.tileID.wrap + e3), i3[r2.tileID.key] = r2;
              }
              for (var a2 in this._tiles = i3, this._timers)
                clearTimeout(this._timers[a2]), delete this._timers[a2];
              for (var n2 in this._tiles)
                this._setTileReloadTimer(n2, this._tiles[n2]);
            }
          }, i2.prototype.update = function(e3) {
            var o2 = this;
            if (this.transform = e3, this._sourceLoaded && !this._paused) {
              var r2;
              this.updateCacheSize(e3), this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used ? this._source.tileID ? r2 = e3.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e4) {
                return new t.OverscaledTileID(e4.canonical.z, e4.wrap, e4.canonical.z, e4.canonical.x, e4.canonical.y);
              }) : (r2 = e3.coveringTiles({tileSize: this._source.tileSize, minzoom: this._source.minzoom, maxzoom: this._source.maxzoom, roundZoom: this._source.roundZoom, reparseOverscaled: this._source.reparseOverscaled}), this._source.hasTile && (r2 = r2.filter(function(t2) {
                return o2._source.hasTile(t2);
              }))) : r2 = [];
              var a2 = e3.coveringZoomLevel(this._source), n2 = Math.max(a2 - i2.maxOverzooming, this._source.minzoom), s2 = Math.max(a2 + i2.maxUnderzooming, this._source.minzoom), l2 = this._updateRetainedTiles(r2, a2);
              if (Mt(this._source.type)) {
                for (var c2 = {}, u2 = {}, h2 = 0, p2 = Object.keys(l2); h2 < p2.length; h2 += 1) {
                  var d2 = p2[h2], _2 = l2[d2], f2 = this._tiles[d2];
                  if (f2 && !(f2.fadeEndTime && f2.fadeEndTime <= t.browser.now())) {
                    var m2 = this.findLoadedParent(_2, n2);
                    m2 && (this._addTile(m2.tileID), c2[m2.tileID.key] = m2.tileID), u2[d2] = _2;
                  }
                }
                for (var g2 in this._retainLoadedChildren(u2, a2, s2, l2), c2)
                  l2[g2] || (this._coveredTiles[g2] = true, l2[g2] = c2[g2]);
              }
              for (var v2 in l2)
                this._tiles[v2].clearFadeHold();
              for (var y2 = 0, x2 = t.keysDifference(this._tiles, l2); y2 < x2.length; y2 += 1) {
                var b2 = x2[y2], w2 = this._tiles[b2];
                w2.hasSymbolBuckets && !w2.holdingForFade() ? w2.setHoldDuration(this.map._fadeDuration) : w2.hasSymbolBuckets && !w2.symbolFadeFinished() || this._removeTile(b2);
              }
              this._updateLoadedParentTileCache();
            }
          }, i2.prototype.releaseSymbolFadeTiles = function() {
            for (var t2 in this._tiles)
              this._tiles[t2].holdingForFade() && this._removeTile(t2);
          }, i2.prototype._updateRetainedTiles = function(t2, e3) {
            for (var o2 = {}, r2 = {}, a2 = Math.max(e3 - i2.maxOverzooming, this._source.minzoom), n2 = Math.max(e3 + i2.maxUnderzooming, this._source.minzoom), s2 = {}, l2 = 0, c2 = t2; l2 < c2.length; l2 += 1) {
              var u2 = c2[l2], h2 = this._addTile(u2);
              o2[u2.key] = u2, h2.hasData() || e3 < this._source.maxzoom && (s2[u2.key] = u2);
            }
            this._retainLoadedChildren(s2, e3, n2, o2);
            for (var p2 = 0, d2 = t2; p2 < d2.length; p2 += 1) {
              var _2 = d2[p2], f2 = this._tiles[_2.key];
              if (!f2.hasData()) {
                if (e3 + 1 > this._source.maxzoom) {
                  var m2 = _2.children(this._source.maxzoom)[0], g2 = this.getTile(m2);
                  if (g2 && g2.hasData()) {
                    o2[m2.key] = m2;
                    continue;
                  }
                } else {
                  var v2 = _2.children(this._source.maxzoom);
                  if (o2[v2[0].key] && o2[v2[1].key] && o2[v2[2].key] && o2[v2[3].key])
                    continue;
                }
                for (var y2 = f2.wasRequested(), x2 = _2.overscaledZ - 1; x2 >= a2; --x2) {
                  var b2 = _2.scaledTo(x2);
                  if (r2[b2.key])
                    break;
                  if (r2[b2.key] = true, !(f2 = this.getTile(b2)) && y2 && (f2 = this._addTile(b2)), f2 && (o2[b2.key] = b2, y2 = f2.wasRequested(), f2.hasData()))
                    break;
                }
              }
            }
            return o2;
          }, i2.prototype._updateLoadedParentTileCache = function() {
            for (var t2 in this._loadedParentTiles = {}, this._tiles) {
              for (var e3 = [], i3 = void 0, o2 = this._tiles[t2].tileID; o2.overscaledZ > 0; ) {
                if (o2.key in this._loadedParentTiles) {
                  i3 = this._loadedParentTiles[o2.key];
                  break;
                }
                e3.push(o2.key);
                var r2 = o2.scaledTo(o2.overscaledZ - 1);
                if (i3 = this._getLoadedTile(r2))
                  break;
                o2 = r2;
              }
              for (var a2 = 0, n2 = e3; a2 < n2.length; a2 += 1)
                this._loadedParentTiles[n2[a2]] = i3;
            }
          }, i2.prototype._addTile = function(e3) {
            var i3 = this._tiles[e3.key];
            if (i3)
              return i3;
            (i3 = this._cache.getAndRemove(e3)) && (this._setTileReloadTimer(e3.key, i3), i3.tileID = e3, this._state.initializeTileState(i3, this.map ? this.map.painter : null), this._cacheTimers[e3.key] && (clearTimeout(this._cacheTimers[e3.key]), delete this._cacheTimers[e3.key], this._setTileReloadTimer(e3.key, i3)));
            var o2 = Boolean(i3);
            return o2 || (i3 = new t.Tile(e3, this._source.tileSize * e3.overscaleFactor()), this._loadTile(i3, this._tileLoaded.bind(this, i3, e3.key, i3.state))), i3 ? (i3.uses++, this._tiles[e3.key] = i3, o2 || this._source.fire(new t.Event("dataloading", {tile: i3, coord: i3.tileID, dataType: "source"})), i3) : null;
          }, i2.prototype._setTileReloadTimer = function(t2, e3) {
            var i3 = this;
            t2 in this._timers && (clearTimeout(this._timers[t2]), delete this._timers[t2]);
            var o2 = e3.getExpiryTimeout();
            o2 && (this._timers[t2] = setTimeout(function() {
              i3._reloadTile(t2, "expired"), delete i3._timers[t2];
            }, o2));
          }, i2.prototype._removeTile = function(t2) {
            var e3 = this._tiles[t2];
            e3 && (e3.uses--, delete this._tiles[t2], this._timers[t2] && (clearTimeout(this._timers[t2]), delete this._timers[t2]), e3.uses > 0 || (e3.hasData() && e3.state !== "reloading" ? this._cache.add(e3.tileID, e3, e3.getExpiryTimeout()) : (e3.aborted = true, this._abortTile(e3), this._unloadTile(e3))));
          }, i2.prototype.clearTiles = function() {
            for (var t2 in this._shouldReloadOnResume = false, this._paused = false, this._tiles)
              this._removeTile(t2);
            this._cache.reset();
          }, i2.prototype.tilesIn = function(e3, i3, o2) {
            var r2 = this, a2 = [], n2 = this.transform;
            if (!n2)
              return a2;
            for (var s2 = o2 ? n2.getCameraQueryGeometry(e3) : e3, l2 = e3.map(function(t2) {
              return n2.pointCoordinate(t2);
            }), c2 = s2.map(function(t2) {
              return n2.pointCoordinate(t2);
            }), u2 = this.getIds(), h2 = 1 / 0, p2 = 1 / 0, d2 = -1 / 0, _2 = -1 / 0, f2 = 0, m2 = c2; f2 < m2.length; f2 += 1) {
              var g2 = m2[f2];
              h2 = Math.min(h2, g2.x), p2 = Math.min(p2, g2.y), d2 = Math.max(d2, g2.x), _2 = Math.max(_2, g2.y);
            }
            for (var v2 = function(e4) {
              var o3 = r2._tiles[u2[e4]];
              if (!o3.holdingForFade()) {
                var s3 = o3.tileID, f3 = Math.pow(2, n2.zoom - o3.tileID.overscaledZ), m3 = i3 * o3.queryPadding * t.EXTENT / o3.tileSize / f3, g3 = [s3.getTilePoint(new t.MercatorCoordinate(h2, p2)), s3.getTilePoint(new t.MercatorCoordinate(d2, _2))];
                if (g3[0].x - m3 < t.EXTENT && g3[0].y - m3 < t.EXTENT && g3[1].x + m3 >= 0 && g3[1].y + m3 >= 0) {
                  var v3 = l2.map(function(t2) {
                    return s3.getTilePoint(t2);
                  }), y3 = c2.map(function(t2) {
                    return s3.getTilePoint(t2);
                  });
                  a2.push({tile: o3, tileID: s3, queryGeometry: v3, cameraQueryGeometry: y3, scale: f3});
                }
              }
            }, y2 = 0; y2 < u2.length; y2++)
              v2(y2);
            return a2;
          }, i2.prototype.getVisibleCoordinates = function(t2) {
            for (var e3 = this, i3 = this.getRenderableIds(t2).map(function(t3) {
              return e3._tiles[t3].tileID;
            }), o2 = 0, r2 = i3; o2 < r2.length; o2 += 1) {
              var a2 = r2[o2];
              a2.posMatrix = this.transform.calculatePosMatrix(a2.toUnwrapped());
            }
            return i3;
          }, i2.prototype.hasTransition = function() {
            if (this._source.hasTransition())
              return true;
            if (Mt(this._source.type))
              for (var e3 in this._tiles) {
                var i3 = this._tiles[e3];
                if (i3.fadeEndTime !== void 0 && i3.fadeEndTime >= t.browser.now())
                  return true;
              }
            return false;
          }, i2.prototype.setFeatureState = function(t2, e3, i3) {
            this._state.updateState(t2 = t2 || "_geojsonTileLayer", e3, i3);
          }, i2.prototype.removeFeatureState = function(t2, e3, i3) {
            this._state.removeFeatureState(t2 = t2 || "_geojsonTileLayer", e3, i3);
          }, i2.prototype.getFeatureState = function(t2, e3) {
            return this._state.getState(t2 = t2 || "_geojsonTileLayer", e3);
          }, i2.prototype.setDependencies = function(t2, e3, i3) {
            var o2 = this._tiles[t2];
            o2 && o2.setDependencies(e3, i3);
          }, i2.prototype.reloadTilesForDependencies = function(t2, e3) {
            for (var i3 in this._tiles)
              this._tiles[i3].hasDependency(t2, e3) && this._reloadTile(i3, "reloading");
            this._cache.filter(function(i4) {
              return !i4.hasDependency(t2, e3);
            });
          }, i2;
        }(t.Evented);
        function At(t2, e2) {
          var i2 = Math.abs(2 * t2.wrap) - +(t2.wrap < 0), o2 = Math.abs(2 * e2.wrap) - +(e2.wrap < 0);
          return t2.overscaledZ - e2.overscaledZ || o2 - i2 || e2.canonical.y - t2.canonical.y || e2.canonical.x - t2.canonical.x;
        }
        function Mt(t2) {
          return t2 === "raster" || t2 === "image" || t2 === "video";
        }
        function Lt() {
          return new t.window.Worker(Kr.workerUrl);
        }
        Dt.maxOverzooming = 10, Dt.maxUnderzooming = 3;
        var Rt = "mapboxgl_preloaded_worker_pool", kt = function() {
          this.active = {};
        };
        kt.prototype.acquire = function(t2) {
          if (!this.workers)
            for (this.workers = []; this.workers.length < kt.workerCount; )
              this.workers.push(new Lt());
          return this.active[t2] = true, this.workers.slice();
        }, kt.prototype.release = function(t2) {
          delete this.active[t2], this.numActive() === 0 && (this.workers.forEach(function(t3) {
            t3.terminate();
          }), this.workers = null);
        }, kt.prototype.isPreloaded = function() {
          return !!this.active[Rt];
        }, kt.prototype.numActive = function() {
          return Object.keys(this.active).length;
        };
        var Bt, Ot = Math.floor(t.browser.hardwareConcurrency / 2);
        function Ft() {
          return Bt || (Bt = new kt()), Bt;
        }
        function Ut(e2, i2) {
          var o2 = {};
          for (var r2 in e2)
            r2 !== "ref" && (o2[r2] = e2[r2]);
          return t.refProperties.forEach(function(t2) {
            t2 in i2 && (o2[t2] = i2[t2]);
          }), o2;
        }
        function Nt(t2) {
          t2 = t2.slice();
          for (var e2 = Object.create(null), i2 = 0; i2 < t2.length; i2++)
            e2[t2[i2].id] = t2[i2];
          for (var o2 = 0; o2 < t2.length; o2++)
            "ref" in t2[o2] && (t2[o2] = Ut(t2[o2], e2[t2[o2].ref]));
          return t2;
        }
        kt.workerCount = Math.max(Math.min(Ot, 6), 1);
        var Zt = {setStyle: "setStyle", addLayer: "addLayer", removeLayer: "removeLayer", setPaintProperty: "setPaintProperty", setLayoutProperty: "setLayoutProperty", setFilter: "setFilter", addSource: "addSource", removeSource: "removeSource", setGeoJSONSourceData: "setGeoJSONSourceData", setLayerZoomRange: "setLayerZoomRange", setLayerProperty: "setLayerProperty", setCenter: "setCenter", setZoom: "setZoom", setBearing: "setBearing", setPitch: "setPitch", setSprite: "setSprite", setGlyphs: "setGlyphs", setTransition: "setTransition", setLight: "setLight"};
        function qt(t2, e2, i2) {
          i2.push({command: Zt.addSource, args: [t2, e2[t2]]});
        }
        function jt(t2, e2, i2) {
          e2.push({command: Zt.removeSource, args: [t2]}), i2[t2] = true;
        }
        function Vt(t2, e2, i2, o2) {
          jt(t2, i2, o2), qt(t2, e2, i2);
        }
        function Gt(e2, i2, o2) {
          var r2;
          for (r2 in e2[o2])
            if (e2[o2].hasOwnProperty(r2) && r2 !== "data" && !t.deepEqual(e2[o2][r2], i2[o2][r2]))
              return false;
          for (r2 in i2[o2])
            if (i2[o2].hasOwnProperty(r2) && r2 !== "data" && !t.deepEqual(e2[o2][r2], i2[o2][r2]))
              return false;
          return true;
        }
        function Wt(e2, i2, o2, r2, a2, n2) {
          var s2;
          for (s2 in i2 = i2 || {}, e2 = e2 || {})
            e2.hasOwnProperty(s2) && (t.deepEqual(e2[s2], i2[s2]) || o2.push({command: n2, args: [r2, s2, i2[s2], a2]}));
          for (s2 in i2)
            i2.hasOwnProperty(s2) && !e2.hasOwnProperty(s2) && (t.deepEqual(e2[s2], i2[s2]) || o2.push({command: n2, args: [r2, s2, i2[s2], a2]}));
        }
        function Xt(t2) {
          return t2.id;
        }
        function Ht(t2, e2) {
          return t2[e2.id] = e2, t2;
        }
        var Kt = function(t2, e2) {
          this.reset(t2, e2);
        };
        Kt.prototype.reset = function(t2, e2) {
          this.points = t2 || [], this._distances = [0];
          for (var i2 = 1; i2 < this.points.length; i2++)
            this._distances[i2] = this._distances[i2 - 1] + this.points[i2].dist(this.points[i2 - 1]);
          this.length = this._distances[this._distances.length - 1], this.padding = Math.min(e2 || 0, 0.5 * this.length), this.paddedLength = this.length - 2 * this.padding;
        }, Kt.prototype.lerp = function(e2) {
          if (this.points.length === 1)
            return this.points[0];
          e2 = t.clamp(e2, 0, 1);
          for (var i2 = 1, o2 = this._distances[i2], r2 = e2 * this.paddedLength + this.padding; o2 < r2 && i2 < this._distances.length; )
            o2 = this._distances[++i2];
          var a2 = i2 - 1, n2 = this._distances[a2], s2 = o2 - n2, l2 = s2 > 0 ? (r2 - n2) / s2 : 0;
          return this.points[a2].mult(1 - l2).add(this.points[i2].mult(l2));
        };
        var Yt = function(t2, e2, i2) {
          var o2 = this.boxCells = [], r2 = this.circleCells = [];
          this.xCellCount = Math.ceil(t2 / i2), this.yCellCount = Math.ceil(e2 / i2);
          for (var a2 = 0; a2 < this.xCellCount * this.yCellCount; a2++)
            o2.push([]), r2.push([]);
          this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = t2, this.height = e2, this.xScale = this.xCellCount / t2, this.yScale = this.yCellCount / e2, this.boxUid = 0, this.circleUid = 0;
        };
        function Jt(e2, i2, o2, r2, a2) {
          var n2 = t.create();
          return i2 ? (t.scale(n2, n2, [1 / a2, 1 / a2, 1]), o2 || t.rotateZ(n2, n2, r2.angle)) : t.multiply(n2, r2.labelPlaneMatrix, e2), n2;
        }
        function Qt(e2, i2, o2, r2, a2) {
          if (i2) {
            var n2 = t.clone(e2);
            return t.scale(n2, n2, [a2, a2, 1]), o2 || t.rotateZ(n2, n2, -r2.angle), n2;
          }
          return r2.glCoordMatrix;
        }
        function $t(e2, i2) {
          var o2 = [e2.x, e2.y, 0, 1];
          ue(o2, o2, i2);
          var r2 = o2[3];
          return {point: new t.Point(o2[0] / r2, o2[1] / r2), signedDistanceFromCamera: r2};
        }
        function te(t2, e2) {
          return 0.5 + t2 / e2 * 0.5;
        }
        function ee(t2, e2) {
          var i2 = t2[0] / t2[3], o2 = t2[1] / t2[3];
          return i2 >= -e2[0] && i2 <= e2[0] && o2 >= -e2[1] && o2 <= e2[1];
        }
        function ie(e2, i2, o2, r2, a2, n2, s2, l2) {
          var c2 = r2 ? e2.textSizeData : e2.iconSizeData, u2 = t.evaluateSizeForZoom(c2, o2.transform.zoom), h2 = [256 / o2.width * 2 + 1, 256 / o2.height * 2 + 1], p2 = r2 ? e2.text.dynamicLayoutVertexArray : e2.icon.dynamicLayoutVertexArray;
          p2.clear();
          for (var d2 = e2.lineVertexArray, _2 = r2 ? e2.text.placedSymbolArray : e2.icon.placedSymbolArray, f2 = o2.transform.width / o2.transform.height, m2 = false, g2 = 0; g2 < _2.length; g2++) {
            var v2 = _2.get(g2);
            if (v2.hidden || v2.writingMode === t.WritingMode.vertical && !m2)
              ce(v2.numGlyphs, p2);
            else {
              m2 = false;
              var y2 = [v2.anchorX, v2.anchorY, 0, 1];
              if (t.transformMat4(y2, y2, i2), ee(y2, h2)) {
                var x2 = te(o2.transform.cameraToCenterDistance, y2[3]), b2 = t.evaluateSizeForFeature(c2, u2, v2), w2 = s2 ? b2 / x2 : b2 * x2, T2 = new t.Point(v2.anchorX, v2.anchorY), E2 = $t(T2, a2).point, I2 = {}, P2 = ae(v2, w2, false, l2, i2, a2, n2, e2.glyphOffsetArray, d2, p2, E2, T2, I2, f2);
                m2 = P2.useVertical, (P2.notEnoughRoom || m2 || P2.needsFlipping && ae(v2, w2, true, l2, i2, a2, n2, e2.glyphOffsetArray, d2, p2, E2, T2, I2, f2).notEnoughRoom) && ce(v2.numGlyphs, p2);
              } else
                ce(v2.numGlyphs, p2);
            }
          }
          r2 ? e2.text.dynamicLayoutVertexBuffer.updateData(p2) : e2.icon.dynamicLayoutVertexBuffer.updateData(p2);
        }
        function oe(t2, e2, i2, o2, r2, a2, n2, s2, l2, c2, u2) {
          var h2 = s2.glyphStartIndex + s2.numGlyphs, p2 = s2.lineStartIndex, d2 = s2.lineStartIndex + s2.lineLength, _2 = e2.getoffsetX(s2.glyphStartIndex), f2 = e2.getoffsetX(h2 - 1), m2 = se(t2 * _2, i2, o2, r2, a2, n2, s2.segment, p2, d2, l2, c2, u2);
          if (!m2)
            return null;
          var g2 = se(t2 * f2, i2, o2, r2, a2, n2, s2.segment, p2, d2, l2, c2, u2);
          return g2 ? {first: m2, last: g2} : null;
        }
        function re(e2, i2, o2, r2) {
          return e2 === t.WritingMode.horizontal && Math.abs(o2.y - i2.y) > Math.abs(o2.x - i2.x) * r2 ? {useVertical: true} : (e2 === t.WritingMode.vertical ? i2.y < o2.y : i2.x > o2.x) ? {needsFlipping: true} : null;
        }
        function ae(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2, p2, d2, _2) {
          var f2, m2 = i2 / 24, g2 = e2.lineOffsetX * m2, v2 = e2.lineOffsetY * m2;
          if (e2.numGlyphs > 1) {
            var y2 = e2.glyphStartIndex + e2.numGlyphs, x2 = e2.lineStartIndex, b2 = e2.lineStartIndex + e2.lineLength, w2 = oe(m2, l2, g2, v2, o2, h2, p2, e2, c2, n2, d2);
            if (!w2)
              return {notEnoughRoom: true};
            var T2 = $t(w2.first.point, s2).point, E2 = $t(w2.last.point, s2).point;
            if (r2 && !o2) {
              var I2 = re(e2.writingMode, T2, E2, _2);
              if (I2)
                return I2;
            }
            f2 = [w2.first];
            for (var P2 = e2.glyphStartIndex + 1; P2 < y2 - 1; P2++)
              f2.push(se(m2 * l2.getoffsetX(P2), g2, v2, o2, h2, p2, e2.segment, x2, b2, c2, n2, d2));
            f2.push(w2.last);
          } else {
            if (r2 && !o2) {
              var S2 = $t(p2, a2).point, C2 = e2.lineStartIndex + e2.segment + 1, z2 = new t.Point(c2.getx(C2), c2.gety(C2)), D2 = $t(z2, a2), A2 = D2.signedDistanceFromCamera > 0 ? D2.point : ne(p2, z2, S2, 1, a2), M2 = re(e2.writingMode, S2, A2, _2);
              if (M2)
                return M2;
            }
            var L2 = se(m2 * l2.getoffsetX(e2.glyphStartIndex), g2, v2, o2, h2, p2, e2.segment, e2.lineStartIndex, e2.lineStartIndex + e2.lineLength, c2, n2, d2);
            if (!L2)
              return {notEnoughRoom: true};
            f2 = [L2];
          }
          for (var R2 = 0, k2 = f2; R2 < k2.length; R2 += 1) {
            var B2 = k2[R2];
            t.addDynamicAttributes(u2, B2.point, B2.angle);
          }
          return {};
        }
        function ne(t2, e2, i2, o2, r2) {
          var a2 = $t(t2.add(t2.sub(e2)._unit()), r2).point, n2 = i2.sub(a2);
          return i2.add(n2._mult(o2 / n2.mag()));
        }
        function se(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2, p2) {
          var d2 = r2 ? e2 - i2 : e2 + i2, _2 = d2 > 0 ? 1 : -1, f2 = 0;
          r2 && (_2 *= -1, f2 = Math.PI), _2 < 0 && (f2 += Math.PI);
          for (var m2 = _2 > 0 ? l2 + s2 : l2 + s2 + 1, g2 = a2, v2 = a2, y2 = 0, x2 = 0, b2 = Math.abs(d2), w2 = []; y2 + x2 <= b2; ) {
            if ((m2 += _2) < l2 || m2 >= c2)
              return null;
            if (v2 = g2, w2.push(g2), (g2 = p2[m2]) === void 0) {
              var T2 = new t.Point(u2.getx(m2), u2.gety(m2)), E2 = $t(T2, h2);
              if (E2.signedDistanceFromCamera > 0)
                g2 = p2[m2] = E2.point;
              else {
                var I2 = m2 - _2;
                g2 = ne(y2 === 0 ? n2 : new t.Point(u2.getx(I2), u2.gety(I2)), T2, v2, b2 - y2 + 1, h2);
              }
            }
            y2 += x2, x2 = v2.dist(g2);
          }
          var P2 = (b2 - y2) / x2, S2 = g2.sub(v2), C2 = S2.mult(P2)._add(v2);
          C2._add(S2._unit()._perp()._mult(o2 * _2));
          var z2 = f2 + Math.atan2(g2.y - v2.y, g2.x - v2.x);
          return w2.push(C2), {point: C2, angle: z2, path: w2};
        }
        Yt.prototype.keysLength = function() {
          return this.boxKeys.length + this.circleKeys.length;
        }, Yt.prototype.insert = function(t2, e2, i2, o2, r2) {
          this._forEachCell(e2, i2, o2, r2, this._insertBoxCell, this.boxUid++), this.boxKeys.push(t2), this.bboxes.push(e2), this.bboxes.push(i2), this.bboxes.push(o2), this.bboxes.push(r2);
        }, Yt.prototype.insertCircle = function(t2, e2, i2, o2) {
          this._forEachCell(e2 - o2, i2 - o2, e2 + o2, i2 + o2, this._insertCircleCell, this.circleUid++), this.circleKeys.push(t2), this.circles.push(e2), this.circles.push(i2), this.circles.push(o2);
        }, Yt.prototype._insertBoxCell = function(t2, e2, i2, o2, r2, a2) {
          this.boxCells[r2].push(a2);
        }, Yt.prototype._insertCircleCell = function(t2, e2, i2, o2, r2, a2) {
          this.circleCells[r2].push(a2);
        }, Yt.prototype._query = function(t2, e2, i2, o2, r2, a2) {
          if (i2 < 0 || t2 > this.width || o2 < 0 || e2 > this.height)
            return !r2 && [];
          var n2 = [];
          if (t2 <= 0 && e2 <= 0 && this.width <= i2 && this.height <= o2) {
            if (r2)
              return true;
            for (var s2 = 0; s2 < this.boxKeys.length; s2++)
              n2.push({key: this.boxKeys[s2], x1: this.bboxes[4 * s2], y1: this.bboxes[4 * s2 + 1], x2: this.bboxes[4 * s2 + 2], y2: this.bboxes[4 * s2 + 3]});
            for (var l2 = 0; l2 < this.circleKeys.length; l2++) {
              var c2 = this.circles[3 * l2], u2 = this.circles[3 * l2 + 1], h2 = this.circles[3 * l2 + 2];
              n2.push({key: this.circleKeys[l2], x1: c2 - h2, y1: u2 - h2, x2: c2 + h2, y2: u2 + h2});
            }
            return a2 ? n2.filter(a2) : n2;
          }
          return this._forEachCell(t2, e2, i2, o2, this._queryCell, n2, {hitTest: r2, seenUids: {box: {}, circle: {}}}, a2), r2 ? n2.length > 0 : n2;
        }, Yt.prototype._queryCircle = function(t2, e2, i2, o2, r2) {
          var a2 = t2 - i2, n2 = t2 + i2, s2 = e2 - i2, l2 = e2 + i2;
          if (n2 < 0 || a2 > this.width || l2 < 0 || s2 > this.height)
            return !o2 && [];
          var c2 = [];
          return this._forEachCell(a2, s2, n2, l2, this._queryCellCircle, c2, {hitTest: o2, circle: {x: t2, y: e2, radius: i2}, seenUids: {box: {}, circle: {}}}, r2), o2 ? c2.length > 0 : c2;
        }, Yt.prototype.query = function(t2, e2, i2, o2, r2) {
          return this._query(t2, e2, i2, o2, false, r2);
        }, Yt.prototype.hitTest = function(t2, e2, i2, o2, r2) {
          return this._query(t2, e2, i2, o2, true, r2);
        }, Yt.prototype.hitTestCircle = function(t2, e2, i2, o2) {
          return this._queryCircle(t2, e2, i2, true, o2);
        }, Yt.prototype._queryCell = function(t2, e2, i2, o2, r2, a2, n2, s2) {
          var l2 = n2.seenUids, c2 = this.boxCells[r2];
          if (c2 !== null)
            for (var u2 = this.bboxes, h2 = 0, p2 = c2; h2 < p2.length; h2 += 1) {
              var d2 = p2[h2];
              if (!l2.box[d2]) {
                l2.box[d2] = true;
                var _2 = 4 * d2;
                if (t2 <= u2[_2 + 2] && e2 <= u2[_2 + 3] && i2 >= u2[_2 + 0] && o2 >= u2[_2 + 1] && (!s2 || s2(this.boxKeys[d2]))) {
                  if (n2.hitTest)
                    return a2.push(true), true;
                  a2.push({key: this.boxKeys[d2], x1: u2[_2], y1: u2[_2 + 1], x2: u2[_2 + 2], y2: u2[_2 + 3]});
                }
              }
            }
          var f2 = this.circleCells[r2];
          if (f2 !== null)
            for (var m2 = this.circles, g2 = 0, v2 = f2; g2 < v2.length; g2 += 1) {
              var y2 = v2[g2];
              if (!l2.circle[y2]) {
                l2.circle[y2] = true;
                var x2 = 3 * y2;
                if (this._circleAndRectCollide(m2[x2], m2[x2 + 1], m2[x2 + 2], t2, e2, i2, o2) && (!s2 || s2(this.circleKeys[y2]))) {
                  if (n2.hitTest)
                    return a2.push(true), true;
                  var b2 = m2[x2], w2 = m2[x2 + 1], T2 = m2[x2 + 2];
                  a2.push({key: this.circleKeys[y2], x1: b2 - T2, y1: w2 - T2, x2: b2 + T2, y2: w2 + T2});
                }
              }
            }
        }, Yt.prototype._queryCellCircle = function(t2, e2, i2, o2, r2, a2, n2, s2) {
          var l2 = n2.circle, c2 = n2.seenUids, u2 = this.boxCells[r2];
          if (u2 !== null)
            for (var h2 = this.bboxes, p2 = 0, d2 = u2; p2 < d2.length; p2 += 1) {
              var _2 = d2[p2];
              if (!c2.box[_2]) {
                c2.box[_2] = true;
                var f2 = 4 * _2;
                if (this._circleAndRectCollide(l2.x, l2.y, l2.radius, h2[f2 + 0], h2[f2 + 1], h2[f2 + 2], h2[f2 + 3]) && (!s2 || s2(this.boxKeys[_2])))
                  return a2.push(true), true;
              }
            }
          var m2 = this.circleCells[r2];
          if (m2 !== null)
            for (var g2 = this.circles, v2 = 0, y2 = m2; v2 < y2.length; v2 += 1) {
              var x2 = y2[v2];
              if (!c2.circle[x2]) {
                c2.circle[x2] = true;
                var b2 = 3 * x2;
                if (this._circlesCollide(g2[b2], g2[b2 + 1], g2[b2 + 2], l2.x, l2.y, l2.radius) && (!s2 || s2(this.circleKeys[x2])))
                  return a2.push(true), true;
              }
            }
        }, Yt.prototype._forEachCell = function(t2, e2, i2, o2, r2, a2, n2, s2) {
          for (var l2 = this._convertToXCellCoord(t2), c2 = this._convertToYCellCoord(e2), u2 = this._convertToXCellCoord(i2), h2 = this._convertToYCellCoord(o2), p2 = l2; p2 <= u2; p2++)
            for (var d2 = c2; d2 <= h2; d2++)
              if (r2.call(this, t2, e2, i2, o2, this.xCellCount * d2 + p2, a2, n2, s2))
                return;
        }, Yt.prototype._convertToXCellCoord = function(t2) {
          return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(t2 * this.xScale)));
        }, Yt.prototype._convertToYCellCoord = function(t2) {
          return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(t2 * this.yScale)));
        }, Yt.prototype._circlesCollide = function(t2, e2, i2, o2, r2, a2) {
          var n2 = o2 - t2, s2 = r2 - e2, l2 = i2 + a2;
          return l2 * l2 > n2 * n2 + s2 * s2;
        }, Yt.prototype._circleAndRectCollide = function(t2, e2, i2, o2, r2, a2, n2) {
          var s2 = (a2 - o2) / 2, l2 = Math.abs(t2 - (o2 + s2));
          if (l2 > s2 + i2)
            return false;
          var c2 = (n2 - r2) / 2, u2 = Math.abs(e2 - (r2 + c2));
          if (u2 > c2 + i2)
            return false;
          if (l2 <= s2 || u2 <= c2)
            return true;
          var h2 = l2 - s2, p2 = u2 - c2;
          return h2 * h2 + p2 * p2 <= i2 * i2;
        };
        var le = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);
        function ce(t2, e2) {
          for (var i2 = 0; i2 < t2; i2++) {
            var o2 = e2.length;
            e2.resize(o2 + 4), e2.float32.set(le, 3 * o2);
          }
        }
        function ue(t2, e2, i2) {
          var o2 = e2[0], r2 = e2[1];
          return t2[0] = i2[0] * o2 + i2[4] * r2 + i2[12], t2[1] = i2[1] * o2 + i2[5] * r2 + i2[13], t2[3] = i2[3] * o2 + i2[7] * r2 + i2[15], t2;
        }
        var he = function(t2, e2, i2) {
          e2 === void 0 && (e2 = new Yt(t2.width + 200, t2.height + 200, 25)), i2 === void 0 && (i2 = new Yt(t2.width + 200, t2.height + 200, 25)), this.transform = t2, this.grid = e2, this.ignoredGrid = i2, this.pitchfactor = Math.cos(t2._pitch) * t2.cameraToCenterDistance, this.screenRightBoundary = t2.width + 100, this.screenBottomBoundary = t2.height + 100, this.gridRightBoundary = t2.width + 200, this.gridBottomBoundary = t2.height + 200;
        };
        function pe(e2, i2, o2) {
          return i2 * (t.EXTENT / (e2.tileSize * Math.pow(2, o2 - e2.tileID.overscaledZ)));
        }
        he.prototype.placeCollisionBox = function(t2, e2, i2, o2, r2) {
          var a2 = this.projectAndGetPerspectiveRatio(o2, t2.anchorPointX, t2.anchorPointY), n2 = i2 * a2.perspectiveRatio, s2 = t2.x1 * n2 + a2.point.x, l2 = t2.y1 * n2 + a2.point.y, c2 = t2.x2 * n2 + a2.point.x, u2 = t2.y2 * n2 + a2.point.y;
          return !this.isInsideGrid(s2, l2, c2, u2) || !e2 && this.grid.hitTest(s2, l2, c2, u2, r2) ? {box: [], offscreen: false} : {box: [s2, l2, c2, u2], offscreen: this.isOffscreen(s2, l2, c2, u2)};
        }, he.prototype.placeCollisionCircles = function(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2, p2, d2) {
          var _2 = [], f2 = new t.Point(i2.anchorX, i2.anchorY), m2 = $t(f2, n2), g2 = te(this.transform.cameraToCenterDistance, m2.signedDistanceFromCamera), v2 = (u2 ? a2 / g2 : a2 * g2) / t.ONE_EM, y2 = $t(f2, s2).point, x2 = oe(v2, r2, i2.lineOffsetX * v2, i2.lineOffsetY * v2, false, y2, f2, i2, o2, s2, {}), b2 = false, w2 = false, T2 = true;
          if (x2) {
            for (var E2 = 0.5 * p2 * g2 + d2, I2 = new t.Point(-100, -100), P2 = new t.Point(this.screenRightBoundary, this.screenBottomBoundary), S2 = new Kt(), C2 = x2.first, z2 = x2.last, D2 = [], A2 = C2.path.length - 1; A2 >= 1; A2--)
              D2.push(C2.path[A2]);
            for (var M2 = 1; M2 < z2.path.length; M2++)
              D2.push(z2.path[M2]);
            var L2 = 2.5 * E2;
            if (l2) {
              var R2 = D2.map(function(t2) {
                return $t(t2, l2);
              });
              D2 = R2.some(function(t2) {
                return t2.signedDistanceFromCamera <= 0;
              }) ? [] : R2.map(function(t2) {
                return t2.point;
              });
            }
            var k2 = [];
            if (D2.length > 0) {
              for (var B2 = D2[0].clone(), O2 = D2[0].clone(), F2 = 1; F2 < D2.length; F2++)
                B2.x = Math.min(B2.x, D2[F2].x), B2.y = Math.min(B2.y, D2[F2].y), O2.x = Math.max(O2.x, D2[F2].x), O2.y = Math.max(O2.y, D2[F2].y);
              k2 = B2.x >= I2.x && O2.x <= P2.x && B2.y >= I2.y && O2.y <= P2.y ? [D2] : O2.x < I2.x || B2.x > P2.x || O2.y < I2.y || B2.y > P2.y ? [] : t.clipLine([D2], I2.x, I2.y, P2.x, P2.y);
            }
            for (var U2 = 0, N2 = k2; U2 < N2.length; U2 += 1) {
              var Z2;
              S2.reset(N2[U2], 0.25 * E2), Z2 = S2.length <= 0.5 * E2 ? 1 : Math.ceil(S2.paddedLength / L2) + 1;
              for (var q2 = 0; q2 < Z2; q2++) {
                var j2 = q2 / Math.max(Z2 - 1, 1), V2 = S2.lerp(j2), G2 = V2.x + 100, W2 = V2.y + 100;
                _2.push(G2, W2, E2, 0);
                var X2 = G2 - E2, H2 = W2 - E2, K2 = G2 + E2, Y2 = W2 + E2;
                if (T2 = T2 && this.isOffscreen(X2, H2, K2, Y2), w2 = w2 || this.isInsideGrid(X2, H2, K2, Y2), !e2 && this.grid.hitTestCircle(G2, W2, E2, h2) && (b2 = true, !c2))
                  return {circles: [], offscreen: false, collisionDetected: b2};
              }
            }
          }
          return {circles: !c2 && b2 || !w2 ? [] : _2, offscreen: T2, collisionDetected: b2};
        }, he.prototype.queryRenderedSymbols = function(e2) {
          if (e2.length === 0 || this.grid.keysLength() === 0 && this.ignoredGrid.keysLength() === 0)
            return {};
          for (var i2 = [], o2 = 1 / 0, r2 = 1 / 0, a2 = -1 / 0, n2 = -1 / 0, s2 = 0, l2 = e2; s2 < l2.length; s2 += 1) {
            var c2 = l2[s2], u2 = new t.Point(c2.x + 100, c2.y + 100);
            o2 = Math.min(o2, u2.x), r2 = Math.min(r2, u2.y), a2 = Math.max(a2, u2.x), n2 = Math.max(n2, u2.y), i2.push(u2);
          }
          for (var h2 = {}, p2 = {}, d2 = 0, _2 = this.grid.query(o2, r2, a2, n2).concat(this.ignoredGrid.query(o2, r2, a2, n2)); d2 < _2.length; d2 += 1) {
            var f2 = _2[d2], m2 = f2.key;
            if (h2[m2.bucketInstanceId] === void 0 && (h2[m2.bucketInstanceId] = {}), !h2[m2.bucketInstanceId][m2.featureIndex]) {
              var g2 = [new t.Point(f2.x1, f2.y1), new t.Point(f2.x2, f2.y1), new t.Point(f2.x2, f2.y2), new t.Point(f2.x1, f2.y2)];
              t.polygonIntersectsPolygon(i2, g2) && (h2[m2.bucketInstanceId][m2.featureIndex] = true, p2[m2.bucketInstanceId] === void 0 && (p2[m2.bucketInstanceId] = []), p2[m2.bucketInstanceId].push(m2.featureIndex));
            }
          }
          return p2;
        }, he.prototype.insertCollisionBox = function(t2, e2, i2, o2, r2) {
          (e2 ? this.ignoredGrid : this.grid).insert({bucketInstanceId: i2, featureIndex: o2, collisionGroupID: r2}, t2[0], t2[1], t2[2], t2[3]);
        }, he.prototype.insertCollisionCircles = function(t2, e2, i2, o2, r2) {
          for (var a2 = e2 ? this.ignoredGrid : this.grid, n2 = {bucketInstanceId: i2, featureIndex: o2, collisionGroupID: r2}, s2 = 0; s2 < t2.length; s2 += 4)
            a2.insertCircle(n2, t2[s2], t2[s2 + 1], t2[s2 + 2]);
        }, he.prototype.projectAndGetPerspectiveRatio = function(e2, i2, o2) {
          var r2 = [i2, o2, 0, 1];
          return ue(r2, r2, e2), {point: new t.Point((r2[0] / r2[3] + 1) / 2 * this.transform.width + 100, (-r2[1] / r2[3] + 1) / 2 * this.transform.height + 100), perspectiveRatio: 0.5 + this.transform.cameraToCenterDistance / r2[3] * 0.5};
        }, he.prototype.isOffscreen = function(t2, e2, i2, o2) {
          return i2 < 100 || t2 >= this.screenRightBoundary || o2 < 100 || e2 > this.screenBottomBoundary;
        }, he.prototype.isInsideGrid = function(t2, e2, i2, o2) {
          return i2 >= 0 && t2 < this.gridRightBoundary && o2 >= 0 && e2 < this.gridBottomBoundary;
        }, he.prototype.getViewportMatrix = function() {
          var e2 = t.identity([]);
          return t.translate(e2, e2, [-100, -100, 0]), e2;
        };
        var de = function(t2, e2, i2, o2) {
          this.opacity = t2 ? Math.max(0, Math.min(1, t2.opacity + (t2.placed ? e2 : -e2))) : o2 && i2 ? 1 : 0, this.placed = i2;
        };
        de.prototype.isHidden = function() {
          return this.opacity === 0 && !this.placed;
        };
        var _e = function(t2, e2, i2, o2, r2) {
          this.text = new de(t2 ? t2.text : null, e2, i2, r2), this.icon = new de(t2 ? t2.icon : null, e2, o2, r2);
        };
        _e.prototype.isHidden = function() {
          return this.text.isHidden() && this.icon.isHidden();
        };
        var fe = function(t2, e2, i2) {
          this.text = t2, this.icon = e2, this.skipFade = i2;
        }, me = function() {
          this.invProjMatrix = t.create(), this.viewportMatrix = t.create(), this.circles = [];
        }, ge = function(t2, e2, i2, o2, r2) {
          this.bucketInstanceId = t2, this.featureIndex = e2, this.sourceLayerIndex = i2, this.bucketIndex = o2, this.tileID = r2;
        }, ve = function(t2) {
          this.crossSourceCollisions = t2, this.maxGroupID = 0, this.collisionGroups = {};
        };
        function ye(e2, i2, o2, r2, a2) {
          var n2 = t.getAnchorAlignment(e2), s2 = -(n2.horizontalAlign - 0.5) * i2, l2 = -(n2.verticalAlign - 0.5) * o2, c2 = t.evaluateVariableOffset(e2, r2);
          return new t.Point(s2 + c2[0] * a2, l2 + c2[1] * a2);
        }
        function xe(e2, i2, o2, r2, a2, n2) {
          var s2 = e2.x1, l2 = e2.x2, c2 = e2.y1, u2 = e2.y2, h2 = e2.anchorPointX, p2 = e2.anchorPointY, d2 = new t.Point(i2, o2);
          return r2 && d2._rotate(a2 ? n2 : -n2), {x1: s2 + d2.x, y1: c2 + d2.y, x2: l2 + d2.x, y2: u2 + d2.y, anchorPointX: h2, anchorPointY: p2};
        }
        ve.prototype.get = function(t2) {
          if (this.crossSourceCollisions)
            return {ID: 0, predicate: null};
          if (!this.collisionGroups[t2]) {
            var e2 = ++this.maxGroupID;
            this.collisionGroups[t2] = {ID: e2, predicate: function(t3) {
              return t3.collisionGroupID === e2;
            }};
          }
          return this.collisionGroups[t2];
        };
        var be = function(t2, e2, i2, o2) {
          this.transform = t2.clone(), this.collisionIndex = new he(this.transform), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = false, this.commitTime = 0, this.fadeDuration = e2, this.retainedQueryData = {}, this.collisionGroups = new ve(i2), this.collisionCircleArrays = {}, this.prevPlacement = o2, o2 && (o2.prevPlacement = void 0), this.placedOrientations = {};
        };
        function we(t2, e2, i2, o2, r2) {
          t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, r2 || 0), t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, r2 || 0), t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, r2 || 0), t2.emplaceBack(e2 ? 1 : 0, i2 ? 1 : 0, o2 || 0, r2 || 0);
        }
        be.prototype.getBucketParts = function(e2, i2, o2, r2) {
          var a2 = o2.getBucket(i2), n2 = o2.latestFeatureIndex;
          if (a2 && n2 && i2.id === a2.layerIds[0]) {
            var s2 = o2.collisionBoxArray, l2 = a2.layers[0].layout, c2 = Math.pow(2, this.transform.zoom - o2.tileID.overscaledZ), u2 = o2.tileSize / t.EXTENT, h2 = this.transform.calculatePosMatrix(o2.tileID.toUnwrapped()), p2 = l2.get("text-pitch-alignment") === "map", d2 = l2.get("text-rotation-alignment") === "map", _2 = pe(o2, 1, this.transform.zoom), f2 = Jt(h2, p2, d2, this.transform, _2), m2 = null;
            if (p2) {
              var g2 = Qt(h2, p2, d2, this.transform, _2);
              m2 = t.multiply([], this.transform.labelPlaneMatrix, g2);
            }
            this.retainedQueryData[a2.bucketInstanceId] = new ge(a2.bucketInstanceId, n2, a2.sourceLayerIndex, a2.index, o2.tileID);
            var v2 = {bucket: a2, layout: l2, posMatrix: h2, textLabelPlaneMatrix: f2, labelToScreenMatrix: m2, scale: c2, textPixelRatio: u2, holdingForFade: o2.holdingForFade(), collisionBoxArray: s2, partiallyEvaluatedTextSize: t.evaluateSizeForZoom(a2.textSizeData, this.transform.zoom), collisionGroup: this.collisionGroups.get(a2.sourceID)};
            if (r2)
              for (var y2 = 0, x2 = a2.sortKeyRanges; y2 < x2.length; y2 += 1) {
                var b2 = x2[y2];
                e2.push({sortKey: b2.sortKey, symbolInstanceStart: b2.symbolInstanceStart, symbolInstanceEnd: b2.symbolInstanceEnd, parameters: v2});
              }
            else
              e2.push({symbolInstanceStart: 0, symbolInstanceEnd: a2.symbolInstances.length, parameters: v2});
          }
        }, be.prototype.attemptAnchorPlacement = function(t2, e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2, p2, d2, _2) {
          var f2, m2 = [h2.textOffset0, h2.textOffset1], g2 = ye(t2, i2, o2, m2, r2), v2 = this.collisionIndex.placeCollisionBox(xe(e2, g2.x, g2.y, a2, n2, this.transform.angle), u2, s2, l2, c2.predicate);
          if (!_2 || this.collisionIndex.placeCollisionBox(xe(_2, g2.x, g2.y, a2, n2, this.transform.angle), u2, s2, l2, c2.predicate).box.length !== 0)
            return v2.box.length > 0 ? (this.prevPlacement && this.prevPlacement.variableOffsets[h2.crossTileID] && this.prevPlacement.placements[h2.crossTileID] && this.prevPlacement.placements[h2.crossTileID].text && (f2 = this.prevPlacement.variableOffsets[h2.crossTileID].anchor), this.variableOffsets[h2.crossTileID] = {textOffset: m2, width: i2, height: o2, anchor: t2, textBoxScale: r2, prevAnchor: f2}, this.markUsedJustification(p2, t2, h2, d2), p2.allowVerticalPlacement && (this.markUsedOrientation(p2, d2, h2), this.placedOrientations[h2.crossTileID] = d2), {shift: g2, placedGlyphBoxes: v2}) : void 0;
        }, be.prototype.placeLayerBucketPart = function(e2, i2, o2) {
          var r2 = this, a2 = e2.parameters, n2 = a2.bucket, s2 = a2.layout, l2 = a2.posMatrix, c2 = a2.textLabelPlaneMatrix, u2 = a2.labelToScreenMatrix, h2 = a2.textPixelRatio, p2 = a2.holdingForFade, d2 = a2.collisionBoxArray, _2 = a2.partiallyEvaluatedTextSize, f2 = a2.collisionGroup, m2 = s2.get("text-optional"), g2 = s2.get("icon-optional"), v2 = s2.get("text-allow-overlap"), y2 = s2.get("icon-allow-overlap"), x2 = s2.get("text-rotation-alignment") === "map", b2 = s2.get("text-pitch-alignment") === "map", w2 = s2.get("icon-text-fit") !== "none", T2 = s2.get("symbol-z-order") === "viewport-y", E2 = v2 && (y2 || !n2.hasIconData() || g2), I2 = y2 && (v2 || !n2.hasTextData() || m2);
          !n2.collisionArrays && d2 && n2.deserializeCollisionBoxes(d2);
          var P2 = function(e3, a3) {
            if (!i2[e3.crossTileID])
              if (p2)
                r2.placements[e3.crossTileID] = new fe(false, false, false);
              else {
                var d3, T3 = false, P3 = false, S3 = true, C3 = null, z3 = {box: null, offscreen: null}, D3 = {box: null, offscreen: null}, A3 = null, M2 = null, L2 = 0, R2 = 0, k2 = 0;
                a3.textFeatureIndex ? L2 = a3.textFeatureIndex : e3.useRuntimeCollisionCircles && (L2 = e3.featureIndex), a3.verticalTextFeatureIndex && (R2 = a3.verticalTextFeatureIndex);
                var B2 = a3.textBox;
                if (B2) {
                  var O2 = function(i3) {
                    var o3 = t.WritingMode.horizontal;
                    if (n2.allowVerticalPlacement && !i3 && r2.prevPlacement) {
                      var a4 = r2.prevPlacement.placedOrientations[e3.crossTileID];
                      a4 && (r2.placedOrientations[e3.crossTileID] = a4, r2.markUsedOrientation(n2, o3 = a4, e3));
                    }
                    return o3;
                  }, F2 = function(i3, o3) {
                    if (n2.allowVerticalPlacement && e3.numVerticalGlyphVertices > 0 && a3.verticalTextBox)
                      for (var r3 = 0, s3 = n2.writingModes; r3 < s3.length && (s3[r3] === t.WritingMode.vertical ? (z3 = o3(), D3 = z3) : z3 = i3(), !(z3 && z3.box && z3.box.length)); r3 += 1)
                        ;
                    else
                      z3 = i3();
                  };
                  if (s2.get("text-variable-anchor")) {
                    var U2 = s2.get("text-variable-anchor");
                    if (r2.prevPlacement && r2.prevPlacement.variableOffsets[e3.crossTileID]) {
                      var N2 = r2.prevPlacement.variableOffsets[e3.crossTileID];
                      U2.indexOf(N2.anchor) > 0 && (U2 = U2.filter(function(t2) {
                        return t2 !== N2.anchor;
                      })).unshift(N2.anchor);
                    }
                    var Z2 = function(t2, i3, o3) {
                      for (var a4 = t2.x2 - t2.x1, s3 = t2.y2 - t2.y1, c3 = e3.textBoxScale, u3 = w2 && !y2 ? i3 : null, p3 = {box: [], offscreen: false}, d4 = v2 ? 2 * U2.length : U2.length, _3 = 0; _3 < d4; ++_3) {
                        var m3 = r2.attemptAnchorPlacement(U2[_3 % U2.length], t2, a4, s3, c3, x2, b2, h2, l2, f2, _3 >= U2.length, e3, n2, o3, u3);
                        if (m3 && (p3 = m3.placedGlyphBoxes) && p3.box && p3.box.length) {
                          T3 = true, C3 = m3.shift;
                          break;
                        }
                      }
                      return p3;
                    };
                    F2(function() {
                      return Z2(B2, a3.iconBox, t.WritingMode.horizontal);
                    }, function() {
                      var i3 = a3.verticalTextBox;
                      return n2.allowVerticalPlacement && !(z3 && z3.box && z3.box.length) && e3.numVerticalGlyphVertices > 0 && i3 ? Z2(i3, a3.verticalIconBox, t.WritingMode.vertical) : {box: null, offscreen: null};
                    }), z3 && (T3 = z3.box, S3 = z3.offscreen);
                    var q2 = O2(z3 && z3.box);
                    if (!T3 && r2.prevPlacement) {
                      var j2 = r2.prevPlacement.variableOffsets[e3.crossTileID];
                      j2 && (r2.variableOffsets[e3.crossTileID] = j2, r2.markUsedJustification(n2, j2.anchor, e3, q2));
                    }
                  } else {
                    var V2 = function(t2, i3) {
                      var o3 = r2.collisionIndex.placeCollisionBox(t2, v2, h2, l2, f2.predicate);
                      return o3 && o3.box && o3.box.length && (r2.markUsedOrientation(n2, i3, e3), r2.placedOrientations[e3.crossTileID] = i3), o3;
                    };
                    F2(function() {
                      return V2(B2, t.WritingMode.horizontal);
                    }, function() {
                      var i3 = a3.verticalTextBox;
                      return n2.allowVerticalPlacement && e3.numVerticalGlyphVertices > 0 && i3 ? V2(i3, t.WritingMode.vertical) : {box: null, offscreen: null};
                    }), O2(z3 && z3.box && z3.box.length);
                  }
                }
                if (T3 = (d3 = z3) && d3.box && d3.box.length > 0, S3 = d3 && d3.offscreen, e3.useRuntimeCollisionCircles) {
                  var G2 = n2.text.placedSymbolArray.get(e3.centerJustifiedTextSymbolIndex), W2 = t.evaluateSizeForFeature(n2.textSizeData, _2, G2), X2 = s2.get("text-padding");
                  A3 = r2.collisionIndex.placeCollisionCircles(v2, G2, n2.lineVertexArray, n2.glyphOffsetArray, W2, l2, c2, u2, o2, b2, f2.predicate, e3.collisionCircleDiameter, X2), T3 = v2 || A3.circles.length > 0 && !A3.collisionDetected, S3 = S3 && A3.offscreen;
                }
                if (a3.iconFeatureIndex && (k2 = a3.iconFeatureIndex), a3.iconBox) {
                  var H2 = function(t2) {
                    var e4 = w2 && C3 ? xe(t2, C3.x, C3.y, x2, b2, r2.transform.angle) : t2;
                    return r2.collisionIndex.placeCollisionBox(e4, y2, h2, l2, f2.predicate);
                  };
                  P3 = D3 && D3.box && D3.box.length && a3.verticalIconBox ? (M2 = H2(a3.verticalIconBox)).box.length > 0 : (M2 = H2(a3.iconBox)).box.length > 0, S3 = S3 && M2.offscreen;
                }
                var K2 = m2 || e3.numHorizontalGlyphVertices === 0 && e3.numVerticalGlyphVertices === 0, Y2 = g2 || e3.numIconVertices === 0;
                if (K2 || Y2 ? Y2 ? K2 || (P3 = P3 && T3) : T3 = P3 && T3 : P3 = T3 = P3 && T3, T3 && d3 && d3.box && r2.collisionIndex.insertCollisionBox(d3.box, s2.get("text-ignore-placement"), n2.bucketInstanceId, D3 && D3.box && R2 ? R2 : L2, f2.ID), P3 && M2 && r2.collisionIndex.insertCollisionBox(M2.box, s2.get("icon-ignore-placement"), n2.bucketInstanceId, k2, f2.ID), A3 && (T3 && r2.collisionIndex.insertCollisionCircles(A3.circles, s2.get("text-ignore-placement"), n2.bucketInstanceId, L2, f2.ID), o2)) {
                  var J2 = n2.bucketInstanceId, Q2 = r2.collisionCircleArrays[J2];
                  Q2 === void 0 && (Q2 = r2.collisionCircleArrays[J2] = new me());
                  for (var $2 = 0; $2 < A3.circles.length; $2 += 4)
                    Q2.circles.push(A3.circles[$2 + 0]), Q2.circles.push(A3.circles[$2 + 1]), Q2.circles.push(A3.circles[$2 + 2]), Q2.circles.push(A3.collisionDetected ? 1 : 0);
                }
                r2.placements[e3.crossTileID] = new fe(T3 || E2, P3 || I2, S3 || n2.justReloaded), i2[e3.crossTileID] = true;
              }
          };
          if (T2)
            for (var S2 = n2.getSortedSymbolIndexes(this.transform.angle), C2 = S2.length - 1; C2 >= 0; --C2) {
              var z2 = S2[C2];
              P2(n2.symbolInstances.get(z2), n2.collisionArrays[z2]);
            }
          else
            for (var D2 = e2.symbolInstanceStart; D2 < e2.symbolInstanceEnd; D2++)
              P2(n2.symbolInstances.get(D2), n2.collisionArrays[D2]);
          if (o2 && n2.bucketInstanceId in this.collisionCircleArrays) {
            var A2 = this.collisionCircleArrays[n2.bucketInstanceId];
            t.invert(A2.invProjMatrix, l2), A2.viewportMatrix = this.collisionIndex.getViewportMatrix();
          }
          n2.justReloaded = false;
        }, be.prototype.markUsedJustification = function(e2, i2, o2, r2) {
          var a2;
          a2 = r2 === t.WritingMode.vertical ? o2.verticalPlacedTextSymbolIndex : {left: o2.leftJustifiedTextSymbolIndex, center: o2.centerJustifiedTextSymbolIndex, right: o2.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(i2)];
          for (var n2 = 0, s2 = [o2.leftJustifiedTextSymbolIndex, o2.centerJustifiedTextSymbolIndex, o2.rightJustifiedTextSymbolIndex, o2.verticalPlacedTextSymbolIndex]; n2 < s2.length; n2 += 1) {
            var l2 = s2[n2];
            l2 >= 0 && (e2.text.placedSymbolArray.get(l2).crossTileID = a2 >= 0 && l2 !== a2 ? 0 : o2.crossTileID);
          }
        }, be.prototype.markUsedOrientation = function(e2, i2, o2) {
          for (var r2 = i2 === t.WritingMode.horizontal || i2 === t.WritingMode.horizontalOnly ? i2 : 0, a2 = i2 === t.WritingMode.vertical ? i2 : 0, n2 = 0, s2 = [o2.leftJustifiedTextSymbolIndex, o2.centerJustifiedTextSymbolIndex, o2.rightJustifiedTextSymbolIndex]; n2 < s2.length; n2 += 1)
            e2.text.placedSymbolArray.get(s2[n2]).placedOrientation = r2;
          o2.verticalPlacedTextSymbolIndex && (e2.text.placedSymbolArray.get(o2.verticalPlacedTextSymbolIndex).placedOrientation = a2);
        }, be.prototype.commit = function(t2) {
          this.commitTime = t2, this.zoomAtLastRecencyCheck = this.transform.zoom;
          var e2 = this.prevPlacement, i2 = false;
          this.prevZoomAdjustment = e2 ? e2.zoomAdjustment(this.transform.zoom) : 0;
          var o2 = e2 ? e2.symbolFadeChange(t2) : 1, r2 = e2 ? e2.opacities : {}, a2 = e2 ? e2.variableOffsets : {}, n2 = e2 ? e2.placedOrientations : {};
          for (var s2 in this.placements) {
            var l2 = this.placements[s2], c2 = r2[s2];
            c2 ? (this.opacities[s2] = new _e(c2, o2, l2.text, l2.icon), i2 = i2 || l2.text !== c2.text.placed || l2.icon !== c2.icon.placed) : (this.opacities[s2] = new _e(null, o2, l2.text, l2.icon, l2.skipFade), i2 = i2 || l2.text || l2.icon);
          }
          for (var u2 in r2) {
            var h2 = r2[u2];
            if (!this.opacities[u2]) {
              var p2 = new _e(h2, o2, false, false);
              p2.isHidden() || (this.opacities[u2] = p2, i2 = i2 || h2.text.placed || h2.icon.placed);
            }
          }
          for (var d2 in a2)
            this.variableOffsets[d2] || !this.opacities[d2] || this.opacities[d2].isHidden() || (this.variableOffsets[d2] = a2[d2]);
          for (var _2 in n2)
            this.placedOrientations[_2] || !this.opacities[_2] || this.opacities[_2].isHidden() || (this.placedOrientations[_2] = n2[_2]);
          i2 ? this.lastPlacementChangeTime = t2 : typeof this.lastPlacementChangeTime != "number" && (this.lastPlacementChangeTime = e2 ? e2.lastPlacementChangeTime : t2);
        }, be.prototype.updateLayerOpacities = function(t2, e2) {
          for (var i2 = {}, o2 = 0, r2 = e2; o2 < r2.length; o2 += 1) {
            var a2 = r2[o2], n2 = a2.getBucket(t2);
            n2 && a2.latestFeatureIndex && t2.id === n2.layerIds[0] && this.updateBucketOpacities(n2, i2, a2.collisionBoxArray);
          }
        }, be.prototype.updateBucketOpacities = function(e2, i2, o2) {
          var r2 = this;
          e2.hasTextData() && e2.text.opacityVertexArray.clear(), e2.hasIconData() && e2.icon.opacityVertexArray.clear(), e2.hasIconCollisionBoxData() && e2.iconCollisionBox.collisionVertexArray.clear(), e2.hasTextCollisionBoxData() && e2.textCollisionBox.collisionVertexArray.clear();
          var a2 = e2.layers[0].layout, n2 = new _e(null, 0, false, false, true), s2 = a2.get("text-allow-overlap"), l2 = a2.get("icon-allow-overlap"), c2 = a2.get("text-variable-anchor"), u2 = a2.get("text-rotation-alignment") === "map", h2 = a2.get("text-pitch-alignment") === "map", p2 = a2.get("icon-text-fit") !== "none", d2 = new _e(null, 0, s2 && (l2 || !e2.hasIconData() || a2.get("icon-optional")), l2 && (s2 || !e2.hasTextData() || a2.get("text-optional")), true);
          !e2.collisionArrays && o2 && (e2.hasIconCollisionBoxData() || e2.hasTextCollisionBoxData()) && e2.deserializeCollisionBoxes(o2);
          for (var _2 = function(t2, e3, i3) {
            for (var o3 = 0; o3 < e3 / 4; o3++)
              t2.opacityVertexArray.emplaceBack(i3);
          }, f2 = function(o3) {
            var a3 = e2.symbolInstances.get(o3), s3 = a3.numHorizontalGlyphVertices, l3 = a3.numVerticalGlyphVertices, f3 = a3.crossTileID, m3 = r2.opacities[f3];
            i2[f3] ? m3 = n2 : m3 || (r2.opacities[f3] = m3 = d2), i2[f3] = true;
            var g3 = a3.numIconVertices > 0, v2 = r2.placedOrientations[a3.crossTileID], y2 = v2 === t.WritingMode.vertical, x2 = v2 === t.WritingMode.horizontal || v2 === t.WritingMode.horizontalOnly;
            if (s3 > 0 || l3 > 0) {
              var b2 = De(m3.text);
              _2(e2.text, s3, y2 ? Ae : b2), _2(e2.text, l3, x2 ? Ae : b2);
              var w2 = m3.text.isHidden();
              [a3.rightJustifiedTextSymbolIndex, a3.centerJustifiedTextSymbolIndex, a3.leftJustifiedTextSymbolIndex].forEach(function(t2) {
                t2 >= 0 && (e2.text.placedSymbolArray.get(t2).hidden = w2 || y2 ? 1 : 0);
              }), a3.verticalPlacedTextSymbolIndex >= 0 && (e2.text.placedSymbolArray.get(a3.verticalPlacedTextSymbolIndex).hidden = w2 || x2 ? 1 : 0);
              var T2 = r2.variableOffsets[a3.crossTileID];
              T2 && r2.markUsedJustification(e2, T2.anchor, a3, v2);
              var E2 = r2.placedOrientations[a3.crossTileID];
              E2 && (r2.markUsedJustification(e2, "left", a3, E2), r2.markUsedOrientation(e2, E2, a3));
            }
            if (g3) {
              var I2 = De(m3.icon), P2 = !(p2 && a3.verticalPlacedIconSymbolIndex && y2);
              a3.placedIconSymbolIndex >= 0 && (_2(e2.icon, a3.numIconVertices, P2 ? I2 : Ae), e2.icon.placedSymbolArray.get(a3.placedIconSymbolIndex).hidden = m3.icon.isHidden()), a3.verticalPlacedIconSymbolIndex >= 0 && (_2(e2.icon, a3.numVerticalIconVertices, P2 ? Ae : I2), e2.icon.placedSymbolArray.get(a3.verticalPlacedIconSymbolIndex).hidden = m3.icon.isHidden());
            }
            if (e2.hasIconCollisionBoxData() || e2.hasTextCollisionBoxData()) {
              var S2 = e2.collisionArrays[o3];
              if (S2) {
                var C2 = new t.Point(0, 0);
                if (S2.textBox || S2.verticalTextBox) {
                  var z2 = true;
                  if (c2) {
                    var D2 = r2.variableOffsets[f3];
                    D2 ? (C2 = ye(D2.anchor, D2.width, D2.height, D2.textOffset, D2.textBoxScale), u2 && C2._rotate(h2 ? r2.transform.angle : -r2.transform.angle)) : z2 = false;
                  }
                  S2.textBox && we(e2.textCollisionBox.collisionVertexArray, m3.text.placed, !z2 || y2, C2.x, C2.y), S2.verticalTextBox && we(e2.textCollisionBox.collisionVertexArray, m3.text.placed, !z2 || x2, C2.x, C2.y);
                }
                var A2 = Boolean(!x2 && S2.verticalIconBox);
                S2.iconBox && we(e2.iconCollisionBox.collisionVertexArray, m3.icon.placed, A2, p2 ? C2.x : 0, p2 ? C2.y : 0), S2.verticalIconBox && we(e2.iconCollisionBox.collisionVertexArray, m3.icon.placed, !A2, p2 ? C2.x : 0, p2 ? C2.y : 0);
              }
            }
          }, m2 = 0; m2 < e2.symbolInstances.length; m2++)
            f2(m2);
          if (e2.sortFeatures(this.transform.angle), this.retainedQueryData[e2.bucketInstanceId] && (this.retainedQueryData[e2.bucketInstanceId].featureSortOrder = e2.featureSortOrder), e2.hasTextData() && e2.text.opacityVertexBuffer && e2.text.opacityVertexBuffer.updateData(e2.text.opacityVertexArray), e2.hasIconData() && e2.icon.opacityVertexBuffer && e2.icon.opacityVertexBuffer.updateData(e2.icon.opacityVertexArray), e2.hasIconCollisionBoxData() && e2.iconCollisionBox.collisionVertexBuffer && e2.iconCollisionBox.collisionVertexBuffer.updateData(e2.iconCollisionBox.collisionVertexArray), e2.hasTextCollisionBoxData() && e2.textCollisionBox.collisionVertexBuffer && e2.textCollisionBox.collisionVertexBuffer.updateData(e2.textCollisionBox.collisionVertexArray), e2.bucketInstanceId in this.collisionCircleArrays) {
            var g2 = this.collisionCircleArrays[e2.bucketInstanceId];
            e2.placementInvProjMatrix = g2.invProjMatrix, e2.placementViewportMatrix = g2.viewportMatrix, e2.collisionCircleArray = g2.circles, delete this.collisionCircleArrays[e2.bucketInstanceId];
          }
        }, be.prototype.symbolFadeChange = function(t2) {
          return this.fadeDuration === 0 ? 1 : (t2 - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment;
        }, be.prototype.zoomAdjustment = function(t2) {
          return Math.max(0, (this.transform.zoom - t2) / 1.5);
        }, be.prototype.hasTransitions = function(t2) {
          return this.stale || t2 - this.lastPlacementChangeTime < this.fadeDuration;
        }, be.prototype.stillRecent = function(t2, e2) {
          var i2 = this.zoomAtLastRecencyCheck === e2 ? 1 - this.zoomAdjustment(e2) : 1;
          return this.zoomAtLastRecencyCheck = e2, this.commitTime + this.fadeDuration * i2 > t2;
        }, be.prototype.setStale = function() {
          this.stale = true;
        };
        var Te = Math.pow(2, 25), Ee = Math.pow(2, 24), Ie = Math.pow(2, 17), Pe = Math.pow(2, 16), Se = Math.pow(2, 9), Ce = Math.pow(2, 8), ze = Math.pow(2, 1);
        function De(t2) {
          if (t2.opacity === 0 && !t2.placed)
            return 0;
          if (t2.opacity === 1 && t2.placed)
            return 4294967295;
          var e2 = t2.placed ? 1 : 0, i2 = Math.floor(127 * t2.opacity);
          return i2 * Te + e2 * Ee + i2 * Ie + e2 * Pe + i2 * Se + e2 * Ce + i2 * ze + e2;
        }
        var Ae = 0, Me = function(t2) {
          this._sortAcrossTiles = t2.layout.get("symbol-z-order") !== "viewport-y" && t2.layout.get("symbol-sort-key").constantOr(1) !== void 0, this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = [];
        };
        Me.prototype.continuePlacement = function(t2, e2, i2, o2, r2) {
          for (var a2 = this._bucketParts; this._currentTileIndex < t2.length; )
            if (e2.getBucketParts(a2, o2, t2[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, r2())
              return true;
          for (this._sortAcrossTiles && (this._sortAcrossTiles = false, a2.sort(function(t3, e3) {
            return t3.sortKey - e3.sortKey;
          })); this._currentPartIndex < a2.length; )
            if (e2.placeLayerBucketPart(a2[this._currentPartIndex], this._seenCrossTileIDs, i2), this._currentPartIndex++, r2())
              return true;
          return false;
        };
        var Le = function(t2, e2, i2, o2, r2, a2, n2) {
          this.placement = new be(t2, r2, a2, n2), this._currentPlacementIndex = e2.length - 1, this._forceFullPlacement = i2, this._showCollisionBoxes = o2, this._done = false;
        };
        Le.prototype.isDone = function() {
          return this._done;
        }, Le.prototype.continuePlacement = function(e2, i2, o2) {
          for (var r2 = this, a2 = t.browser.now(), n2 = function() {
            var e3 = t.browser.now() - a2;
            return !r2._forceFullPlacement && e3 > 2;
          }; this._currentPlacementIndex >= 0; ) {
            var s2 = i2[e2[this._currentPlacementIndex]], l2 = this.placement.collisionIndex.transform.zoom;
            if (s2.type === "symbol" && (!s2.minzoom || s2.minzoom <= l2) && (!s2.maxzoom || s2.maxzoom > l2)) {
              if (this._inProgressLayer || (this._inProgressLayer = new Me(s2)), this._inProgressLayer.continuePlacement(o2[s2.source], this.placement, this._showCollisionBoxes, s2, n2))
                return;
              delete this._inProgressLayer;
            }
            this._currentPlacementIndex--;
          }
          this._done = true;
        }, Le.prototype.commit = function(t2) {
          return this.placement.commit(t2), this.placement;
        };
        var Re = 512 / t.EXTENT / 2, ke = function(t2, e2, i2) {
          this.tileID = t2, this.indexedSymbolInstances = {}, this.bucketInstanceId = i2;
          for (var o2 = 0; o2 < e2.length; o2++) {
            var r2 = e2.get(o2), a2 = r2.key;
            this.indexedSymbolInstances[a2] || (this.indexedSymbolInstances[a2] = []), this.indexedSymbolInstances[a2].push({crossTileID: r2.crossTileID, coord: this.getScaledCoordinates(r2, t2)});
          }
        };
        ke.prototype.getScaledCoordinates = function(e2, i2) {
          var o2 = Re / Math.pow(2, i2.canonical.z - this.tileID.canonical.z);
          return {x: Math.floor((i2.canonical.x * t.EXTENT + e2.anchorX) * o2), y: Math.floor((i2.canonical.y * t.EXTENT + e2.anchorY) * o2)};
        }, ke.prototype.findMatches = function(t2, e2, i2) {
          for (var o2 = this.tileID.canonical.z < e2.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - e2.canonical.z), r2 = 0; r2 < t2.length; r2++) {
            var a2 = t2.get(r2);
            if (!a2.crossTileID) {
              var n2 = this.indexedSymbolInstances[a2.key];
              if (n2)
                for (var s2 = this.getScaledCoordinates(a2, e2), l2 = 0, c2 = n2; l2 < c2.length; l2 += 1) {
                  var u2 = c2[l2];
                  if (Math.abs(u2.coord.x - s2.x) <= o2 && Math.abs(u2.coord.y - s2.y) <= o2 && !i2[u2.crossTileID]) {
                    i2[u2.crossTileID] = true, a2.crossTileID = u2.crossTileID;
                    break;
                  }
                }
            }
          }
        };
        var Be = function() {
          this.maxCrossTileID = 0;
        };
        Be.prototype.generate = function() {
          return ++this.maxCrossTileID;
        };
        var Oe = function() {
          this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0;
        };
        Oe.prototype.handleWrapJump = function(t2) {
          var e2 = Math.round((t2 - this.lng) / 360);
          if (e2 !== 0)
            for (var i2 in this.indexes) {
              var o2 = this.indexes[i2], r2 = {};
              for (var a2 in o2) {
                var n2 = o2[a2];
                n2.tileID = n2.tileID.unwrapTo(n2.tileID.wrap + e2), r2[n2.tileID.key] = n2;
              }
              this.indexes[i2] = r2;
            }
          this.lng = t2;
        }, Oe.prototype.addBucket = function(t2, e2, i2) {
          if (this.indexes[t2.overscaledZ] && this.indexes[t2.overscaledZ][t2.key]) {
            if (this.indexes[t2.overscaledZ][t2.key].bucketInstanceId === e2.bucketInstanceId)
              return false;
            this.removeBucketCrossTileIDs(t2.overscaledZ, this.indexes[t2.overscaledZ][t2.key]);
          }
          for (var o2 = 0; o2 < e2.symbolInstances.length; o2++)
            e2.symbolInstances.get(o2).crossTileID = 0;
          this.usedCrossTileIDs[t2.overscaledZ] || (this.usedCrossTileIDs[t2.overscaledZ] = {});
          var r2 = this.usedCrossTileIDs[t2.overscaledZ];
          for (var a2 in this.indexes) {
            var n2 = this.indexes[a2];
            if (Number(a2) > t2.overscaledZ)
              for (var s2 in n2) {
                var l2 = n2[s2];
                l2.tileID.isChildOf(t2) && l2.findMatches(e2.symbolInstances, t2, r2);
              }
            else {
              var c2 = n2[t2.scaledTo(Number(a2)).key];
              c2 && c2.findMatches(e2.symbolInstances, t2, r2);
            }
          }
          for (var u2 = 0; u2 < e2.symbolInstances.length; u2++) {
            var h2 = e2.symbolInstances.get(u2);
            h2.crossTileID || (h2.crossTileID = i2.generate(), r2[h2.crossTileID] = true);
          }
          return this.indexes[t2.overscaledZ] === void 0 && (this.indexes[t2.overscaledZ] = {}), this.indexes[t2.overscaledZ][t2.key] = new ke(t2, e2.symbolInstances, e2.bucketInstanceId), true;
        }, Oe.prototype.removeBucketCrossTileIDs = function(t2, e2) {
          for (var i2 in e2.indexedSymbolInstances)
            for (var o2 = 0, r2 = e2.indexedSymbolInstances[i2]; o2 < r2.length; o2 += 1)
              delete this.usedCrossTileIDs[t2][r2[o2].crossTileID];
        }, Oe.prototype.removeStaleBuckets = function(t2) {
          var e2 = false;
          for (var i2 in this.indexes) {
            var o2 = this.indexes[i2];
            for (var r2 in o2)
              t2[o2[r2].bucketInstanceId] || (this.removeBucketCrossTileIDs(i2, o2[r2]), delete o2[r2], e2 = true);
          }
          return e2;
        };
        var Fe = function() {
          this.layerIndexes = {}, this.crossTileIDs = new Be(), this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {};
        };
        Fe.prototype.addLayer = function(t2, e2, i2) {
          var o2 = this.layerIndexes[t2.id];
          o2 === void 0 && (o2 = this.layerIndexes[t2.id] = new Oe());
          var r2 = false, a2 = {};
          o2.handleWrapJump(i2);
          for (var n2 = 0, s2 = e2; n2 < s2.length; n2 += 1) {
            var l2 = s2[n2], c2 = l2.getBucket(t2);
            c2 && t2.id === c2.layerIds[0] && (c2.bucketInstanceId || (c2.bucketInstanceId = ++this.maxBucketInstanceId), o2.addBucket(l2.tileID, c2, this.crossTileIDs) && (r2 = true), a2[c2.bucketInstanceId] = true);
          }
          return o2.removeStaleBuckets(a2) && (r2 = true), r2;
        }, Fe.prototype.pruneUnusedLayers = function(t2) {
          var e2 = {};
          for (var i2 in t2.forEach(function(t3) {
            e2[t3] = true;
          }), this.layerIndexes)
            e2[i2] || delete this.layerIndexes[i2];
        };
        var Ue = function(e2, i2) {
          return t.emitValidationErrors(e2, i2 && i2.filter(function(t2) {
            return t2.identifier !== "source.canvas";
          }));
        }, Ne = t.pick(Zt, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData"]), Ze = t.pick(Zt, ["setCenter", "setZoom", "setBearing", "setPitch"]), qe = function() {
          var e2 = {}, i2 = t.styleSpec.$version;
          for (var o2 in t.styleSpec.$root) {
            var r2, a2 = t.styleSpec.$root[o2];
            if (a2.required)
              (r2 = o2 === "version" ? i2 : a2.type === "array" ? [] : {}) != null && (e2[o2] = r2);
          }
          return e2;
        }(), je = function(e2) {
          function i2(o2, r2) {
            var a2 = this;
            r2 === void 0 && (r2 = {}), e2.call(this), this.map = o2, this.dispatcher = new E(Ft(), this), this.imageManager = new p(), this.imageManager.setEventedParent(this), this.glyphManager = new y(o2._requestManager, r2.localIdeographFontFamily), this.lineAtlas = new T(256, 512), this.crossTileSymbolIndex = new Fe(), this._layers = {}, this._serializedLayers = {}, this._order = [], this.sourceCaches = {}, this.zoomHistory = new t.ZoomHistory(), this._loaded = false, this._availableImages = [], this._resetUpdates(), this.dispatcher.broadcast("setReferrer", t.getReferrer());
            var n2 = this;
            this._rtlTextPluginCallback = i2.registerForPluginStateChange(function(e3) {
              n2.dispatcher.broadcast("syncRTLPluginState", {pluginStatus: e3.pluginStatus, pluginURL: e3.pluginURL}, function(e4, i3) {
                if (t.triggerPluginCompletionEvent(e4), i3 && i3.every(function(t2) {
                  return t2;
                }))
                  for (var o3 in n2.sourceCaches)
                    n2.sourceCaches[o3].reload();
              });
            }), this.on("data", function(t2) {
              if (t2.dataType === "source" && t2.sourceDataType === "metadata") {
                var e3 = a2.sourceCaches[t2.sourceId];
                if (e3) {
                  var i3 = e3.getSource();
                  if (i3 && i3.vectorLayerIds)
                    for (var o3 in a2._layers) {
                      var r3 = a2._layers[o3];
                      r3.source === i3.id && a2._validateLayer(r3);
                    }
                }
              }
            });
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.loadURL = function(e3, i3) {
            var o2 = this;
            i3 === void 0 && (i3 = {}), this.fire(new t.Event("dataloading", {dataType: "style"}));
            var r2 = typeof i3.validate == "boolean" ? i3.validate : !t.isMapboxURL(e3);
            e3 = this.map._requestManager.normalizeStyleURL(e3, i3.accessToken);
            var a2 = this.map._requestManager.transformRequest(e3, t.ResourceType.Style);
            this._request = t.getJSON(a2, function(e4, i4) {
              o2._request = null, e4 ? o2.fire(new t.ErrorEvent(e4)) : i4 && o2._load(i4, r2);
            });
          }, i2.prototype.loadJSON = function(e3, i3) {
            var o2 = this;
            i3 === void 0 && (i3 = {}), this.fire(new t.Event("dataloading", {dataType: "style"})), this._request = t.browser.frame(function() {
              o2._request = null, o2._load(e3, i3.validate !== false);
            });
          }, i2.prototype.loadEmpty = function() {
            this.fire(new t.Event("dataloading", {dataType: "style"})), this._load(qe, false);
          }, i2.prototype._load = function(e3, i3) {
            if (!i3 || !Ue(this, t.validateStyle(e3))) {
              for (var o2 in this._loaded = true, this.stylesheet = e3, e3.sources)
                this.addSource(o2, e3.sources[o2], {validate: false});
              e3.sprite ? this._loadSprite(e3.sprite) : this.imageManager.setLoaded(true), this.glyphManager.setURL(e3.glyphs);
              var r2 = Nt(this.stylesheet.layers);
              this._order = r2.map(function(t2) {
                return t2.id;
              }), this._layers = {}, this._serializedLayers = {};
              for (var a2 = 0, n2 = r2; a2 < n2.length; a2 += 1) {
                var s2 = n2[a2];
                (s2 = t.createStyleLayer(s2)).setEventedParent(this, {layer: {id: s2.id}}), this._layers[s2.id] = s2, this._serializedLayers[s2.id] = s2.serialize();
              }
              this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)), this.light = new w(this.stylesheet.light), this.fire(new t.Event("data", {dataType: "style"})), this.fire(new t.Event("style.load"));
            }
          }, i2.prototype._loadSprite = function(e3) {
            var i3 = this;
            this._spriteRequest = function(e4, i4, o2) {
              var r2, a2, n2, s2 = t.browser.devicePixelRatio > 1 ? "@2x" : "", l2 = t.getJSON(i4.transformRequest(i4.normalizeSpriteURL(e4, s2, ".json"), t.ResourceType.SpriteJSON), function(t2, e5) {
                l2 = null, n2 || (n2 = t2, r2 = e5, u2());
              }), c2 = t.getImage(i4.transformRequest(i4.normalizeSpriteURL(e4, s2, ".png"), t.ResourceType.SpriteImage), function(t2, e5) {
                c2 = null, n2 || (n2 = t2, a2 = e5, u2());
              });
              function u2() {
                if (n2)
                  o2(n2);
                else if (r2 && a2) {
                  var e5 = t.browser.getImageData(a2), i5 = {};
                  for (var s3 in r2) {
                    var l3 = r2[s3], c3 = l3.width, u3 = l3.height, h2 = l3.x, p2 = l3.y, d2 = l3.sdf, _2 = l3.pixelRatio, f2 = l3.stretchX, m2 = l3.stretchY, g2 = l3.content, v2 = new t.RGBAImage({width: c3, height: u3});
                    t.RGBAImage.copy(e5, v2, {x: h2, y: p2}, {x: 0, y: 0}, {width: c3, height: u3}), i5[s3] = {data: v2, pixelRatio: _2, sdf: d2, stretchX: f2, stretchY: m2, content: g2};
                  }
                  o2(null, i5);
                }
              }
              return {cancel: function() {
                l2 && (l2.cancel(), l2 = null), c2 && (c2.cancel(), c2 = null);
              }};
            }(e3, this.map._requestManager, function(e4, o2) {
              if (i3._spriteRequest = null, e4)
                i3.fire(new t.ErrorEvent(e4));
              else if (o2)
                for (var r2 in o2)
                  i3.imageManager.addImage(r2, o2[r2]);
              i3.imageManager.setLoaded(true), i3._availableImages = i3.imageManager.listImages(), i3.dispatcher.broadcast("setImages", i3._availableImages), i3.fire(new t.Event("data", {dataType: "style"}));
            });
          }, i2.prototype._validateLayer = function(e3) {
            var i3 = this.sourceCaches[e3.source];
            if (i3) {
              var o2 = e3.sourceLayer;
              if (o2) {
                var r2 = i3.getSource();
                (r2.type === "geojson" || r2.vectorLayerIds && r2.vectorLayerIds.indexOf(o2) === -1) && this.fire(new t.ErrorEvent(new Error('Source layer "' + o2 + '" does not exist on source "' + r2.id + '" as specified by style layer "' + e3.id + '"')));
              }
            }
          }, i2.prototype.loaded = function() {
            if (!this._loaded)
              return false;
            if (Object.keys(this._updatedSources).length)
              return false;
            for (var t2 in this.sourceCaches)
              if (!this.sourceCaches[t2].loaded())
                return false;
            return !!this.imageManager.isLoaded();
          }, i2.prototype._serializeLayers = function(t2) {
            for (var e3 = [], i3 = 0, o2 = t2; i3 < o2.length; i3 += 1) {
              var r2 = this._layers[o2[i3]];
              r2.type !== "custom" && e3.push(r2.serialize());
            }
            return e3;
          }, i2.prototype.hasTransitions = function() {
            if (this.light && this.light.hasTransition())
              return true;
            for (var t2 in this.sourceCaches)
              if (this.sourceCaches[t2].hasTransition())
                return true;
            for (var e3 in this._layers)
              if (this._layers[e3].hasTransition())
                return true;
            return false;
          }, i2.prototype._checkLoaded = function() {
            if (!this._loaded)
              throw new Error("Style is not done loading");
          }, i2.prototype.update = function(e3) {
            if (this._loaded) {
              var i3 = this._changed;
              if (this._changed) {
                var o2 = Object.keys(this._updatedLayers), r2 = Object.keys(this._removedLayers);
                for (var a2 in (o2.length || r2.length) && this._updateWorkerLayers(o2, r2), this._updatedSources) {
                  var n2 = this._updatedSources[a2];
                  n2 === "reload" ? this._reloadSource(a2) : n2 === "clear" && this._clearSource(a2);
                }
                for (var s2 in this._updateTilesForChangedImages(), this._updatedPaintProps)
                  this._layers[s2].updateTransitions(e3);
                this.light.updateTransitions(e3), this._resetUpdates();
              }
              var l2 = {};
              for (var c2 in this.sourceCaches) {
                var u2 = this.sourceCaches[c2];
                l2[c2] = u2.used, u2.used = false;
              }
              for (var h2 = 0, p2 = this._order; h2 < p2.length; h2 += 1) {
                var d2 = this._layers[p2[h2]];
                d2.recalculate(e3, this._availableImages), !d2.isHidden(e3.zoom) && d2.source && (this.sourceCaches[d2.source].used = true);
              }
              for (var _2 in l2) {
                var f2 = this.sourceCaches[_2];
                l2[_2] !== f2.used && f2.fire(new t.Event("data", {sourceDataType: "visibility", dataType: "source", sourceId: _2}));
              }
              this.light.recalculate(e3), this.z = e3.zoom, i3 && this.fire(new t.Event("data", {dataType: "style"}));
            }
          }, i2.prototype._updateTilesForChangedImages = function() {
            var t2 = Object.keys(this._changedImages);
            if (t2.length) {
              for (var e3 in this.sourceCaches)
                this.sourceCaches[e3].reloadTilesForDependencies(["icons", "patterns"], t2);
              this._changedImages = {};
            }
          }, i2.prototype._updateWorkerLayers = function(t2, e3) {
            this.dispatcher.broadcast("updateLayers", {layers: this._serializeLayers(t2), removedIds: e3});
          }, i2.prototype._resetUpdates = function() {
            this._changed = false, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {};
          }, i2.prototype.setState = function(e3) {
            var i3 = this;
            if (this._checkLoaded(), Ue(this, t.validateStyle(e3)))
              return false;
            (e3 = t.clone$1(e3)).layers = Nt(e3.layers);
            var o2 = function(e4, i4) {
              if (!e4)
                return [{command: Zt.setStyle, args: [i4]}];
              var o3 = [];
              try {
                if (!t.deepEqual(e4.version, i4.version))
                  return [{command: Zt.setStyle, args: [i4]}];
                t.deepEqual(e4.center, i4.center) || o3.push({command: Zt.setCenter, args: [i4.center]}), t.deepEqual(e4.zoom, i4.zoom) || o3.push({command: Zt.setZoom, args: [i4.zoom]}), t.deepEqual(e4.bearing, i4.bearing) || o3.push({command: Zt.setBearing, args: [i4.bearing]}), t.deepEqual(e4.pitch, i4.pitch) || o3.push({command: Zt.setPitch, args: [i4.pitch]}), t.deepEqual(e4.sprite, i4.sprite) || o3.push({command: Zt.setSprite, args: [i4.sprite]}), t.deepEqual(e4.glyphs, i4.glyphs) || o3.push({command: Zt.setGlyphs, args: [i4.glyphs]}), t.deepEqual(e4.transition, i4.transition) || o3.push({command: Zt.setTransition, args: [i4.transition]}), t.deepEqual(e4.light, i4.light) || o3.push({command: Zt.setLight, args: [i4.light]});
                var r3 = {}, a2 = [];
                !function(e5, i5, o4, r4) {
                  var a3;
                  for (a3 in i5 = i5 || {}, e5 = e5 || {})
                    e5.hasOwnProperty(a3) && (i5.hasOwnProperty(a3) || jt(a3, o4, r4));
                  for (a3 in i5)
                    i5.hasOwnProperty(a3) && (e5.hasOwnProperty(a3) ? t.deepEqual(e5[a3], i5[a3]) || (e5[a3].type === "geojson" && i5[a3].type === "geojson" && Gt(e5, i5, a3) ? o4.push({command: Zt.setGeoJSONSourceData, args: [a3, i5[a3].data]}) : Vt(a3, i5, o4, r4)) : qt(a3, i5, o4));
                }(e4.sources, i4.sources, a2, r3);
                var n2 = [];
                e4.layers && e4.layers.forEach(function(t2) {
                  r3[t2.source] ? o3.push({command: Zt.removeLayer, args: [t2.id]}) : n2.push(t2);
                }), o3 = o3.concat(a2), function(e5, i5, o4) {
                  i5 = i5 || [];
                  var r4, a3, n3, s2, l2, c2, u2, h2 = (e5 = e5 || []).map(Xt), p2 = i5.map(Xt), d2 = e5.reduce(Ht, {}), _2 = i5.reduce(Ht, {}), f2 = h2.slice(), m2 = Object.create(null);
                  for (r4 = 0, a3 = 0; r4 < h2.length; r4++)
                    _2.hasOwnProperty(n3 = h2[r4]) ? a3++ : (o4.push({command: Zt.removeLayer, args: [n3]}), f2.splice(f2.indexOf(n3, a3), 1));
                  for (r4 = 0, a3 = 0; r4 < p2.length; r4++)
                    f2[f2.length - 1 - r4] !== (n3 = p2[p2.length - 1 - r4]) && (d2.hasOwnProperty(n3) ? (o4.push({command: Zt.removeLayer, args: [n3]}), f2.splice(f2.lastIndexOf(n3, f2.length - a3), 1)) : a3++, o4.push({command: Zt.addLayer, args: [_2[n3], c2 = f2[f2.length - r4]]}), f2.splice(f2.length - r4, 0, n3), m2[n3] = true);
                  for (r4 = 0; r4 < p2.length; r4++)
                    if (s2 = d2[n3 = p2[r4]], l2 = _2[n3], !m2[n3] && !t.deepEqual(s2, l2))
                      if (t.deepEqual(s2.source, l2.source) && t.deepEqual(s2["source-layer"], l2["source-layer"]) && t.deepEqual(s2.type, l2.type)) {
                        for (u2 in Wt(s2.layout, l2.layout, o4, n3, null, Zt.setLayoutProperty), Wt(s2.paint, l2.paint, o4, n3, null, Zt.setPaintProperty), t.deepEqual(s2.filter, l2.filter) || o4.push({command: Zt.setFilter, args: [n3, l2.filter]}), t.deepEqual(s2.minzoom, l2.minzoom) && t.deepEqual(s2.maxzoom, l2.maxzoom) || o4.push({command: Zt.setLayerZoomRange, args: [n3, l2.minzoom, l2.maxzoom]}), s2)
                          s2.hasOwnProperty(u2) && u2 !== "layout" && u2 !== "paint" && u2 !== "filter" && u2 !== "metadata" && u2 !== "minzoom" && u2 !== "maxzoom" && (u2.indexOf("paint.") === 0 ? Wt(s2[u2], l2[u2], o4, n3, u2.slice(6), Zt.setPaintProperty) : t.deepEqual(s2[u2], l2[u2]) || o4.push({command: Zt.setLayerProperty, args: [n3, u2, l2[u2]]}));
                        for (u2 in l2)
                          l2.hasOwnProperty(u2) && !s2.hasOwnProperty(u2) && u2 !== "layout" && u2 !== "paint" && u2 !== "filter" && u2 !== "metadata" && u2 !== "minzoom" && u2 !== "maxzoom" && (u2.indexOf("paint.") === 0 ? Wt(s2[u2], l2[u2], o4, n3, u2.slice(6), Zt.setPaintProperty) : t.deepEqual(s2[u2], l2[u2]) || o4.push({command: Zt.setLayerProperty, args: [n3, u2, l2[u2]]}));
                      } else
                        o4.push({command: Zt.removeLayer, args: [n3]}), c2 = f2[f2.lastIndexOf(n3) + 1], o4.push({command: Zt.addLayer, args: [l2, c2]});
                }(n2, i4.layers, o3);
              } catch (t2) {
                console.warn("Unable to compute style diff:", t2), o3 = [{command: Zt.setStyle, args: [i4]}];
              }
              return o3;
            }(this.serialize(), e3).filter(function(t2) {
              return !(t2.command in Ze);
            });
            if (o2.length === 0)
              return false;
            var r2 = o2.filter(function(t2) {
              return !(t2.command in Ne);
            });
            if (r2.length > 0)
              throw new Error("Unimplemented: " + r2.map(function(t2) {
                return t2.command;
              }).join(", ") + ".");
            return o2.forEach(function(t2) {
              t2.command !== "setTransition" && i3[t2.command].apply(i3, t2.args);
            }), this.stylesheet = e3, true;
          }, i2.prototype.addImage = function(e3, i3) {
            if (this.getImage(e3))
              return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));
            this.imageManager.addImage(e3, i3), this._afterImageUpdated(e3);
          }, i2.prototype.updateImage = function(t2, e3) {
            this.imageManager.updateImage(t2, e3);
          }, i2.prototype.getImage = function(t2) {
            return this.imageManager.getImage(t2);
          }, i2.prototype.removeImage = function(e3) {
            if (!this.getImage(e3))
              return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));
            this.imageManager.removeImage(e3), this._afterImageUpdated(e3);
          }, i2.prototype._afterImageUpdated = function(e3) {
            this._availableImages = this.imageManager.listImages(), this._changedImages[e3] = true, this._changed = true, this.dispatcher.broadcast("setImages", this._availableImages), this.fire(new t.Event("data", {dataType: "style"}));
          }, i2.prototype.listImages = function() {
            return this._checkLoaded(), this.imageManager.listImages();
          }, i2.prototype.addSource = function(e3, i3, o2) {
            var r2 = this;
            if (o2 === void 0 && (o2 = {}), this._checkLoaded(), this.sourceCaches[e3] !== void 0)
              throw new Error("There is already a source with this ID");
            if (!i3.type)
              throw new Error("The type property must be defined, but only the following properties were given: " + Object.keys(i3).join(", ") + ".");
            if (!(["vector", "raster", "geojson", "video", "image"].indexOf(i3.type) >= 0 && this._validate(t.validateStyle.source, "sources." + e3, i3, null, o2))) {
              this.map && this.map._collectResourceTiming && (i3.collectResourceTiming = true);
              var a2 = this.sourceCaches[e3] = new Dt(e3, i3, this.dispatcher);
              a2.style = this, a2.setEventedParent(this, function() {
                return {isSourceLoaded: r2.loaded(), source: a2.serialize(), sourceId: e3};
              }), a2.onAdd(this.map), this._changed = true;
            }
          }, i2.prototype.removeSource = function(e3) {
            if (this._checkLoaded(), this.sourceCaches[e3] === void 0)
              throw new Error("There is no source with this ID");
            for (var i3 in this._layers)
              if (this._layers[i3].source === e3)
                return this.fire(new t.ErrorEvent(new Error('Source "' + e3 + '" cannot be removed while layer "' + i3 + '" is using it.')));
            var o2 = this.sourceCaches[e3];
            delete this.sourceCaches[e3], delete this._updatedSources[e3], o2.fire(new t.Event("data", {sourceDataType: "metadata", dataType: "source", sourceId: e3})), o2.setEventedParent(null), o2.clearTiles(), o2.onRemove && o2.onRemove(this.map), this._changed = true;
          }, i2.prototype.setGeoJSONSourceData = function(t2, e3) {
            this._checkLoaded(), this.sourceCaches[t2].getSource().setData(e3), this._changed = true;
          }, i2.prototype.getSource = function(t2) {
            return this.sourceCaches[t2] && this.sourceCaches[t2].getSource();
          }, i2.prototype.addLayer = function(e3, i3, o2) {
            o2 === void 0 && (o2 = {}), this._checkLoaded();
            var r2 = e3.id;
            if (this.getLayer(r2))
              this.fire(new t.ErrorEvent(new Error('Layer with id "' + r2 + '" already exists on this map')));
            else {
              var a2;
              if (e3.type === "custom") {
                if (Ue(this, t.validateCustomStyleLayer(e3)))
                  return;
                a2 = t.createStyleLayer(e3);
              } else {
                if (typeof e3.source == "object" && (this.addSource(r2, e3.source), e3 = t.clone$1(e3), e3 = t.extend(e3, {source: r2})), this._validate(t.validateStyle.layer, "layers." + r2, e3, {arrayIndex: -1}, o2))
                  return;
                a2 = t.createStyleLayer(e3), this._validateLayer(a2), a2.setEventedParent(this, {layer: {id: r2}}), this._serializedLayers[a2.id] = a2.serialize();
              }
              var n2 = i3 ? this._order.indexOf(i3) : this._order.length;
              if (i3 && n2 === -1)
                this.fire(new t.ErrorEvent(new Error('Layer with id "' + i3 + '" does not exist on this map.')));
              else {
                if (this._order.splice(n2, 0, r2), this._layerOrderChanged = true, this._layers[r2] = a2, this._removedLayers[r2] && a2.source && a2.type !== "custom") {
                  var s2 = this._removedLayers[r2];
                  delete this._removedLayers[r2], s2.type !== a2.type ? this._updatedSources[a2.source] = "clear" : (this._updatedSources[a2.source] = "reload", this.sourceCaches[a2.source].pause());
                }
                this._updateLayer(a2), a2.onAdd && a2.onAdd(this.map);
              }
            }
          }, i2.prototype.moveLayer = function(e3, i3) {
            if (this._checkLoaded(), this._changed = true, this._layers[e3]) {
              if (e3 !== i3) {
                var o2 = this._order.indexOf(e3);
                this._order.splice(o2, 1);
                var r2 = i3 ? this._order.indexOf(i3) : this._order.length;
                i3 && r2 === -1 ? this.fire(new t.ErrorEvent(new Error('Layer with id "' + i3 + '" does not exist on this map.'))) : (this._order.splice(r2, 0, e3), this._layerOrderChanged = true);
              }
            } else
              this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style and cannot be moved.")));
          }, i2.prototype.removeLayer = function(e3) {
            this._checkLoaded();
            var i3 = this._layers[e3];
            if (i3) {
              i3.setEventedParent(null);
              var o2 = this._order.indexOf(e3);
              this._order.splice(o2, 1), this._layerOrderChanged = true, this._changed = true, this._removedLayers[e3] = i3, delete this._layers[e3], delete this._serializedLayers[e3], delete this._updatedLayers[e3], delete this._updatedPaintProps[e3], i3.onRemove && i3.onRemove(this.map);
            } else
              this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style and cannot be removed.")));
          }, i2.prototype.getLayer = function(t2) {
            return this._layers[t2];
          }, i2.prototype.hasLayer = function(t2) {
            return t2 in this._layers;
          }, i2.prototype.setLayerZoomRange = function(e3, i3, o2) {
            this._checkLoaded();
            var r2 = this.getLayer(e3);
            r2 ? r2.minzoom === i3 && r2.maxzoom === o2 || (i3 != null && (r2.minzoom = i3), o2 != null && (r2.maxzoom = o2), this._updateLayer(r2)) : this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style and cannot have zoom extent.")));
          }, i2.prototype.setFilter = function(e3, i3, o2) {
            o2 === void 0 && (o2 = {}), this._checkLoaded();
            var r2 = this.getLayer(e3);
            if (r2) {
              if (!t.deepEqual(r2.filter, i3))
                return i3 == null ? (r2.filter = void 0, void this._updateLayer(r2)) : void (this._validate(t.validateStyle.filter, "layers." + r2.id + ".filter", i3, null, o2) || (r2.filter = t.clone$1(i3), this._updateLayer(r2)));
            } else
              this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style and cannot be filtered.")));
          }, i2.prototype.getFilter = function(e3) {
            return t.clone$1(this.getLayer(e3).filter);
          }, i2.prototype.setLayoutProperty = function(e3, i3, o2, r2) {
            r2 === void 0 && (r2 = {}), this._checkLoaded();
            var a2 = this.getLayer(e3);
            a2 ? t.deepEqual(a2.getLayoutProperty(i3), o2) || (a2.setLayoutProperty(i3, o2, r2), this._updateLayer(a2)) : this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style and cannot be styled.")));
          }, i2.prototype.getLayoutProperty = function(e3, i3) {
            var o2 = this.getLayer(e3);
            if (o2)
              return o2.getLayoutProperty(i3);
            this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style.")));
          }, i2.prototype.setPaintProperty = function(e3, i3, o2, r2) {
            r2 === void 0 && (r2 = {}), this._checkLoaded();
            var a2 = this.getLayer(e3);
            a2 ? t.deepEqual(a2.getPaintProperty(i3), o2) || (a2.setPaintProperty(i3, o2, r2) && this._updateLayer(a2), this._changed = true, this._updatedPaintProps[e3] = true) : this.fire(new t.ErrorEvent(new Error("The layer '" + e3 + "' does not exist in the map's style and cannot be styled.")));
          }, i2.prototype.getPaintProperty = function(t2, e3) {
            return this.getLayer(t2).getPaintProperty(e3);
          }, i2.prototype.setFeatureState = function(e3, i3) {
            this._checkLoaded();
            var o2 = e3.source, r2 = e3.sourceLayer, a2 = this.sourceCaches[o2];
            if (a2 !== void 0) {
              var n2 = a2.getSource().type;
              n2 === "geojson" && r2 ? this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))) : n2 !== "vector" || r2 ? (e3.id === void 0 && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), a2.setFeatureState(r2, e3.id, i3)) : this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
            } else
              this.fire(new t.ErrorEvent(new Error("The source '" + o2 + "' does not exist in the map's style.")));
          }, i2.prototype.removeFeatureState = function(e3, i3) {
            this._checkLoaded();
            var o2 = e3.source, r2 = this.sourceCaches[o2];
            if (r2 !== void 0) {
              var a2 = r2.getSource().type, n2 = a2 === "vector" ? e3.sourceLayer : void 0;
              a2 !== "vector" || n2 ? i3 && typeof e3.id != "string" && typeof e3.id != "number" ? this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))) : r2.removeFeatureState(n2, e3.id, i3) : this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
            } else
              this.fire(new t.ErrorEvent(new Error("The source '" + o2 + "' does not exist in the map's style.")));
          }, i2.prototype.getFeatureState = function(e3) {
            this._checkLoaded();
            var i3 = e3.source, o2 = e3.sourceLayer, r2 = this.sourceCaches[i3];
            if (r2 !== void 0) {
              if (r2.getSource().type !== "vector" || o2)
                return e3.id === void 0 && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), r2.getFeatureState(o2, e3.id);
              this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
            } else
              this.fire(new t.ErrorEvent(new Error("The source '" + i3 + "' does not exist in the map's style.")));
          }, i2.prototype.getTransition = function() {
            return t.extend({duration: 300, delay: 0}, this.stylesheet && this.stylesheet.transition);
          }, i2.prototype.serialize = function() {
            return t.filterObject({version: this.stylesheet.version, name: this.stylesheet.name, metadata: this.stylesheet.metadata, light: this.stylesheet.light, center: this.stylesheet.center, zoom: this.stylesheet.zoom, bearing: this.stylesheet.bearing, pitch: this.stylesheet.pitch, sprite: this.stylesheet.sprite, glyphs: this.stylesheet.glyphs, transition: this.stylesheet.transition, sources: t.mapObject(this.sourceCaches, function(t2) {
              return t2.serialize();
            }), layers: this._serializeLayers(this._order)}, function(t2) {
              return t2 !== void 0;
            });
          }, i2.prototype._updateLayer = function(t2) {
            this._updatedLayers[t2.id] = true, t2.source && !this._updatedSources[t2.source] && this.sourceCaches[t2.source].getSource().type !== "raster" && (this._updatedSources[t2.source] = "reload", this.sourceCaches[t2.source].pause()), this._changed = true;
          }, i2.prototype._flattenAndSortRenderedFeatures = function(t2) {
            for (var e3 = this, i3 = function(t3) {
              return e3._layers[t3].type === "fill-extrusion";
            }, o2 = {}, r2 = [], a2 = this._order.length - 1; a2 >= 0; a2--) {
              var n2 = this._order[a2];
              if (i3(n2)) {
                o2[n2] = a2;
                for (var s2 = 0, l2 = t2; s2 < l2.length; s2 += 1) {
                  var c2 = l2[s2][n2];
                  if (c2)
                    for (var u2 = 0, h2 = c2; u2 < h2.length; u2 += 1)
                      r2.push(h2[u2]);
                }
              }
            }
            r2.sort(function(t3, e4) {
              return e4.intersectionZ - t3.intersectionZ;
            });
            for (var p2 = [], d2 = this._order.length - 1; d2 >= 0; d2--) {
              var _2 = this._order[d2];
              if (i3(_2))
                for (var f2 = r2.length - 1; f2 >= 0; f2--) {
                  var m2 = r2[f2].feature;
                  if (o2[m2.layer.id] < d2)
                    break;
                  p2.push(m2), r2.pop();
                }
              else
                for (var g2 = 0, v2 = t2; g2 < v2.length; g2 += 1) {
                  var y2 = v2[g2][_2];
                  if (y2)
                    for (var x2 = 0, b2 = y2; x2 < b2.length; x2 += 1)
                      p2.push(b2[x2].feature);
                }
            }
            return p2;
          }, i2.prototype.queryRenderedFeatures = function(e3, i3, o2) {
            i3 && i3.filter && this._validate(t.validateStyle.filter, "queryRenderedFeatures.filter", i3.filter, null, i3);
            var r2 = {};
            if (i3 && i3.layers) {
              if (!Array.isArray(i3.layers))
                return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))), [];
              for (var a2 = 0, n2 = i3.layers; a2 < n2.length; a2 += 1) {
                var s2 = n2[a2], l2 = this._layers[s2];
                if (!l2)
                  return this.fire(new t.ErrorEvent(new Error("The layer '" + s2 + "' does not exist in the map's style and cannot be queried for features."))), [];
                r2[l2.source] = true;
              }
            }
            var c2 = [];
            for (var u2 in i3.availableImages = this._availableImages, this.sourceCaches)
              i3.layers && !r2[u2] || c2.push(O(this.sourceCaches[u2], this._layers, this._serializedLayers, e3, i3, o2));
            return this.placement && c2.push(function(t2, e4, i4, o3, r3, a3, n3) {
              for (var s3 = {}, l3 = a3.queryRenderedSymbols(o3), c3 = [], u3 = 0, h2 = Object.keys(l3).map(Number); u3 < h2.length; u3 += 1)
                c3.push(n3[h2[u3]]);
              c3.sort(F);
              for (var p2 = function() {
                var i5 = _2[d2], o4 = i5.featureIndex.lookupSymbolFeatures(l3[i5.bucketInstanceId], e4, i5.bucketIndex, i5.sourceLayerIndex, r3.filter, r3.layers, r3.availableImages, t2);
                for (var a4 in o4) {
                  var n4 = s3[a4] = s3[a4] || [], c4 = o4[a4];
                  c4.sort(function(t3, e5) {
                    var o5 = i5.featureSortOrder;
                    if (o5) {
                      var r4 = o5.indexOf(t3.featureIndex);
                      return o5.indexOf(e5.featureIndex) - r4;
                    }
                    return e5.featureIndex - t3.featureIndex;
                  });
                  for (var u4 = 0, h3 = c4; u4 < h3.length; u4 += 1)
                    n4.push(h3[u4]);
                }
              }, d2 = 0, _2 = c3; d2 < _2.length; d2 += 1)
                p2();
              var f2 = function(e5) {
                s3[e5].forEach(function(o4) {
                  var r4 = o4.feature, a4 = i4[t2[e5].source].getFeatureState(r4.layer["source-layer"], r4.id);
                  r4.source = r4.layer.source, r4.layer["source-layer"] && (r4.sourceLayer = r4.layer["source-layer"]), r4.state = a4;
                });
              };
              for (var m2 in s3)
                f2(m2);
              return s3;
            }(this._layers, this._serializedLayers, this.sourceCaches, e3, i3, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(c2);
          }, i2.prototype.querySourceFeatures = function(e3, i3) {
            i3 && i3.filter && this._validate(t.validateStyle.filter, "querySourceFeatures.filter", i3.filter, null, i3);
            var o2 = this.sourceCaches[e3];
            return o2 ? function(t2, e4) {
              for (var i4 = t2.getRenderableIds().map(function(e5) {
                return t2.getTileByID(e5);
              }), o3 = [], r2 = {}, a2 = 0; a2 < i4.length; a2++) {
                var n2 = i4[a2], s2 = n2.tileID.canonical.key;
                r2[s2] || (r2[s2] = true, n2.querySourceFeatures(o3, e4));
              }
              return o3;
            }(o2, i3) : [];
          }, i2.prototype.addSourceType = function(t2, e3, o2) {
            return i2.getSourceType(t2) ? o2(new Error('A source type called "' + t2 + '" already exists.')) : (i2.setSourceType(t2, e3), e3.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", {name: t2, url: e3.workerSourceURL}, o2) : o2(null, null));
          }, i2.prototype.getLight = function() {
            return this.light.getLight();
          }, i2.prototype.setLight = function(e3, i3) {
            i3 === void 0 && (i3 = {}), this._checkLoaded();
            var o2 = this.light.getLight(), r2 = false;
            for (var a2 in e3)
              if (!t.deepEqual(e3[a2], o2[a2])) {
                r2 = true;
                break;
              }
            if (r2) {
              var n2 = {now: t.browser.now(), transition: t.extend({duration: 300, delay: 0}, this.stylesheet.transition)};
              this.light.setLight(e3, i3), this.light.updateTransitions(n2);
            }
          }, i2.prototype._validate = function(e3, i3, o2, r2, a2) {
            return a2 === void 0 && (a2 = {}), (!a2 || a2.validate !== false) && Ue(this, e3.call(t.validateStyle, t.extend({key: i3, style: this.serialize(), value: o2, styleSpec: t.styleSpec}, r2)));
          }, i2.prototype._remove = function() {
            for (var e3 in this._request && (this._request.cancel(), this._request = null), this._spriteRequest && (this._spriteRequest.cancel(), this._spriteRequest = null), t.evented.off("pluginStateChange", this._rtlTextPluginCallback), this._layers)
              this._layers[e3].setEventedParent(null);
            for (var i3 in this.sourceCaches)
              this.sourceCaches[i3].clearTiles(), this.sourceCaches[i3].setEventedParent(null);
            this.imageManager.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove();
          }, i2.prototype._clearSource = function(t2) {
            this.sourceCaches[t2].clearTiles();
          }, i2.prototype._reloadSource = function(t2) {
            this.sourceCaches[t2].resume(), this.sourceCaches[t2].reload();
          }, i2.prototype._updateSources = function(t2) {
            for (var e3 in this.sourceCaches)
              this.sourceCaches[e3].update(t2);
          }, i2.prototype._generateCollisionBoxes = function() {
            for (var t2 in this.sourceCaches)
              this._reloadSource(t2);
          }, i2.prototype._updatePlacement = function(e3, i3, o2, r2, a2) {
            a2 === void 0 && (a2 = false);
            for (var n2 = false, s2 = false, l2 = {}, c2 = 0, u2 = this._order; c2 < u2.length; c2 += 1) {
              var h2 = this._layers[u2[c2]];
              if (h2.type === "symbol") {
                if (!l2[h2.source]) {
                  var p2 = this.sourceCaches[h2.source];
                  l2[h2.source] = p2.getRenderableIds(true).map(function(t2) {
                    return p2.getTileByID(t2);
                  }).sort(function(t2, e4) {
                    return e4.tileID.overscaledZ - t2.tileID.overscaledZ || (t2.tileID.isLessThan(e4.tileID) ? -1 : 1);
                  });
                }
                var d2 = this.crossTileSymbolIndex.addLayer(h2, l2[h2.source], e3.center.lng);
                n2 = n2 || d2;
              }
            }
            if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), ((a2 = a2 || this._layerOrderChanged || o2 === 0) || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(t.browser.now(), e3.zoom)) && (this.pauseablePlacement = new Le(e3, this._order, a2, i3, o2, r2, this.placement), this._layerOrderChanged = false), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l2), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(t.browser.now()), s2 = true), n2 && this.pauseablePlacement.placement.setStale()), s2 || n2)
              for (var _2 = 0, f2 = this._order; _2 < f2.length; _2 += 1) {
                var m2 = this._layers[f2[_2]];
                m2.type === "symbol" && this.placement.updateLayerOpacities(m2, l2[m2.source]);
              }
            return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(t.browser.now());
          }, i2.prototype._releaseSymbolFadeTiles = function() {
            for (var t2 in this.sourceCaches)
              this.sourceCaches[t2].releaseSymbolFadeTiles();
          }, i2.prototype.getImages = function(t2, e3, i3) {
            this.imageManager.getImages(e3.icons, i3), this._updateTilesForChangedImages();
            var o2 = this.sourceCaches[e3.source];
            o2 && o2.setDependencies(e3.tileID.key, e3.type, e3.icons);
          }, i2.prototype.getGlyphs = function(t2, e3, i3) {
            this.glyphManager.getGlyphs(e3.stacks, i3);
          }, i2.prototype.getResource = function(e3, i3, o2) {
            return t.makeRequest(i3, o2);
          }, i2;
        }(t.Evented);
        je.getSourceType = function(t2) {
          return k[t2];
        }, je.setSourceType = function(t2, e2) {
          k[t2] = e2;
        }, je.registerForPluginStateChange = t.registerForPluginStateChange;
        var Ve = t.createLayout([{name: "a_pos", type: "Int16", components: 2}]), Ge = gi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif", "#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"), We = gi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"), Xe = gi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"), He = gi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"), Ke = gi("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"), Ye = gi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"), Je = gi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"), Qe = gi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}", "attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"), $e = gi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"), ti = gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"), ei = gi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"), ii = gi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"), oi = gi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"), ri = gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"), ai = gi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"), ni = gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"), si = gi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"), li = gi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"), ci = gi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"), ui = gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"), hi = gi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"), pi = gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"), di = gi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"), _i = gi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"), fi = gi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"), mi = gi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");
        function gi(t2, e2) {
          var i2 = /#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g, o2 = e2.match(/attribute ([\w]+) ([\w]+)/g), r2 = t2.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g), a2 = e2.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g), n2 = a2 ? a2.concat(r2) : r2, s2 = {};
          return {fragmentSource: t2 = t2.replace(i2, function(t3, e3, i3, o3, r3) {
            return s2[r3] = true, e3 === "define" ? "\n#ifndef HAS_UNIFORM_u_" + r3 + "\nvarying " + i3 + " " + o3 + " " + r3 + ";\n#else\nuniform " + i3 + " " + o3 + " u_" + r3 + ";\n#endif\n" : "\n#ifdef HAS_UNIFORM_u_" + r3 + "\n    " + i3 + " " + o3 + " " + r3 + " = u_" + r3 + ";\n#endif\n";
          }), vertexSource: e2 = e2.replace(i2, function(t3, e3, i3, o3, r3) {
            var a3 = o3 === "float" ? "vec2" : "vec4", n3 = r3.match(/color/) ? "color" : a3;
            return s2[r3] ? e3 === "define" ? "\n#ifndef HAS_UNIFORM_u_" + r3 + "\nuniform lowp float u_" + r3 + "_t;\nattribute " + i3 + " " + a3 + " a_" + r3 + ";\nvarying " + i3 + " " + o3 + " " + r3 + ";\n#else\nuniform " + i3 + " " + o3 + " u_" + r3 + ";\n#endif\n" : n3 === "vec4" ? "\n#ifndef HAS_UNIFORM_u_" + r3 + "\n    " + r3 + " = a_" + r3 + ";\n#else\n    " + i3 + " " + o3 + " " + r3 + " = u_" + r3 + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + r3 + "\n    " + r3 + " = unpack_mix_" + n3 + "(a_" + r3 + ", u_" + r3 + "_t);\n#else\n    " + i3 + " " + o3 + " " + r3 + " = u_" + r3 + ";\n#endif\n" : e3 === "define" ? "\n#ifndef HAS_UNIFORM_u_" + r3 + "\nuniform lowp float u_" + r3 + "_t;\nattribute " + i3 + " " + a3 + " a_" + r3 + ";\n#else\nuniform " + i3 + " " + o3 + " u_" + r3 + ";\n#endif\n" : n3 === "vec4" ? "\n#ifndef HAS_UNIFORM_u_" + r3 + "\n    " + i3 + " " + o3 + " " + r3 + " = a_" + r3 + ";\n#else\n    " + i3 + " " + o3 + " " + r3 + " = u_" + r3 + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + r3 + "\n    " + i3 + " " + o3 + " " + r3 + " = unpack_mix_" + n3 + "(a_" + r3 + ", u_" + r3 + "_t);\n#else\n    " + i3 + " " + o3 + " " + r3 + " = u_" + r3 + ";\n#endif\n";
          }), staticAttributes: o2, staticUniforms: n2};
        }
        var vi = Object.freeze({__proto__: null, prelude: Ge, background: We, backgroundPattern: Xe, circle: He, clippingMask: Ke, heatmap: Ye, heatmapTexture: Je, collisionBox: Qe, collisionCircle: $e, debug: ti, fill: ei, fillOutline: ii, fillOutlinePattern: oi, fillPattern: ri, fillExtrusion: ai, fillExtrusionPattern: ni, hillshadePrepare: si, hillshade: li, line: ci, lineGradient: ui, linePattern: hi, lineSDF: pi, raster: di, symbolIcon: _i, symbolSDF: fi, symbolTextAndIcon: mi}), yi = function() {
          this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffer = null, this.vao = null;
        };
        function xi(t2) {
          for (var e2 = [], i2 = 0; i2 < t2.length; i2++)
            if (t2[i2] !== null) {
              var o2 = t2[i2].split(" ");
              e2.push(o2.pop());
            }
          return e2;
        }
        yi.prototype.bind = function(t2, e2, i2, o2, r2, a2, n2, s2) {
          this.context = t2;
          for (var l2 = this.boundPaintVertexBuffers.length !== o2.length, c2 = 0; !l2 && c2 < o2.length; c2++)
            this.boundPaintVertexBuffers[c2] !== o2[c2] && (l2 = true);
          t2.extVertexArrayObject && this.vao && this.boundProgram === e2 && this.boundLayoutVertexBuffer === i2 && !l2 && this.boundIndexBuffer === r2 && this.boundVertexOffset === a2 && this.boundDynamicVertexBuffer === n2 && this.boundDynamicVertexBuffer2 === s2 ? (t2.bindVertexArrayOES.set(this.vao), n2 && n2.bind(), r2 && r2.dynamicDraw && r2.bind(), s2 && s2.bind()) : this.freshBind(e2, i2, o2, r2, a2, n2, s2);
        }, yi.prototype.freshBind = function(t2, e2, i2, o2, r2, a2, n2) {
          var s2, l2 = t2.numAttributes, c2 = this.context, u2 = c2.gl;
          if (c2.extVertexArrayObject)
            this.vao && this.destroy(), this.vao = c2.extVertexArrayObject.createVertexArrayOES(), c2.bindVertexArrayOES.set(this.vao), s2 = 0, this.boundProgram = t2, this.boundLayoutVertexBuffer = e2, this.boundPaintVertexBuffers = i2, this.boundIndexBuffer = o2, this.boundVertexOffset = r2, this.boundDynamicVertexBuffer = a2, this.boundDynamicVertexBuffer2 = n2;
          else {
            s2 = c2.currentNumAttributes || 0;
            for (var h2 = l2; h2 < s2; h2++)
              u2.disableVertexAttribArray(h2);
          }
          e2.enableAttributes(u2, t2);
          for (var p2 = 0, d2 = i2; p2 < d2.length; p2 += 1)
            d2[p2].enableAttributes(u2, t2);
          a2 && a2.enableAttributes(u2, t2), n2 && n2.enableAttributes(u2, t2), e2.bind(), e2.setVertexAttribPointers(u2, t2, r2);
          for (var _2 = 0, f2 = i2; _2 < f2.length; _2 += 1) {
            var m2 = f2[_2];
            m2.bind(), m2.setVertexAttribPointers(u2, t2, r2);
          }
          a2 && (a2.bind(), a2.setVertexAttribPointers(u2, t2, r2)), o2 && o2.bind(), n2 && (n2.bind(), n2.setVertexAttribPointers(u2, t2, r2)), c2.currentNumAttributes = l2;
        }, yi.prototype.destroy = function() {
          this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null);
        };
        var bi = function(t2, e2, i2, o2, r2, a2) {
          var n2 = t2.gl;
          this.program = n2.createProgram();
          for (var s2 = xi(i2.staticAttributes), l2 = o2 ? o2.getBinderAttributes() : [], c2 = s2.concat(l2), u2 = i2.staticUniforms ? xi(i2.staticUniforms) : [], h2 = o2 ? o2.getBinderUniforms() : [], p2 = [], d2 = 0, _2 = u2.concat(h2); d2 < _2.length; d2 += 1) {
            var f2 = _2[d2];
            p2.indexOf(f2) < 0 && p2.push(f2);
          }
          var m2 = o2 ? o2.defines() : [];
          a2 && m2.push("#define OVERDRAW_INSPECTOR;");
          var g2 = m2.concat(Ge.fragmentSource, i2.fragmentSource).join("\n"), v2 = m2.concat(Ge.vertexSource, i2.vertexSource).join("\n"), y2 = n2.createShader(n2.FRAGMENT_SHADER);
          if (n2.isContextLost())
            this.failedToCreate = true;
          else {
            n2.shaderSource(y2, g2), n2.compileShader(y2), n2.attachShader(this.program, y2);
            var x2 = n2.createShader(n2.VERTEX_SHADER);
            if (n2.isContextLost())
              this.failedToCreate = true;
            else {
              n2.shaderSource(x2, v2), n2.compileShader(x2), n2.attachShader(this.program, x2), this.attributes = {};
              var b2 = {};
              this.numAttributes = c2.length;
              for (var w2 = 0; w2 < this.numAttributes; w2++)
                c2[w2] && (n2.bindAttribLocation(this.program, w2, c2[w2]), this.attributes[c2[w2]] = w2);
              n2.linkProgram(this.program), n2.deleteShader(x2), n2.deleteShader(y2);
              for (var T2 = 0; T2 < p2.length; T2++) {
                var E2 = p2[T2];
                if (E2 && !b2[E2]) {
                  var I2 = n2.getUniformLocation(this.program, E2);
                  I2 && (b2[E2] = I2);
                }
              }
              this.fixedUniforms = r2(t2, b2), this.binderUniforms = o2 ? o2.getUniforms(t2, b2) : [];
            }
          }
        };
        function wi(t2, e2, i2) {
          var o2 = 1 / pe(i2, 1, e2.transform.tileZoom), r2 = Math.pow(2, i2.tileID.overscaledZ), a2 = i2.tileSize * Math.pow(2, e2.transform.tileZoom) / r2, n2 = a2 * (i2.tileID.canonical.x + i2.tileID.wrap * r2), s2 = a2 * i2.tileID.canonical.y;
          return {u_image: 0, u_texsize: i2.imageAtlasTexture.size, u_scale: [o2, t2.fromScale, t2.toScale], u_fade: t2.t, u_pixel_coord_upper: [n2 >> 16, s2 >> 16], u_pixel_coord_lower: [65535 & n2, 65535 & s2]};
        }
        bi.prototype.draw = function(t2, e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2, p2, d2, _2, f2) {
          var m2, g2 = t2.gl;
          if (!this.failedToCreate) {
            for (var v2 in t2.program.set(this.program), t2.setDepthMode(i2), t2.setStencilMode(o2), t2.setColorMode(r2), t2.setCullFace(a2), this.fixedUniforms)
              this.fixedUniforms[v2].set(n2[v2]);
            d2 && d2.setUniforms(t2, this.binderUniforms, h2, {zoom: p2});
            for (var y2 = (m2 = {}, m2[g2.LINES] = 2, m2[g2.TRIANGLES] = 3, m2[g2.LINE_STRIP] = 1, m2)[e2], x2 = 0, b2 = u2.get(); x2 < b2.length; x2 += 1) {
              var w2 = b2[x2], T2 = w2.vaos || (w2.vaos = {});
              (T2[s2] || (T2[s2] = new yi())).bind(t2, this, l2, d2 ? d2.getPaintVertexBuffers() : [], c2, w2.vertexOffset, _2, f2), g2.drawElements(e2, w2.primitiveLength * y2, g2.UNSIGNED_SHORT, w2.primitiveOffset * y2 * 2);
            }
          }
        };
        var Ti = function(e2, i2, o2, r2) {
          var a2 = i2.style.light, n2 = a2.properties.get("position"), s2 = [n2.x, n2.y, n2.z], l2 = t.create$1();
          a2.properties.get("anchor") === "viewport" && t.fromRotation(l2, -i2.transform.angle), t.transformMat3(s2, s2, l2);
          var c2 = a2.properties.get("color");
          return {u_matrix: e2, u_lightpos: s2, u_lightintensity: a2.properties.get("intensity"), u_lightcolor: [c2.r, c2.g, c2.b], u_vertical_gradient: +o2, u_opacity: r2};
        }, Ei = function(e2, i2, o2, r2, a2, n2, s2) {
          return t.extend(Ti(e2, i2, o2, r2), wi(n2, i2, s2), {u_height_factor: -Math.pow(2, a2.overscaledZ) / s2.tileSize / 8});
        }, Ii = function(t2) {
          return {u_matrix: t2};
        }, Pi = function(e2, i2, o2, r2) {
          return t.extend(Ii(e2), wi(o2, i2, r2));
        }, Si = function(t2, e2) {
          return {u_matrix: t2, u_world: e2};
        }, Ci = function(e2, i2, o2, r2, a2) {
          return t.extend(Pi(e2, i2, o2, r2), {u_world: a2});
        }, zi = function(e2, i2, o2, r2) {
          var a2, n2, s2 = e2.transform;
          if (r2.paint.get("circle-pitch-alignment") === "map") {
            var l2 = pe(o2, 1, s2.zoom);
            a2 = true, n2 = [l2, l2];
          } else
            a2 = false, n2 = s2.pixelsToGLUnits;
          return {u_camera_to_center_distance: s2.cameraToCenterDistance, u_scale_with_map: +(r2.paint.get("circle-pitch-scale") === "map"), u_matrix: e2.translatePosMatrix(i2.posMatrix, o2, r2.paint.get("circle-translate"), r2.paint.get("circle-translate-anchor")), u_pitch_with_map: +a2, u_device_pixel_ratio: t.browser.devicePixelRatio, u_extrude_scale: n2};
        }, Di = function(t2, e2, i2) {
          var o2 = pe(i2, 1, e2.zoom), r2 = Math.pow(2, e2.zoom - i2.tileID.overscaledZ), a2 = i2.tileID.overscaleFactor();
          return {u_matrix: t2, u_camera_to_center_distance: e2.cameraToCenterDistance, u_pixels_to_tile_units: o2, u_extrude_scale: [e2.pixelsToGLUnits[0] / (o2 * r2), e2.pixelsToGLUnits[1] / (o2 * r2)], u_overscale_factor: a2};
        }, Ai = function(t2, e2, i2) {
          return {u_matrix: t2, u_inv_matrix: e2, u_camera_to_center_distance: i2.cameraToCenterDistance, u_viewport_size: [i2.width, i2.height]};
        }, Mi = function(t2, e2, i2) {
          return i2 === void 0 && (i2 = 1), {u_matrix: t2, u_color: e2, u_overlay: 0, u_overlay_scale: i2};
        }, Li = function(t2) {
          return {u_matrix: t2};
        }, Ri = function(t2, e2, i2, o2) {
          return {u_matrix: t2, u_extrude_scale: pe(e2, 1, i2), u_intensity: o2};
        }, ki = function(e2, i2, o2) {
          var r2 = e2.transform;
          return {u_matrix: Ni(e2, i2, o2), u_ratio: 1 / pe(i2, 1, r2.zoom), u_device_pixel_ratio: t.browser.devicePixelRatio, u_units_to_pixels: [1 / r2.pixelsToGLUnits[0], 1 / r2.pixelsToGLUnits[1]]};
        }, Bi = function(e2, i2, o2, r2) {
          return t.extend(ki(e2, i2, o2), {u_image: 0, u_image_height: r2});
        }, Oi = function(e2, i2, o2, r2) {
          var a2 = e2.transform, n2 = Ui(i2, a2);
          return {u_matrix: Ni(e2, i2, o2), u_texsize: i2.imageAtlasTexture.size, u_ratio: 1 / pe(i2, 1, a2.zoom), u_device_pixel_ratio: t.browser.devicePixelRatio, u_image: 0, u_scale: [n2, r2.fromScale, r2.toScale], u_fade: r2.t, u_units_to_pixels: [1 / a2.pixelsToGLUnits[0], 1 / a2.pixelsToGLUnits[1]]};
        }, Fi = function(e2, i2, o2, r2, a2) {
          var n2 = e2.lineAtlas, s2 = Ui(i2, e2.transform), l2 = o2.layout.get("line-cap") === "round", c2 = n2.getDash(r2.from, l2), u2 = n2.getDash(r2.to, l2), h2 = c2.width * a2.fromScale, p2 = u2.width * a2.toScale;
          return t.extend(ki(e2, i2, o2), {u_patternscale_a: [s2 / h2, -c2.height / 2], u_patternscale_b: [s2 / p2, -u2.height / 2], u_sdfgamma: n2.width / (256 * Math.min(h2, p2) * t.browser.devicePixelRatio) / 2, u_image: 0, u_tex_y_a: c2.y, u_tex_y_b: u2.y, u_mix: a2.t});
        };
        function Ui(t2, e2) {
          return 1 / pe(t2, 1, e2.tileZoom);
        }
        function Ni(t2, e2, i2) {
          return t2.translatePosMatrix(e2.tileID.posMatrix, e2, i2.paint.get("line-translate"), i2.paint.get("line-translate-anchor"));
        }
        var Zi = function(t2, e2, i2, o2, r2) {
          return {u_matrix: t2, u_tl_parent: e2, u_scale_parent: i2, u_buffer_scale: 1, u_fade_t: o2.mix, u_opacity: o2.opacity * r2.paint.get("raster-opacity"), u_image0: 0, u_image1: 1, u_brightness_low: r2.paint.get("raster-brightness-min"), u_brightness_high: r2.paint.get("raster-brightness-max"), u_saturation_factor: (n2 = r2.paint.get("raster-saturation"), n2 > 0 ? 1 - 1 / (1.001 - n2) : -n2), u_contrast_factor: (a2 = r2.paint.get("raster-contrast"), a2 > 0 ? 1 / (1 - a2) : 1 + a2), u_spin_weights: qi(r2.paint.get("raster-hue-rotate"))};
          var a2, n2;
        };
        function qi(t2) {
          t2 *= Math.PI / 180;
          var e2 = Math.sin(t2), i2 = Math.cos(t2);
          return [(2 * i2 + 1) / 3, (-Math.sqrt(3) * e2 - i2 + 1) / 3, (Math.sqrt(3) * e2 - i2 + 1) / 3];
        }
        var ji, Vi = function(t2, e2, i2, o2, r2, a2, n2, s2, l2, c2) {
          var u2 = r2.transform;
          return {u_is_size_zoom_constant: +(t2 === "constant" || t2 === "source"), u_is_size_feature_constant: +(t2 === "constant" || t2 === "camera"), u_size_t: e2 ? e2.uSizeT : 0, u_size: e2 ? e2.uSize : 0, u_camera_to_center_distance: u2.cameraToCenterDistance, u_pitch: u2.pitch / 360 * 2 * Math.PI, u_rotate_symbol: +i2, u_aspect_ratio: u2.width / u2.height, u_fade_change: r2.options.fadeDuration ? r2.symbolFadeChange : 1, u_matrix: a2, u_label_plane_matrix: n2, u_coord_matrix: s2, u_is_text: +l2, u_pitch_with_map: +o2, u_texsize: c2, u_texture: 0};
        }, Gi = function(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2) {
          var p2 = a2.transform;
          return t.extend(Vi(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2), {u_gamma_scale: r2 ? Math.cos(p2._pitch) * p2.cameraToCenterDistance : 1, u_device_pixel_ratio: t.browser.devicePixelRatio, u_is_halo: +h2});
        }, Wi = function(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2) {
          return t.extend(Gi(e2, i2, o2, r2, a2, n2, s2, l2, true, c2, true), {u_texsize_icon: u2, u_texture_icon: 1});
        }, Xi = function(t2, e2, i2) {
          return {u_matrix: t2, u_opacity: e2, u_color: i2};
        }, Hi = function(e2, i2, o2, r2, a2, n2) {
          return t.extend(function(t2, e3, i3, o3) {
            var r3 = i3.imageManager.getPattern(t2.from.toString()), a3 = i3.imageManager.getPattern(t2.to.toString()), n3 = i3.imageManager.getPixelSize(), s2 = n3.width, l2 = n3.height, c2 = Math.pow(2, o3.tileID.overscaledZ), u2 = o3.tileSize * Math.pow(2, i3.transform.tileZoom) / c2, h2 = u2 * (o3.tileID.canonical.x + o3.tileID.wrap * c2), p2 = u2 * o3.tileID.canonical.y;
            return {u_image: 0, u_pattern_tl_a: r3.tl, u_pattern_br_a: r3.br, u_pattern_tl_b: a3.tl, u_pattern_br_b: a3.br, u_texsize: [s2, l2], u_mix: e3.t, u_pattern_size_a: r3.displaySize, u_pattern_size_b: a3.displaySize, u_scale_a: e3.fromScale, u_scale_b: e3.toScale, u_tile_units_to_pixels: 1 / pe(o3, 1, i3.transform.tileZoom), u_pixel_coord_upper: [h2 >> 16, p2 >> 16], u_pixel_coord_lower: [65535 & h2, 65535 & p2]};
          }(r2, n2, o2, a2), {u_matrix: e2, u_opacity: i2});
        }, Ki = {fillExtrusion: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_lightpos: new t.Uniform3f(e2, i2.u_lightpos), u_lightintensity: new t.Uniform1f(e2, i2.u_lightintensity), u_lightcolor: new t.Uniform3f(e2, i2.u_lightcolor), u_vertical_gradient: new t.Uniform1f(e2, i2.u_vertical_gradient), u_opacity: new t.Uniform1f(e2, i2.u_opacity)};
        }, fillExtrusionPattern: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_lightpos: new t.Uniform3f(e2, i2.u_lightpos), u_lightintensity: new t.Uniform1f(e2, i2.u_lightintensity), u_lightcolor: new t.Uniform3f(e2, i2.u_lightcolor), u_vertical_gradient: new t.Uniform1f(e2, i2.u_vertical_gradient), u_height_factor: new t.Uniform1f(e2, i2.u_height_factor), u_image: new t.Uniform1i(e2, i2.u_image), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade), u_opacity: new t.Uniform1f(e2, i2.u_opacity)};
        }, fill: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix)};
        }, fillPattern: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_image: new t.Uniform1i(e2, i2.u_image), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade)};
        }, fillOutline: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_world: new t.Uniform2f(e2, i2.u_world)};
        }, fillOutlinePattern: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_world: new t.Uniform2f(e2, i2.u_world), u_image: new t.Uniform1i(e2, i2.u_image), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade)};
        }, circle: function(e2, i2) {
          return {u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_scale_with_map: new t.Uniform1i(e2, i2.u_scale_with_map), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_extrude_scale: new t.Uniform2f(e2, i2.u_extrude_scale), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix)};
        }, collisionBox: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pixels_to_tile_units: new t.Uniform1f(e2, i2.u_pixels_to_tile_units), u_extrude_scale: new t.Uniform2f(e2, i2.u_extrude_scale), u_overscale_factor: new t.Uniform1f(e2, i2.u_overscale_factor)};
        }, collisionCircle: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_inv_matrix: new t.UniformMatrix4f(e2, i2.u_inv_matrix), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_viewport_size: new t.Uniform2f(e2, i2.u_viewport_size)};
        }, debug: function(e2, i2) {
          return {u_color: new t.UniformColor(e2, i2.u_color), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_overlay: new t.Uniform1i(e2, i2.u_overlay), u_overlay_scale: new t.Uniform1f(e2, i2.u_overlay_scale)};
        }, clippingMask: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix)};
        }, heatmap: function(e2, i2) {
          return {u_extrude_scale: new t.Uniform1f(e2, i2.u_extrude_scale), u_intensity: new t.Uniform1f(e2, i2.u_intensity), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix)};
        }, heatmapTexture: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_world: new t.Uniform2f(e2, i2.u_world), u_image: new t.Uniform1i(e2, i2.u_image), u_color_ramp: new t.Uniform1i(e2, i2.u_color_ramp), u_opacity: new t.Uniform1f(e2, i2.u_opacity)};
        }, hillshade: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_image: new t.Uniform1i(e2, i2.u_image), u_latrange: new t.Uniform2f(e2, i2.u_latrange), u_light: new t.Uniform2f(e2, i2.u_light), u_shadow: new t.UniformColor(e2, i2.u_shadow), u_highlight: new t.UniformColor(e2, i2.u_highlight), u_accent: new t.UniformColor(e2, i2.u_accent)};
        }, hillshadePrepare: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_image: new t.Uniform1i(e2, i2.u_image), u_dimension: new t.Uniform2f(e2, i2.u_dimension), u_zoom: new t.Uniform1f(e2, i2.u_zoom), u_unpack: new t.Uniform4f(e2, i2.u_unpack)};
        }, line: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels)};
        }, lineGradient: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels), u_image: new t.Uniform1i(e2, i2.u_image), u_image_height: new t.Uniform1f(e2, i2.u_image_height)};
        }, linePattern: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_image: new t.Uniform1i(e2, i2.u_image), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels), u_scale: new t.Uniform3f(e2, i2.u_scale), u_fade: new t.Uniform1f(e2, i2.u_fade)};
        }, lineSDF: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_ratio: new t.Uniform1f(e2, i2.u_ratio), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_units_to_pixels: new t.Uniform2f(e2, i2.u_units_to_pixels), u_patternscale_a: new t.Uniform2f(e2, i2.u_patternscale_a), u_patternscale_b: new t.Uniform2f(e2, i2.u_patternscale_b), u_sdfgamma: new t.Uniform1f(e2, i2.u_sdfgamma), u_image: new t.Uniform1i(e2, i2.u_image), u_tex_y_a: new t.Uniform1f(e2, i2.u_tex_y_a), u_tex_y_b: new t.Uniform1f(e2, i2.u_tex_y_b), u_mix: new t.Uniform1f(e2, i2.u_mix)};
        }, raster: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_tl_parent: new t.Uniform2f(e2, i2.u_tl_parent), u_scale_parent: new t.Uniform1f(e2, i2.u_scale_parent), u_buffer_scale: new t.Uniform1f(e2, i2.u_buffer_scale), u_fade_t: new t.Uniform1f(e2, i2.u_fade_t), u_opacity: new t.Uniform1f(e2, i2.u_opacity), u_image0: new t.Uniform1i(e2, i2.u_image0), u_image1: new t.Uniform1i(e2, i2.u_image1), u_brightness_low: new t.Uniform1f(e2, i2.u_brightness_low), u_brightness_high: new t.Uniform1f(e2, i2.u_brightness_high), u_saturation_factor: new t.Uniform1f(e2, i2.u_saturation_factor), u_contrast_factor: new t.Uniform1f(e2, i2.u_contrast_factor), u_spin_weights: new t.Uniform3f(e2, i2.u_spin_weights)};
        }, symbolIcon: function(e2, i2) {
          return {u_is_size_zoom_constant: new t.Uniform1i(e2, i2.u_is_size_zoom_constant), u_is_size_feature_constant: new t.Uniform1i(e2, i2.u_is_size_feature_constant), u_size_t: new t.Uniform1f(e2, i2.u_size_t), u_size: new t.Uniform1f(e2, i2.u_size), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pitch: new t.Uniform1f(e2, i2.u_pitch), u_rotate_symbol: new t.Uniform1i(e2, i2.u_rotate_symbol), u_aspect_ratio: new t.Uniform1f(e2, i2.u_aspect_ratio), u_fade_change: new t.Uniform1f(e2, i2.u_fade_change), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_label_plane_matrix: new t.UniformMatrix4f(e2, i2.u_label_plane_matrix), u_coord_matrix: new t.UniformMatrix4f(e2, i2.u_coord_matrix), u_is_text: new t.Uniform1i(e2, i2.u_is_text), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_texture: new t.Uniform1i(e2, i2.u_texture)};
        }, symbolSDF: function(e2, i2) {
          return {u_is_size_zoom_constant: new t.Uniform1i(e2, i2.u_is_size_zoom_constant), u_is_size_feature_constant: new t.Uniform1i(e2, i2.u_is_size_feature_constant), u_size_t: new t.Uniform1f(e2, i2.u_size_t), u_size: new t.Uniform1f(e2, i2.u_size), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pitch: new t.Uniform1f(e2, i2.u_pitch), u_rotate_symbol: new t.Uniform1i(e2, i2.u_rotate_symbol), u_aspect_ratio: new t.Uniform1f(e2, i2.u_aspect_ratio), u_fade_change: new t.Uniform1f(e2, i2.u_fade_change), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_label_plane_matrix: new t.UniformMatrix4f(e2, i2.u_label_plane_matrix), u_coord_matrix: new t.UniformMatrix4f(e2, i2.u_coord_matrix), u_is_text: new t.Uniform1i(e2, i2.u_is_text), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_texture: new t.Uniform1i(e2, i2.u_texture), u_gamma_scale: new t.Uniform1f(e2, i2.u_gamma_scale), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_is_halo: new t.Uniform1i(e2, i2.u_is_halo)};
        }, symbolTextAndIcon: function(e2, i2) {
          return {u_is_size_zoom_constant: new t.Uniform1i(e2, i2.u_is_size_zoom_constant), u_is_size_feature_constant: new t.Uniform1i(e2, i2.u_is_size_feature_constant), u_size_t: new t.Uniform1f(e2, i2.u_size_t), u_size: new t.Uniform1f(e2, i2.u_size), u_camera_to_center_distance: new t.Uniform1f(e2, i2.u_camera_to_center_distance), u_pitch: new t.Uniform1f(e2, i2.u_pitch), u_rotate_symbol: new t.Uniform1i(e2, i2.u_rotate_symbol), u_aspect_ratio: new t.Uniform1f(e2, i2.u_aspect_ratio), u_fade_change: new t.Uniform1f(e2, i2.u_fade_change), u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_label_plane_matrix: new t.UniformMatrix4f(e2, i2.u_label_plane_matrix), u_coord_matrix: new t.UniformMatrix4f(e2, i2.u_coord_matrix), u_is_text: new t.Uniform1i(e2, i2.u_is_text), u_pitch_with_map: new t.Uniform1i(e2, i2.u_pitch_with_map), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_texsize_icon: new t.Uniform2f(e2, i2.u_texsize_icon), u_texture: new t.Uniform1i(e2, i2.u_texture), u_texture_icon: new t.Uniform1i(e2, i2.u_texture_icon), u_gamma_scale: new t.Uniform1f(e2, i2.u_gamma_scale), u_device_pixel_ratio: new t.Uniform1f(e2, i2.u_device_pixel_ratio), u_is_halo: new t.Uniform1i(e2, i2.u_is_halo)};
        }, background: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_opacity: new t.Uniform1f(e2, i2.u_opacity), u_color: new t.UniformColor(e2, i2.u_color)};
        }, backgroundPattern: function(e2, i2) {
          return {u_matrix: new t.UniformMatrix4f(e2, i2.u_matrix), u_opacity: new t.Uniform1f(e2, i2.u_opacity), u_image: new t.Uniform1i(e2, i2.u_image), u_pattern_tl_a: new t.Uniform2f(e2, i2.u_pattern_tl_a), u_pattern_br_a: new t.Uniform2f(e2, i2.u_pattern_br_a), u_pattern_tl_b: new t.Uniform2f(e2, i2.u_pattern_tl_b), u_pattern_br_b: new t.Uniform2f(e2, i2.u_pattern_br_b), u_texsize: new t.Uniform2f(e2, i2.u_texsize), u_mix: new t.Uniform1f(e2, i2.u_mix), u_pattern_size_a: new t.Uniform2f(e2, i2.u_pattern_size_a), u_pattern_size_b: new t.Uniform2f(e2, i2.u_pattern_size_b), u_scale_a: new t.Uniform1f(e2, i2.u_scale_a), u_scale_b: new t.Uniform1f(e2, i2.u_scale_b), u_pixel_coord_upper: new t.Uniform2f(e2, i2.u_pixel_coord_upper), u_pixel_coord_lower: new t.Uniform2f(e2, i2.u_pixel_coord_lower), u_tile_units_to_pixels: new t.Uniform1f(e2, i2.u_tile_units_to_pixels)};
        }};
        function Yi(e2, i2, o2, r2, a2, n2, s2) {
          for (var l2 = e2.context, c2 = l2.gl, u2 = e2.useProgram("collisionBox"), h2 = [], p2 = 0, d2 = 0, _2 = 0; _2 < r2.length; _2++) {
            var f2 = r2[_2], m2 = i2.getTile(f2), g2 = m2.getBucket(o2);
            if (g2) {
              var v2 = f2.posMatrix;
              a2[0] === 0 && a2[1] === 0 || (v2 = e2.translatePosMatrix(f2.posMatrix, m2, a2, n2));
              var y2 = s2 ? g2.textCollisionBox : g2.iconCollisionBox, x2 = g2.collisionCircleArray;
              if (x2.length > 0) {
                var b2 = t.create(), w2 = v2;
                t.mul(b2, g2.placementInvProjMatrix, e2.transform.glCoordMatrix), t.mul(b2, b2, g2.placementViewportMatrix), h2.push({circleArray: x2, circleOffset: d2, transform: w2, invTransform: b2}), d2 = p2 += x2.length / 4;
              }
              y2 && u2.draw(l2, c2.LINES, It.disabled, Pt.disabled, e2.colorModeForRenderPass(), Ct.disabled, Di(v2, e2.transform, m2), o2.id, y2.layoutVertexBuffer, y2.indexBuffer, y2.segments, null, e2.transform.zoom, null, null, y2.collisionVertexBuffer);
            }
          }
          if (s2 && h2.length) {
            var T2 = e2.useProgram("collisionCircle"), E2 = new t.StructArrayLayout2f1f2i16();
            E2.resize(4 * p2), E2._trim();
            for (var I2 = 0, P2 = 0, S2 = h2; P2 < S2.length; P2 += 1)
              for (var C2 = S2[P2], z2 = 0; z2 < C2.circleArray.length / 4; z2++) {
                var D2 = 4 * z2, A2 = C2.circleArray[D2 + 0], M2 = C2.circleArray[D2 + 1], L2 = C2.circleArray[D2 + 2], R2 = C2.circleArray[D2 + 3];
                E2.emplace(I2++, A2, M2, L2, R2, 0), E2.emplace(I2++, A2, M2, L2, R2, 1), E2.emplace(I2++, A2, M2, L2, R2, 2), E2.emplace(I2++, A2, M2, L2, R2, 3);
              }
            (!ji || ji.length < 2 * p2) && (ji = function(e3) {
              var i3 = 2 * e3, o3 = new t.StructArrayLayout3ui6();
              o3.resize(i3), o3._trim();
              for (var r3 = 0; r3 < i3; r3++) {
                var a3 = 6 * r3;
                o3.uint16[a3 + 0] = 4 * r3 + 0, o3.uint16[a3 + 1] = 4 * r3 + 1, o3.uint16[a3 + 2] = 4 * r3 + 2, o3.uint16[a3 + 3] = 4 * r3 + 2, o3.uint16[a3 + 4] = 4 * r3 + 3, o3.uint16[a3 + 5] = 4 * r3 + 0;
              }
              return o3;
            }(p2));
            for (var k2 = l2.createIndexBuffer(ji, true), B2 = l2.createVertexBuffer(E2, t.collisionCircleLayout.members, true), O2 = 0, F2 = h2; O2 < F2.length; O2 += 1) {
              var U2 = F2[O2], N2 = Ai(U2.transform, U2.invTransform, e2.transform);
              T2.draw(l2, c2.TRIANGLES, It.disabled, Pt.disabled, e2.colorModeForRenderPass(), Ct.disabled, N2, o2.id, B2, k2, t.SegmentVector.simpleSegment(0, 2 * U2.circleOffset, U2.circleArray.length, U2.circleArray.length / 2), null, e2.transform.zoom, null, null, null);
            }
            B2.destroy(), k2.destroy();
          }
        }
        var Ji = t.identity(new Float32Array(16));
        function Qi(e2, i2, o2, r2, a2, n2) {
          var s2 = t.getAnchorAlignment(e2), l2 = -(s2.horizontalAlign - 0.5) * i2, c2 = -(s2.verticalAlign - 0.5) * o2, u2 = t.evaluateVariableOffset(e2, r2);
          return new t.Point((l2 / a2 + u2[0]) * n2, (c2 / a2 + u2[1]) * n2);
        }
        function $i(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2) {
          var p2 = e2.text.placedSymbolArray, d2 = e2.text.dynamicLayoutVertexArray, _2 = e2.icon.dynamicLayoutVertexArray, f2 = {};
          d2.clear();
          for (var m2 = 0; m2 < p2.length; m2++) {
            var g2 = p2.get(m2), v2 = g2.hidden || !g2.crossTileID || e2.allowVerticalPlacement && !g2.placedOrientation ? null : r2[g2.crossTileID];
            if (v2) {
              var y2 = new t.Point(g2.anchorX, g2.anchorY), x2 = $t(y2, o2 ? l2 : s2), b2 = te(n2.cameraToCenterDistance, x2.signedDistanceFromCamera), w2 = a2.evaluateSizeForFeature(e2.textSizeData, u2, g2) * b2 / t.ONE_EM;
              o2 && (w2 *= e2.tilePixelRatio / c2);
              for (var T2 = Qi(v2.anchor, v2.width, v2.height, v2.textOffset, v2.textBoxScale, w2), E2 = o2 ? $t(y2.add(T2), s2).point : x2.point.add(i2 ? T2.rotate(-n2.angle) : T2), I2 = e2.allowVerticalPlacement && g2.placedOrientation === t.WritingMode.vertical ? Math.PI / 2 : 0, P2 = 0; P2 < g2.numGlyphs; P2++)
                t.addDynamicAttributes(d2, E2, I2);
              h2 && g2.associatedIconIndex >= 0 && (f2[g2.associatedIconIndex] = {shiftedAnchor: E2, angle: I2});
            } else
              ce(g2.numGlyphs, d2);
          }
          if (h2) {
            _2.clear();
            for (var S2 = e2.icon.placedSymbolArray, C2 = 0; C2 < S2.length; C2++) {
              var z2 = S2.get(C2);
              if (z2.hidden)
                ce(z2.numGlyphs, _2);
              else {
                var D2 = f2[C2];
                if (D2)
                  for (var A2 = 0; A2 < z2.numGlyphs; A2++)
                    t.addDynamicAttributes(_2, D2.shiftedAnchor, D2.angle);
                else
                  ce(z2.numGlyphs, _2);
              }
            }
            e2.icon.dynamicLayoutVertexBuffer.updateData(_2);
          }
          e2.text.dynamicLayoutVertexBuffer.updateData(d2);
        }
        function to(t2, e2, i2) {
          return i2.iconsInText && e2 ? "symbolTextAndIcon" : t2 ? "symbolSDF" : "symbolIcon";
        }
        function eo(e2, i2, o2, r2, a2, n2, s2, l2, c2, u2, h2, p2) {
          for (var d2 = e2.context, _2 = d2.gl, f2 = e2.transform, m2 = l2 === "map", g2 = c2 === "map", v2 = m2 && o2.layout.get("symbol-placement") !== "point", y2 = m2 && !g2 && !v2, x2 = o2.layout.get("symbol-sort-key").constantOr(1) !== void 0, b2 = false, w2 = e2.depthModeForSublayer(0, It.ReadOnly), T2 = o2.layout.get("text-variable-anchor"), E2 = [], I2 = 0, P2 = r2; I2 < P2.length; I2 += 1) {
            var S2 = P2[I2], C2 = i2.getTile(S2), z2 = C2.getBucket(o2);
            if (z2) {
              var D2 = a2 ? z2.text : z2.icon;
              if (D2 && D2.segments.get().length) {
                var A2 = D2.programConfigurations.get(o2.id), M2 = a2 || z2.sdfIcons, L2 = a2 ? z2.textSizeData : z2.iconSizeData, R2 = g2 || f2.pitch !== 0, k2 = e2.useProgram(to(M2, a2, z2), A2), B2 = t.evaluateSizeForZoom(L2, f2.zoom), O2 = void 0, F2 = [0, 0], U2 = void 0, N2 = void 0, Z2 = null, q2 = void 0;
                if (a2)
                  U2 = C2.glyphAtlasTexture, N2 = _2.LINEAR, O2 = C2.glyphAtlasTexture.size, z2.iconsInText && (F2 = C2.imageAtlasTexture.size, Z2 = C2.imageAtlasTexture, q2 = R2 || e2.options.rotating || e2.options.zooming || L2.kind === "composite" || L2.kind === "camera" ? _2.LINEAR : _2.NEAREST);
                else {
                  var j2 = o2.layout.get("icon-size").constantOr(0) !== 1 || z2.iconsNeedLinear;
                  U2 = C2.imageAtlasTexture, N2 = M2 || e2.options.rotating || e2.options.zooming || j2 || R2 ? _2.LINEAR : _2.NEAREST, O2 = C2.imageAtlasTexture.size;
                }
                var V2 = pe(C2, 1, e2.transform.zoom), G2 = Jt(S2.posMatrix, g2, m2, e2.transform, V2), W2 = Qt(S2.posMatrix, g2, m2, e2.transform, V2), X2 = T2 && z2.hasTextData(), H2 = o2.layout.get("icon-text-fit") !== "none" && X2 && z2.hasIconData();
                v2 && ie(z2, S2.posMatrix, e2, a2, G2, W2, g2, u2);
                var K2 = e2.translatePosMatrix(S2.posMatrix, C2, n2, s2), Y2 = v2 || a2 && T2 || H2 ? Ji : G2, J2 = e2.translatePosMatrix(W2, C2, n2, s2, true), Q2 = M2 && o2.paint.get(a2 ? "text-halo-width" : "icon-halo-width").constantOr(1) !== 0, $2 = {program: k2, buffers: D2, uniformValues: M2 ? z2.iconsInText ? Wi(L2.kind, B2, y2, g2, e2, K2, Y2, J2, O2, F2) : Gi(L2.kind, B2, y2, g2, e2, K2, Y2, J2, a2, O2, true) : Vi(L2.kind, B2, y2, g2, e2, K2, Y2, J2, a2, O2), atlasTexture: U2, atlasTextureIcon: Z2, atlasInterpolation: N2, atlasInterpolationIcon: q2, isSDF: M2, hasHalo: Q2};
                if (x2 && z2.canOverlap) {
                  b2 = true;
                  for (var tt2 = 0, et2 = D2.segments.get(); tt2 < et2.length; tt2 += 1) {
                    var it2 = et2[tt2];
                    E2.push({segments: new t.SegmentVector([it2]), sortKey: it2.sortKey, state: $2});
                  }
                } else
                  E2.push({segments: D2.segments, sortKey: 0, state: $2});
              }
            }
          }
          b2 && E2.sort(function(t2, e3) {
            return t2.sortKey - e3.sortKey;
          });
          for (var ot2 = 0, rt2 = E2; ot2 < rt2.length; ot2 += 1) {
            var at2 = rt2[ot2], nt2 = at2.state;
            if (d2.activeTexture.set(_2.TEXTURE0), nt2.atlasTexture.bind(nt2.atlasInterpolation, _2.CLAMP_TO_EDGE), nt2.atlasTextureIcon && (d2.activeTexture.set(_2.TEXTURE1), nt2.atlasTextureIcon && nt2.atlasTextureIcon.bind(nt2.atlasInterpolationIcon, _2.CLAMP_TO_EDGE)), nt2.isSDF) {
              var st2 = nt2.uniformValues;
              nt2.hasHalo && (st2.u_is_halo = 1, io(nt2.buffers, at2.segments, o2, e2, nt2.program, w2, h2, p2, st2)), st2.u_is_halo = 0;
            }
            io(nt2.buffers, at2.segments, o2, e2, nt2.program, w2, h2, p2, nt2.uniformValues);
          }
        }
        function io(t2, e2, i2, o2, r2, a2, n2, s2, l2) {
          var c2 = o2.context;
          r2.draw(c2, c2.gl.TRIANGLES, a2, n2, s2, Ct.disabled, l2, i2.id, t2.layoutVertexBuffer, t2.indexBuffer, e2, i2.paint, o2.transform.zoom, t2.programConfigurations.get(i2.id), t2.dynamicLayoutVertexBuffer, t2.opacityVertexBuffer);
        }
        function oo(t2, e2, i2, o2, r2, a2, n2) {
          var s2, l2, c2, u2, h2, p2 = t2.context.gl, d2 = i2.paint.get("fill-pattern"), _2 = d2 && d2.constantOr(1), f2 = i2.getCrossfadeParameters();
          n2 ? (l2 = _2 && !i2.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline", s2 = p2.LINES) : (l2 = _2 ? "fillPattern" : "fill", s2 = p2.TRIANGLES);
          for (var m2 = 0, g2 = o2; m2 < g2.length; m2 += 1) {
            var v2 = g2[m2], y2 = e2.getTile(v2);
            if (!_2 || y2.patternsLoaded()) {
              var x2 = y2.getBucket(i2);
              if (x2) {
                var b2 = x2.programConfigurations.get(i2.id), w2 = t2.useProgram(l2, b2);
                _2 && (t2.context.activeTexture.set(p2.TEXTURE0), y2.imageAtlasTexture.bind(p2.LINEAR, p2.CLAMP_TO_EDGE), b2.updatePaintBuffers(f2));
                var T2 = d2.constantOr(null);
                if (T2 && y2.imageAtlas) {
                  var E2 = y2.imageAtlas, I2 = E2.patternPositions[T2.to.toString()], P2 = E2.patternPositions[T2.from.toString()];
                  I2 && P2 && b2.setConstantPatternPositions(I2, P2);
                }
                var S2 = t2.translatePosMatrix(v2.posMatrix, y2, i2.paint.get("fill-translate"), i2.paint.get("fill-translate-anchor"));
                if (n2) {
                  u2 = x2.indexBuffer2, h2 = x2.segments2;
                  var C2 = [p2.drawingBufferWidth, p2.drawingBufferHeight];
                  c2 = l2 === "fillOutlinePattern" && _2 ? Ci(S2, t2, f2, y2, C2) : Si(S2, C2);
                } else
                  u2 = x2.indexBuffer, h2 = x2.segments, c2 = _2 ? Pi(S2, t2, f2, y2) : Ii(S2);
                w2.draw(t2.context, s2, r2, t2.stencilModeForClipping(v2), a2, Ct.disabled, c2, i2.id, x2.layoutVertexBuffer, u2, h2, i2.paint, t2.transform.zoom, b2);
              }
            }
          }
        }
        function ro(t2, e2, i2, o2, r2, a2, n2) {
          for (var s2 = t2.context, l2 = s2.gl, c2 = i2.paint.get("fill-extrusion-pattern"), u2 = c2.constantOr(1), h2 = i2.getCrossfadeParameters(), p2 = i2.paint.get("fill-extrusion-opacity"), d2 = 0, _2 = o2; d2 < _2.length; d2 += 1) {
            var f2 = _2[d2], m2 = e2.getTile(f2), g2 = m2.getBucket(i2);
            if (g2) {
              var v2 = g2.programConfigurations.get(i2.id), y2 = t2.useProgram(u2 ? "fillExtrusionPattern" : "fillExtrusion", v2);
              u2 && (t2.context.activeTexture.set(l2.TEXTURE0), m2.imageAtlasTexture.bind(l2.LINEAR, l2.CLAMP_TO_EDGE), v2.updatePaintBuffers(h2));
              var x2 = c2.constantOr(null);
              if (x2 && m2.imageAtlas) {
                var b2 = m2.imageAtlas, w2 = b2.patternPositions[x2.to.toString()], T2 = b2.patternPositions[x2.from.toString()];
                w2 && T2 && v2.setConstantPatternPositions(w2, T2);
              }
              var E2 = t2.translatePosMatrix(f2.posMatrix, m2, i2.paint.get("fill-extrusion-translate"), i2.paint.get("fill-extrusion-translate-anchor")), I2 = i2.paint.get("fill-extrusion-vertical-gradient"), P2 = u2 ? Ei(E2, t2, I2, p2, f2, h2, m2) : Ti(E2, t2, I2, p2);
              y2.draw(s2, s2.gl.TRIANGLES, r2, a2, n2, Ct.backCCW, P2, i2.id, g2.layoutVertexBuffer, g2.indexBuffer, g2.segments, i2.paint, t2.transform.zoom, v2);
            }
          }
        }
        function ao(e2, i2, o2, r2, a2, n2) {
          var s2 = e2.context, l2 = s2.gl, c2 = i2.fbo;
          if (c2) {
            var u2 = e2.useProgram("hillshade");
            s2.activeTexture.set(l2.TEXTURE0), l2.bindTexture(l2.TEXTURE_2D, c2.colorAttachment.get());
            var h2 = function(e3, i3, o3) {
              var r3 = o3.paint.get("hillshade-shadow-color"), a3 = o3.paint.get("hillshade-highlight-color"), n3 = o3.paint.get("hillshade-accent-color"), s3 = o3.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
              o3.paint.get("hillshade-illumination-anchor") === "viewport" && (s3 -= e3.transform.angle);
              var l3, c3, u3, h3 = !e3.options.moving;
              return {u_matrix: e3.transform.calculatePosMatrix(i3.tileID.toUnwrapped(), h3), u_image: 0, u_latrange: (l3 = i3.tileID, c3 = Math.pow(2, l3.canonical.z), u3 = l3.canonical.y, [new t.MercatorCoordinate(0, u3 / c3).toLngLat().lat, new t.MercatorCoordinate(0, (u3 + 1) / c3).toLngLat().lat]), u_light: [o3.paint.get("hillshade-exaggeration"), s3], u_shadow: r3, u_highlight: a3, u_accent: n3};
            }(e2, i2, o2);
            u2.draw(s2, l2.TRIANGLES, r2, a2, n2, Ct.disabled, h2, o2.id, e2.rasterBoundsBuffer, e2.quadTriangleIndexBuffer, e2.rasterBoundsSegments);
          }
        }
        function no(e2, i2, o2, r2, a2, n2) {
          var s2 = e2.context, l2 = s2.gl, c2 = i2.dem;
          if (c2 && c2.data) {
            var u2 = c2.dim, h2 = c2.stride, p2 = c2.getPixels();
            if (s2.activeTexture.set(l2.TEXTURE1), s2.pixelStoreUnpackPremultiplyAlpha.set(false), i2.demTexture = i2.demTexture || e2.getTileTexture(h2), i2.demTexture) {
              var d2 = i2.demTexture;
              d2.update(p2, {premultiply: false}), d2.bind(l2.NEAREST, l2.CLAMP_TO_EDGE);
            } else
              i2.demTexture = new t.Texture(s2, p2, l2.RGBA, {premultiply: false}), i2.demTexture.bind(l2.NEAREST, l2.CLAMP_TO_EDGE);
            s2.activeTexture.set(l2.TEXTURE0);
            var _2 = i2.fbo;
            if (!_2) {
              var f2 = new t.Texture(s2, {width: u2, height: u2, data: null}, l2.RGBA);
              f2.bind(l2.LINEAR, l2.CLAMP_TO_EDGE), (_2 = i2.fbo = s2.createFramebuffer(u2, u2, true)).colorAttachment.set(f2.texture);
            }
            s2.bindFramebuffer.set(_2.framebuffer), s2.viewport.set([0, 0, u2, u2]), e2.useProgram("hillshadePrepare").draw(s2, l2.TRIANGLES, r2, a2, n2, Ct.disabled, function(e3, i3) {
              var o3 = i3.stride, r3 = t.create();
              return t.ortho(r3, 0, t.EXTENT, -t.EXTENT, 0, 0, 1), t.translate(r3, r3, [0, -t.EXTENT, 0]), {u_matrix: r3, u_image: 1, u_dimension: [o3, o3], u_zoom: e3.overscaledZ, u_unpack: i3.getUnpackVector()};
            }(i2.tileID, c2), o2.id, e2.rasterBoundsBuffer, e2.quadTriangleIndexBuffer, e2.rasterBoundsSegments), i2.needsHillshadePrepare = false;
          }
        }
        function so(e2, i2, o2, r2, a2) {
          var n2 = r2.paint.get("raster-fade-duration");
          if (n2 > 0) {
            var s2 = t.browser.now(), l2 = (s2 - e2.timeAdded) / n2, c2 = i2 ? (s2 - i2.timeAdded) / n2 : -1, u2 = o2.getSource(), h2 = a2.coveringZoomLevel({tileSize: u2.tileSize, roundZoom: u2.roundZoom}), p2 = !i2 || Math.abs(i2.tileID.overscaledZ - h2) > Math.abs(e2.tileID.overscaledZ - h2), d2 = p2 && e2.refreshedUponExpiration ? 1 : t.clamp(p2 ? l2 : 1 - c2, 0, 1);
            return e2.refreshedUponExpiration && l2 >= 1 && (e2.refreshedUponExpiration = false), i2 ? {opacity: 1, mix: 1 - d2} : {opacity: d2, mix: 0};
          }
          return {opacity: 1, mix: 0};
        }
        var lo = new t.Color(1, 0, 0, 1), co = new t.Color(0, 1, 0, 1), uo = new t.Color(0, 0, 1, 1), ho = new t.Color(1, 0, 1, 1), po = new t.Color(0, 1, 1, 1);
        function _o(t2, e2, i2, o2) {
          mo(t2, 0, e2 + i2 / 2, t2.transform.width, i2, o2);
        }
        function fo(t2, e2, i2, o2) {
          mo(t2, e2 - i2 / 2, 0, i2, t2.transform.height, o2);
        }
        function mo(e2, i2, o2, r2, a2, n2) {
          var s2 = e2.context, l2 = s2.gl;
          l2.enable(l2.SCISSOR_TEST), l2.scissor(i2 * t.browser.devicePixelRatio, o2 * t.browser.devicePixelRatio, r2 * t.browser.devicePixelRatio, a2 * t.browser.devicePixelRatio), s2.clear({color: n2}), l2.disable(l2.SCISSOR_TEST);
        }
        function go(e2, i2, o2) {
          var r2 = e2.context, a2 = r2.gl, n2 = o2.posMatrix, s2 = e2.useProgram("debug"), l2 = It.disabled, c2 = Pt.disabled, u2 = e2.colorModeForRenderPass();
          r2.activeTexture.set(a2.TEXTURE0), e2.emptyTexture.bind(a2.LINEAR, a2.CLAMP_TO_EDGE), s2.draw(r2, a2.LINE_STRIP, l2, c2, u2, Ct.disabled, Mi(n2, t.Color.red), "$debug", e2.debugBuffer, e2.tileBorderIndexBuffer, e2.debugSegments);
          var h2 = i2.getTileByID(o2.key).latestRawTileData, p2 = Math.floor((h2 && h2.byteLength || 0) / 1024), d2 = i2.getTile(o2).tileSize, _2 = 512 / Math.min(d2, 512) * (o2.overscaledZ / e2.transform.zoom) * 0.5, f2 = o2.canonical.toString();
          o2.overscaledZ !== o2.canonical.z && (f2 += " => " + o2.overscaledZ), function(t2, e3) {
            t2.initDebugOverlayCanvas();
            var i3 = t2.debugOverlayCanvas, o3 = t2.context.gl, r3 = t2.debugOverlayCanvas.getContext("2d");
            r3.clearRect(0, 0, i3.width, i3.height), r3.shadowColor = "white", r3.shadowBlur = 2, r3.lineWidth = 1.5, r3.strokeStyle = "white", r3.textBaseline = "top", r3.font = "bold 36px Open Sans, sans-serif", r3.fillText(e3, 5, 5), r3.strokeText(e3, 5, 5), t2.debugOverlayTexture.update(i3), t2.debugOverlayTexture.bind(o3.LINEAR, o3.CLAMP_TO_EDGE);
          }(e2, f2 + " " + p2 + "kb"), s2.draw(r2, a2.TRIANGLES, l2, c2, St.alphaBlended, Ct.disabled, Mi(n2, t.Color.transparent, _2), "$debug", e2.debugBuffer, e2.quadTriangleIndexBuffer, e2.debugSegments);
        }
        var vo = {symbol: function(e2, i2, o2, r2, a2) {
          if (e2.renderPass === "translucent") {
            var n2 = Pt.disabled, s2 = e2.colorModeForRenderPass();
            o2.layout.get("text-variable-anchor") && function(e3, i3, o3, r3, a3, n3, s3) {
              for (var l2 = i3.transform, c2 = a3 === "map", u2 = n3 === "map", h2 = 0, p2 = e3; h2 < p2.length; h2 += 1) {
                var d2 = p2[h2], _2 = r3.getTile(d2), f2 = _2.getBucket(o3);
                if (f2 && f2.text && f2.text.segments.get().length) {
                  var m2 = t.evaluateSizeForZoom(f2.textSizeData, l2.zoom), g2 = pe(_2, 1, i3.transform.zoom), v2 = Jt(d2.posMatrix, u2, c2, i3.transform, g2), y2 = o3.layout.get("icon-text-fit") !== "none" && f2.hasIconData();
                  if (m2) {
                    var x2 = Math.pow(2, l2.zoom - _2.tileID.overscaledZ);
                    $i(f2, c2, u2, s3, t.symbolSize, l2, v2, d2.posMatrix, x2, m2, y2);
                  }
                }
              }
            }(r2, e2, o2, i2, o2.layout.get("text-rotation-alignment"), o2.layout.get("text-pitch-alignment"), a2), o2.paint.get("icon-opacity").constantOr(1) !== 0 && eo(e2, i2, o2, r2, false, o2.paint.get("icon-translate"), o2.paint.get("icon-translate-anchor"), o2.layout.get("icon-rotation-alignment"), o2.layout.get("icon-pitch-alignment"), o2.layout.get("icon-keep-upright"), n2, s2), o2.paint.get("text-opacity").constantOr(1) !== 0 && eo(e2, i2, o2, r2, true, o2.paint.get("text-translate"), o2.paint.get("text-translate-anchor"), o2.layout.get("text-rotation-alignment"), o2.layout.get("text-pitch-alignment"), o2.layout.get("text-keep-upright"), n2, s2), i2.map.showCollisionBoxes && (Yi(e2, i2, o2, r2, o2.paint.get("text-translate"), o2.paint.get("text-translate-anchor"), true), Yi(e2, i2, o2, r2, o2.paint.get("icon-translate"), o2.paint.get("icon-translate-anchor"), false));
          }
        }, circle: function(e2, i2, o2, r2) {
          if (e2.renderPass === "translucent") {
            var a2 = o2.paint.get("circle-opacity"), n2 = o2.paint.get("circle-stroke-width"), s2 = o2.paint.get("circle-stroke-opacity"), l2 = o2.layout.get("circle-sort-key").constantOr(1) !== void 0;
            if (a2.constantOr(1) !== 0 || n2.constantOr(1) !== 0 && s2.constantOr(1) !== 0) {
              for (var c2 = e2.context, u2 = c2.gl, h2 = e2.depthModeForSublayer(0, It.ReadOnly), p2 = Pt.disabled, d2 = e2.colorModeForRenderPass(), _2 = [], f2 = 0; f2 < r2.length; f2++) {
                var m2 = r2[f2], g2 = i2.getTile(m2), v2 = g2.getBucket(o2);
                if (v2) {
                  var y2 = v2.programConfigurations.get(o2.id), x2 = {programConfiguration: y2, program: e2.useProgram("circle", y2), layoutVertexBuffer: v2.layoutVertexBuffer, indexBuffer: v2.indexBuffer, uniformValues: zi(e2, m2, g2, o2)};
                  if (l2)
                    for (var b2 = 0, w2 = v2.segments.get(); b2 < w2.length; b2 += 1) {
                      var T2 = w2[b2];
                      _2.push({segments: new t.SegmentVector([T2]), sortKey: T2.sortKey, state: x2});
                    }
                  else
                    _2.push({segments: v2.segments, sortKey: 0, state: x2});
                }
              }
              l2 && _2.sort(function(t2, e3) {
                return t2.sortKey - e3.sortKey;
              });
              for (var E2 = 0, I2 = _2; E2 < I2.length; E2 += 1) {
                var P2 = I2[E2], S2 = P2.state;
                S2.program.draw(c2, u2.TRIANGLES, h2, p2, d2, Ct.disabled, S2.uniformValues, o2.id, S2.layoutVertexBuffer, S2.indexBuffer, P2.segments, o2.paint, e2.transform.zoom, S2.programConfiguration);
              }
            }
          }
        }, heatmap: function(e2, i2, o2, r2) {
          if (o2.paint.get("heatmap-opacity") !== 0)
            if (e2.renderPass === "offscreen") {
              var a2 = e2.context, n2 = a2.gl, s2 = Pt.disabled, l2 = new St([n2.ONE, n2.ONE], t.Color.transparent, [true, true, true, true]);
              !function(t2, e3, i3) {
                var o3 = t2.gl;
                t2.activeTexture.set(o3.TEXTURE1), t2.viewport.set([0, 0, e3.width / 4, e3.height / 4]);
                var r3 = i3.heatmapFbo;
                if (r3)
                  o3.bindTexture(o3.TEXTURE_2D, r3.colorAttachment.get()), t2.bindFramebuffer.set(r3.framebuffer);
                else {
                  var a3 = o3.createTexture();
                  o3.bindTexture(o3.TEXTURE_2D, a3), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_WRAP_S, o3.CLAMP_TO_EDGE), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_WRAP_T, o3.CLAMP_TO_EDGE), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_MIN_FILTER, o3.LINEAR), o3.texParameteri(o3.TEXTURE_2D, o3.TEXTURE_MAG_FILTER, o3.LINEAR), r3 = i3.heatmapFbo = t2.createFramebuffer(e3.width / 4, e3.height / 4, false), function(t3, e4, i4, o4) {
                    var r4 = t3.gl;
                    r4.texImage2D(r4.TEXTURE_2D, 0, r4.RGBA, e4.width / 4, e4.height / 4, 0, r4.RGBA, t3.extRenderToTextureHalfFloat ? t3.extTextureHalfFloat.HALF_FLOAT_OES : r4.UNSIGNED_BYTE, null), o4.colorAttachment.set(i4);
                  }(t2, e3, a3, r3);
                }
              }(a2, e2, o2), a2.clear({color: t.Color.transparent});
              for (var c2 = 0; c2 < r2.length; c2++) {
                var u2 = r2[c2];
                if (!i2.hasRenderableParent(u2)) {
                  var h2 = i2.getTile(u2), p2 = h2.getBucket(o2);
                  if (p2) {
                    var d2 = p2.programConfigurations.get(o2.id);
                    e2.useProgram("heatmap", d2).draw(a2, n2.TRIANGLES, It.disabled, s2, l2, Ct.disabled, Ri(u2.posMatrix, h2, e2.transform.zoom, o2.paint.get("heatmap-intensity")), o2.id, p2.layoutVertexBuffer, p2.indexBuffer, p2.segments, o2.paint, e2.transform.zoom, d2);
                  }
                }
              }
              a2.viewport.set([0, 0, e2.width, e2.height]);
            } else
              e2.renderPass === "translucent" && (e2.context.setColorMode(e2.colorModeForRenderPass()), function(e3, i3) {
                var o3 = e3.context, r3 = o3.gl, a3 = i3.heatmapFbo;
                if (a3) {
                  o3.activeTexture.set(r3.TEXTURE0), r3.bindTexture(r3.TEXTURE_2D, a3.colorAttachment.get()), o3.activeTexture.set(r3.TEXTURE1);
                  var n3 = i3.colorRampTexture;
                  n3 || (n3 = i3.colorRampTexture = new t.Texture(o3, i3.colorRamp, r3.RGBA)), n3.bind(r3.LINEAR, r3.CLAMP_TO_EDGE), e3.useProgram("heatmapTexture").draw(o3, r3.TRIANGLES, It.disabled, Pt.disabled, e3.colorModeForRenderPass(), Ct.disabled, function(e4, i4, o4, r4) {
                    var a4 = t.create();
                    t.ortho(a4, 0, e4.width, e4.height, 0, 0, 1);
                    var n4 = e4.context.gl;
                    return {u_matrix: a4, u_world: [n4.drawingBufferWidth, n4.drawingBufferHeight], u_image: 0, u_color_ramp: 1, u_opacity: i4.paint.get("heatmap-opacity")};
                  }(e3, i3), i3.id, e3.viewportBuffer, e3.quadTriangleIndexBuffer, e3.viewportSegments, i3.paint, e3.transform.zoom);
                }
              }(e2, o2));
        }, line: function(e2, i2, o2, r2) {
          if (e2.renderPass === "translucent") {
            var a2 = o2.paint.get("line-opacity"), n2 = o2.paint.get("line-width");
            if (a2.constantOr(1) !== 0 && n2.constantOr(1) !== 0)
              for (var s2 = e2.depthModeForSublayer(0, It.ReadOnly), l2 = e2.colorModeForRenderPass(), c2 = o2.paint.get("line-dasharray"), u2 = o2.paint.get("line-pattern"), h2 = u2.constantOr(1), p2 = o2.paint.get("line-gradient"), d2 = o2.getCrossfadeParameters(), _2 = h2 ? "linePattern" : c2 ? "lineSDF" : p2 ? "lineGradient" : "line", f2 = e2.context, m2 = f2.gl, g2 = true, v2 = 0, y2 = r2; v2 < y2.length; v2 += 1) {
                var x2 = y2[v2], b2 = i2.getTile(x2);
                if (!h2 || b2.patternsLoaded()) {
                  var w2 = b2.getBucket(o2);
                  if (w2) {
                    var T2 = w2.programConfigurations.get(o2.id), E2 = e2.context.program.get(), I2 = e2.useProgram(_2, T2), P2 = g2 || I2.program !== E2, S2 = u2.constantOr(null);
                    if (S2 && b2.imageAtlas) {
                      var C2 = b2.imageAtlas, z2 = C2.patternPositions[S2.to.toString()], D2 = C2.patternPositions[S2.from.toString()];
                      z2 && D2 && T2.setConstantPatternPositions(z2, D2);
                    }
                    var A2 = h2 ? Oi(e2, b2, o2, d2) : c2 ? Fi(e2, b2, o2, c2, d2) : p2 ? Bi(e2, b2, o2, w2.lineClipsArray.length) : ki(e2, b2, o2);
                    if (h2)
                      f2.activeTexture.set(m2.TEXTURE0), b2.imageAtlasTexture.bind(m2.LINEAR, m2.CLAMP_TO_EDGE), T2.updatePaintBuffers(d2);
                    else if (c2 && (P2 || e2.lineAtlas.dirty))
                      f2.activeTexture.set(m2.TEXTURE0), e2.lineAtlas.bind(f2);
                    else if (p2) {
                      var M2 = w2.gradients[o2.id], L2 = M2.texture;
                      if (o2.gradientVersion !== M2.version) {
                        var R2 = 256;
                        if (o2.stepInterpolant) {
                          var k2 = i2.getSource().maxzoom, B2 = x2.canonical.z === k2 ? Math.ceil(1 << e2.transform.maxZoom - x2.canonical.z) : 1;
                          R2 = t.clamp(t.nextPowerOfTwo(w2.maxLineLength / t.EXTENT * 1024 * B2), 256, f2.maxTextureSize);
                        }
                        M2.gradient = t.renderColorRamp({expression: o2.gradientExpression(), evaluationKey: "lineProgress", resolution: R2, image: M2.gradient || void 0, clips: w2.lineClipsArray}), M2.texture ? M2.texture.update(M2.gradient) : M2.texture = new t.Texture(f2, M2.gradient, m2.RGBA), M2.version = o2.gradientVersion, L2 = M2.texture;
                      }
                      f2.activeTexture.set(m2.TEXTURE0), L2.bind(o2.stepInterpolant ? m2.NEAREST : m2.LINEAR, m2.CLAMP_TO_EDGE);
                    }
                    I2.draw(f2, m2.TRIANGLES, s2, e2.stencilModeForClipping(x2), l2, Ct.disabled, A2, o2.id, w2.layoutVertexBuffer, w2.indexBuffer, w2.segments, o2.paint, e2.transform.zoom, T2, w2.layoutVertexBuffer2), g2 = false;
                  }
                }
              }
          }
        }, fill: function(e2, i2, o2, r2) {
          var a2 = o2.paint.get("fill-color"), n2 = o2.paint.get("fill-opacity");
          if (n2.constantOr(1) !== 0) {
            var s2 = e2.colorModeForRenderPass(), l2 = o2.paint.get("fill-pattern"), c2 = e2.opaquePassEnabledForLayer() && !l2.constantOr(1) && a2.constantOr(t.Color.transparent).a === 1 && n2.constantOr(0) === 1 ? "opaque" : "translucent";
            if (e2.renderPass === c2) {
              var u2 = e2.depthModeForSublayer(1, e2.renderPass === "opaque" ? It.ReadWrite : It.ReadOnly);
              oo(e2, i2, o2, r2, u2, s2, false);
            }
            if (e2.renderPass === "translucent" && o2.paint.get("fill-antialias")) {
              var h2 = e2.depthModeForSublayer(o2.getPaintProperty("fill-outline-color") ? 2 : 0, It.ReadOnly);
              oo(e2, i2, o2, r2, h2, s2, true);
            }
          }
        }, "fill-extrusion": function(t2, e2, i2, o2) {
          var r2 = i2.paint.get("fill-extrusion-opacity");
          if (r2 !== 0 && t2.renderPass === "translucent") {
            var a2 = new It(t2.context.gl.LEQUAL, It.ReadWrite, t2.depthRangeFor3D);
            if (r2 !== 1 || i2.paint.get("fill-extrusion-pattern").constantOr(1))
              ro(t2, e2, i2, o2, a2, Pt.disabled, St.disabled), ro(t2, e2, i2, o2, a2, t2.stencilModeFor3D(), t2.colorModeForRenderPass());
            else {
              var n2 = t2.colorModeForRenderPass();
              ro(t2, e2, i2, o2, a2, Pt.disabled, n2);
            }
          }
        }, hillshade: function(t2, e2, i2, o2) {
          if (t2.renderPass === "offscreen" || t2.renderPass === "translucent") {
            for (var r2 = t2.context, a2 = t2.depthModeForSublayer(0, It.ReadOnly), n2 = t2.colorModeForRenderPass(), s2 = t2.renderPass === "translucent" ? t2.stencilConfigForOverlap(o2) : [{}, o2], l2 = s2[0], c2 = 0, u2 = s2[1]; c2 < u2.length; c2 += 1) {
              var h2 = u2[c2], p2 = e2.getTile(h2);
              p2.needsHillshadePrepare && t2.renderPass === "offscreen" ? no(t2, p2, i2, a2, Pt.disabled, n2) : t2.renderPass === "translucent" && ao(t2, p2, i2, a2, l2[h2.overscaledZ], n2);
            }
            r2.viewport.set([0, 0, t2.width, t2.height]);
          }
        }, raster: function(t2, e2, i2, o2) {
          if (t2.renderPass === "translucent" && i2.paint.get("raster-opacity") !== 0 && o2.length)
            for (var r2 = t2.context, a2 = r2.gl, n2 = e2.getSource(), s2 = t2.useProgram("raster"), l2 = t2.colorModeForRenderPass(), c2 = n2 instanceof M ? [{}, o2] : t2.stencilConfigForOverlap(o2), u2 = c2[0], h2 = c2[1], p2 = h2[h2.length - 1].overscaledZ, d2 = !t2.options.moving, _2 = 0, f2 = h2; _2 < f2.length; _2 += 1) {
              var m2 = f2[_2], g2 = t2.depthModeForSublayer(m2.overscaledZ - p2, i2.paint.get("raster-opacity") === 1 ? It.ReadWrite : It.ReadOnly, a2.LESS), v2 = e2.getTile(m2), y2 = t2.transform.calculatePosMatrix(m2.toUnwrapped(), d2);
              v2.registerFadeDuration(i2.paint.get("raster-fade-duration"));
              var x2 = e2.findLoadedParent(m2, 0), b2 = so(v2, x2, e2, i2, t2.transform), w2 = void 0, T2 = void 0, E2 = i2.paint.get("raster-resampling") === "nearest" ? a2.NEAREST : a2.LINEAR;
              r2.activeTexture.set(a2.TEXTURE0), v2.texture.bind(E2, a2.CLAMP_TO_EDGE, a2.LINEAR_MIPMAP_NEAREST), r2.activeTexture.set(a2.TEXTURE1), x2 ? (x2.texture.bind(E2, a2.CLAMP_TO_EDGE, a2.LINEAR_MIPMAP_NEAREST), w2 = Math.pow(2, x2.tileID.overscaledZ - v2.tileID.overscaledZ), T2 = [v2.tileID.canonical.x * w2 % 1, v2.tileID.canonical.y * w2 % 1]) : v2.texture.bind(E2, a2.CLAMP_TO_EDGE, a2.LINEAR_MIPMAP_NEAREST);
              var I2 = Zi(y2, T2 || [0, 0], w2 || 1, b2, i2);
              n2 instanceof M ? s2.draw(r2, a2.TRIANGLES, g2, Pt.disabled, l2, Ct.disabled, I2, i2.id, n2.boundsBuffer, t2.quadTriangleIndexBuffer, n2.boundsSegments) : s2.draw(r2, a2.TRIANGLES, g2, u2[m2.overscaledZ], l2, Ct.disabled, I2, i2.id, t2.rasterBoundsBuffer, t2.quadTriangleIndexBuffer, t2.rasterBoundsSegments);
            }
        }, background: function(t2, e2, i2) {
          var o2 = i2.paint.get("background-color"), r2 = i2.paint.get("background-opacity");
          if (r2 !== 0) {
            var a2 = t2.context, n2 = a2.gl, s2 = t2.transform, l2 = s2.tileSize, c2 = i2.paint.get("background-pattern");
            if (!t2.isPatternMissing(c2)) {
              var u2 = !c2 && o2.a === 1 && r2 === 1 && t2.opaquePassEnabledForLayer() ? "opaque" : "translucent";
              if (t2.renderPass === u2) {
                var h2 = Pt.disabled, p2 = t2.depthModeForSublayer(0, u2 === "opaque" ? It.ReadWrite : It.ReadOnly), d2 = t2.colorModeForRenderPass(), _2 = t2.useProgram(c2 ? "backgroundPattern" : "background"), f2 = s2.coveringTiles({tileSize: l2});
                c2 && (a2.activeTexture.set(n2.TEXTURE0), t2.imageManager.bind(t2.context));
                for (var m2 = i2.getCrossfadeParameters(), g2 = 0, v2 = f2; g2 < v2.length; g2 += 1) {
                  var y2 = v2[g2], x2 = t2.transform.calculatePosMatrix(y2.toUnwrapped()), b2 = c2 ? Hi(x2, r2, t2, c2, {tileID: y2, tileSize: l2}, m2) : Xi(x2, r2, o2);
                  _2.draw(a2, n2.TRIANGLES, p2, h2, d2, Ct.disabled, b2, i2.id, t2.tileExtentBuffer, t2.quadTriangleIndexBuffer, t2.tileExtentSegments);
                }
              }
            }
          }
        }, debug: function(t2, e2, i2) {
          for (var o2 = 0; o2 < i2.length; o2++)
            go(t2, e2, i2[o2]);
        }, custom: function(t2, e2, i2) {
          var o2 = t2.context, r2 = i2.implementation;
          if (t2.renderPass === "offscreen") {
            var a2 = r2.prerender;
            a2 && (t2.setCustomLayerDefaults(), o2.setColorMode(t2.colorModeForRenderPass()), a2.call(r2, o2.gl, t2.transform.customLayerMatrix()), o2.setDirty(), t2.setBaseState());
          } else if (t2.renderPass === "translucent") {
            t2.setCustomLayerDefaults(), o2.setColorMode(t2.colorModeForRenderPass()), o2.setStencilMode(Pt.disabled);
            var n2 = r2.renderingMode === "3d" ? new It(t2.context.gl.LEQUAL, It.ReadWrite, t2.depthRangeFor3D) : t2.depthModeForSublayer(0, It.ReadOnly);
            o2.setDepthMode(n2), r2.render(o2.gl, t2.transform.customLayerMatrix()), o2.setDirty(), t2.setBaseState(), o2.bindFramebuffer.set(null);
          }
        }}, yo = function(t2, e2) {
          this.context = new zt(t2), this.transform = e2, this._tileTextures = {}, this.setup(), this.numSublayers = Dt.maxUnderzooming + Dt.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new Fe(), this.gpuTimers = {};
        };
        yo.prototype.resize = function(e2, i2) {
          if (this.width = e2 * t.browser.devicePixelRatio, this.height = i2 * t.browser.devicePixelRatio, this.context.viewport.set([0, 0, this.width, this.height]), this.style)
            for (var o2 = 0, r2 = this.style._order; o2 < r2.length; o2 += 1)
              this.style._layers[r2[o2]].resize();
        }, yo.prototype.setup = function() {
          var e2 = this.context, i2 = new t.StructArrayLayout2i4();
          i2.emplaceBack(0, 0), i2.emplaceBack(t.EXTENT, 0), i2.emplaceBack(0, t.EXTENT), i2.emplaceBack(t.EXTENT, t.EXTENT), this.tileExtentBuffer = e2.createVertexBuffer(i2, Ve.members), this.tileExtentSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
          var o2 = new t.StructArrayLayout2i4();
          o2.emplaceBack(0, 0), o2.emplaceBack(t.EXTENT, 0), o2.emplaceBack(0, t.EXTENT), o2.emplaceBack(t.EXTENT, t.EXTENT), this.debugBuffer = e2.createVertexBuffer(o2, Ve.members), this.debugSegments = t.SegmentVector.simpleSegment(0, 0, 4, 5);
          var r2 = new t.StructArrayLayout4i8();
          r2.emplaceBack(0, 0, 0, 0), r2.emplaceBack(t.EXTENT, 0, t.EXTENT, 0), r2.emplaceBack(0, t.EXTENT, 0, t.EXTENT), r2.emplaceBack(t.EXTENT, t.EXTENT, t.EXTENT, t.EXTENT), this.rasterBoundsBuffer = e2.createVertexBuffer(r2, A.members), this.rasterBoundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
          var a2 = new t.StructArrayLayout2i4();
          a2.emplaceBack(0, 0), a2.emplaceBack(1, 0), a2.emplaceBack(0, 1), a2.emplaceBack(1, 1), this.viewportBuffer = e2.createVertexBuffer(a2, Ve.members), this.viewportSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
          var n2 = new t.StructArrayLayout1ui2();
          n2.emplaceBack(0), n2.emplaceBack(1), n2.emplaceBack(3), n2.emplaceBack(2), n2.emplaceBack(0), this.tileBorderIndexBuffer = e2.createIndexBuffer(n2);
          var s2 = new t.StructArrayLayout3ui6();
          s2.emplaceBack(0, 1, 2), s2.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = e2.createIndexBuffer(s2), this.emptyTexture = new t.Texture(e2, {width: 1, height: 1, data: new Uint8Array([0, 0, 0, 0])}, e2.gl.RGBA);
          var l2 = this.context.gl;
          this.stencilClearMode = new Pt({func: l2.ALWAYS, mask: 0}, 0, 255, l2.ZERO, l2.ZERO, l2.ZERO);
        }, yo.prototype.clearStencil = function() {
          var e2 = this.context, i2 = e2.gl;
          this.nextStencilID = 1, this.currentStencilSource = void 0;
          var o2 = t.create();
          t.ortho(o2, 0, this.width, this.height, 0, 0, 1), t.scale(o2, o2, [i2.drawingBufferWidth, i2.drawingBufferHeight, 0]), this.useProgram("clippingMask").draw(e2, i2.TRIANGLES, It.disabled, this.stencilClearMode, St.disabled, Ct.disabled, Li(o2), "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments);
        }, yo.prototype._renderTileClippingMasks = function(t2, e2) {
          if (this.currentStencilSource !== t2.source && t2.isTileClipped() && e2 && e2.length) {
            this.currentStencilSource = t2.source;
            var i2 = this.context, o2 = i2.gl;
            this.nextStencilID + e2.length > 256 && this.clearStencil(), i2.setColorMode(St.disabled), i2.setDepthMode(It.disabled);
            var r2 = this.useProgram("clippingMask");
            this._tileClippingMaskIDs = {};
            for (var a2 = 0, n2 = e2; a2 < n2.length; a2 += 1) {
              var s2 = n2[a2], l2 = this._tileClippingMaskIDs[s2.key] = this.nextStencilID++;
              r2.draw(i2, o2.TRIANGLES, It.disabled, new Pt({func: o2.ALWAYS, mask: 0}, l2, 255, o2.KEEP, o2.KEEP, o2.REPLACE), St.disabled, Ct.disabled, Li(s2.posMatrix), "$clipping", this.tileExtentBuffer, this.quadTriangleIndexBuffer, this.tileExtentSegments);
            }
          }
        }, yo.prototype.stencilModeFor3D = function() {
          this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();
          var t2 = this.nextStencilID++, e2 = this.context.gl;
          return new Pt({func: e2.NOTEQUAL, mask: 255}, t2, 255, e2.KEEP, e2.KEEP, e2.REPLACE);
        }, yo.prototype.stencilModeForClipping = function(t2) {
          var e2 = this.context.gl;
          return new Pt({func: e2.EQUAL, mask: 255}, this._tileClippingMaskIDs[t2.key], 0, e2.KEEP, e2.KEEP, e2.REPLACE);
        }, yo.prototype.stencilConfigForOverlap = function(t2) {
          var e2, i2 = this.context.gl, o2 = t2.sort(function(t3, e3) {
            return e3.overscaledZ - t3.overscaledZ;
          }), r2 = o2[o2.length - 1].overscaledZ, a2 = o2[0].overscaledZ - r2 + 1;
          if (a2 > 1) {
            this.currentStencilSource = void 0, this.nextStencilID + a2 > 256 && this.clearStencil();
            for (var n2 = {}, s2 = 0; s2 < a2; s2++)
              n2[s2 + r2] = new Pt({func: i2.GEQUAL, mask: 255}, s2 + this.nextStencilID, 255, i2.KEEP, i2.KEEP, i2.REPLACE);
            return this.nextStencilID += a2, [n2, o2];
          }
          return [(e2 = {}, e2[r2] = Pt.disabled, e2), o2];
        }, yo.prototype.colorModeForRenderPass = function() {
          var e2 = this.context.gl;
          return this._showOverdrawInspector ? new St([e2.CONSTANT_COLOR, e2.ONE], new t.Color(1 / 8, 1 / 8, 1 / 8, 0), [true, true, true, true]) : this.renderPass === "opaque" ? St.unblended : St.alphaBlended;
        }, yo.prototype.depthModeForSublayer = function(t2, e2, i2) {
          if (!this.opaquePassEnabledForLayer())
            return It.disabled;
          var o2 = 1 - ((1 + this.currentLayer) * this.numSublayers + t2) * this.depthEpsilon;
          return new It(i2 || this.context.gl.LEQUAL, e2, [o2, o2]);
        }, yo.prototype.opaquePassEnabledForLayer = function() {
          return this.currentLayer < this.opaquePassCutoff;
        }, yo.prototype.render = function(e2, i2) {
          var o2 = this;
          this.style = e2, this.options = i2, this.lineAtlas = e2.lineAtlas, this.imageManager = e2.imageManager, this.glyphManager = e2.glyphManager, this.symbolFadeChange = e2.placement.symbolFadeChange(t.browser.now()), this.imageManager.beginFrame();
          var r2 = this.style._order, a2 = this.style.sourceCaches;
          for (var n2 in a2) {
            var s2 = a2[n2];
            s2.used && s2.prepare(this.context);
          }
          var l2, c2, u2 = {}, h2 = {}, p2 = {};
          for (var d2 in a2) {
            var _2 = a2[d2];
            u2[d2] = _2.getVisibleCoordinates(), h2[d2] = u2[d2].slice().reverse(), p2[d2] = _2.getVisibleCoordinates(true).reverse();
          }
          this.opaquePassCutoff = 1 / 0;
          for (var f2 = 0; f2 < r2.length; f2++)
            if (this.style._layers[r2[f2]].is3D()) {
              this.opaquePassCutoff = f2;
              break;
            }
          this.renderPass = "offscreen";
          for (var m2 = 0, g2 = r2; m2 < g2.length; m2 += 1) {
            var v2 = this.style._layers[g2[m2]];
            if (v2.hasOffscreenPass() && !v2.isHidden(this.transform.zoom)) {
              var y2 = h2[v2.source];
              (v2.type === "custom" || y2.length) && this.renderLayer(this, a2[v2.source], v2, y2);
            }
          }
          for (this.context.bindFramebuffer.set(null), this.context.clear({color: i2.showOverdrawInspector ? t.Color.black : t.Color.transparent, depth: 1}), this.clearStencil(), this._showOverdrawInspector = i2.showOverdrawInspector, this.depthRangeFor3D = [0, 1 - (e2._order.length + 2) * this.numSublayers * this.depthEpsilon], this.renderPass = "opaque", this.currentLayer = r2.length - 1; this.currentLayer >= 0; this.currentLayer--) {
            var x2 = this.style._layers[r2[this.currentLayer]], b2 = a2[x2.source], w2 = u2[x2.source];
            this._renderTileClippingMasks(x2, w2), this.renderLayer(this, b2, x2, w2);
          }
          for (this.renderPass = "translucent", this.currentLayer = 0; this.currentLayer < r2.length; this.currentLayer++) {
            var T2 = this.style._layers[r2[this.currentLayer]], E2 = a2[T2.source], I2 = (T2.type === "symbol" ? p2 : h2)[T2.source];
            this._renderTileClippingMasks(T2, u2[T2.source]), this.renderLayer(this, E2, T2, I2);
          }
          this.options.showTileBoundaries && (t.values(this.style._layers).forEach(function(t2) {
            t2.source && !t2.isHidden(o2.transform.zoom) && (t2.source !== (c2 && c2.id) && (c2 = o2.style.sourceCaches[t2.source]), (!l2 || l2.getSource().maxzoom < c2.getSource().maxzoom) && (l2 = c2));
          }), l2 && vo.debug(this, l2, l2.getVisibleCoordinates())), this.options.showPadding && function(t2) {
            var e3 = t2.transform.padding;
            _o(t2, t2.transform.height - (e3.top || 0), 3, lo), _o(t2, e3.bottom || 0, 3, co), fo(t2, e3.left || 0, 3, uo), fo(t2, t2.transform.width - (e3.right || 0), 3, ho);
            var i3 = t2.transform.centerPoint;
            !function(t3, e4, i4, o3) {
              mo(t3, e4 - 1, i4 - 10, 2, 20, o3), mo(t3, e4 - 10, i4 - 1, 20, 2, o3);
            }(t2, i3.x, t2.transform.height - i3.y, po);
          }(this), this.context.setDefault();
        }, yo.prototype.renderLayer = function(t2, e2, i2, o2) {
          i2.isHidden(this.transform.zoom) || (i2.type === "background" || i2.type === "custom" || o2.length) && (this.id = i2.id, this.gpuTimingStart(i2), vo[i2.type](t2, e2, i2, o2, this.style.placement.variableOffsets), this.gpuTimingEnd());
        }, yo.prototype.gpuTimingStart = function(t2) {
          if (this.options.gpuTiming) {
            var e2 = this.context.extTimerQuery, i2 = this.gpuTimers[t2.id];
            i2 || (i2 = this.gpuTimers[t2.id] = {calls: 0, cpuTime: 0, query: e2.createQueryEXT()}), i2.calls++, e2.beginQueryEXT(e2.TIME_ELAPSED_EXT, i2.query);
          }
        }, yo.prototype.gpuTimingEnd = function() {
          if (this.options.gpuTiming) {
            var t2 = this.context.extTimerQuery;
            t2.endQueryEXT(t2.TIME_ELAPSED_EXT);
          }
        }, yo.prototype.collectGpuTimers = function() {
          var t2 = this.gpuTimers;
          return this.gpuTimers = {}, t2;
        }, yo.prototype.queryGpuTimers = function(t2) {
          var e2 = {};
          for (var i2 in t2) {
            var o2 = t2[i2], r2 = this.context.extTimerQuery, a2 = r2.getQueryObjectEXT(o2.query, r2.QUERY_RESULT_EXT) / 1e6;
            r2.deleteQueryEXT(o2.query), e2[i2] = a2;
          }
          return e2;
        }, yo.prototype.translatePosMatrix = function(e2, i2, o2, r2, a2) {
          if (!o2[0] && !o2[1])
            return e2;
          var n2 = a2 ? r2 === "map" ? this.transform.angle : 0 : r2 === "viewport" ? -this.transform.angle : 0;
          if (n2) {
            var s2 = Math.sin(n2), l2 = Math.cos(n2);
            o2 = [o2[0] * l2 - o2[1] * s2, o2[0] * s2 + o2[1] * l2];
          }
          var c2 = [a2 ? o2[0] : pe(i2, o2[0], this.transform.zoom), a2 ? o2[1] : pe(i2, o2[1], this.transform.zoom), 0], u2 = new Float32Array(16);
          return t.translate(u2, e2, c2), u2;
        }, yo.prototype.saveTileTexture = function(t2) {
          var e2 = this._tileTextures[t2.size[0]];
          e2 ? e2.push(t2) : this._tileTextures[t2.size[0]] = [t2];
        }, yo.prototype.getTileTexture = function(t2) {
          var e2 = this._tileTextures[t2];
          return e2 && e2.length > 0 ? e2.pop() : null;
        }, yo.prototype.isPatternMissing = function(t2) {
          if (!t2)
            return false;
          if (!t2.from || !t2.to)
            return true;
          var e2 = this.imageManager.getPattern(t2.from.toString()), i2 = this.imageManager.getPattern(t2.to.toString());
          return !e2 || !i2;
        }, yo.prototype.useProgram = function(t2, e2) {
          this.cache = this.cache || {};
          var i2 = "" + t2 + (e2 ? e2.cacheKey : "") + (this._showOverdrawInspector ? "/overdraw" : "");
          return this.cache[i2] || (this.cache[i2] = new bi(this.context, t2, vi[t2], e2, Ki[t2], this._showOverdrawInspector)), this.cache[i2];
        }, yo.prototype.setCustomLayerDefaults = function() {
          this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault();
        }, yo.prototype.setBaseState = function() {
          var t2 = this.context.gl;
          this.context.cullFace.set(false), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(t2.FUNC_ADD);
        }, yo.prototype.initDebugOverlayCanvas = function() {
          this.debugOverlayCanvas == null && (this.debugOverlayCanvas = t.window.document.createElement("canvas"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new t.Texture(this.context, this.debugOverlayCanvas, this.context.gl.RGBA));
        }, yo.prototype.destroy = function() {
          this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy();
        };
        var xo = function(t2, e2) {
          this.points = t2, this.planes = e2;
        };
        xo.fromInvProjectionMatrix = function(e2, i2, o2) {
          var r2 = Math.pow(2, o2), a2 = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map(function(i3) {
            return t.transformMat4([], i3, e2);
          }).map(function(e3) {
            return t.scale$1([], e3, 1 / e3[3] / i2 * r2);
          }), n2 = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map(function(e3) {
            var i3 = t.sub([], a2[e3[0]], a2[e3[1]]), o3 = t.sub([], a2[e3[2]], a2[e3[1]]), r3 = t.normalize([], t.cross([], i3, o3)), n3 = -t.dot(r3, a2[e3[1]]);
            return r3.concat(n3);
          });
          return new xo(a2, n2);
        };
        var bo = function(e2, i2) {
          this.min = e2, this.max = i2, this.center = t.scale$2([], t.add([], this.min, this.max), 0.5);
        };
        bo.prototype.quadrant = function(e2) {
          for (var i2 = [e2 % 2 == 0, e2 < 2], o2 = t.clone$2(this.min), r2 = t.clone$2(this.max), a2 = 0; a2 < i2.length; a2++)
            o2[a2] = i2[a2] ? this.min[a2] : this.center[a2], r2[a2] = i2[a2] ? this.center[a2] : this.max[a2];
          return r2[2] = this.max[2], new bo(o2, r2);
        }, bo.prototype.distanceX = function(t2) {
          return Math.max(Math.min(this.max[0], t2[0]), this.min[0]) - t2[0];
        }, bo.prototype.distanceY = function(t2) {
          return Math.max(Math.min(this.max[1], t2[1]), this.min[1]) - t2[1];
        }, bo.prototype.intersects = function(e2) {
          for (var i2 = [[this.min[0], this.min[1], 0, 1], [this.max[0], this.min[1], 0, 1], [this.max[0], this.max[1], 0, 1], [this.min[0], this.max[1], 0, 1]], o2 = true, r2 = 0; r2 < e2.planes.length; r2++) {
            for (var a2 = e2.planes[r2], n2 = 0, s2 = 0; s2 < i2.length; s2++)
              n2 += t.dot$1(a2, i2[s2]) >= 0;
            if (n2 === 0)
              return 0;
            n2 !== i2.length && (o2 = false);
          }
          if (o2)
            return 2;
          for (var l2 = 0; l2 < 3; l2++) {
            for (var c2 = Number.MAX_VALUE, u2 = -Number.MAX_VALUE, h2 = 0; h2 < e2.points.length; h2++) {
              var p2 = e2.points[h2][l2] - this.min[l2];
              c2 = Math.min(c2, p2), u2 = Math.max(u2, p2);
            }
            if (u2 < 0 || c2 > this.max[l2] - this.min[l2])
              return 0;
          }
          return 1;
        };
        var wo = function(t2, e2, i2, o2) {
          if (t2 === void 0 && (t2 = 0), e2 === void 0 && (e2 = 0), i2 === void 0 && (i2 = 0), o2 === void 0 && (o2 = 0), isNaN(t2) || t2 < 0 || isNaN(e2) || e2 < 0 || isNaN(i2) || i2 < 0 || isNaN(o2) || o2 < 0)
            throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
          this.top = t2, this.bottom = e2, this.left = i2, this.right = o2;
        };
        wo.prototype.interpolate = function(e2, i2, o2) {
          return i2.top != null && e2.top != null && (this.top = t.number(e2.top, i2.top, o2)), i2.bottom != null && e2.bottom != null && (this.bottom = t.number(e2.bottom, i2.bottom, o2)), i2.left != null && e2.left != null && (this.left = t.number(e2.left, i2.left, o2)), i2.right != null && e2.right != null && (this.right = t.number(e2.right, i2.right, o2)), this;
        }, wo.prototype.getCenter = function(e2, i2) {
          var o2 = t.clamp((this.left + e2 - this.right) / 2, 0, e2), r2 = t.clamp((this.top + i2 - this.bottom) / 2, 0, i2);
          return new t.Point(o2, r2);
        }, wo.prototype.equals = function(t2) {
          return this.top === t2.top && this.bottom === t2.bottom && this.left === t2.left && this.right === t2.right;
        }, wo.prototype.clone = function() {
          return new wo(this.top, this.bottom, this.left, this.right);
        }, wo.prototype.toJSON = function() {
          return {top: this.top, bottom: this.bottom, left: this.left, right: this.right};
        };
        var To = function(e2, i2, o2, r2, a2) {
          this.tileSize = 512, this.maxValidLatitude = 85.051129, this._renderWorldCopies = a2 === void 0 || a2, this._minZoom = e2 || 0, this._maxZoom = i2 || 22, this._minPitch = o2 == null ? 0 : o2, this._maxPitch = r2 == null ? 60 : r2, this.setMaxBounds(), this.width = 0, this.height = 0, this._center = new t.LngLat(0, 0), this.zoom = 0, this.angle = 0, this._fov = 0.6435011087932844, this._pitch = 0, this._unmodified = true, this._edgeInsets = new wo(), this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
        }, Eo = {minZoom: {configurable: true}, maxZoom: {configurable: true}, minPitch: {configurable: true}, maxPitch: {configurable: true}, renderWorldCopies: {configurable: true}, worldSize: {configurable: true}, centerOffset: {configurable: true}, size: {configurable: true}, bearing: {configurable: true}, pitch: {configurable: true}, fov: {configurable: true}, zoom: {configurable: true}, center: {configurable: true}, padding: {configurable: true}, centerPoint: {configurable: true}, unmodified: {configurable: true}, point: {configurable: true}};
        To.prototype.clone = function() {
          var t2 = new To(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies);
          return t2.tileSize = this.tileSize, t2.latRange = this.latRange, t2.width = this.width, t2.height = this.height, t2._center = this._center, t2.zoom = this.zoom, t2.angle = this.angle, t2._fov = this._fov, t2._pitch = this._pitch, t2._unmodified = this._unmodified, t2._edgeInsets = this._edgeInsets.clone(), t2._calcMatrices(), t2;
        }, Eo.minZoom.get = function() {
          return this._minZoom;
        }, Eo.minZoom.set = function(t2) {
          this._minZoom !== t2 && (this._minZoom = t2, this.zoom = Math.max(this.zoom, t2));
        }, Eo.maxZoom.get = function() {
          return this._maxZoom;
        }, Eo.maxZoom.set = function(t2) {
          this._maxZoom !== t2 && (this._maxZoom = t2, this.zoom = Math.min(this.zoom, t2));
        }, Eo.minPitch.get = function() {
          return this._minPitch;
        }, Eo.minPitch.set = function(t2) {
          this._minPitch !== t2 && (this._minPitch = t2, this.pitch = Math.max(this.pitch, t2));
        }, Eo.maxPitch.get = function() {
          return this._maxPitch;
        }, Eo.maxPitch.set = function(t2) {
          this._maxPitch !== t2 && (this._maxPitch = t2, this.pitch = Math.min(this.pitch, t2));
        }, Eo.renderWorldCopies.get = function() {
          return this._renderWorldCopies;
        }, Eo.renderWorldCopies.set = function(t2) {
          t2 === void 0 ? t2 = true : t2 === null && (t2 = false), this._renderWorldCopies = t2;
        }, Eo.worldSize.get = function() {
          return this.tileSize * this.scale;
        }, Eo.centerOffset.get = function() {
          return this.centerPoint._sub(this.size._div(2));
        }, Eo.size.get = function() {
          return new t.Point(this.width, this.height);
        }, Eo.bearing.get = function() {
          return -this.angle / Math.PI * 180;
        }, Eo.bearing.set = function(e2) {
          var i2 = -t.wrap(e2, -180, 180) * Math.PI / 180;
          this.angle !== i2 && (this._unmodified = false, this.angle = i2, this._calcMatrices(), this.rotationMatrix = t.create$2(), t.rotate(this.rotationMatrix, this.rotationMatrix, this.angle));
        }, Eo.pitch.get = function() {
          return this._pitch / Math.PI * 180;
        }, Eo.pitch.set = function(e2) {
          var i2 = t.clamp(e2, this.minPitch, this.maxPitch) / 180 * Math.PI;
          this._pitch !== i2 && (this._unmodified = false, this._pitch = i2, this._calcMatrices());
        }, Eo.fov.get = function() {
          return this._fov / Math.PI * 180;
        }, Eo.fov.set = function(t2) {
          t2 = Math.max(0.01, Math.min(60, t2)), this._fov !== t2 && (this._unmodified = false, this._fov = t2 / 180 * Math.PI, this._calcMatrices());
        }, Eo.zoom.get = function() {
          return this._zoom;
        }, Eo.zoom.set = function(t2) {
          var e2 = Math.min(Math.max(t2, this.minZoom), this.maxZoom);
          this._zoom !== e2 && (this._unmodified = false, this._zoom = e2, this.scale = this.zoomScale(e2), this.tileZoom = Math.floor(e2), this.zoomFraction = e2 - this.tileZoom, this._constrain(), this._calcMatrices());
        }, Eo.center.get = function() {
          return this._center;
        }, Eo.center.set = function(t2) {
          t2.lat === this._center.lat && t2.lng === this._center.lng || (this._unmodified = false, this._center = t2, this._constrain(), this._calcMatrices());
        }, Eo.padding.get = function() {
          return this._edgeInsets.toJSON();
        }, Eo.padding.set = function(t2) {
          this._edgeInsets.equals(t2) || (this._unmodified = false, this._edgeInsets.interpolate(this._edgeInsets, t2, 1), this._calcMatrices());
        }, Eo.centerPoint.get = function() {
          return this._edgeInsets.getCenter(this.width, this.height);
        }, To.prototype.isPaddingEqual = function(t2) {
          return this._edgeInsets.equals(t2);
        }, To.prototype.interpolatePadding = function(t2, e2, i2) {
          this._unmodified = false, this._edgeInsets.interpolate(t2, e2, i2), this._constrain(), this._calcMatrices();
        }, To.prototype.coveringZoomLevel = function(t2) {
          var e2 = (t2.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / t2.tileSize));
          return Math.max(0, e2);
        }, To.prototype.getVisibleUnwrappedCoordinates = function(e2) {
          var i2 = [new t.UnwrappedTileID(0, e2)];
          if (this._renderWorldCopies)
            for (var o2 = this.pointCoordinate(new t.Point(0, 0)), r2 = this.pointCoordinate(new t.Point(this.width, 0)), a2 = this.pointCoordinate(new t.Point(this.width, this.height)), n2 = this.pointCoordinate(new t.Point(0, this.height)), s2 = Math.floor(Math.min(o2.x, r2.x, a2.x, n2.x)), l2 = Math.floor(Math.max(o2.x, r2.x, a2.x, n2.x)), c2 = s2 - 1; c2 <= l2 + 1; c2++)
              c2 !== 0 && i2.push(new t.UnwrappedTileID(c2, e2));
          return i2;
        }, To.prototype.coveringTiles = function(e2) {
          var i2 = this.coveringZoomLevel(e2), o2 = i2;
          if (e2.minzoom !== void 0 && i2 < e2.minzoom)
            return [];
          e2.maxzoom !== void 0 && i2 > e2.maxzoom && (i2 = e2.maxzoom);
          var r2 = t.MercatorCoordinate.fromLngLat(this.center), a2 = Math.pow(2, i2), n2 = [a2 * r2.x, a2 * r2.y, 0], s2 = xo.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, i2), l2 = e2.minzoom || 0;
          this.pitch <= 60 && this._edgeInsets.top < 0.1 && (l2 = i2);
          var c2 = function(t2) {
            return {aabb: new bo([t2 * a2, 0, 0], [(t2 + 1) * a2, a2, 0]), zoom: 0, x: 0, y: 0, wrap: t2, fullyVisible: false};
          }, u2 = [], h2 = [], p2 = i2, d2 = e2.reparseOverscaled ? o2 : i2;
          if (this._renderWorldCopies)
            for (var _2 = 1; _2 <= 3; _2++)
              u2.push(c2(-_2)), u2.push(c2(_2));
          for (u2.push(c2(0)); u2.length > 0; ) {
            var f2 = u2.pop(), m2 = f2.x, g2 = f2.y, v2 = f2.fullyVisible;
            if (!v2) {
              var y2 = f2.aabb.intersects(s2);
              if (y2 === 0)
                continue;
              v2 = y2 === 2;
            }
            var x2 = f2.aabb.distanceX(n2), b2 = f2.aabb.distanceY(n2), w2 = Math.max(Math.abs(x2), Math.abs(b2));
            if (f2.zoom === p2 || w2 > 3 + (1 << p2 - f2.zoom) - 2 && f2.zoom >= l2)
              h2.push({tileID: new t.OverscaledTileID(f2.zoom === p2 ? d2 : f2.zoom, f2.wrap, f2.zoom, m2, g2), distanceSq: t.sqrLen([n2[0] - 0.5 - m2, n2[1] - 0.5 - g2])});
            else
              for (var T2 = 0; T2 < 4; T2++) {
                var E2 = (m2 << 1) + T2 % 2, I2 = (g2 << 1) + (T2 >> 1);
                u2.push({aabb: f2.aabb.quadrant(T2), zoom: f2.zoom + 1, x: E2, y: I2, wrap: f2.wrap, fullyVisible: v2});
              }
          }
          return h2.sort(function(t2, e3) {
            return t2.distanceSq - e3.distanceSq;
          }).map(function(t2) {
            return t2.tileID;
          });
        }, To.prototype.resize = function(t2, e2) {
          this.width = t2, this.height = e2, this.pixelsToGLUnits = [2 / t2, -2 / e2], this._constrain(), this._calcMatrices();
        }, Eo.unmodified.get = function() {
          return this._unmodified;
        }, To.prototype.zoomScale = function(t2) {
          return Math.pow(2, t2);
        }, To.prototype.scaleZoom = function(t2) {
          return Math.log(t2) / Math.LN2;
        }, To.prototype.project = function(e2) {
          var i2 = t.clamp(e2.lat, -this.maxValidLatitude, this.maxValidLatitude);
          return new t.Point(t.mercatorXfromLng(e2.lng) * this.worldSize, t.mercatorYfromLat(i2) * this.worldSize);
        }, To.prototype.unproject = function(e2) {
          return new t.MercatorCoordinate(e2.x / this.worldSize, e2.y / this.worldSize).toLngLat();
        }, Eo.point.get = function() {
          return this.project(this.center);
        }, To.prototype.setLocationAtPoint = function(e2, i2) {
          var o2 = this.pointCoordinate(i2), r2 = this.pointCoordinate(this.centerPoint), a2 = this.locationCoordinate(e2), n2 = new t.MercatorCoordinate(a2.x - (o2.x - r2.x), a2.y - (o2.y - r2.y));
          this.center = this.coordinateLocation(n2), this._renderWorldCopies && (this.center = this.center.wrap());
        }, To.prototype.locationPoint = function(t2) {
          return this.coordinatePoint(this.locationCoordinate(t2));
        }, To.prototype.pointLocation = function(t2) {
          return this.coordinateLocation(this.pointCoordinate(t2));
        }, To.prototype.locationCoordinate = function(e2) {
          return t.MercatorCoordinate.fromLngLat(e2);
        }, To.prototype.coordinateLocation = function(t2) {
          return t2.toLngLat();
        }, To.prototype.pointCoordinate = function(e2) {
          var i2 = [e2.x, e2.y, 0, 1], o2 = [e2.x, e2.y, 1, 1];
          t.transformMat4(i2, i2, this.pixelMatrixInverse), t.transformMat4(o2, o2, this.pixelMatrixInverse);
          var r2 = i2[3], a2 = o2[3], n2 = i2[1] / r2, s2 = o2[1] / a2, l2 = i2[2] / r2, c2 = o2[2] / a2, u2 = l2 === c2 ? 0 : (0 - l2) / (c2 - l2);
          return new t.MercatorCoordinate(t.number(i2[0] / r2, o2[0] / a2, u2) / this.worldSize, t.number(n2, s2, u2) / this.worldSize);
        }, To.prototype.coordinatePoint = function(e2) {
          var i2 = [e2.x * this.worldSize, e2.y * this.worldSize, 0, 1];
          return t.transformMat4(i2, i2, this.pixelMatrix), new t.Point(i2[0] / i2[3], i2[1] / i2[3]);
        }, To.prototype.getBounds = function() {
          return new t.LngLatBounds().extend(this.pointLocation(new t.Point(0, 0))).extend(this.pointLocation(new t.Point(this.width, 0))).extend(this.pointLocation(new t.Point(this.width, this.height))).extend(this.pointLocation(new t.Point(0, this.height)));
        }, To.prototype.getMaxBounds = function() {
          return this.latRange && this.latRange.length === 2 && this.lngRange && this.lngRange.length === 2 ? new t.LngLatBounds([this.lngRange[0], this.latRange[0]], [this.lngRange[1], this.latRange[1]]) : null;
        }, To.prototype.setMaxBounds = function(t2) {
          t2 ? (this.lngRange = [t2.getWest(), t2.getEast()], this.latRange = [t2.getSouth(), t2.getNorth()], this._constrain()) : (this.lngRange = null, this.latRange = [-this.maxValidLatitude, this.maxValidLatitude]);
        }, To.prototype.calculatePosMatrix = function(e2, i2) {
          i2 === void 0 && (i2 = false);
          var o2 = e2.key, r2 = i2 ? this._alignedPosMatrixCache : this._posMatrixCache;
          if (r2[o2])
            return r2[o2];
          var a2 = e2.canonical, n2 = this.worldSize / this.zoomScale(a2.z), s2 = a2.x + Math.pow(2, a2.z) * e2.wrap, l2 = t.identity(new Float64Array(16));
          return t.translate(l2, l2, [s2 * n2, a2.y * n2, 0]), t.scale(l2, l2, [n2 / t.EXTENT, n2 / t.EXTENT, 1]), t.multiply(l2, i2 ? this.alignedProjMatrix : this.projMatrix, l2), r2[o2] = new Float32Array(l2), r2[o2];
        }, To.prototype.customLayerMatrix = function() {
          return this.mercatorMatrix.slice();
        }, To.prototype._constrain = function() {
          if (this.center && this.width && this.height && !this._constraining) {
            this._constraining = true;
            var e2, i2, o2, r2, a2 = -90, n2 = 90, s2 = -180, l2 = 180, c2 = this.size, u2 = this._unmodified;
            if (this.latRange) {
              var h2 = this.latRange;
              a2 = t.mercatorYfromLat(h2[1]) * this.worldSize, e2 = (n2 = t.mercatorYfromLat(h2[0]) * this.worldSize) - a2 < c2.y ? c2.y / (n2 - a2) : 0;
            }
            if (this.lngRange) {
              var p2 = this.lngRange;
              s2 = t.mercatorXfromLng(p2[0]) * this.worldSize, i2 = (l2 = t.mercatorXfromLng(p2[1]) * this.worldSize) - s2 < c2.x ? c2.x / (l2 - s2) : 0;
            }
            var d2 = this.point, _2 = Math.max(i2 || 0, e2 || 0);
            if (_2)
              return this.center = this.unproject(new t.Point(i2 ? (l2 + s2) / 2 : d2.x, e2 ? (n2 + a2) / 2 : d2.y)), this.zoom += this.scaleZoom(_2), this._unmodified = u2, void (this._constraining = false);
            if (this.latRange) {
              var f2 = d2.y, m2 = c2.y / 2;
              f2 - m2 < a2 && (r2 = a2 + m2), f2 + m2 > n2 && (r2 = n2 - m2);
            }
            if (this.lngRange) {
              var g2 = d2.x, v2 = c2.x / 2;
              g2 - v2 < s2 && (o2 = s2 + v2), g2 + v2 > l2 && (o2 = l2 - v2);
            }
            o2 === void 0 && r2 === void 0 || (this.center = this.unproject(new t.Point(o2 !== void 0 ? o2 : d2.x, r2 !== void 0 ? r2 : d2.y))), this._unmodified = u2, this._constraining = false;
          }
        }, To.prototype._calcMatrices = function() {
          if (this.height) {
            var e2 = this.centerOffset;
            this.cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * this.height;
            var i2 = Math.PI / 2 + this._pitch, o2 = this._fov * (0.5 + e2.y / this.height), r2 = Math.sin(o2) * this.cameraToCenterDistance / Math.sin(t.clamp(Math.PI - i2 - o2, 0.01, Math.PI - 0.01)), a2 = this.point, n2 = a2.x, s2 = a2.y, l2 = 1.01 * (Math.cos(Math.PI / 2 - this._pitch) * r2 + this.cameraToCenterDistance), c2 = this.height / 50, u2 = new Float64Array(16);
            t.perspective(u2, this._fov, this.width / this.height, c2, l2), u2[8] = 2 * -e2.x / this.width, u2[9] = 2 * e2.y / this.height, t.scale(u2, u2, [1, -1, 1]), t.translate(u2, u2, [0, 0, -this.cameraToCenterDistance]), t.rotateX(u2, u2, this._pitch), t.rotateZ(u2, u2, this.angle), t.translate(u2, u2, [-n2, -s2, 0]), this.mercatorMatrix = t.scale([], u2, [this.worldSize, this.worldSize, this.worldSize]), t.scale(u2, u2, [1, 1, t.mercatorZfromAltitude(1, this.center.lat) * this.worldSize, 1]), this.projMatrix = u2, this.invProjMatrix = t.invert([], this.projMatrix);
            var h2 = this.width % 2 / 2, p2 = this.height % 2 / 2, d2 = Math.cos(this.angle), _2 = Math.sin(this.angle), f2 = n2 - Math.round(n2) + d2 * h2 + _2 * p2, m2 = s2 - Math.round(s2) + d2 * p2 + _2 * h2, g2 = new Float64Array(u2);
            if (t.translate(g2, g2, [f2 > 0.5 ? f2 - 1 : f2, m2 > 0.5 ? m2 - 1 : m2, 0]), this.alignedProjMatrix = g2, u2 = t.create(), t.scale(u2, u2, [this.width / 2, -this.height / 2, 1]), t.translate(u2, u2, [1, -1, 0]), this.labelPlaneMatrix = u2, u2 = t.create(), t.scale(u2, u2, [1, -1, 1]), t.translate(u2, u2, [-1, -1, 0]), t.scale(u2, u2, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = u2, this.pixelMatrix = t.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix), !(u2 = t.invert(new Float64Array(16), this.pixelMatrix)))
              throw new Error("failed to invert matrix");
            this.pixelMatrixInverse = u2, this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
          }
        }, To.prototype.maxPitchScaleFactor = function() {
          if (!this.pixelMatrixInverse)
            return 1;
          var e2 = this.pointCoordinate(new t.Point(0, 0)), i2 = [e2.x * this.worldSize, e2.y * this.worldSize, 0, 1];
          return t.transformMat4(i2, i2, this.pixelMatrix)[3] / this.cameraToCenterDistance;
        }, To.prototype.getCameraPoint = function() {
          var e2 = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
          return this.centerPoint.add(new t.Point(0, e2));
        }, To.prototype.getCameraQueryGeometry = function(e2) {
          var i2 = this.getCameraPoint();
          if (e2.length === 1)
            return [e2[0], i2];
          for (var o2 = i2.x, r2 = i2.y, a2 = i2.x, n2 = i2.y, s2 = 0, l2 = e2; s2 < l2.length; s2 += 1) {
            var c2 = l2[s2];
            o2 = Math.min(o2, c2.x), r2 = Math.min(r2, c2.y), a2 = Math.max(a2, c2.x), n2 = Math.max(n2, c2.y);
          }
          return [new t.Point(o2, r2), new t.Point(a2, r2), new t.Point(a2, n2), new t.Point(o2, n2), new t.Point(o2, r2)];
        }, Object.defineProperties(To.prototype, Eo);
        var Io = function(e2) {
          var i2, o2, r2, a2;
          this._hashName = e2 && encodeURIComponent(e2), t.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this), this._updateHash = (i2 = this._updateHashUnthrottled.bind(this), o2 = false, r2 = null, a2 = function() {
            r2 = null, o2 && (i2(), r2 = setTimeout(a2, 300), o2 = false);
          }, function() {
            return o2 = true, r2 || a2(), r2;
          });
        };
        Io.prototype.addTo = function(e2) {
          return this._map = e2, t.window.addEventListener("hashchange", this._onHashChange, false), this._map.on("moveend", this._updateHash), this;
        }, Io.prototype.remove = function() {
          return t.window.removeEventListener("hashchange", this._onHashChange, false), this._map.off("moveend", this._updateHash), clearTimeout(this._updateHash()), delete this._map, this;
        }, Io.prototype.getHashString = function(e2) {
          var i2 = this._map.getCenter(), o2 = Math.round(100 * this._map.getZoom()) / 100, r2 = Math.ceil((o2 * Math.LN2 + Math.log(512 / 360 / 0.5)) / Math.LN10), a2 = Math.pow(10, r2), n2 = Math.round(i2.lng * a2) / a2, s2 = Math.round(i2.lat * a2) / a2, l2 = this._map.getBearing(), c2 = this._map.getPitch(), u2 = "";
          if (u2 += e2 ? "/" + n2 + "/" + s2 + "/" + o2 : o2 + "/" + s2 + "/" + n2, (l2 || c2) && (u2 += "/" + Math.round(10 * l2) / 10), c2 && (u2 += "/" + Math.round(c2)), this._hashName) {
            var h2 = this._hashName, p2 = false, d2 = t.window.location.hash.slice(1).split("&").map(function(t2) {
              var e3 = t2.split("=")[0];
              return e3 === h2 ? (p2 = true, e3 + "=" + u2) : t2;
            }).filter(function(t2) {
              return t2;
            });
            return p2 || d2.push(h2 + "=" + u2), "#" + d2.join("&");
          }
          return "#" + u2;
        }, Io.prototype._getCurrentHash = function() {
          var e2, i2 = this, o2 = t.window.location.hash.replace("#", "");
          return this._hashName ? (o2.split("&").map(function(t2) {
            return t2.split("=");
          }).forEach(function(t2) {
            t2[0] === i2._hashName && (e2 = t2);
          }), (e2 && e2[1] || "").split("/")) : o2.split("/");
        }, Io.prototype._onHashChange = function() {
          var t2 = this._getCurrentHash();
          if (t2.length >= 3 && !t2.some(function(t3) {
            return isNaN(t3);
          })) {
            var e2 = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(t2[3] || 0) : this._map.getBearing();
            return this._map.jumpTo({center: [+t2[2], +t2[1]], zoom: +t2[0], bearing: e2, pitch: +(t2[4] || 0)}), true;
          }
          return false;
        }, Io.prototype._updateHashUnthrottled = function() {
          var e2 = t.window.location.href.replace(/(#.+)?$/, this.getHashString());
          try {
            t.window.history.replaceState(t.window.history.state, null, e2);
          } catch (t2) {
          }
        };
        var Po = {linearity: 0.3, easing: t.bezier(0, 0, 0.3, 1)}, So = t.extend({deceleration: 2500, maxSpeed: 1400}, Po), Co = t.extend({deceleration: 20, maxSpeed: 1400}, Po), zo = t.extend({deceleration: 1e3, maxSpeed: 360}, Po), Do = t.extend({deceleration: 1e3, maxSpeed: 90}, Po), Ao = function(t2) {
          this._map = t2, this.clear();
        };
        function Mo(t2, e2) {
          (!t2.duration || t2.duration < e2.duration) && (t2.duration = e2.duration, t2.easing = e2.easing);
        }
        function Lo(e2, i2, o2) {
          var r2 = o2.maxSpeed, a2 = o2.linearity, n2 = o2.deceleration, s2 = t.clamp(e2 * a2 / (i2 / 1e3), -r2, r2), l2 = Math.abs(s2) / (n2 * a2);
          return {easing: o2.easing, duration: 1e3 * l2, amount: s2 * (l2 / 2)};
        }
        Ao.prototype.clear = function() {
          this._inertiaBuffer = [];
        }, Ao.prototype.record = function(e2) {
          this._drainInertiaBuffer(), this._inertiaBuffer.push({time: t.browser.now(), settings: e2});
        }, Ao.prototype._drainInertiaBuffer = function() {
          for (var e2 = this._inertiaBuffer, i2 = t.browser.now(); e2.length > 0 && i2 - e2[0].time > 160; )
            e2.shift();
        }, Ao.prototype._onMoveEnd = function(e2) {
          if (this._drainInertiaBuffer(), !(this._inertiaBuffer.length < 2)) {
            for (var i2 = {zoom: 0, bearing: 0, pitch: 0, pan: new t.Point(0, 0), pinchAround: void 0, around: void 0}, o2 = 0, r2 = this._inertiaBuffer; o2 < r2.length; o2 += 1) {
              var a2 = r2[o2].settings;
              i2.zoom += a2.zoomDelta || 0, i2.bearing += a2.bearingDelta || 0, i2.pitch += a2.pitchDelta || 0, a2.panDelta && i2.pan._add(a2.panDelta), a2.around && (i2.around = a2.around), a2.pinchAround && (i2.pinchAround = a2.pinchAround);
            }
            var n2 = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time, s2 = {};
            if (i2.pan.mag()) {
              var l2 = Lo(i2.pan.mag(), n2, t.extend({}, So, e2 || {}));
              s2.offset = i2.pan.mult(l2.amount / i2.pan.mag()), s2.center = this._map.transform.center, Mo(s2, l2);
            }
            if (i2.zoom) {
              var c2 = Lo(i2.zoom, n2, Co);
              s2.zoom = this._map.transform.zoom + c2.amount, Mo(s2, c2);
            }
            if (i2.bearing) {
              var u2 = Lo(i2.bearing, n2, zo);
              s2.bearing = this._map.transform.bearing + t.clamp(u2.amount, -179, 179), Mo(s2, u2);
            }
            if (i2.pitch) {
              var h2 = Lo(i2.pitch, n2, Do);
              s2.pitch = this._map.transform.pitch + h2.amount, Mo(s2, h2);
            }
            if (s2.zoom || s2.bearing) {
              var p2 = i2.pinchAround === void 0 ? i2.around : i2.pinchAround;
              s2.around = p2 ? this._map.unproject(p2) : this._map.getCenter();
            }
            return this.clear(), t.extend(s2, {noMoveStart: true});
          }
        };
        var Ro = function(e2) {
          function o2(o3, r3, a2, n2) {
            n2 === void 0 && (n2 = {});
            var s2 = i.mousePos(r3.getCanvasContainer(), a2), l2 = r3.unproject(s2);
            e2.call(this, o3, t.extend({point: s2, lngLat: l2, originalEvent: a2}, n2)), this._defaultPrevented = false, this.target = r3;
          }
          e2 && (o2.__proto__ = e2), (o2.prototype = Object.create(e2 && e2.prototype)).constructor = o2;
          var r2 = {defaultPrevented: {configurable: true}};
          return o2.prototype.preventDefault = function() {
            this._defaultPrevented = true;
          }, r2.defaultPrevented.get = function() {
            return this._defaultPrevented;
          }, Object.defineProperties(o2.prototype, r2), o2;
        }(t.Event), ko = function(e2) {
          function o2(o3, r3, a2) {
            var n2 = o3 === "touchend" ? a2.changedTouches : a2.touches, s2 = i.touchPos(r3.getCanvasContainer(), n2), l2 = s2.map(function(t2) {
              return r3.unproject(t2);
            }), c2 = s2.reduce(function(t2, e3, i2, o4) {
              return t2.add(e3.div(o4.length));
            }, new t.Point(0, 0)), u2 = r3.unproject(c2);
            e2.call(this, o3, {points: s2, point: c2, lngLats: l2, lngLat: u2, originalEvent: a2}), this._defaultPrevented = false;
          }
          e2 && (o2.__proto__ = e2), (o2.prototype = Object.create(e2 && e2.prototype)).constructor = o2;
          var r2 = {defaultPrevented: {configurable: true}};
          return o2.prototype.preventDefault = function() {
            this._defaultPrevented = true;
          }, r2.defaultPrevented.get = function() {
            return this._defaultPrevented;
          }, Object.defineProperties(o2.prototype, r2), o2;
        }(t.Event), Bo = function(t2) {
          function e2(e3, i3, o2) {
            t2.call(this, e3, {originalEvent: o2}), this._defaultPrevented = false;
          }
          t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2;
          var i2 = {defaultPrevented: {configurable: true}};
          return e2.prototype.preventDefault = function() {
            this._defaultPrevented = true;
          }, i2.defaultPrevented.get = function() {
            return this._defaultPrevented;
          }, Object.defineProperties(e2.prototype, i2), e2;
        }(t.Event), Oo = function(t2, e2) {
          this._map = t2, this._clickTolerance = e2.clickTolerance;
        };
        Oo.prototype.reset = function() {
          delete this._mousedownPos;
        }, Oo.prototype.wheel = function(t2) {
          return this._firePreventable(new Bo(t2.type, this._map, t2));
        }, Oo.prototype.mousedown = function(t2, e2) {
          return this._mousedownPos = e2, this._firePreventable(new Ro(t2.type, this._map, t2));
        }, Oo.prototype.mouseup = function(t2) {
          this._map.fire(new Ro(t2.type, this._map, t2));
        }, Oo.prototype.click = function(t2, e2) {
          this._mousedownPos && this._mousedownPos.dist(e2) >= this._clickTolerance || this._map.fire(new Ro(t2.type, this._map, t2));
        }, Oo.prototype.dblclick = function(t2) {
          return this._firePreventable(new Ro(t2.type, this._map, t2));
        }, Oo.prototype.mouseover = function(t2) {
          this._map.fire(new Ro(t2.type, this._map, t2));
        }, Oo.prototype.mouseout = function(t2) {
          this._map.fire(new Ro(t2.type, this._map, t2));
        }, Oo.prototype.touchstart = function(t2) {
          return this._firePreventable(new ko(t2.type, this._map, t2));
        }, Oo.prototype.touchmove = function(t2) {
          this._map.fire(new ko(t2.type, this._map, t2));
        }, Oo.prototype.touchend = function(t2) {
          this._map.fire(new ko(t2.type, this._map, t2));
        }, Oo.prototype.touchcancel = function(t2) {
          this._map.fire(new ko(t2.type, this._map, t2));
        }, Oo.prototype._firePreventable = function(t2) {
          if (this._map.fire(t2), t2.defaultPrevented)
            return {};
        }, Oo.prototype.isEnabled = function() {
          return true;
        }, Oo.prototype.isActive = function() {
          return false;
        }, Oo.prototype.enable = function() {
        }, Oo.prototype.disable = function() {
        };
        var Fo = function(t2) {
          this._map = t2;
        };
        Fo.prototype.reset = function() {
          this._delayContextMenu = false, delete this._contextMenuEvent;
        }, Fo.prototype.mousemove = function(t2) {
          this._map.fire(new Ro(t2.type, this._map, t2));
        }, Fo.prototype.mousedown = function() {
          this._delayContextMenu = true;
        }, Fo.prototype.mouseup = function() {
          this._delayContextMenu = false, this._contextMenuEvent && (this._map.fire(new Ro("contextmenu", this._map, this._contextMenuEvent)), delete this._contextMenuEvent);
        }, Fo.prototype.contextmenu = function(t2) {
          this._delayContextMenu ? this._contextMenuEvent = t2 : this._map.fire(new Ro(t2.type, this._map, t2)), this._map.listens("contextmenu") && t2.preventDefault();
        }, Fo.prototype.isEnabled = function() {
          return true;
        }, Fo.prototype.isActive = function() {
          return false;
        }, Fo.prototype.enable = function() {
        }, Fo.prototype.disable = function() {
        };
        var Uo = function(t2, e2) {
          this._map = t2, this._el = t2.getCanvasContainer(), this._container = t2.getContainer(), this._clickTolerance = e2.clickTolerance || 1;
        };
        function No(t2, e2) {
          for (var i2 = {}, o2 = 0; o2 < t2.length; o2++)
            i2[t2[o2].identifier] = e2[o2];
          return i2;
        }
        Uo.prototype.isEnabled = function() {
          return !!this._enabled;
        }, Uo.prototype.isActive = function() {
          return !!this._active;
        }, Uo.prototype.enable = function() {
          this.isEnabled() || (this._enabled = true);
        }, Uo.prototype.disable = function() {
          this.isEnabled() && (this._enabled = false);
        }, Uo.prototype.mousedown = function(t2, e2) {
          this.isEnabled() && t2.shiftKey && t2.button === 0 && (i.disableDrag(), this._startPos = this._lastPos = e2, this._active = true);
        }, Uo.prototype.mousemoveWindow = function(t2, e2) {
          if (this._active) {
            var o2 = e2;
            if (!(this._lastPos.equals(o2) || !this._box && o2.dist(this._startPos) < this._clickTolerance)) {
              var r2 = this._startPos;
              this._lastPos = o2, this._box || (this._box = i.create("div", "mapboxgl-boxzoom", this._container), this._container.classList.add("mapboxgl-crosshair"), this._fireEvent("boxzoomstart", t2));
              var a2 = Math.min(r2.x, o2.x), n2 = Math.max(r2.x, o2.x), s2 = Math.min(r2.y, o2.y), l2 = Math.max(r2.y, o2.y);
              i.setTransform(this._box, "translate(" + a2 + "px," + s2 + "px)"), this._box.style.width = n2 - a2 + "px", this._box.style.height = l2 - s2 + "px";
            }
          }
        }, Uo.prototype.mouseupWindow = function(e2, o2) {
          var r2 = this;
          if (this._active && e2.button === 0) {
            var a2 = this._startPos, n2 = o2;
            if (this.reset(), i.suppressClick(), a2.x !== n2.x || a2.y !== n2.y)
              return this._map.fire(new t.Event("boxzoomend", {originalEvent: e2})), {cameraAnimation: function(t2) {
                return t2.fitScreenCoordinates(a2, n2, r2._map.getBearing(), {linear: true});
              }};
            this._fireEvent("boxzoomcancel", e2);
          }
        }, Uo.prototype.keydown = function(t2) {
          this._active && t2.keyCode === 27 && (this.reset(), this._fireEvent("boxzoomcancel", t2));
        }, Uo.prototype.reset = function() {
          this._active = false, this._container.classList.remove("mapboxgl-crosshair"), this._box && (i.remove(this._box), this._box = null), i.enableDrag(), delete this._startPos, delete this._lastPos;
        }, Uo.prototype._fireEvent = function(e2, i2) {
          return this._map.fire(new t.Event(e2, {originalEvent: i2}));
        };
        var Zo = function(t2) {
          this.reset(), this.numTouches = t2.numTouches;
        };
        Zo.prototype.reset = function() {
          delete this.centroid, delete this.startTime, delete this.touches, this.aborted = false;
        }, Zo.prototype.touchstart = function(e2, i2, o2) {
          (this.centroid || o2.length > this.numTouches) && (this.aborted = true), this.aborted || (this.startTime === void 0 && (this.startTime = e2.timeStamp), o2.length === this.numTouches && (this.centroid = function(e3) {
            for (var i3 = new t.Point(0, 0), o3 = 0, r2 = e3; o3 < r2.length; o3 += 1)
              i3._add(r2[o3]);
            return i3.div(e3.length);
          }(i2), this.touches = No(o2, i2)));
        }, Zo.prototype.touchmove = function(t2, e2, i2) {
          if (!this.aborted && this.centroid) {
            var o2 = No(i2, e2);
            for (var r2 in this.touches) {
              var a2 = o2[r2];
              (!a2 || a2.dist(this.touches[r2]) > 30) && (this.aborted = true);
            }
          }
        }, Zo.prototype.touchend = function(t2, e2, i2) {
          if ((!this.centroid || t2.timeStamp - this.startTime > 500) && (this.aborted = true), i2.length === 0) {
            var o2 = !this.aborted && this.centroid;
            if (this.reset(), o2)
              return o2;
          }
        };
        var qo = function(t2) {
          this.singleTap = new Zo(t2), this.numTaps = t2.numTaps, this.reset();
        };
        qo.prototype.reset = function() {
          this.lastTime = 1 / 0, delete this.lastTap, this.count = 0, this.singleTap.reset();
        }, qo.prototype.touchstart = function(t2, e2, i2) {
          this.singleTap.touchstart(t2, e2, i2);
        }, qo.prototype.touchmove = function(t2, e2, i2) {
          this.singleTap.touchmove(t2, e2, i2);
        }, qo.prototype.touchend = function(t2, e2, i2) {
          var o2 = this.singleTap.touchend(t2, e2, i2);
          if (o2) {
            var r2 = t2.timeStamp - this.lastTime < 500, a2 = !this.lastTap || this.lastTap.dist(o2) < 30;
            if (r2 && a2 || this.reset(), this.count++, this.lastTime = t2.timeStamp, this.lastTap = o2, this.count === this.numTaps)
              return this.reset(), o2;
          }
        };
        var jo = function() {
          this._zoomIn = new qo({numTouches: 1, numTaps: 2}), this._zoomOut = new qo({numTouches: 2, numTaps: 1}), this.reset();
        };
        jo.prototype.reset = function() {
          this._active = false, this._zoomIn.reset(), this._zoomOut.reset();
        }, jo.prototype.touchstart = function(t2, e2, i2) {
          this._zoomIn.touchstart(t2, e2, i2), this._zoomOut.touchstart(t2, e2, i2);
        }, jo.prototype.touchmove = function(t2, e2, i2) {
          this._zoomIn.touchmove(t2, e2, i2), this._zoomOut.touchmove(t2, e2, i2);
        }, jo.prototype.touchend = function(t2, e2, i2) {
          var o2 = this, r2 = this._zoomIn.touchend(t2, e2, i2), a2 = this._zoomOut.touchend(t2, e2, i2);
          return r2 ? (this._active = true, t2.preventDefault(), setTimeout(function() {
            return o2.reset();
          }, 0), {cameraAnimation: function(e3) {
            return e3.easeTo({duration: 300, zoom: e3.getZoom() + 1, around: e3.unproject(r2)}, {originalEvent: t2});
          }}) : a2 ? (this._active = true, t2.preventDefault(), setTimeout(function() {
            return o2.reset();
          }, 0), {cameraAnimation: function(e3) {
            return e3.easeTo({duration: 300, zoom: e3.getZoom() - 1, around: e3.unproject(a2)}, {originalEvent: t2});
          }}) : void 0;
        }, jo.prototype.touchcancel = function() {
          this.reset();
        }, jo.prototype.enable = function() {
          this._enabled = true;
        }, jo.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, jo.prototype.isEnabled = function() {
          return this._enabled;
        }, jo.prototype.isActive = function() {
          return this._active;
        };
        var Vo = {0: 1, 2: 2}, Go = function(t2) {
          this.reset(), this._clickTolerance = t2.clickTolerance || 1;
        };
        Go.prototype.reset = function() {
          this._active = false, this._moved = false, delete this._lastPoint, delete this._eventButton;
        }, Go.prototype._correctButton = function(t2, e2) {
          return false;
        }, Go.prototype._move = function(t2, e2) {
          return {};
        }, Go.prototype.mousedown = function(t2, e2) {
          if (!this._lastPoint) {
            var o2 = i.mouseButton(t2);
            this._correctButton(t2, o2) && (this._lastPoint = e2, this._eventButton = o2);
          }
        }, Go.prototype.mousemoveWindow = function(t2, e2) {
          var i2 = this._lastPoint;
          if (i2) {
            if (t2.preventDefault(), function(t3, e3) {
              var i3 = Vo[e3];
              return t3.buttons === void 0 || (t3.buttons & i3) !== i3;
            }(t2, this._eventButton))
              this.reset();
            else if (this._moved || !(e2.dist(i2) < this._clickTolerance))
              return this._moved = true, this._lastPoint = e2, this._move(i2, e2);
          }
        }, Go.prototype.mouseupWindow = function(t2) {
          this._lastPoint && i.mouseButton(t2) === this._eventButton && (this._moved && i.suppressClick(), this.reset());
        }, Go.prototype.enable = function() {
          this._enabled = true;
        }, Go.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, Go.prototype.isEnabled = function() {
          return this._enabled;
        }, Go.prototype.isActive = function() {
          return this._active;
        };
        var Wo = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.mousedown = function(e3, i2) {
            t2.prototype.mousedown.call(this, e3, i2), this._lastPoint && (this._active = true);
          }, e2.prototype._correctButton = function(t3, e3) {
            return e3 === 0 && !t3.ctrlKey;
          }, e2.prototype._move = function(t3, e3) {
            return {around: e3, panDelta: e3.sub(t3)};
          }, e2;
        }(Go), Xo = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._correctButton = function(t3, e3) {
            return e3 === 0 && t3.ctrlKey || e3 === 2;
          }, e2.prototype._move = function(t3, e3) {
            var i2 = 0.8 * (e3.x - t3.x);
            if (i2)
              return this._active = true, {bearingDelta: i2};
          }, e2.prototype.contextmenu = function(t3) {
            t3.preventDefault();
          }, e2;
        }(Go), Ho = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype._correctButton = function(t3, e3) {
            return e3 === 0 && t3.ctrlKey || e3 === 2;
          }, e2.prototype._move = function(t3, e3) {
            var i2 = -0.5 * (e3.y - t3.y);
            if (i2)
              return this._active = true, {pitchDelta: i2};
          }, e2.prototype.contextmenu = function(t3) {
            t3.preventDefault();
          }, e2;
        }(Go), Ko = function(t2) {
          this._minTouches = 1, this._clickTolerance = t2.clickTolerance || 1, this.reset();
        };
        Ko.prototype.reset = function() {
          this._active = false, this._touches = {}, this._sum = new t.Point(0, 0);
        }, Ko.prototype.touchstart = function(t2, e2, i2) {
          return this._calculateTransform(t2, e2, i2);
        }, Ko.prototype.touchmove = function(t2, e2, i2) {
          if (this._active && !(i2.length < this._minTouches))
            return t2.preventDefault(), this._calculateTransform(t2, e2, i2);
        }, Ko.prototype.touchend = function(t2, e2, i2) {
          this._calculateTransform(t2, e2, i2), this._active && i2.length < this._minTouches && this.reset();
        }, Ko.prototype.touchcancel = function() {
          this.reset();
        }, Ko.prototype._calculateTransform = function(e2, i2, o2) {
          o2.length > 0 && (this._active = true);
          var r2 = No(o2, i2), a2 = new t.Point(0, 0), n2 = new t.Point(0, 0), s2 = 0;
          for (var l2 in r2) {
            var c2 = r2[l2], u2 = this._touches[l2];
            u2 && (a2._add(c2), n2._add(c2.sub(u2)), s2++, r2[l2] = c2);
          }
          if (this._touches = r2, !(s2 < this._minTouches) && n2.mag()) {
            var h2 = n2.div(s2);
            if (this._sum._add(h2), !(this._sum.mag() < this._clickTolerance))
              return {around: a2.div(s2), panDelta: h2};
          }
        }, Ko.prototype.enable = function() {
          this._enabled = true;
        }, Ko.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, Ko.prototype.isEnabled = function() {
          return this._enabled;
        }, Ko.prototype.isActive = function() {
          return this._active;
        };
        var Yo = function() {
          this.reset();
        };
        function Jo(t2, e2, i2) {
          for (var o2 = 0; o2 < t2.length; o2++)
            if (t2[o2].identifier === i2)
              return e2[o2];
        }
        function Qo(t2, e2) {
          return Math.log(t2 / e2) / Math.LN2;
        }
        Yo.prototype.reset = function() {
          this._active = false, delete this._firstTwoTouches;
        }, Yo.prototype._start = function(t2) {
        }, Yo.prototype._move = function(t2, e2, i2) {
          return {};
        }, Yo.prototype.touchstart = function(t2, e2, i2) {
          this._firstTwoTouches || i2.length < 2 || (this._firstTwoTouches = [i2[0].identifier, i2[1].identifier], this._start([e2[0], e2[1]]));
        }, Yo.prototype.touchmove = function(t2, e2, i2) {
          if (this._firstTwoTouches) {
            t2.preventDefault();
            var o2 = this._firstTwoTouches, r2 = o2[1], a2 = Jo(i2, e2, o2[0]), n2 = Jo(i2, e2, r2);
            if (a2 && n2) {
              var s2 = this._aroundCenter ? null : a2.add(n2).div(2);
              return this._move([a2, n2], s2, t2);
            }
          }
        }, Yo.prototype.touchend = function(t2, e2, o2) {
          if (this._firstTwoTouches) {
            var r2 = this._firstTwoTouches, a2 = r2[1], n2 = Jo(o2, e2, r2[0]), s2 = Jo(o2, e2, a2);
            n2 && s2 || (this._active && i.suppressClick(), this.reset());
          }
        }, Yo.prototype.touchcancel = function() {
          this.reset();
        }, Yo.prototype.enable = function(t2) {
          this._enabled = true, this._aroundCenter = !!t2 && t2.around === "center";
        }, Yo.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, Yo.prototype.isEnabled = function() {
          return this._enabled;
        }, Yo.prototype.isActive = function() {
          return this._active;
        };
        var $o = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.reset = function() {
            t2.prototype.reset.call(this), delete this._distance, delete this._startDistance;
          }, e2.prototype._start = function(t3) {
            this._startDistance = this._distance = t3[0].dist(t3[1]);
          }, e2.prototype._move = function(t3, e3) {
            var i2 = this._distance;
            if (this._distance = t3[0].dist(t3[1]), this._active || !(Math.abs(Qo(this._distance, this._startDistance)) < 0.1))
              return this._active = true, {zoomDelta: Qo(this._distance, i2), pinchAround: e3};
          }, e2;
        }(Yo);
        function tr(t2, e2) {
          return 180 * t2.angleWith(e2) / Math.PI;
        }
        var er = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.reset = function() {
            t2.prototype.reset.call(this), delete this._minDiameter, delete this._startVector, delete this._vector;
          }, e2.prototype._start = function(t3) {
            this._startVector = this._vector = t3[0].sub(t3[1]), this._minDiameter = t3[0].dist(t3[1]);
          }, e2.prototype._move = function(t3, e3) {
            var i2 = this._vector;
            if (this._vector = t3[0].sub(t3[1]), this._active || !this._isBelowThreshold(this._vector))
              return this._active = true, {bearingDelta: tr(this._vector, i2), pinchAround: e3};
          }, e2.prototype._isBelowThreshold = function(t3) {
            this._minDiameter = Math.min(this._minDiameter, t3.mag());
            var e3 = 25 / (Math.PI * this._minDiameter) * 360, i2 = tr(t3, this._startVector);
            return Math.abs(i2) < e3;
          }, e2;
        }(Yo);
        function ir(t2) {
          return Math.abs(t2.y) > Math.abs(t2.x);
        }
        var or = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2.prototype.reset = function() {
            t2.prototype.reset.call(this), this._valid = void 0, delete this._firstMove, delete this._lastPoints;
          }, e2.prototype._start = function(t3) {
            this._lastPoints = t3, ir(t3[0].sub(t3[1])) && (this._valid = false);
          }, e2.prototype._move = function(t3, e3, i2) {
            var o2 = t3[0].sub(this._lastPoints[0]), r2 = t3[1].sub(this._lastPoints[1]);
            if (this._valid = this.gestureBeginsVertically(o2, r2, i2.timeStamp), this._valid)
              return this._lastPoints = t3, this._active = true, {pitchDelta: (o2.y + r2.y) / 2 * -0.5};
          }, e2.prototype.gestureBeginsVertically = function(t3, e3, i2) {
            if (this._valid !== void 0)
              return this._valid;
            var o2 = t3.mag() >= 2, r2 = e3.mag() >= 2;
            if (o2 || r2) {
              if (!o2 || !r2)
                return this._firstMove === void 0 && (this._firstMove = i2), i2 - this._firstMove < 100 && void 0;
              var a2 = t3.y > 0 == e3.y > 0;
              return ir(t3) && ir(e3) && a2;
            }
          }, e2;
        }(Yo), rr = {panStep: 100, bearingStep: 15, pitchStep: 10}, ar = function() {
          var t2 = rr;
          this._panStep = t2.panStep, this._bearingStep = t2.bearingStep, this._pitchStep = t2.pitchStep, this._rotationDisabled = false;
        };
        function nr(t2) {
          return t2 * (2 - t2);
        }
        ar.prototype.reset = function() {
          this._active = false;
        }, ar.prototype.keydown = function(t2) {
          var e2 = this;
          if (!(t2.altKey || t2.ctrlKey || t2.metaKey)) {
            var i2 = 0, o2 = 0, r2 = 0, a2 = 0, n2 = 0;
            switch (t2.keyCode) {
              case 61:
              case 107:
              case 171:
              case 187:
                i2 = 1;
                break;
              case 189:
              case 109:
              case 173:
                i2 = -1;
                break;
              case 37:
                t2.shiftKey ? o2 = -1 : (t2.preventDefault(), a2 = -1);
                break;
              case 39:
                t2.shiftKey ? o2 = 1 : (t2.preventDefault(), a2 = 1);
                break;
              case 38:
                t2.shiftKey ? r2 = 1 : (t2.preventDefault(), n2 = -1);
                break;
              case 40:
                t2.shiftKey ? r2 = -1 : (t2.preventDefault(), n2 = 1);
                break;
              default:
                return;
            }
            return this._rotationDisabled && (o2 = 0, r2 = 0), {cameraAnimation: function(s2) {
              var l2 = s2.getZoom();
              s2.easeTo({duration: 300, easeId: "keyboardHandler", easing: nr, zoom: i2 ? Math.round(l2) + i2 * (t2.shiftKey ? 2 : 1) : l2, bearing: s2.getBearing() + o2 * e2._bearingStep, pitch: s2.getPitch() + r2 * e2._pitchStep, offset: [-a2 * e2._panStep, -n2 * e2._panStep], center: s2.getCenter()}, {originalEvent: t2});
            }};
          }
        }, ar.prototype.enable = function() {
          this._enabled = true;
        }, ar.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, ar.prototype.isEnabled = function() {
          return this._enabled;
        }, ar.prototype.isActive = function() {
          return this._active;
        }, ar.prototype.disableRotation = function() {
          this._rotationDisabled = true;
        }, ar.prototype.enableRotation = function() {
          this._rotationDisabled = false;
        };
        var sr = function(e2, i2) {
          this._map = e2, this._el = e2.getCanvasContainer(), this._handler = i2, this._delta = 0, this._defaultZoomRate = 0.01, this._wheelZoomRate = 1 / 450, t.bindAll(["_onTimeout"], this);
        };
        sr.prototype.setZoomRate = function(t2) {
          this._defaultZoomRate = t2;
        }, sr.prototype.setWheelZoomRate = function(t2) {
          this._wheelZoomRate = t2;
        }, sr.prototype.isEnabled = function() {
          return !!this._enabled;
        }, sr.prototype.isActive = function() {
          return !!this._active || this._finishTimeout !== void 0;
        }, sr.prototype.isZooming = function() {
          return !!this._zooming;
        }, sr.prototype.enable = function(t2) {
          this.isEnabled() || (this._enabled = true, this._aroundCenter = t2 && t2.around === "center");
        }, sr.prototype.disable = function() {
          this.isEnabled() && (this._enabled = false);
        }, sr.prototype.wheel = function(e2) {
          if (this.isEnabled()) {
            var i2 = e2.deltaMode === t.window.WheelEvent.DOM_DELTA_LINE ? 40 * e2.deltaY : e2.deltaY, o2 = t.browser.now(), r2 = o2 - (this._lastWheelEventTime || 0);
            this._lastWheelEventTime = o2, i2 !== 0 && i2 % 4.000244140625 == 0 ? this._type = "wheel" : i2 !== 0 && Math.abs(i2) < 4 ? this._type = "trackpad" : r2 > 400 ? (this._type = null, this._lastValue = i2, this._timeout = setTimeout(this._onTimeout, 40, e2)) : this._type || (this._type = Math.abs(r2 * i2) < 200 ? "trackpad" : "wheel", this._timeout && (clearTimeout(this._timeout), this._timeout = null, i2 += this._lastValue)), e2.shiftKey && i2 && (i2 /= 4), this._type && (this._lastWheelEvent = e2, this._delta -= i2, this._active || this._start(e2)), e2.preventDefault();
          }
        }, sr.prototype._onTimeout = function(t2) {
          this._type = "wheel", this._delta -= this._lastValue, this._active || this._start(t2);
        }, sr.prototype._start = function(e2) {
          if (this._delta) {
            this._frameId && (this._frameId = null), this._active = true, this.isZooming() || (this._zooming = true), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);
            var o2 = i.mousePos(this._el, e2);
            this._around = t.LngLat.convert(this._aroundCenter ? this._map.getCenter() : this._map.unproject(o2)), this._aroundPoint = this._map.transform.locationPoint(this._around), this._frameId || (this._frameId = true, this._handler._triggerRenderFrame());
          }
        }, sr.prototype.renderFrame = function() {
          var e2 = this;
          if (this._frameId && (this._frameId = null, this.isActive())) {
            var i2 = this._map.transform;
            if (this._delta !== 0) {
              var o2 = this._type === "wheel" && Math.abs(this._delta) > 4.000244140625 ? this._wheelZoomRate : this._defaultZoomRate, r2 = 2 / (1 + Math.exp(-Math.abs(this._delta * o2)));
              this._delta < 0 && r2 !== 0 && (r2 = 1 / r2);
              var a2 = typeof this._targetZoom == "number" ? i2.zoomScale(this._targetZoom) : i2.scale;
              this._targetZoom = Math.min(i2.maxZoom, Math.max(i2.minZoom, i2.scaleZoom(a2 * r2))), this._type === "wheel" && (this._startZoom = i2.zoom, this._easing = this._smoothOutEasing(200)), this._delta = 0;
            }
            var n2, s2 = typeof this._targetZoom == "number" ? this._targetZoom : i2.zoom, l2 = this._startZoom, c2 = this._easing, u2 = false;
            if (this._type === "wheel" && l2 && c2) {
              var h2 = Math.min((t.browser.now() - this._lastWheelEventTime) / 200, 1), p2 = c2(h2);
              n2 = t.number(l2, s2, p2), h2 < 1 ? this._frameId || (this._frameId = true) : u2 = true;
            } else
              n2 = s2, u2 = true;
            return this._active = true, u2 && (this._active = false, this._finishTimeout = setTimeout(function() {
              e2._zooming = false, e2._handler._triggerRenderFrame(), delete e2._targetZoom, delete e2._finishTimeout;
            }, 200)), {noInertia: true, needsRenderFrame: !u2, zoomDelta: n2 - i2.zoom, around: this._aroundPoint, originalEvent: this._lastWheelEvent};
          }
        }, sr.prototype._smoothOutEasing = function(e2) {
          var i2 = t.ease;
          if (this._prevEase) {
            var o2 = this._prevEase, r2 = (t.browser.now() - o2.start) / o2.duration, a2 = o2.easing(r2 + 0.01) - o2.easing(r2), n2 = 0.27 / Math.sqrt(a2 * a2 + 1e-4) * 0.01, s2 = Math.sqrt(0.0729 - n2 * n2);
            i2 = t.bezier(n2, s2, 0.25, 1);
          }
          return this._prevEase = {start: t.browser.now(), duration: e2, easing: i2}, i2;
        }, sr.prototype.reset = function() {
          this._active = false;
        };
        var lr = function(t2, e2) {
          this._clickZoom = t2, this._tapZoom = e2;
        };
        lr.prototype.enable = function() {
          this._clickZoom.enable(), this._tapZoom.enable();
        }, lr.prototype.disable = function() {
          this._clickZoom.disable(), this._tapZoom.disable();
        }, lr.prototype.isEnabled = function() {
          return this._clickZoom.isEnabled() && this._tapZoom.isEnabled();
        }, lr.prototype.isActive = function() {
          return this._clickZoom.isActive() || this._tapZoom.isActive();
        };
        var cr = function() {
          this.reset();
        };
        cr.prototype.reset = function() {
          this._active = false;
        }, cr.prototype.dblclick = function(t2, e2) {
          return t2.preventDefault(), {cameraAnimation: function(i2) {
            i2.easeTo({duration: 300, zoom: i2.getZoom() + (t2.shiftKey ? -1 : 1), around: i2.unproject(e2)}, {originalEvent: t2});
          }};
        }, cr.prototype.enable = function() {
          this._enabled = true;
        }, cr.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, cr.prototype.isEnabled = function() {
          return this._enabled;
        }, cr.prototype.isActive = function() {
          return this._active;
        };
        var ur = function() {
          this._tap = new qo({numTouches: 1, numTaps: 1}), this.reset();
        };
        ur.prototype.reset = function() {
          this._active = false, delete this._swipePoint, delete this._swipeTouch, delete this._tapTime, this._tap.reset();
        }, ur.prototype.touchstart = function(t2, e2, i2) {
          this._swipePoint || (this._tapTime && t2.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? i2.length > 0 && (this._swipePoint = e2[0], this._swipeTouch = i2[0].identifier) : this._tap.touchstart(t2, e2, i2));
        }, ur.prototype.touchmove = function(t2, e2, i2) {
          if (this._tapTime) {
            if (this._swipePoint) {
              if (i2[0].identifier !== this._swipeTouch)
                return;
              var o2 = e2[0], r2 = o2.y - this._swipePoint.y;
              return this._swipePoint = o2, t2.preventDefault(), this._active = true, {zoomDelta: r2 / 128};
            }
          } else
            this._tap.touchmove(t2, e2, i2);
        }, ur.prototype.touchend = function(t2, e2, i2) {
          this._tapTime ? this._swipePoint && i2.length === 0 && this.reset() : this._tap.touchend(t2, e2, i2) && (this._tapTime = t2.timeStamp);
        }, ur.prototype.touchcancel = function() {
          this.reset();
        }, ur.prototype.enable = function() {
          this._enabled = true;
        }, ur.prototype.disable = function() {
          this._enabled = false, this.reset();
        }, ur.prototype.isEnabled = function() {
          return this._enabled;
        }, ur.prototype.isActive = function() {
          return this._active;
        };
        var hr = function(t2, e2, i2) {
          this._el = t2, this._mousePan = e2, this._touchPan = i2;
        };
        hr.prototype.enable = function(t2) {
          this._inertiaOptions = t2 || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add("mapboxgl-touch-drag-pan");
        }, hr.prototype.disable = function() {
          this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove("mapboxgl-touch-drag-pan");
        }, hr.prototype.isEnabled = function() {
          return this._mousePan.isEnabled() && this._touchPan.isEnabled();
        }, hr.prototype.isActive = function() {
          return this._mousePan.isActive() || this._touchPan.isActive();
        };
        var pr = function(t2, e2, i2) {
          this._pitchWithRotate = t2.pitchWithRotate, this._mouseRotate = e2, this._mousePitch = i2;
        };
        pr.prototype.enable = function() {
          this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable();
        }, pr.prototype.disable = function() {
          this._mouseRotate.disable(), this._mousePitch.disable();
        }, pr.prototype.isEnabled = function() {
          return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled());
        }, pr.prototype.isActive = function() {
          return this._mouseRotate.isActive() || this._mousePitch.isActive();
        };
        var dr = function(t2, e2, i2, o2) {
          this._el = t2, this._touchZoom = e2, this._touchRotate = i2, this._tapDragZoom = o2, this._rotationDisabled = false, this._enabled = true;
        };
        dr.prototype.enable = function(t2) {
          this._touchZoom.enable(t2), this._rotationDisabled || this._touchRotate.enable(t2), this._tapDragZoom.enable(), this._el.classList.add("mapboxgl-touch-zoom-rotate");
        }, dr.prototype.disable = function() {
          this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove("mapboxgl-touch-zoom-rotate");
        }, dr.prototype.isEnabled = function() {
          return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled();
        }, dr.prototype.isActive = function() {
          return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive();
        }, dr.prototype.disableRotation = function() {
          this._rotationDisabled = true, this._touchRotate.disable();
        }, dr.prototype.enableRotation = function() {
          this._rotationDisabled = false, this._touchZoom.isEnabled() && this._touchRotate.enable();
        };
        var _r = function(t2) {
          return t2.zoom || t2.drag || t2.pitch || t2.rotate;
        }, fr = function(t2) {
          function e2() {
            t2.apply(this, arguments);
          }
          return t2 && (e2.__proto__ = t2), (e2.prototype = Object.create(t2 && t2.prototype)).constructor = e2, e2;
        }(t.Event);
        function mr(t2) {
          return t2.panDelta && t2.panDelta.mag() || t2.zoomDelta || t2.bearingDelta || t2.pitchDelta;
        }
        var gr = function(e2, o2) {
          this._map = e2, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new Ao(e2), this._bearingSnap = o2.bearingSnap, this._previousActiveHandlers = {}, this._eventsInProgress = {}, this._addDefaultHandlers(o2), t.bindAll(["handleEvent", "handleWindowEvent"], this);
          var r2 = this._el;
          this._listeners = [[r2, "touchstart", {passive: true}], [r2, "touchmove", {passive: false}], [r2, "touchend", void 0], [r2, "touchcancel", void 0], [r2, "mousedown", void 0], [r2, "mousemove", void 0], [r2, "mouseup", void 0], [t.window.document, "mousemove", {capture: true}], [t.window.document, "mouseup", void 0], [r2, "mouseover", void 0], [r2, "mouseout", void 0], [r2, "dblclick", void 0], [r2, "click", void 0], [r2, "keydown", {capture: false}], [r2, "keyup", void 0], [r2, "wheel", {passive: false}], [r2, "contextmenu", void 0], [t.window, "blur", void 0]];
          for (var a2 = 0, n2 = this._listeners; a2 < n2.length; a2 += 1) {
            var s2 = n2[a2], l2 = s2[0];
            i.addEventListener(l2, s2[1], l2 === t.window.document ? this.handleWindowEvent : this.handleEvent, s2[2]);
          }
        };
        gr.prototype.destroy = function() {
          for (var e2 = 0, o2 = this._listeners; e2 < o2.length; e2 += 1) {
            var r2 = o2[e2], a2 = r2[0];
            i.removeEventListener(a2, r2[1], a2 === t.window.document ? this.handleWindowEvent : this.handleEvent, r2[2]);
          }
        }, gr.prototype._addDefaultHandlers = function(t2) {
          var e2 = this._map, i2 = e2.getCanvasContainer();
          this._add("mapEvent", new Oo(e2, t2));
          var o2 = e2.boxZoom = new Uo(e2, t2);
          this._add("boxZoom", o2);
          var r2 = new jo(), a2 = new cr();
          e2.doubleClickZoom = new lr(a2, r2), this._add("tapZoom", r2), this._add("clickZoom", a2);
          var n2 = new ur();
          this._add("tapDragZoom", n2);
          var s2 = e2.touchPitch = new or();
          this._add("touchPitch", s2);
          var l2 = new Xo(t2), c2 = new Ho(t2);
          e2.dragRotate = new pr(t2, l2, c2), this._add("mouseRotate", l2, ["mousePitch"]), this._add("mousePitch", c2, ["mouseRotate"]);
          var u2 = new Wo(t2), h2 = new Ko(t2);
          e2.dragPan = new hr(i2, u2, h2), this._add("mousePan", u2), this._add("touchPan", h2, ["touchZoom", "touchRotate"]);
          var p2 = new er(), d2 = new $o();
          e2.touchZoomRotate = new dr(i2, d2, p2, n2), this._add("touchRotate", p2, ["touchPan", "touchZoom"]), this._add("touchZoom", d2, ["touchPan", "touchRotate"]);
          var _2 = e2.scrollZoom = new sr(e2, this);
          this._add("scrollZoom", _2, ["mousePan"]);
          var f2 = e2.keyboard = new ar();
          this._add("keyboard", f2), this._add("blockableMapEvent", new Fo(e2));
          for (var m2 = 0, g2 = ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"]; m2 < g2.length; m2 += 1) {
            var v2 = g2[m2];
            t2.interactive && t2[v2] && e2[v2].enable(t2[v2]);
          }
        }, gr.prototype._add = function(t2, e2, i2) {
          this._handlers.push({handlerName: t2, handler: e2, allowed: i2}), this._handlersById[t2] = e2;
        }, gr.prototype.stop = function(t2) {
          if (!this._updatingCamera) {
            for (var e2 = 0, i2 = this._handlers; e2 < i2.length; e2 += 1)
              i2[e2].handler.reset();
            this._inertia.clear(), this._fireEvents({}, {}, t2), this._changes = [];
          }
        }, gr.prototype.isActive = function() {
          for (var t2 = 0, e2 = this._handlers; t2 < e2.length; t2 += 1)
            if (e2[t2].handler.isActive())
              return true;
          return false;
        }, gr.prototype.isZooming = function() {
          return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming();
        }, gr.prototype.isRotating = function() {
          return !!this._eventsInProgress.rotate;
        }, gr.prototype.isMoving = function() {
          return Boolean(_r(this._eventsInProgress)) || this.isZooming();
        }, gr.prototype._blockedByActive = function(t2, e2, i2) {
          for (var o2 in t2)
            if (o2 !== i2 && (!e2 || e2.indexOf(o2) < 0))
              return true;
          return false;
        }, gr.prototype.handleWindowEvent = function(t2) {
          this.handleEvent(t2, t2.type + "Window");
        }, gr.prototype._getMapTouches = function(t2) {
          for (var e2 = [], i2 = 0, o2 = t2; i2 < o2.length; i2 += 1) {
            var r2 = o2[i2];
            this._el.contains(r2.target) && e2.push(r2);
          }
          return e2;
        }, gr.prototype.handleEvent = function(t2, e2) {
          if (t2.type !== "blur") {
            this._updatingCamera = true;
            for (var o2 = t2.type === "renderFrame" ? void 0 : t2, r2 = {needsRenderFrame: false}, a2 = {}, n2 = {}, s2 = t2.touches ? this._getMapTouches(t2.touches) : void 0, l2 = s2 ? i.touchPos(this._el, s2) : i.mousePos(this._el, t2), c2 = 0, u2 = this._handlers; c2 < u2.length; c2 += 1) {
              var h2 = u2[c2], p2 = h2.handlerName, d2 = h2.handler, _2 = h2.allowed;
              if (d2.isEnabled()) {
                var f2 = void 0;
                this._blockedByActive(n2, _2, p2) ? d2.reset() : d2[e2 || t2.type] && (f2 = d2[e2 || t2.type](t2, l2, s2), this.mergeHandlerResult(r2, a2, f2, p2, o2), f2 && f2.needsRenderFrame && this._triggerRenderFrame()), (f2 || d2.isActive()) && (n2[p2] = d2);
              }
            }
            var m2 = {};
            for (var g2 in this._previousActiveHandlers)
              n2[g2] || (m2[g2] = o2);
            this._previousActiveHandlers = n2, (Object.keys(m2).length || mr(r2)) && (this._changes.push([r2, a2, m2]), this._triggerRenderFrame()), (Object.keys(n2).length || mr(r2)) && this._map._stop(true), this._updatingCamera = false;
            var v2 = r2.cameraAnimation;
            v2 && (this._inertia.clear(), this._fireEvents({}, {}, true), this._changes = [], v2(this._map));
          } else
            this.stop(true);
        }, gr.prototype.mergeHandlerResult = function(e2, i2, o2, r2, a2) {
          if (o2) {
            t.extend(e2, o2);
            var n2 = {handlerName: r2, originalEvent: o2.originalEvent || a2};
            o2.zoomDelta !== void 0 && (i2.zoom = n2), o2.panDelta !== void 0 && (i2.drag = n2), o2.pitchDelta !== void 0 && (i2.pitch = n2), o2.bearingDelta !== void 0 && (i2.rotate = n2);
          }
        }, gr.prototype._applyChanges = function() {
          for (var e2 = {}, i2 = {}, o2 = {}, r2 = 0, a2 = this._changes; r2 < a2.length; r2 += 1) {
            var n2 = a2[r2], s2 = n2[0], l2 = n2[1], c2 = n2[2];
            s2.panDelta && (e2.panDelta = (e2.panDelta || new t.Point(0, 0))._add(s2.panDelta)), s2.zoomDelta && (e2.zoomDelta = (e2.zoomDelta || 0) + s2.zoomDelta), s2.bearingDelta && (e2.bearingDelta = (e2.bearingDelta || 0) + s2.bearingDelta), s2.pitchDelta && (e2.pitchDelta = (e2.pitchDelta || 0) + s2.pitchDelta), s2.around !== void 0 && (e2.around = s2.around), s2.pinchAround !== void 0 && (e2.pinchAround = s2.pinchAround), s2.noInertia && (e2.noInertia = s2.noInertia), t.extend(i2, l2), t.extend(o2, c2);
          }
          this._updateMapTransform(e2, i2, o2), this._changes = [];
        }, gr.prototype._updateMapTransform = function(t2, e2, i2) {
          var o2 = this._map, r2 = o2.transform;
          if (!mr(t2))
            return this._fireEvents(e2, i2, true);
          var a2 = t2.panDelta, n2 = t2.zoomDelta, s2 = t2.bearingDelta, l2 = t2.pitchDelta, c2 = t2.around, u2 = t2.pinchAround;
          u2 !== void 0 && (c2 = u2), o2._stop(true), c2 = c2 || o2.transform.centerPoint;
          var h2 = r2.pointLocation(a2 ? c2.sub(a2) : c2);
          s2 && (r2.bearing += s2), l2 && (r2.pitch += l2), n2 && (r2.zoom += n2), r2.setLocationAtPoint(h2, c2), this._map._update(), t2.noInertia || this._inertia.record(t2), this._fireEvents(e2, i2, true);
        }, gr.prototype._fireEvents = function(e2, i2, o2) {
          var r2 = this, a2 = _r(this._eventsInProgress), n2 = _r(e2), s2 = {};
          for (var l2 in e2)
            this._eventsInProgress[l2] || (s2[l2 + "start"] = e2[l2].originalEvent), this._eventsInProgress[l2] = e2[l2];
          for (var c2 in !a2 && n2 && this._fireEvent("movestart", n2.originalEvent), s2)
            this._fireEvent(c2, s2[c2]);
          for (var u2 in n2 && this._fireEvent("move", n2.originalEvent), e2)
            this._fireEvent(u2, e2[u2].originalEvent);
          var h2, p2 = {};
          for (var d2 in this._eventsInProgress) {
            var _2 = this._eventsInProgress[d2], f2 = _2.handlerName, m2 = _2.originalEvent;
            this._handlersById[f2].isActive() || (delete this._eventsInProgress[d2], p2[d2 + "end"] = h2 = i2[f2] || m2);
          }
          for (var g2 in p2)
            this._fireEvent(g2, p2[g2]);
          var v2 = _r(this._eventsInProgress);
          if (o2 && (a2 || n2) && !v2) {
            this._updatingCamera = true;
            var y2 = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions), x2 = function(t2) {
              return t2 !== 0 && -r2._bearingSnap < t2 && t2 < r2._bearingSnap;
            };
            y2 ? (x2(y2.bearing || this._map.getBearing()) && (y2.bearing = 0), this._map.easeTo(y2, {originalEvent: h2})) : (this._map.fire(new t.Event("moveend", {originalEvent: h2})), x2(this._map.getBearing()) && this._map.resetNorth()), this._updatingCamera = false;
          }
        }, gr.prototype._fireEvent = function(e2, i2) {
          this._map.fire(new t.Event(e2, i2 ? {originalEvent: i2} : {}));
        }, gr.prototype._requestFrame = function() {
          var t2 = this;
          return this._map.triggerRepaint(), this._map._renderTaskQueue.add(function(e2) {
            delete t2._frameId, t2.handleEvent(new fr("renderFrame", {timeStamp: e2})), t2._applyChanges();
          });
        }, gr.prototype._triggerRenderFrame = function() {
          this._frameId === void 0 && (this._frameId = this._requestFrame());
        };
        var vr = function(e2) {
          function i2(i3, o2) {
            e2.call(this), this._moving = false, this._zooming = false, this.transform = i3, this._bearingSnap = o2.bearingSnap, t.bindAll(["_renderFrameCallback"], this);
          }
          return e2 && (i2.__proto__ = e2), (i2.prototype = Object.create(e2 && e2.prototype)).constructor = i2, i2.prototype.getCenter = function() {
            return new t.LngLat(this.transform.center.lng, this.transform.center.lat);
          }, i2.prototype.setCenter = function(t2, e3) {
            return this.jumpTo({center: t2}, e3);
          }, i2.prototype.panBy = function(e3, i3, o2) {
            return e3 = t.Point.convert(e3).mult(-1), this.panTo(this.transform.center, t.extend({offset: e3}, i3), o2);
          }, i2.prototype.panTo = function(e3, i3, o2) {
            return this.easeTo(t.extend({center: e3}, i3), o2);
          }, i2.prototype.getZoom = function() {
            return this.transform.zoom;
          }, i2.prototype.setZoom = function(t2, e3) {
            return this.jumpTo({zoom: t2}, e3), this;
          }, i2.prototype.zoomTo = function(e3, i3, o2) {
            return this.easeTo(t.extend({zoom: e3}, i3), o2);
          }, i2.prototype.zoomIn = function(t2, e3) {
            return this.zoomTo(this.getZoom() + 1, t2, e3), this;
          }, i2.prototype.zoomOut = function(t2, e3) {
            return this.zoomTo(this.getZoom() - 1, t2, e3), this;
          }, i2.prototype.getBearing = function() {
            return this.transform.bearing;
          }, i2.prototype.setBearing = function(t2, e3) {
            return this.jumpTo({bearing: t2}, e3), this;
          }, i2.prototype.getPadding = function() {
            return this.transform.padding;
          }, i2.prototype.setPadding = function(t2, e3) {
            return this.jumpTo({padding: t2}, e3), this;
          }, i2.prototype.rotateTo = function(e3, i3, o2) {
            return this.easeTo(t.extend({bearing: e3}, i3), o2);
          }, i2.prototype.resetNorth = function(e3, i3) {
            return this.rotateTo(0, t.extend({duration: 1e3}, e3), i3), this;
          }, i2.prototype.resetNorthPitch = function(e3, i3) {
            return this.easeTo(t.extend({bearing: 0, pitch: 0, duration: 1e3}, e3), i3), this;
          }, i2.prototype.snapToNorth = function(t2, e3) {
            return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(t2, e3) : this;
          }, i2.prototype.getPitch = function() {
            return this.transform.pitch;
          }, i2.prototype.setPitch = function(t2, e3) {
            return this.jumpTo({pitch: t2}, e3), this;
          }, i2.prototype.cameraForBounds = function(e3, i3) {
            e3 = t.LngLatBounds.convert(e3);
            var o2 = i3 && i3.bearing || 0;
            return this._cameraForBoxAndBearing(e3.getNorthWest(), e3.getSouthEast(), o2, i3);
          }, i2.prototype._cameraForBoxAndBearing = function(e3, i3, o2, r2) {
            var a2 = {top: 0, bottom: 0, right: 0, left: 0};
            if (typeof (r2 = t.extend({padding: a2, offset: [0, 0], maxZoom: this.transform.maxZoom}, r2)).padding == "number") {
              var n2 = r2.padding;
              r2.padding = {top: n2, bottom: n2, right: n2, left: n2};
            }
            r2.padding = t.extend(a2, r2.padding);
            var s2 = this.transform, l2 = s2.padding, c2 = s2.project(t.LngLat.convert(e3)), u2 = s2.project(t.LngLat.convert(i3)), h2 = c2.rotate(-o2 * Math.PI / 180), p2 = u2.rotate(-o2 * Math.PI / 180), d2 = new t.Point(Math.max(h2.x, p2.x), Math.max(h2.y, p2.y)), _2 = new t.Point(Math.min(h2.x, p2.x), Math.min(h2.y, p2.y)), f2 = d2.sub(_2), m2 = (s2.width - (l2.left + l2.right + r2.padding.left + r2.padding.right)) / f2.x, g2 = (s2.height - (l2.top + l2.bottom + r2.padding.top + r2.padding.bottom)) / f2.y;
            if (!(g2 < 0 || m2 < 0)) {
              var v2 = Math.min(s2.scaleZoom(s2.scale * Math.min(m2, g2)), r2.maxZoom), y2 = typeof r2.offset.x == "number" ? new t.Point(r2.offset.x, r2.offset.y) : t.Point.convert(r2.offset), x2 = new t.Point((r2.padding.left - r2.padding.right) / 2, (r2.padding.top - r2.padding.bottom) / 2).rotate(o2 * Math.PI / 180), b2 = y2.add(x2).mult(s2.scale / s2.zoomScale(v2));
              return {center: s2.unproject(c2.add(u2).div(2).sub(b2)), zoom: v2, bearing: o2};
            }
            t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
          }, i2.prototype.fitBounds = function(t2, e3, i3) {
            return this._fitInternal(this.cameraForBounds(t2, e3), e3, i3);
          }, i2.prototype.fitScreenCoordinates = function(e3, i3, o2, r2, a2) {
            return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e3)), this.transform.pointLocation(t.Point.convert(i3)), o2, r2), r2, a2);
          }, i2.prototype._fitInternal = function(e3, i3, o2) {
            return e3 ? (delete (i3 = t.extend(e3, i3)).padding, i3.linear ? this.easeTo(i3, o2) : this.flyTo(i3, o2)) : this;
          }, i2.prototype.jumpTo = function(e3, i3) {
            this.stop();
            var o2 = this.transform, r2 = false, a2 = false, n2 = false;
            return "zoom" in e3 && o2.zoom !== +e3.zoom && (r2 = true, o2.zoom = +e3.zoom), e3.center !== void 0 && (o2.center = t.LngLat.convert(e3.center)), "bearing" in e3 && o2.bearing !== +e3.bearing && (a2 = true, o2.bearing = +e3.bearing), "pitch" in e3 && o2.pitch !== +e3.pitch && (n2 = true, o2.pitch = +e3.pitch), e3.padding == null || o2.isPaddingEqual(e3.padding) || (o2.padding = e3.padding), this.fire(new t.Event("movestart", i3)).fire(new t.Event("move", i3)), r2 && this.fire(new t.Event("zoomstart", i3)).fire(new t.Event("zoom", i3)).fire(new t.Event("zoomend", i3)), a2 && this.fire(new t.Event("rotatestart", i3)).fire(new t.Event("rotate", i3)).fire(new t.Event("rotateend", i3)), n2 && this.fire(new t.Event("pitchstart", i3)).fire(new t.Event("pitch", i3)).fire(new t.Event("pitchend", i3)), this.fire(new t.Event("moveend", i3));
          }, i2.prototype.easeTo = function(e3, i3) {
            var o2 = this;
            this._stop(false, e3.easeId), ((e3 = t.extend({offset: [0, 0], duration: 500, easing: t.ease}, e3)).animate === false || !e3.essential && t.browser.prefersReducedMotion) && (e3.duration = 0);
            var r2 = this.transform, a2 = this.getZoom(), n2 = this.getBearing(), s2 = this.getPitch(), l2 = this.getPadding(), c2 = "zoom" in e3 ? +e3.zoom : a2, u2 = "bearing" in e3 ? this._normalizeBearing(e3.bearing, n2) : n2, h2 = "pitch" in e3 ? +e3.pitch : s2, p2 = "padding" in e3 ? e3.padding : r2.padding, d2 = t.Point.convert(e3.offset), _2 = r2.centerPoint.add(d2), f2 = r2.pointLocation(_2), m2 = t.LngLat.convert(e3.center || f2);
            this._normalizeCenter(m2);
            var g2, v2, y2 = r2.project(f2), x2 = r2.project(m2).sub(y2), b2 = r2.zoomScale(c2 - a2);
            e3.around && (g2 = t.LngLat.convert(e3.around), v2 = r2.locationPoint(g2));
            var w2 = {moving: this._moving, zooming: this._zooming, rotating: this._rotating, pitching: this._pitching};
            return this._zooming = this._zooming || c2 !== a2, this._rotating = this._rotating || n2 !== u2, this._pitching = this._pitching || h2 !== s2, this._padding = !r2.isPaddingEqual(p2), this._easeId = e3.easeId, this._prepareEase(i3, e3.noMoveStart, w2), this._ease(function(e4) {
              if (o2._zooming && (r2.zoom = t.number(a2, c2, e4)), o2._rotating && (r2.bearing = t.number(n2, u2, e4)), o2._pitching && (r2.pitch = t.number(s2, h2, e4)), o2._padding && (r2.interpolatePadding(l2, p2, e4), _2 = r2.centerPoint.add(d2)), g2)
                r2.setLocationAtPoint(g2, v2);
              else {
                var f3 = r2.zoomScale(r2.zoom - a2), m3 = c2 > a2 ? Math.min(2, b2) : Math.max(0.5, b2), w3 = Math.pow(m3, 1 - e4), T2 = r2.unproject(y2.add(x2.mult(e4 * w3)).mult(f3));
                r2.setLocationAtPoint(r2.renderWorldCopies ? T2.wrap() : T2, _2);
              }
              o2._fireMoveEvents(i3);
            }, function(t2) {
              o2._afterEase(i3, t2);
            }, e3), this;
          }, i2.prototype._prepareEase = function(e3, i3, o2) {
            o2 === void 0 && (o2 = {}), this._moving = true, i3 || o2.moving || this.fire(new t.Event("movestart", e3)), this._zooming && !o2.zooming && this.fire(new t.Event("zoomstart", e3)), this._rotating && !o2.rotating && this.fire(new t.Event("rotatestart", e3)), this._pitching && !o2.pitching && this.fire(new t.Event("pitchstart", e3));
          }, i2.prototype._fireMoveEvents = function(e3) {
            this.fire(new t.Event("move", e3)), this._zooming && this.fire(new t.Event("zoom", e3)), this._rotating && this.fire(new t.Event("rotate", e3)), this._pitching && this.fire(new t.Event("pitch", e3));
          }, i2.prototype._afterEase = function(e3, i3) {
            if (!this._easeId || !i3 || this._easeId !== i3) {
              delete this._easeId;
              var o2 = this._zooming, r2 = this._rotating, a2 = this._pitching;
              this._moving = false, this._zooming = false, this._rotating = false, this._pitching = false, this._padding = false, o2 && this.fire(new t.Event("zoomend", e3)), r2 && this.fire(new t.Event("rotateend", e3)), a2 && this.fire(new t.Event("pitchend", e3)), this.fire(new t.Event("moveend", e3));
            }
          }, i2.prototype.flyTo = function(e3, i3) {
            var o2 = this;
            if (!e3.essential && t.browser.prefersReducedMotion) {
              var r2 = t.pick(e3, ["center", "zoom", "bearing", "pitch", "around"]);
              return this.jumpTo(r2, i3);
            }
            this.stop(), e3 = t.extend({offset: [0, 0], speed: 1.2, curve: 1.42, easing: t.ease}, e3);
            var a2 = this.transform, n2 = this.getZoom(), s2 = this.getBearing(), l2 = this.getPitch(), c2 = this.getPadding(), u2 = "zoom" in e3 ? t.clamp(+e3.zoom, a2.minZoom, a2.maxZoom) : n2, h2 = "bearing" in e3 ? this._normalizeBearing(e3.bearing, s2) : s2, p2 = "pitch" in e3 ? +e3.pitch : l2, d2 = "padding" in e3 ? e3.padding : a2.padding, _2 = a2.zoomScale(u2 - n2), f2 = t.Point.convert(e3.offset), m2 = a2.centerPoint.add(f2), g2 = a2.pointLocation(m2), v2 = t.LngLat.convert(e3.center || g2);
            this._normalizeCenter(v2);
            var y2 = a2.project(g2), x2 = a2.project(v2).sub(y2), b2 = e3.curve, w2 = Math.max(a2.width, a2.height), T2 = w2 / _2, E2 = x2.mag();
            if ("minZoom" in e3) {
              var I2 = t.clamp(Math.min(e3.minZoom, n2, u2), a2.minZoom, a2.maxZoom), P2 = w2 / a2.zoomScale(I2 - n2);
              b2 = Math.sqrt(P2 / E2 * 2);
            }
            var S2 = b2 * b2;
            function C2(t2) {
              var e4 = (T2 * T2 - w2 * w2 + (t2 ? -1 : 1) * S2 * S2 * E2 * E2) / (2 * (t2 ? T2 : w2) * S2 * E2);
              return Math.log(Math.sqrt(e4 * e4 + 1) - e4);
            }
            function z2(t2) {
              return (Math.exp(t2) - Math.exp(-t2)) / 2;
            }
            function D2(t2) {
              return (Math.exp(t2) + Math.exp(-t2)) / 2;
            }
            var A2 = C2(0), M2 = function(t2) {
              return D2(A2) / D2(A2 + b2 * t2);
            }, L2 = function(t2) {
              return w2 * ((D2(A2) * (z2(e4 = A2 + b2 * t2) / D2(e4)) - z2(A2)) / S2) / E2;
              var e4;
            }, R2 = (C2(1) - A2) / b2;
            if (Math.abs(E2) < 1e-6 || !isFinite(R2)) {
              if (Math.abs(w2 - T2) < 1e-6)
                return this.easeTo(e3, i3);
              var k2 = T2 < w2 ? -1 : 1;
              R2 = Math.abs(Math.log(T2 / w2)) / b2, L2 = function() {
                return 0;
              }, M2 = function(t2) {
                return Math.exp(k2 * b2 * t2);
              };
            }
            return e3.duration = "duration" in e3 ? +e3.duration : 1e3 * R2 / ("screenSpeed" in e3 ? +e3.screenSpeed / b2 : +e3.speed), e3.maxDuration && e3.duration > e3.maxDuration && (e3.duration = 0), this._zooming = true, this._rotating = s2 !== h2, this._pitching = p2 !== l2, this._padding = !a2.isPaddingEqual(d2), this._prepareEase(i3, false), this._ease(function(e4) {
              var r3 = e4 * R2, _3 = 1 / M2(r3);
              a2.zoom = e4 === 1 ? u2 : n2 + a2.scaleZoom(_3), o2._rotating && (a2.bearing = t.number(s2, h2, e4)), o2._pitching && (a2.pitch = t.number(l2, p2, e4)), o2._padding && (a2.interpolatePadding(c2, d2, e4), m2 = a2.centerPoint.add(f2));
              var g3 = e4 === 1 ? v2 : a2.unproject(y2.add(x2.mult(L2(r3))).mult(_3));
              a2.setLocationAtPoint(a2.renderWorldCopies ? g3.wrap() : g3, m2), o2._fireMoveEvents(i3);
            }, function() {
              return o2._afterEase(i3);
            }, e3), this;
          }, i2.prototype.isEasing = function() {
            return !!this._easeFrameId;
          }, i2.prototype.stop = function() {
            return this._stop();
          }, i2.prototype._stop = function(t2, e3) {
            if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), delete this._easeFrameId, delete this._onEaseFrame), this._onEaseEnd) {
              var i3 = this._onEaseEnd;
              delete this._onEaseEnd, i3.call(this, e3);
            }
            if (!t2) {
              var o2 = this.handlers;
              o2 && o2.stop(false);
            }
            return this;
          }, i2.prototype._ease = function(e3, i3, o2) {
            o2.animate === false || o2.duration === 0 ? (e3(1), i3()) : (this._easeStart = t.browser.now(), this._easeOptions = o2, this._onEaseFrame = e3, this._onEaseEnd = i3, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback));
          }, i2.prototype._renderFrameCallback = function() {
            var e3 = Math.min((t.browser.now() - this._easeStart) / this._easeOptions.duration, 1);
            this._onEaseFrame(this._easeOptions.easing(e3)), e3 < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop();
          }, i2.prototype._normalizeBearing = function(e3, i3) {
            e3 = t.wrap(e3, -180, 180);
            var o2 = Math.abs(e3 - i3);
            return Math.abs(e3 - 360 - i3) < o2 && (e3 -= 360), Math.abs(e3 + 360 - i3) < o2 && (e3 += 360), e3;
          }, i2.prototype._normalizeCenter = function(t2) {
            var e3 = this.transform;
            if (e3.renderWorldCopies && !e3.lngRange) {
              var i3 = t2.lng - e3.center.lng;
              t2.lng += i3 > 180 ? -360 : i3 < -180 ? 360 : 0;
            }
          }, i2;
        }(t.Evented), yr = function(e2) {
          e2 === void 0 && (e2 = {}), this.options = e2, t.bindAll(["_toggleAttribution", "_updateEditLink", "_updateData", "_updateCompact"], this);
        };
        yr.prototype.getDefaultPosition = function() {
          return "bottom-right";
        }, yr.prototype.onAdd = function(t2) {
          var e2 = this.options && this.options.compact;
          return this._map = t2, this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-attrib"), this._compactButton = i.create("button", "mapboxgl-ctrl-attrib-button", this._container), this._compactButton.addEventListener("click", this._toggleAttribution), this._setElementTitle(this._compactButton, "ToggleAttribution"), this._innerContainer = i.create("div", "mapboxgl-ctrl-attrib-inner", this._container), this._innerContainer.setAttribute("role", "list"), e2 && this._container.classList.add("mapboxgl-compact"), this._updateAttributions(), this._updateEditLink(), this._map.on("styledata", this._updateData), this._map.on("sourcedata", this._updateData), this._map.on("moveend", this._updateEditLink), e2 === void 0 && (this._map.on("resize", this._updateCompact), this._updateCompact()), this._container;
        }, yr.prototype.onRemove = function() {
          i.remove(this._container), this._map.off("styledata", this._updateData), this._map.off("sourcedata", this._updateData), this._map.off("moveend", this._updateEditLink), this._map.off("resize", this._updateCompact), this._map = void 0, this._attribHTML = void 0;
        }, yr.prototype._setElementTitle = function(t2, e2) {
          var i2 = this._map._getUIString("AttributionControl." + e2);
          t2.title = i2, t2.setAttribute("aria-label", i2);
        }, yr.prototype._toggleAttribution = function() {
          this._container.classList.contains("mapboxgl-compact-show") ? (this._container.classList.remove("mapboxgl-compact-show"), this._compactButton.setAttribute("aria-pressed", "false")) : (this._container.classList.add("mapboxgl-compact-show"), this._compactButton.setAttribute("aria-pressed", "true"));
        }, yr.prototype._updateEditLink = function() {
          var e2 = this._editLink;
          e2 || (e2 = this._editLink = this._container.querySelector(".mapbox-improve-map"));
          var i2 = [{key: "owner", value: this.styleOwner}, {key: "id", value: this.styleId}, {key: "access_token", value: this._map._requestManager._customAccessToken || t.config.ACCESS_TOKEN}];
          if (e2) {
            var o2 = i2.reduce(function(t2, e3, o3) {
              return e3.value && (t2 += e3.key + "=" + e3.value + (o3 < i2.length - 1 ? "&" : "")), t2;
            }, "?");
            e2.href = t.config.FEEDBACK_URL + "/" + o2 + (this._map._hash ? this._map._hash.getHashString(true) : ""), e2.rel = "noopener nofollow", this._setElementTitle(e2, "MapFeedback");
          }
        }, yr.prototype._updateData = function(t2) {
          !t2 || t2.sourceDataType !== "metadata" && t2.sourceDataType !== "visibility" && t2.dataType !== "style" || (this._updateAttributions(), this._updateEditLink());
        }, yr.prototype._updateAttributions = function() {
          if (this._map.style) {
            var t2 = [];
            if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? t2 = t2.concat(this.options.customAttribution.map(function(t3) {
              return typeof t3 != "string" ? "" : t3;
            })) : typeof this.options.customAttribution == "string" && t2.push(this.options.customAttribution)), this._map.style.stylesheet) {
              var e2 = this._map.style.stylesheet;
              this.styleOwner = e2.owner, this.styleId = e2.id;
            }
            var i2 = this._map.style.sourceCaches;
            for (var o2 in i2) {
              var r2 = i2[o2];
              if (r2.used) {
                var a2 = r2.getSource();
                a2.attribution && t2.indexOf(a2.attribution) < 0 && t2.push(a2.attribution);
              }
            }
            t2.sort(function(t3, e3) {
              return t3.length - e3.length;
            });
            var n2 = (t2 = t2.filter(function(e3, i3) {
              for (var o3 = i3 + 1; o3 < t2.length; o3++)
                if (t2[o3].indexOf(e3) >= 0)
                  return false;
              return true;
            })).join(" | ");
            n2 !== this._attribHTML && (this._attribHTML = n2, t2.length ? (this._innerContainer.innerHTML = n2, this._container.classList.remove("mapboxgl-attrib-empty")) : this._container.classList.add("mapboxgl-attrib-empty"), this._editLink = null);
          }
        }, yr.prototype._updateCompact = function() {
          this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add("mapboxgl-compact") : this._container.classList.remove("mapboxgl-compact", "mapboxgl-compact-show");
        };
        var xr = function() {
          t.bindAll(["_updateLogo"], this), t.bindAll(["_updateCompact"], this);
        };
        xr.prototype.onAdd = function(t2) {
          this._map = t2, this._container = i.create("div", "mapboxgl-ctrl");
          var e2 = i.create("a", "mapboxgl-ctrl-logo");
          return e2.target = "_blank", e2.rel = "noopener nofollow", e2.href = "https://www.mapbox.com/", e2.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")), e2.setAttribute("rel", "noopener nofollow"), this._container.appendChild(e2), this._container.style.display = "none", this._map.on("sourcedata", this._updateLogo), this._updateLogo(), this._map.on("resize", this._updateCompact), this._updateCompact(), this._container;
        }, xr.prototype.onRemove = function() {
          i.remove(this._container), this._map.off("sourcedata", this._updateLogo), this._map.off("resize", this._updateCompact);
        }, xr.prototype.getDefaultPosition = function() {
          return "bottom-left";
        }, xr.prototype._updateLogo = function(t2) {
          t2 && t2.sourceDataType !== "metadata" || (this._container.style.display = this._logoRequired() ? "block" : "none");
        }, xr.prototype._logoRequired = function() {
          if (this._map.style) {
            var t2 = this._map.style.sourceCaches;
            for (var e2 in t2)
              if (t2[e2].getSource().mapbox_logo)
                return true;
            return false;
          }
        }, xr.prototype._updateCompact = function() {
          var t2 = this._container.children;
          if (t2.length) {
            var e2 = t2[0];
            this._map.getCanvasContainer().offsetWidth < 250 ? e2.classList.add("mapboxgl-compact") : e2.classList.remove("mapboxgl-compact");
          }
        };
        var br = function() {
          this._queue = [], this._id = 0, this._cleared = false, this._currentlyRunning = false;
        };
        br.prototype.add = function(t2) {
          var e2 = ++this._id;
          return this._queue.push({callback: t2, id: e2, cancelled: false}), e2;
        }, br.prototype.remove = function(t2) {
          for (var e2 = this._currentlyRunning, i2 = 0, o2 = e2 ? this._queue.concat(e2) : this._queue; i2 < o2.length; i2 += 1) {
            var r2 = o2[i2];
            if (r2.id === t2)
              return void (r2.cancelled = true);
          }
        }, br.prototype.run = function(t2) {
          t2 === void 0 && (t2 = 0);
          var e2 = this._currentlyRunning = this._queue;
          this._queue = [];
          for (var i2 = 0, o2 = e2; i2 < o2.length; i2 += 1) {
            var r2 = o2[i2];
            if (!r2.cancelled && (r2.callback(t2), this._cleared))
              break;
          }
          this._cleared = false, this._currentlyRunning = false;
        }, br.prototype.clear = function() {
          this._currentlyRunning && (this._cleared = true), this._queue = [];
        };
        var wr = {"AttributionControl.ToggleAttribution": "Toggle attribution", "AttributionControl.MapFeedback": "Map feedback", "FullscreenControl.Enter": "Enter fullscreen", "FullscreenControl.Exit": "Exit fullscreen", "GeolocateControl.FindMyLocation": "Find my location", "GeolocateControl.LocationNotAvailable": "Location not available", "LogoControl.Title": "Mapbox logo", "NavigationControl.ResetBearing": "Reset bearing to north", "NavigationControl.ZoomIn": "Zoom in", "NavigationControl.ZoomOut": "Zoom out", "ScaleControl.Feet": "ft", "ScaleControl.Meters": "m", "ScaleControl.Kilometers": "km", "ScaleControl.Miles": "mi", "ScaleControl.NauticalMiles": "nm"}, Tr = t.window.HTMLImageElement, Er = t.window.HTMLElement, Ir = t.window.ImageBitmap, Pr = {center: [0, 0], zoom: 0, bearing: 0, pitch: 0, minZoom: -2, maxZoom: 22, minPitch: 0, maxPitch: 60, interactive: true, scrollZoom: true, boxZoom: true, dragRotate: true, dragPan: true, keyboard: true, doubleClickZoom: true, touchZoomRotate: true, touchPitch: true, bearingSnap: 7, clickTolerance: 3, pitchWithRotate: true, hash: false, attributionControl: true, failIfMajorPerformanceCaveat: false, preserveDrawingBuffer: false, trackResize: true, renderWorldCopies: true, refreshExpiredTiles: true, maxTileCacheSize: null, localIdeographFontFamily: "sans-serif", transformRequest: null, accessToken: null, fadeDuration: 300, crossSourceCollisions: true}, Sr = function(o2) {
          function r2(e2) {
            var i2 = this;
            if ((e2 = t.extend({}, Pr, e2)).minZoom != null && e2.maxZoom != null && e2.minZoom > e2.maxZoom)
              throw new Error("maxZoom must be greater than or equal to minZoom");
            if (e2.minPitch != null && e2.maxPitch != null && e2.minPitch > e2.maxPitch)
              throw new Error("maxPitch must be greater than or equal to minPitch");
            if (e2.minPitch != null && e2.minPitch < 0)
              throw new Error("minPitch must be greater than or equal to 0");
            if (e2.maxPitch != null && e2.maxPitch > 60)
              throw new Error("maxPitch must be less than or equal to 60");
            var r3 = new To(e2.minZoom, e2.maxZoom, e2.minPitch, e2.maxPitch, e2.renderWorldCopies);
            if (o2.call(this, r3, e2), this._interactive = e2.interactive, this._maxTileCacheSize = e2.maxTileCacheSize, this._failIfMajorPerformanceCaveat = e2.failIfMajorPerformanceCaveat, this._preserveDrawingBuffer = e2.preserveDrawingBuffer, this._antialias = e2.antialias, this._trackResize = e2.trackResize, this._bearingSnap = e2.bearingSnap, this._refreshExpiredTiles = e2.refreshExpiredTiles, this._fadeDuration = e2.fadeDuration, this._crossSourceCollisions = e2.crossSourceCollisions, this._crossFadingFactor = 1, this._collectResourceTiming = e2.collectResourceTiming, this._renderTaskQueue = new br(), this._controls = [], this._mapId = t.uniqueId(), this._locale = t.extend({}, wr, e2.locale), this._clickTolerance = e2.clickTolerance, this._requestManager = new t.RequestManager(e2.transformRequest, e2.accessToken), typeof e2.container == "string") {
              if (this._container = t.window.document.getElementById(e2.container), !this._container)
                throw new Error("Container '" + e2.container + "' not found.");
            } else {
              if (!(e2.container instanceof Er))
                throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
              this._container = e2.container;
            }
            if (e2.maxBounds && this.setMaxBounds(e2.maxBounds), t.bindAll(["_onWindowOnline", "_onWindowResize", "_onMapScroll", "_contextLost", "_contextRestored"], this), this._setupContainer(), this._setupPainter(), this.painter === void 0)
              throw new Error("Failed to initialize WebGL.");
            this.on("move", function() {
              return i2._update(false);
            }), this.on("moveend", function() {
              return i2._update(false);
            }), this.on("zoom", function() {
              return i2._update(true);
            }), t.window !== void 0 && (t.window.addEventListener("online", this._onWindowOnline, false), t.window.addEventListener("resize", this._onWindowResize, false), t.window.addEventListener("orientationchange", this._onWindowResize, false)), this.handlers = new gr(this, e2), this._hash = e2.hash && new Io(typeof e2.hash == "string" && e2.hash || void 0).addTo(this), this._hash && this._hash._onHashChange() || (this.jumpTo({center: e2.center, zoom: e2.zoom, bearing: e2.bearing, pitch: e2.pitch}), e2.bounds && (this.resize(), this.fitBounds(e2.bounds, t.extend({}, e2.fitBoundsOptions, {duration: 0})))), this.resize(), this._localIdeographFontFamily = e2.localIdeographFontFamily, e2.style && this.setStyle(e2.style, {localIdeographFontFamily: e2.localIdeographFontFamily}), e2.attributionControl && this.addControl(new yr({customAttribution: e2.customAttribution})), this.addControl(new xr(), e2.logoPosition), this.on("style.load", function() {
              i2.transform.unmodified && i2.jumpTo(i2.style.stylesheet);
            }), this.on("data", function(e3) {
              i2._update(e3.dataType === "style"), i2.fire(new t.Event(e3.dataType + "data", e3));
            }), this.on("dataloading", function(e3) {
              i2.fire(new t.Event(e3.dataType + "dataloading", e3));
            });
          }
          o2 && (r2.__proto__ = o2), (r2.prototype = Object.create(o2 && o2.prototype)).constructor = r2;
          var a2 = {showTileBoundaries: {configurable: true}, showPadding: {configurable: true}, showCollisionBoxes: {configurable: true}, showOverdrawInspector: {configurable: true}, repaint: {configurable: true}, vertices: {configurable: true}, version: {configurable: true}};
          return r2.prototype._getMapId = function() {
            return this._mapId;
          }, r2.prototype.addControl = function(e2, i2) {
            if (i2 === void 0 && (i2 = e2.getDefaultPosition ? e2.getDefaultPosition() : "top-right"), !e2 || !e2.onAdd)
              return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
            var o3 = e2.onAdd(this);
            this._controls.push(e2);
            var r3 = this._controlPositions[i2];
            return i2.indexOf("bottom") !== -1 ? r3.insertBefore(o3, r3.firstChild) : r3.appendChild(o3), this;
          }, r2.prototype.removeControl = function(e2) {
            if (!e2 || !e2.onRemove)
              return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));
            var i2 = this._controls.indexOf(e2);
            return i2 > -1 && this._controls.splice(i2, 1), e2.onRemove(this), this;
          }, r2.prototype.hasControl = function(t2) {
            return this._controls.indexOf(t2) > -1;
          }, r2.prototype.resize = function(e2) {
            var i2 = this._containerDimensions(), o3 = i2[0], r3 = i2[1];
            this._resizeCanvas(o3, r3), this.transform.resize(o3, r3), this.painter.resize(o3, r3);
            var a3 = !this._moving;
            return a3 && (this.stop(), this.fire(new t.Event("movestart", e2)).fire(new t.Event("move", e2))), this.fire(new t.Event("resize", e2)), a3 && this.fire(new t.Event("moveend", e2)), this;
          }, r2.prototype.getBounds = function() {
            return this.transform.getBounds();
          }, r2.prototype.getMaxBounds = function() {
            return this.transform.getMaxBounds();
          }, r2.prototype.setMaxBounds = function(e2) {
            return this.transform.setMaxBounds(t.LngLatBounds.convert(e2)), this._update();
          }, r2.prototype.setMinZoom = function(t2) {
            if ((t2 = t2 == null ? -2 : t2) >= -2 && t2 <= this.transform.maxZoom)
              return this.transform.minZoom = t2, this._update(), this.getZoom() < t2 && this.setZoom(t2), this;
            throw new Error("minZoom must be between -2 and the current maxZoom, inclusive");
          }, r2.prototype.getMinZoom = function() {
            return this.transform.minZoom;
          }, r2.prototype.setMaxZoom = function(t2) {
            if ((t2 = t2 == null ? 22 : t2) >= this.transform.minZoom)
              return this.transform.maxZoom = t2, this._update(), this.getZoom() > t2 && this.setZoom(t2), this;
            throw new Error("maxZoom must be greater than the current minZoom");
          }, r2.prototype.getMaxZoom = function() {
            return this.transform.maxZoom;
          }, r2.prototype.setMinPitch = function(t2) {
            if ((t2 = t2 == null ? 0 : t2) < 0)
              throw new Error("minPitch must be greater than or equal to 0");
            if (t2 >= 0 && t2 <= this.transform.maxPitch)
              return this.transform.minPitch = t2, this._update(), this.getPitch() < t2 && this.setPitch(t2), this;
            throw new Error("minPitch must be between 0 and the current maxPitch, inclusive");
          }, r2.prototype.getMinPitch = function() {
            return this.transform.minPitch;
          }, r2.prototype.setMaxPitch = function(t2) {
            if ((t2 = t2 == null ? 60 : t2) > 60)
              throw new Error("maxPitch must be less than or equal to 60");
            if (t2 >= this.transform.minPitch)
              return this.transform.maxPitch = t2, this._update(), this.getPitch() > t2 && this.setPitch(t2), this;
            throw new Error("maxPitch must be greater than the current minPitch");
          }, r2.prototype.getMaxPitch = function() {
            return this.transform.maxPitch;
          }, r2.prototype.getRenderWorldCopies = function() {
            return this.transform.renderWorldCopies;
          }, r2.prototype.setRenderWorldCopies = function(t2) {
            return this.transform.renderWorldCopies = t2, this._update();
          }, r2.prototype.project = function(e2) {
            return this.transform.locationPoint(t.LngLat.convert(e2));
          }, r2.prototype.unproject = function(e2) {
            return this.transform.pointLocation(t.Point.convert(e2));
          }, r2.prototype.isMoving = function() {
            return this._moving || this.handlers.isMoving();
          }, r2.prototype.isZooming = function() {
            return this._zooming || this.handlers.isZooming();
          }, r2.prototype.isRotating = function() {
            return this._rotating || this.handlers.isRotating();
          }, r2.prototype._createDelegatedListener = function(t2, e2, i2) {
            var o3, r3 = this;
            if (t2 === "mouseenter" || t2 === "mouseover") {
              var a3 = false;
              return {layer: e2, listener: i2, delegates: {mousemove: function(o4) {
                var n3 = r3.getLayer(e2) ? r3.queryRenderedFeatures(o4.point, {layers: [e2]}) : [];
                n3.length ? a3 || (a3 = true, i2.call(r3, new Ro(t2, r3, o4.originalEvent, {features: n3}))) : a3 = false;
              }, mouseout: function() {
                a3 = false;
              }}};
            }
            if (t2 === "mouseleave" || t2 === "mouseout") {
              var n2 = false;
              return {layer: e2, listener: i2, delegates: {mousemove: function(o4) {
                (r3.getLayer(e2) ? r3.queryRenderedFeatures(o4.point, {layers: [e2]}) : []).length ? n2 = true : n2 && (n2 = false, i2.call(r3, new Ro(t2, r3, o4.originalEvent)));
              }, mouseout: function(e3) {
                n2 && (n2 = false, i2.call(r3, new Ro(t2, r3, e3.originalEvent)));
              }}};
            }
            return {layer: e2, listener: i2, delegates: (o3 = {}, o3[t2] = function(t3) {
              var o4 = r3.getLayer(e2) ? r3.queryRenderedFeatures(t3.point, {layers: [e2]}) : [];
              o4.length && (t3.features = o4, i2.call(r3, t3), delete t3.features);
            }, o3)};
          }, r2.prototype.on = function(t2, e2, i2) {
            if (i2 === void 0)
              return o2.prototype.on.call(this, t2, e2);
            var r3 = this._createDelegatedListener(t2, e2, i2);
            for (var a3 in this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[t2] = this._delegatedListeners[t2] || [], this._delegatedListeners[t2].push(r3), r3.delegates)
              this.on(a3, r3.delegates[a3]);
            return this;
          }, r2.prototype.once = function(t2, e2, i2) {
            if (i2 === void 0)
              return o2.prototype.once.call(this, t2, e2);
            var r3 = this._createDelegatedListener(t2, e2, i2);
            for (var a3 in r3.delegates)
              this.once(a3, r3.delegates[a3]);
            return this;
          }, r2.prototype.off = function(t2, e2, i2) {
            var r3 = this;
            return i2 === void 0 ? o2.prototype.off.call(this, t2, e2) : (this._delegatedListeners && this._delegatedListeners[t2] && function(o3) {
              for (var a3 = o3[t2], n2 = 0; n2 < a3.length; n2++) {
                var s2 = a3[n2];
                if (s2.layer === e2 && s2.listener === i2) {
                  for (var l2 in s2.delegates)
                    r3.off(l2, s2.delegates[l2]);
                  return a3.splice(n2, 1), r3;
                }
              }
            }(this._delegatedListeners), this);
          }, r2.prototype.queryRenderedFeatures = function(e2, i2) {
            if (!this.style)
              return [];
            var o3;
            if (i2 !== void 0 || e2 === void 0 || e2 instanceof t.Point || Array.isArray(e2) || (i2 = e2, e2 = void 0), i2 = i2 || {}, (e2 = e2 || [[0, 0], [this.transform.width, this.transform.height]]) instanceof t.Point || typeof e2[0] == "number")
              o3 = [t.Point.convert(e2)];
            else {
              var r3 = t.Point.convert(e2[0]), a3 = t.Point.convert(e2[1]);
              o3 = [r3, new t.Point(a3.x, r3.y), a3, new t.Point(r3.x, a3.y), r3];
            }
            return this.style.queryRenderedFeatures(o3, i2, this.transform);
          }, r2.prototype.querySourceFeatures = function(t2, e2) {
            return this.style.querySourceFeatures(t2, e2);
          }, r2.prototype.setStyle = function(e2, i2) {
            return (i2 = t.extend({}, {localIdeographFontFamily: this._localIdeographFontFamily}, i2)).diff !== false && i2.localIdeographFontFamily === this._localIdeographFontFamily && this.style && e2 ? (this._diffStyle(e2, i2), this) : (this._localIdeographFontFamily = i2.localIdeographFontFamily, this._updateStyle(e2, i2));
          }, r2.prototype._getUIString = function(t2) {
            var e2 = this._locale[t2];
            if (e2 == null)
              throw new Error("Missing UI string '" + t2 + "'");
            return e2;
          }, r2.prototype._updateStyle = function(t2, e2) {
            return this.style && (this.style.setEventedParent(null), this.style._remove()), t2 ? (this.style = new je(this, e2 || {}), this.style.setEventedParent(this, {style: this.style}), typeof t2 == "string" ? this.style.loadURL(t2) : this.style.loadJSON(t2), this) : (delete this.style, this);
          }, r2.prototype._lazyInitEmptyStyle = function() {
            this.style || (this.style = new je(this, {}), this.style.setEventedParent(this, {style: this.style}), this.style.loadEmpty());
          }, r2.prototype._diffStyle = function(e2, i2) {
            var o3 = this;
            if (typeof e2 == "string") {
              var r3 = this._requestManager.normalizeStyleURL(e2), a3 = this._requestManager.transformRequest(r3, t.ResourceType.Style);
              t.getJSON(a3, function(e3, r4) {
                e3 ? o3.fire(new t.ErrorEvent(e3)) : r4 && o3._updateDiff(r4, i2);
              });
            } else
              typeof e2 == "object" && this._updateDiff(e2, i2);
          }, r2.prototype._updateDiff = function(e2, i2) {
            try {
              this.style.setState(e2) && this._update(true);
            } catch (o3) {
              t.warnOnce("Unable to perform style diff: " + (o3.message || o3.error || o3) + ".  Rebuilding the style from scratch."), this._updateStyle(e2, i2);
            }
          }, r2.prototype.getStyle = function() {
            if (this.style)
              return this.style.serialize();
          }, r2.prototype.isStyleLoaded = function() {
            return this.style ? this.style.loaded() : t.warnOnce("There is no style added to the map.");
          }, r2.prototype.addSource = function(t2, e2) {
            return this._lazyInitEmptyStyle(), this.style.addSource(t2, e2), this._update(true);
          }, r2.prototype.isSourceLoaded = function(e2) {
            var i2 = this.style && this.style.sourceCaches[e2];
            if (i2 !== void 0)
              return i2.loaded();
            this.fire(new t.ErrorEvent(new Error("There is no source with ID '" + e2 + "'")));
          }, r2.prototype.areTilesLoaded = function() {
            var t2 = this.style && this.style.sourceCaches;
            for (var e2 in t2) {
              var i2 = t2[e2]._tiles;
              for (var o3 in i2) {
                var r3 = i2[o3];
                if (r3.state !== "loaded" && r3.state !== "errored")
                  return false;
              }
            }
            return true;
          }, r2.prototype.addSourceType = function(t2, e2, i2) {
            return this._lazyInitEmptyStyle(), this.style.addSourceType(t2, e2, i2);
          }, r2.prototype.removeSource = function(t2) {
            return this.style.removeSource(t2), this._update(true);
          }, r2.prototype.getSource = function(t2) {
            return this.style.getSource(t2);
          }, r2.prototype.addImage = function(e2, i2, o3) {
            o3 === void 0 && (o3 = {});
            var r3 = o3.pixelRatio;
            r3 === void 0 && (r3 = 1);
            var a3 = o3.sdf;
            a3 === void 0 && (a3 = false);
            var n2 = o3.stretchX, s2 = o3.stretchY, l2 = o3.content;
            if (this._lazyInitEmptyStyle(), i2 instanceof Tr || Ir && i2 instanceof Ir) {
              var c2 = t.browser.getImageData(i2);
              this.style.addImage(e2, {data: new t.RGBAImage({width: c2.width, height: c2.height}, c2.data), pixelRatio: r3, stretchX: n2, stretchY: s2, content: l2, sdf: a3, version: 0});
            } else {
              if (i2.width === void 0 || i2.height === void 0)
                return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
              var u2 = i2;
              this.style.addImage(e2, {data: new t.RGBAImage({width: i2.width, height: i2.height}, new Uint8Array(i2.data)), pixelRatio: r3, stretchX: n2, stretchY: s2, content: l2, sdf: a3, version: 0, userImage: u2}), u2.onAdd && u2.onAdd(this, e2);
            }
          }, r2.prototype.updateImage = function(e2, i2) {
            var o3 = this.style.getImage(e2);
            if (!o3)
              return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
            var r3 = i2 instanceof Tr || Ir && i2 instanceof Ir ? t.browser.getImageData(i2) : i2, a3 = r3.width, n2 = r3.height, s2 = r3.data;
            return a3 === void 0 || n2 === void 0 ? this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))) : a3 !== o3.data.width || n2 !== o3.data.height ? this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))) : (o3.data.replace(s2, !(i2 instanceof Tr || Ir && i2 instanceof Ir)), void this.style.updateImage(e2, o3));
          }, r2.prototype.hasImage = function(e2) {
            return e2 ? !!this.style.getImage(e2) : (this.fire(new t.ErrorEvent(new Error("Missing required image id"))), false);
          }, r2.prototype.removeImage = function(t2) {
            this.style.removeImage(t2);
          }, r2.prototype.loadImage = function(e2, i2) {
            t.getImage(this._requestManager.transformRequest(e2, t.ResourceType.Image), i2);
          }, r2.prototype.listImages = function() {
            return this.style.listImages();
          }, r2.prototype.addLayer = function(t2, e2) {
            return this._lazyInitEmptyStyle(), this.style.addLayer(t2, e2), this._update(true);
          }, r2.prototype.moveLayer = function(t2, e2) {
            return this.style.moveLayer(t2, e2), this._update(true);
          }, r2.prototype.removeLayer = function(t2) {
            return this.style.removeLayer(t2), this._update(true);
          }, r2.prototype.getLayer = function(t2) {
            return this.style.getLayer(t2);
          }, r2.prototype.setLayerZoomRange = function(t2, e2, i2) {
            return this.style.setLayerZoomRange(t2, e2, i2), this._update(true);
          }, r2.prototype.setFilter = function(t2, e2, i2) {
            return i2 === void 0 && (i2 = {}), this.style.setFilter(t2, e2, i2), this._update(true);
          }, r2.prototype.getFilter = function(t2) {
            return this.style.getFilter(t2);
          }, r2.prototype.setPaintProperty = function(t2, e2, i2, o3) {
            return o3 === void 0 && (o3 = {}), this.style.setPaintProperty(t2, e2, i2, o3), this._update(true);
          }, r2.prototype.getPaintProperty = function(t2, e2) {
            return this.style.getPaintProperty(t2, e2);
          }, r2.prototype.setLayoutProperty = function(t2, e2, i2, o3) {
            return o3 === void 0 && (o3 = {}), this.style.setLayoutProperty(t2, e2, i2, o3), this._update(true);
          }, r2.prototype.getLayoutProperty = function(t2, e2) {
            return this.style.getLayoutProperty(t2, e2);
          }, r2.prototype.setLight = function(t2, e2) {
            return e2 === void 0 && (e2 = {}), this._lazyInitEmptyStyle(), this.style.setLight(t2, e2), this._update(true);
          }, r2.prototype.getLight = function() {
            return this.style.getLight();
          }, r2.prototype.setFeatureState = function(t2, e2) {
            return this.style.setFeatureState(t2, e2), this._update();
          }, r2.prototype.removeFeatureState = function(t2, e2) {
            return this.style.removeFeatureState(t2, e2), this._update();
          }, r2.prototype.getFeatureState = function(t2) {
            return this.style.getFeatureState(t2);
          }, r2.prototype.getContainer = function() {
            return this._container;
          }, r2.prototype.getCanvasContainer = function() {
            return this._canvasContainer;
          }, r2.prototype.getCanvas = function() {
            return this._canvas;
          }, r2.prototype._containerDimensions = function() {
            var t2 = 0, e2 = 0;
            return this._container && (t2 = this._container.clientWidth || 400, e2 = this._container.clientHeight || 300), [t2, e2];
          }, r2.prototype._detectMissingCSS = function() {
            t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color") !== "rgb(250, 128, 114)" && t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.");
          }, r2.prototype._setupContainer = function() {
            var t2 = this._container;
            t2.classList.add("mapboxgl-map"), (this._missingCSSCanary = i.create("div", "mapboxgl-canary", t2)).style.visibility = "hidden", this._detectMissingCSS();
            var e2 = this._canvasContainer = i.create("div", "mapboxgl-canvas-container", t2);
            this._interactive && e2.classList.add("mapboxgl-interactive"), this._canvas = i.create("canvas", "mapboxgl-canvas", e2), this._canvas.addEventListener("webglcontextlost", this._contextLost, false), this._canvas.addEventListener("webglcontextrestored", this._contextRestored, false), this._canvas.setAttribute("tabindex", "0"), this._canvas.setAttribute("aria-label", "Map"), this._canvas.setAttribute("role", "region");
            var o3 = this._containerDimensions();
            this._resizeCanvas(o3[0], o3[1]);
            var r3 = this._controlContainer = i.create("div", "mapboxgl-control-container", t2), a3 = this._controlPositions = {};
            ["top-left", "top-right", "bottom-left", "bottom-right"].forEach(function(t3) {
              a3[t3] = i.create("div", "mapboxgl-ctrl-" + t3, r3);
            }), this._container.addEventListener("scroll", this._onMapScroll, false);
          }, r2.prototype._resizeCanvas = function(e2, i2) {
            var o3 = t.browser.devicePixelRatio || 1;
            this._canvas.width = o3 * e2, this._canvas.height = o3 * i2, this._canvas.style.width = e2 + "px", this._canvas.style.height = i2 + "px";
          }, r2.prototype._setupPainter = function() {
            var i2 = t.extend({}, e.webGLContextAttributes, {failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat, preserveDrawingBuffer: this._preserveDrawingBuffer, antialias: this._antialias || false}), o3 = this._canvas.getContext("webgl", i2) || this._canvas.getContext("experimental-webgl", i2);
            o3 ? (this.painter = new yo(o3, this.transform), t.webpSupported.testSupport(o3)) : this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")));
          }, r2.prototype._contextLost = function(e2) {
            e2.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new t.Event("webglcontextlost", {originalEvent: e2}));
          }, r2.prototype._contextRestored = function(e2) {
            this._setupPainter(), this.resize(), this._update(), this.fire(new t.Event("webglcontextrestored", {originalEvent: e2}));
          }, r2.prototype._onMapScroll = function(t2) {
            if (t2.target === this._container)
              return this._container.scrollTop = 0, this._container.scrollLeft = 0, false;
          }, r2.prototype.loaded = function() {
            return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded();
          }, r2.prototype._update = function(t2) {
            return this.style ? (this._styleDirty = this._styleDirty || t2, this._sourcesDirty = true, this.triggerRepaint(), this) : this;
          }, r2.prototype._requestRenderFrame = function(t2) {
            return this._update(), this._renderTaskQueue.add(t2);
          }, r2.prototype._cancelRenderFrame = function(t2) {
            this._renderTaskQueue.remove(t2);
          }, r2.prototype._render = function(e2) {
            var i2, o3 = this, r3 = 0, a3 = this.painter.context.extTimerQuery;
            if (this.listens("gpu-timing-frame") && (i2 = a3.createQueryEXT(), a3.beginQueryEXT(a3.TIME_ELAPSED_EXT, i2), r3 = t.browser.now()), this.painter.context.setDirty(), this.painter.setBaseState(), this._renderTaskQueue.run(e2), !this._removed) {
              var n2 = false;
              if (this.style && this._styleDirty) {
                this._styleDirty = false;
                var s2 = this.transform.zoom, l2 = t.browser.now();
                this.style.zoomHistory.update(s2, l2);
                var c2 = new t.EvaluationParameters(s2, {now: l2, fadeDuration: this._fadeDuration, zoomHistory: this.style.zoomHistory, transition: this.style.getTransition()}), u2 = c2.crossFadingFactor();
                u2 === 1 && u2 === this._crossFadingFactor || (n2 = true, this._crossFadingFactor = u2), this.style.update(c2);
              }
              if (this.style && this._sourcesDirty && (this._sourcesDirty = false, this.style._updateSources(this.transform)), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, this._fadeDuration, this._crossSourceCollisions), this.painter.render(this.style, {showTileBoundaries: this.showTileBoundaries, showOverdrawInspector: this._showOverdrawInspector, rotating: this.isRotating(), zooming: this.isZooming(), moving: this.isMoving(), fadeDuration: this._fadeDuration, showPadding: this.showPadding, gpuTiming: !!this.listens("gpu-timing-layer")}), this.fire(new t.Event("render")), this.loaded() && !this._loaded && (this._loaded = true, this.fire(new t.Event("load"))), this.style && (this.style.hasTransitions() || n2) && (this._styleDirty = true), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), this.listens("gpu-timing-frame")) {
                var h2 = t.browser.now() - r3;
                a3.endQueryEXT(a3.TIME_ELAPSED_EXT, i2), setTimeout(function() {
                  var e3 = a3.getQueryObjectEXT(i2, a3.QUERY_RESULT_EXT) / 1e6;
                  a3.deleteQueryEXT(i2), o3.fire(new t.Event("gpu-timing-frame", {cpuTime: h2, gpuTime: e3}));
                }, 50);
              }
              if (this.listens("gpu-timing-layer")) {
                var p2 = this.painter.collectGpuTimers();
                setTimeout(function() {
                  var e3 = o3.painter.queryGpuTimers(p2);
                  o3.fire(new t.Event("gpu-timing-layer", {layerTimes: e3}));
                }, 50);
              }
              var d2 = this._sourcesDirty || this._styleDirty || this._placementDirty;
              return d2 || this._repaint ? this.triggerRepaint() : !this.isMoving() && this.loaded() && this.fire(new t.Event("idle")), !this._loaded || this._fullyLoaded || d2 || (this._fullyLoaded = true), this;
            }
          }, r2.prototype.remove = function() {
            this._hash && this._hash.remove();
            for (var e2 = 0, i2 = this._controls; e2 < i2.length; e2 += 1)
              i2[e2].onRemove(this);
            this._controls = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this.painter.destroy(), this.handlers.destroy(), delete this.handlers, this.setStyle(null), t.window !== void 0 && (t.window.removeEventListener("resize", this._onWindowResize, false), t.window.removeEventListener("orientationchange", this._onWindowResize, false), t.window.removeEventListener("online", this._onWindowOnline, false));
            var o3 = this.painter.context.gl.getExtension("WEBGL_lose_context");
            o3 && o3.loseContext(), Cr(this._canvasContainer), Cr(this._controlContainer), Cr(this._missingCSSCanary), this._container.classList.remove("mapboxgl-map"), this._removed = true, this.fire(new t.Event("remove"));
          }, r2.prototype.triggerRepaint = function() {
            var e2 = this;
            this.style && !this._frame && (this._frame = t.browser.frame(function(t2) {
              e2._frame = null, e2._render(t2);
            }));
          }, r2.prototype._onWindowOnline = function() {
            this._update();
          }, r2.prototype._onWindowResize = function(t2) {
            this._trackResize && this.resize({originalEvent: t2})._update();
          }, a2.showTileBoundaries.get = function() {
            return !!this._showTileBoundaries;
          }, a2.showTileBoundaries.set = function(t2) {
            this._showTileBoundaries !== t2 && (this._showTileBoundaries = t2, this._update());
          }, a2.showPadding.get = function() {
            return !!this._showPadding;
          }, a2.showPadding.set = function(t2) {
            this._showPadding !== t2 && (this._showPadding = t2, this._update());
          }, a2.showCollisionBoxes.get = function() {
            return !!this._showCollisionBoxes;
          }, a2.showCollisionBoxes.set = function(t2) {
            this._showCollisionBoxes !== t2 && (this._showCollisionBoxes = t2, t2 ? this.style._generateCollisionBoxes() : this._update());
          }, a2.showOverdrawInspector.get = function() {
            return !!this._showOverdrawInspector;
          }, a2.showOverdrawInspector.set = function(t2) {
            this._showOverdrawInspector !== t2 && (this._showOverdrawInspector = t2, this._update());
          }, a2.repaint.get = function() {
            return !!this._repaint;
          }, a2.repaint.set = function(t2) {
            this._repaint !== t2 && (this._repaint = t2, this.triggerRepaint());
          }, a2.vertices.get = function() {
            return !!this._vertices;
          }, a2.vertices.set = function(t2) {
            this._vertices = t2, this._update();
          }, r2.prototype._setCacheLimits = function(e2, i2) {
            t.setCacheLimits(e2, i2);
          }, a2.version.get = function() {
            return t.version;
          }, Object.defineProperties(r2.prototype, a2), r2;
        }(vr);
        function Cr(t2) {
          t2.parentNode && t2.parentNode.removeChild(t2);
        }
        var zr = {showCompass: true, showZoom: true, visualizePitch: false}, Dr = function(e2) {
          var o2 = this;
          this.options = t.extend({}, zr, e2), this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._container.addEventListener("contextmenu", function(t2) {
            return t2.preventDefault();
          }), this.options.showZoom && (t.bindAll(["_setButtonTitle", "_updateZoomButtons"], this), this._zoomInButton = this._createButton("mapboxgl-ctrl-zoom-in", function(t2) {
            return o2._map.zoomIn({}, {originalEvent: t2});
          }), i.create("span", "mapboxgl-ctrl-icon", this._zoomInButton).setAttribute("aria-hidden", true), this._zoomOutButton = this._createButton("mapboxgl-ctrl-zoom-out", function(t2) {
            return o2._map.zoomOut({}, {originalEvent: t2});
          }), i.create("span", "mapboxgl-ctrl-icon", this._zoomOutButton).setAttribute("aria-hidden", true)), this.options.showCompass && (t.bindAll(["_rotateCompassArrow"], this), this._compass = this._createButton("mapboxgl-ctrl-compass", function(t2) {
            o2.options.visualizePitch ? o2._map.resetNorthPitch({}, {originalEvent: t2}) : o2._map.resetNorth({}, {originalEvent: t2});
          }), this._compassIcon = i.create("span", "mapboxgl-ctrl-icon", this._compass), this._compassIcon.setAttribute("aria-hidden", true));
        };
        Dr.prototype._updateZoomButtons = function() {
          var t2 = this._map.getZoom(), e2 = t2 === this._map.getMaxZoom(), i2 = t2 === this._map.getMinZoom();
          this._zoomInButton.disabled = e2, this._zoomOutButton.disabled = i2, this._zoomInButton.setAttribute("aria-disabled", e2.toString()), this._zoomOutButton.setAttribute("aria-disabled", i2.toString());
        }, Dr.prototype._rotateCompassArrow = function() {
          var t2 = this.options.visualizePitch ? "scale(" + 1 / Math.pow(Math.cos(this._map.transform.pitch * (Math.PI / 180)), 0.5) + ") rotateX(" + this._map.transform.pitch + "deg) rotateZ(" + this._map.transform.angle * (180 / Math.PI) + "deg)" : "rotate(" + this._map.transform.angle * (180 / Math.PI) + "deg)";
          this._compassIcon.style.transform = t2;
        }, Dr.prototype.onAdd = function(t2) {
          return this._map = t2, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"), this._setButtonTitle(this._zoomOutButton, "ZoomOut"), this._map.on("zoom", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"), this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow), this._map.on("rotate", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new Ar(this._map, this._compass, this.options.visualizePitch)), this._container;
        }, Dr.prototype.onRemove = function() {
          i.remove(this._container), this.options.showZoom && this._map.off("zoom", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow), this._map.off("rotate", this._rotateCompassArrow), this._handler.off(), delete this._handler), delete this._map;
        }, Dr.prototype._createButton = function(t2, e2) {
          var o2 = i.create("button", t2, this._container);
          return o2.type = "button", o2.addEventListener("click", e2), o2;
        }, Dr.prototype._setButtonTitle = function(t2, e2) {
          var i2 = this._map._getUIString("NavigationControl." + e2);
          t2.title = i2, t2.setAttribute("aria-label", i2);
        };
        var Ar = function(e2, o2, r2) {
          r2 === void 0 && (r2 = false), this._clickTolerance = 10, this.element = o2, this.mouseRotate = new Xo({clickTolerance: e2.dragRotate._mouseRotate._clickTolerance}), this.map = e2, r2 && (this.mousePitch = new Ho({clickTolerance: e2.dragRotate._mousePitch._clickTolerance})), t.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this), i.addEventListener(o2, "mousedown", this.mousedown), i.addEventListener(o2, "touchstart", this.touchstart, {passive: false}), i.addEventListener(o2, "touchmove", this.touchmove), i.addEventListener(o2, "touchend", this.touchend), i.addEventListener(o2, "touchcancel", this.reset);
        };
        function Mr(e2, i2, o2) {
          if (e2 = new t.LngLat(e2.lng, e2.lat), i2) {
            var r2 = new t.LngLat(e2.lng - 360, e2.lat), a2 = new t.LngLat(e2.lng + 360, e2.lat), n2 = o2.locationPoint(e2).distSqr(i2);
            o2.locationPoint(r2).distSqr(i2) < n2 ? e2 = r2 : o2.locationPoint(a2).distSqr(i2) < n2 && (e2 = a2);
          }
          for (; Math.abs(e2.lng - o2.center.lng) > 180; ) {
            var s2 = o2.locationPoint(e2);
            if (s2.x >= 0 && s2.y >= 0 && s2.x <= o2.width && s2.y <= o2.height)
              break;
            e2.lng > o2.center.lng ? e2.lng -= 360 : e2.lng += 360;
          }
          return e2;
        }
        Ar.prototype.down = function(t2, e2) {
          this.mouseRotate.mousedown(t2, e2), this.mousePitch && this.mousePitch.mousedown(t2, e2), i.disableDrag();
        }, Ar.prototype.move = function(t2, e2) {
          var i2 = this.map, o2 = this.mouseRotate.mousemoveWindow(t2, e2);
          if (o2 && o2.bearingDelta && i2.setBearing(i2.getBearing() + o2.bearingDelta), this.mousePitch) {
            var r2 = this.mousePitch.mousemoveWindow(t2, e2);
            r2 && r2.pitchDelta && i2.setPitch(i2.getPitch() + r2.pitchDelta);
          }
        }, Ar.prototype.off = function() {
          var t2 = this.element;
          i.removeEventListener(t2, "mousedown", this.mousedown), i.removeEventListener(t2, "touchstart", this.touchstart, {passive: false}), i.removeEventListener(t2, "touchmove", this.touchmove), i.removeEventListener(t2, "touchend", this.touchend), i.removeEventListener(t2, "touchcancel", this.reset), this.offTemp();
        }, Ar.prototype.offTemp = function() {
          i.enableDrag(), i.removeEventListener(t.window, "mousemove", this.mousemove), i.removeEventListener(t.window, "mouseup", this.mouseup);
        }, Ar.prototype.mousedown = function(e2) {
          this.down(t.extend({}, e2, {ctrlKey: true, preventDefault: function() {
            return e2.preventDefault();
          }}), i.mousePos(this.element, e2)), i.addEventListener(t.window, "mousemove", this.mousemove), i.addEventListener(t.window, "mouseup", this.mouseup);
        }, Ar.prototype.mousemove = function(t2) {
          this.move(t2, i.mousePos(this.element, t2));
        }, Ar.prototype.mouseup = function(t2) {
          this.mouseRotate.mouseupWindow(t2), this.mousePitch && this.mousePitch.mouseupWindow(t2), this.offTemp();
        }, Ar.prototype.touchstart = function(t2) {
          t2.targetTouches.length !== 1 ? this.reset() : (this._startPos = this._lastPos = i.touchPos(this.element, t2.targetTouches)[0], this.down({type: "mousedown", button: 0, ctrlKey: true, preventDefault: function() {
            return t2.preventDefault();
          }}, this._startPos));
        }, Ar.prototype.touchmove = function(t2) {
          t2.targetTouches.length !== 1 ? this.reset() : (this._lastPos = i.touchPos(this.element, t2.targetTouches)[0], this.move({preventDefault: function() {
            return t2.preventDefault();
          }}, this._lastPos));
        }, Ar.prototype.touchend = function(t2) {
          t2.targetTouches.length === 0 && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset();
        }, Ar.prototype.reset = function() {
          this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp();
        };
        var Lr = {center: "translate(-50%,-50%)", top: "translate(-50%,0)", "top-left": "translate(0,0)", "top-right": "translate(-100%,0)", bottom: "translate(-50%,-100%)", "bottom-left": "translate(0,-100%)", "bottom-right": "translate(-100%,-100%)", left: "translate(0,-50%)", right: "translate(-100%,-50%)"};
        function Rr(t2, e2, i2) {
          var o2 = t2.classList;
          for (var r2 in Lr)
            o2.remove("mapboxgl-" + i2 + "-anchor-" + r2);
          o2.add("mapboxgl-" + i2 + "-anchor-" + e2);
        }
        var kr, Br = function(e2) {
          function o2(o3, r2) {
            if (e2.call(this), (o3 instanceof t.window.HTMLElement || r2) && (o3 = t.extend({element: o3}, r2)), t.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress"], this), this._anchor = o3 && o3.anchor || "center", this._color = o3 && o3.color || "#3FB1CE", this._scale = o3 && o3.scale || 1, this._draggable = o3 && o3.draggable || false, this._clickTolerance = o3 && o3.clickTolerance || 0, this._isDragging = false, this._state = "inactive", this._rotation = o3 && o3.rotation || 0, this._rotationAlignment = o3 && o3.rotationAlignment || "auto", this._pitchAlignment = o3 && o3.pitchAlignment && o3.pitchAlignment !== "auto" ? o3.pitchAlignment : this._rotationAlignment, o3 && o3.element)
              this._element = o3.element, this._offset = t.Point.convert(o3 && o3.offset || [0, 0]);
            else {
              this._defaultMarker = true, this._element = i.create("div"), this._element.setAttribute("aria-label", "Map marker");
              var a2 = i.createNS("http://www.w3.org/2000/svg", "svg");
              a2.setAttributeNS(null, "display", "block"), a2.setAttributeNS(null, "height", "41px"), a2.setAttributeNS(null, "width", "27px"), a2.setAttributeNS(null, "viewBox", "0 0 27 41");
              var n2 = i.createNS("http://www.w3.org/2000/svg", "g");
              n2.setAttributeNS(null, "stroke", "none"), n2.setAttributeNS(null, "stroke-width", "1"), n2.setAttributeNS(null, "fill", "none"), n2.setAttributeNS(null, "fill-rule", "evenodd");
              var s2 = i.createNS("http://www.w3.org/2000/svg", "g");
              s2.setAttributeNS(null, "fill-rule", "nonzero");
              var l2 = i.createNS("http://www.w3.org/2000/svg", "g");
              l2.setAttributeNS(null, "transform", "translate(3.0, 29.0)"), l2.setAttributeNS(null, "fill", "#000000");
              for (var c2 = 0, u2 = [{rx: "10.5", ry: "5.25002273"}, {rx: "10.5", ry: "5.25002273"}, {rx: "9.5", ry: "4.77275007"}, {rx: "8.5", ry: "4.29549936"}, {rx: "7.5", ry: "3.81822308"}, {rx: "6.5", ry: "3.34094679"}, {rx: "5.5", ry: "2.86367051"}, {rx: "4.5", ry: "2.38636864"}]; c2 < u2.length; c2 += 1) {
                var h2 = u2[c2], p2 = i.createNS("http://www.w3.org/2000/svg", "ellipse");
                p2.setAttributeNS(null, "opacity", "0.04"), p2.setAttributeNS(null, "cx", "10.5"), p2.setAttributeNS(null, "cy", "5.80029008"), p2.setAttributeNS(null, "rx", h2.rx), p2.setAttributeNS(null, "ry", h2.ry), l2.appendChild(p2);
              }
              var d2 = i.createNS("http://www.w3.org/2000/svg", "g");
              d2.setAttributeNS(null, "fill", this._color);
              var _2 = i.createNS("http://www.w3.org/2000/svg", "path");
              _2.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"), d2.appendChild(_2);
              var f2 = i.createNS("http://www.w3.org/2000/svg", "g");
              f2.setAttributeNS(null, "opacity", "0.25"), f2.setAttributeNS(null, "fill", "#000000");
              var m2 = i.createNS("http://www.w3.org/2000/svg", "path");
              m2.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"), f2.appendChild(m2);
              var g2 = i.createNS("http://www.w3.org/2000/svg", "g");
              g2.setAttributeNS(null, "transform", "translate(6.0, 7.0)"), g2.setAttributeNS(null, "fill", "#FFFFFF");
              var v2 = i.createNS("http://www.w3.org/2000/svg", "g");
              v2.setAttributeNS(null, "transform", "translate(8.0, 8.0)");
              var y2 = i.createNS("http://www.w3.org/2000/svg", "circle");
              y2.setAttributeNS(null, "fill", "#000000"), y2.setAttributeNS(null, "opacity", "0.25"), y2.setAttributeNS(null, "cx", "5.5"), y2.setAttributeNS(null, "cy", "5.5"), y2.setAttributeNS(null, "r", "5.4999962");
              var x2 = i.createNS("http://www.w3.org/2000/svg", "circle");
              x2.setAttributeNS(null, "fill", "#FFFFFF"), x2.setAttributeNS(null, "cx", "5.5"), x2.setAttributeNS(null, "cy", "5.5"), x2.setAttributeNS(null, "r", "5.4999962"), v2.appendChild(y2), v2.appendChild(x2), s2.appendChild(l2), s2.appendChild(d2), s2.appendChild(f2), s2.appendChild(g2), s2.appendChild(v2), a2.appendChild(s2), a2.setAttributeNS(null, "height", 41 * this._scale + "px"), a2.setAttributeNS(null, "width", 27 * this._scale + "px"), this._element.appendChild(a2), this._offset = t.Point.convert(o3 && o3.offset || [0, -14]);
            }
            this._element.classList.add("mapboxgl-marker"), this._element.addEventListener("dragstart", function(t2) {
              t2.preventDefault();
            }), this._element.addEventListener("mousedown", function(t2) {
              t2.preventDefault();
            }), Rr(this._element, this._anchor, "marker"), this._popup = null;
          }
          return e2 && (o2.__proto__ = e2), (o2.prototype = Object.create(e2 && e2.prototype)).constructor = o2, o2.prototype.addTo = function(t2) {
            return this.remove(), this._map = t2, t2.getCanvasContainer().appendChild(this._element), t2.on("move", this._update), t2.on("moveend", this._update), this.setDraggable(this._draggable), this._update(), this._map.on("click", this._onMapClick), this;
          }, o2.prototype.remove = function() {
            return this._map && (this._map.off("click", this._onMapClick), this._map.off("move", this._update), this._map.off("moveend", this._update), this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler), this._map.off("mouseup", this._onUp), this._map.off("touchend", this._onUp), this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), delete this._map), i.remove(this._element), this._popup && this._popup.remove(), this;
          }, o2.prototype.getLngLat = function() {
            return this._lngLat;
          }, o2.prototype.setLngLat = function(e3) {
            return this._lngLat = t.LngLat.convert(e3), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(), this;
          }, o2.prototype.getElement = function() {
            return this._element;
          }, o2.prototype.setPopup = function(t2) {
            if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeEventListener("keypress", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute("tabindex")), t2) {
              if (!("offset" in t2.options)) {
                var e3 = Math.sqrt(Math.pow(13.5, 2) / 2);
                t2.options.offset = this._defaultMarker ? {top: [0, 0], "top-left": [0, 0], "top-right": [0, 0], bottom: [0, -38.1], "bottom-left": [e3, -1 * (24.6 + e3)], "bottom-right": [-e3, -1 * (24.6 + e3)], left: [13.5, -24.6], right: [-13.5, -24.6]} : this._offset;
              }
              this._popup = t2, this._lngLat && this._popup.setLngLat(this._lngLat), this._originalTabIndex = this._element.getAttribute("tabindex"), this._originalTabIndex || this._element.setAttribute("tabindex", "0"), this._element.addEventListener("keypress", this._onKeyPress);
            }
            return this;
          }, o2.prototype._onKeyPress = function(t2) {
            var e3 = t2.code, i2 = t2.charCode || t2.keyCode;
            e3 !== "Space" && e3 !== "Enter" && i2 !== 32 && i2 !== 13 || this.togglePopup();
          }, o2.prototype._onMapClick = function(t2) {
            var e3 = t2.originalEvent.target, i2 = this._element;
            this._popup && (e3 === i2 || i2.contains(e3)) && this.togglePopup();
          }, o2.prototype.getPopup = function() {
            return this._popup;
          }, o2.prototype.togglePopup = function() {
            var t2 = this._popup;
            return t2 ? (t2.isOpen() ? t2.remove() : t2.addTo(this._map), this) : this;
          }, o2.prototype._update = function(t2) {
            if (this._map) {
              this._map.transform.renderWorldCopies && (this._lngLat = Mr(this._lngLat, this._pos, this._map.transform)), this._pos = this._map.project(this._lngLat)._add(this._offset);
              var e3 = "";
              this._rotationAlignment === "viewport" || this._rotationAlignment === "auto" ? e3 = "rotateZ(" + this._rotation + "deg)" : this._rotationAlignment === "map" && (e3 = "rotateZ(" + (this._rotation - this._map.getBearing()) + "deg)");
              var o3 = "";
              this._pitchAlignment === "viewport" || this._pitchAlignment === "auto" ? o3 = "rotateX(0deg)" : this._pitchAlignment === "map" && (o3 = "rotateX(" + this._map.getPitch() + "deg)"), t2 && t2.type !== "moveend" || (this._pos = this._pos.round()), i.setTransform(this._element, Lr[this._anchor] + " translate(" + this._pos.x + "px, " + this._pos.y + "px) " + o3 + " " + e3);
            }
          }, o2.prototype.getOffset = function() {
            return this._offset;
          }, o2.prototype.setOffset = function(e3) {
            return this._offset = t.Point.convert(e3), this._update(), this;
          }, o2.prototype._onMove = function(e3) {
            if (!this._isDragging) {
              var i2 = this._clickTolerance || this._map._clickTolerance;
              this._isDragging = e3.point.dist(this._pointerdownPos) >= i2;
            }
            this._isDragging && (this._pos = e3.point.sub(this._positionDelta), this._lngLat = this._map.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = "none", this._state === "pending" && (this._state = "active", this.fire(new t.Event("dragstart"))), this.fire(new t.Event("drag")));
          }, o2.prototype._onUp = function() {
            this._element.style.pointerEvents = "auto", this._positionDelta = null, this._pointerdownPos = null, this._isDragging = false, this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), this._state === "active" && this.fire(new t.Event("dragend")), this._state = "inactive";
          }, o2.prototype._addDragHandler = function(t2) {
            this._element.contains(t2.originalEvent.target) && (t2.preventDefault(), this._positionDelta = t2.point.sub(this._pos).add(this._offset), this._pointerdownPos = t2.point, this._state = "pending", this._map.on("mousemove", this._onMove), this._map.on("touchmove", this._onMove), this._map.once("mouseup", this._onUp), this._map.once("touchend", this._onUp));
          }, o2.prototype.setDraggable = function(t2) {
            return this._draggable = !!t2, this._map && (t2 ? (this._map.on("mousedown", this._addDragHandler), this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler))), this;
          }, o2.prototype.isDraggable = function() {
            return this._draggable;
          }, o2.prototype.setRotation = function(t2) {
            return this._rotation = t2 || 0, this._update(), this;
          }, o2.prototype.getRotation = function() {
            return this._rotation;
          }, o2.prototype.setRotationAlignment = function(t2) {
            return this._rotationAlignment = t2 || "auto", this._update(), this;
          }, o2.prototype.getRotationAlignment = function() {
            return this._rotationAlignment;
          }, o2.prototype.setPitchAlignment = function(t2) {
            return this._pitchAlignment = t2 && t2 !== "auto" ? t2 : this._rotationAlignment, this._update(), this;
          }, o2.prototype.getPitchAlignment = function() {
            return this._pitchAlignment;
          }, o2;
        }(t.Evented), Or = {positionOptions: {enableHighAccuracy: false, maximumAge: 0, timeout: 6e3}, fitBoundsOptions: {maxZoom: 15}, trackUserLocation: false, showAccuracyCircle: true, showUserLocation: true}, Fr = 0, Ur = false, Nr = function(e2) {
          function o2(i2) {
            e2.call(this), this.options = t.extend({}, Or, i2), t.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker"], this);
          }
          return e2 && (o2.__proto__ = e2), (o2.prototype = Object.create(e2 && e2.prototype)).constructor = o2, o2.prototype.onAdd = function(e3) {
            var o3;
            return this._map = e3, this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), o3 = this._setupUI, kr !== void 0 ? o3(kr) : t.window.navigator.permissions !== void 0 ? t.window.navigator.permissions.query({name: "geolocation"}).then(function(t2) {
              o3(kr = t2.state !== "denied");
            }) : o3(kr = !!t.window.navigator.geolocation), this._container;
          }, o2.prototype.onRemove = function() {
            this._geolocationWatchID !== void 0 && (t.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), i.remove(this._container), this._map.off("zoom", this._onZoom), this._map = void 0, Fr = 0, Ur = false;
          }, o2.prototype._isOutOfMapMaxBounds = function(t2) {
            var e3 = this._map.getMaxBounds(), i2 = t2.coords;
            return e3 && (i2.longitude < e3.getWest() || i2.longitude > e3.getEast() || i2.latitude < e3.getSouth() || i2.latitude > e3.getNorth());
          }, o2.prototype._setErrorState = function() {
            switch (this._watchState) {
              case "WAITING_ACTIVE":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                break;
              case "ACTIVE_LOCK":
                this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
                break;
              case "BACKGROUND":
                this._watchState = "BACKGROUND_ERROR", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
            }
          }, o2.prototype._onSuccess = function(e3) {
            if (this._map) {
              if (this._isOutOfMapMaxBounds(e3))
                return this._setErrorState(), this.fire(new t.Event("outofmaxbounds", e3)), this._updateMarker(), void this._finish();
              if (this.options.trackUserLocation)
                switch (this._lastKnownPosition = e3, this._watchState) {
                  case "WAITING_ACTIVE":
                  case "ACTIVE_LOCK":
                  case "ACTIVE_ERROR":
                    this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                    break;
                  case "BACKGROUND":
                  case "BACKGROUND_ERROR":
                    this._watchState = "BACKGROUND", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");
                }
              this.options.showUserLocation && this._watchState !== "OFF" && this._updateMarker(e3), this.options.trackUserLocation && this._watchState !== "ACTIVE_LOCK" || this._updateCamera(e3), this.options.showUserLocation && this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"), this.fire(new t.Event("geolocate", e3)), this._finish();
            }
          }, o2.prototype._updateCamera = function(e3) {
            var i2 = new t.LngLat(e3.coords.longitude, e3.coords.latitude), o3 = e3.coords.accuracy, r2 = this._map.getBearing(), a2 = t.extend({bearing: r2}, this.options.fitBoundsOptions);
            this._map.fitBounds(i2.toBounds(o3), a2, {geolocateSource: true});
          }, o2.prototype._updateMarker = function(e3) {
            if (e3) {
              var i2 = new t.LngLat(e3.coords.longitude, e3.coords.latitude);
              this._accuracyCircleMarker.setLngLat(i2).addTo(this._map), this._userLocationDotMarker.setLngLat(i2).addTo(this._map), this._accuracy = e3.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
            } else
              this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove();
          }, o2.prototype._updateCircleRadius = function() {
            var t2 = this._map._container.clientHeight / 2, e3 = this._map.unproject([0, t2]), i2 = this._map.unproject([1, t2]), o3 = e3.distanceTo(i2), r2 = Math.ceil(2 * this._accuracy / o3);
            this._circleElement.style.width = r2 + "px", this._circleElement.style.height = r2 + "px";
          }, o2.prototype._onZoom = function() {
            this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
          }, o2.prototype._onError = function(e3) {
            if (this._map) {
              if (this.options.trackUserLocation)
                if (e3.code === 1) {
                  this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this._geolocateButton.disabled = true;
                  var i2 = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                  this._geolocateButton.title = i2, this._geolocateButton.setAttribute("aria-label", i2), this._geolocationWatchID !== void 0 && this._clearWatch();
                } else {
                  if (e3.code === 3 && Ur)
                    return;
                  this._setErrorState();
                }
              this._watchState !== "OFF" && this.options.showUserLocation && this._dotElement.classList.add("mapboxgl-user-location-dot-stale"), this.fire(new t.Event("error", e3)), this._finish();
            }
          }, o2.prototype._finish = function() {
            this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0;
          }, o2.prototype._setupUI = function(e3) {
            var o3 = this;
            if (this._container.addEventListener("contextmenu", function(t2) {
              return t2.preventDefault();
            }), this._geolocateButton = i.create("button", "mapboxgl-ctrl-geolocate", this._container), i.create("span", "mapboxgl-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", true), this._geolocateButton.type = "button", e3 === false) {
              t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");
              var r2 = this._map._getUIString("GeolocateControl.LocationNotAvailable");
              this._geolocateButton.disabled = true, this._geolocateButton.title = r2, this._geolocateButton.setAttribute("aria-label", r2);
            } else {
              var a2 = this._map._getUIString("GeolocateControl.FindMyLocation");
              this._geolocateButton.title = a2, this._geolocateButton.setAttribute("aria-label", a2);
            }
            this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"), this._watchState = "OFF"), this.options.showUserLocation && (this._dotElement = i.create("div", "mapboxgl-user-location-dot"), this._userLocationDotMarker = new Br(this._dotElement), this._circleElement = i.create("div", "mapboxgl-user-location-accuracy-circle"), this._accuracyCircleMarker = new Br({element: this._circleElement, pitchAlignment: "map"}), this.options.trackUserLocation && (this._watchState = "OFF"), this._map.on("zoom", this._onZoom)), this._geolocateButton.addEventListener("click", this.trigger.bind(this)), this._setup = true, this.options.trackUserLocation && this._map.on("movestart", function(e4) {
              e4.geolocateSource || o3._watchState !== "ACTIVE_LOCK" || e4.originalEvent && e4.originalEvent.type === "resize" || (o3._watchState = "BACKGROUND", o3._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"), o3._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), o3.fire(new t.Event("trackuserlocationend")));
            });
          }, o2.prototype.trigger = function() {
            if (!this._setup)
              return t.warnOnce("Geolocate control triggered before added to a map"), false;
            if (this.options.trackUserLocation) {
              switch (this._watchState) {
                case "OFF":
                  this._watchState = "WAITING_ACTIVE", this.fire(new t.Event("trackuserlocationstart"));
                  break;
                case "WAITING_ACTIVE":
                case "ACTIVE_LOCK":
                case "ACTIVE_ERROR":
                case "BACKGROUND_ERROR":
                  Fr--, Ur = false, this._watchState = "OFF", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"), this.fire(new t.Event("trackuserlocationend"));
                  break;
                case "BACKGROUND":
                  this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new t.Event("trackuserlocationstart"));
              }
              switch (this._watchState) {
                case "WAITING_ACTIVE":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                  break;
                case "ACTIVE_LOCK":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
                  break;
                case "ACTIVE_ERROR":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");
                  break;
                case "BACKGROUND":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");
                  break;
                case "BACKGROUND_ERROR":
                  this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");
              }
              if (this._watchState === "OFF" && this._geolocationWatchID !== void 0)
                this._clearWatch();
              else if (this._geolocationWatchID === void 0) {
                var e3;
                this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "true"), ++Fr > 1 ? (e3 = {maximumAge: 6e5, timeout: 0}, Ur = true) : (e3 = this.options.positionOptions, Ur = false), this._geolocationWatchID = t.window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, e3);
              }
            } else
              t.window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);
            return true;
          }, o2.prototype._clearWatch = function() {
            t.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "false"), this.options.showUserLocation && this._updateMarker(null);
          }, o2;
        }(t.Evented), Zr = {maxWidth: 100, unit: "metric"}, qr = function(e2) {
          this.options = t.extend({}, Zr, e2), t.bindAll(["_onMove", "setUnit"], this);
        };
        function jr(t2, e2, i2) {
          var o2 = i2 && i2.maxWidth || 100, r2 = t2._container.clientHeight / 2, a2 = t2.unproject([0, r2]), n2 = t2.unproject([o2, r2]), s2 = a2.distanceTo(n2);
          if (i2 && i2.unit === "imperial") {
            var l2 = 3.2808 * s2;
            l2 > 5280 ? Vr(e2, o2, l2 / 5280, t2._getUIString("ScaleControl.Miles")) : Vr(e2, o2, l2, t2._getUIString("ScaleControl.Feet"));
          } else
            i2 && i2.unit === "nautical" ? Vr(e2, o2, s2 / 1852, t2._getUIString("ScaleControl.NauticalMiles")) : s2 >= 1e3 ? Vr(e2, o2, s2 / 1e3, t2._getUIString("ScaleControl.Kilometers")) : Vr(e2, o2, s2, t2._getUIString("ScaleControl.Meters"));
        }
        function Vr(t2, e2, i2, o2) {
          var r2, a2, n2, s2 = (r2 = i2, (a2 = Math.pow(10, ("" + Math.floor(r2)).length - 1)) * (n2 = (n2 = r2 / a2) >= 10 ? 10 : n2 >= 5 ? 5 : n2 >= 3 ? 3 : n2 >= 2 ? 2 : n2 >= 1 ? 1 : function(t3) {
            var e3 = Math.pow(10, Math.ceil(-Math.log(t3) / Math.LN10));
            return Math.round(t3 * e3) / e3;
          }(n2)));
          t2.style.width = e2 * (s2 / i2) + "px", t2.innerHTML = s2 + "&nbsp;" + o2;
        }
        qr.prototype.getDefaultPosition = function() {
          return "bottom-left";
        }, qr.prototype._onMove = function() {
          jr(this._map, this._container, this.options);
        }, qr.prototype.onAdd = function(t2) {
          return this._map = t2, this._container = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-scale", t2.getContainer()), this._map.on("move", this._onMove), this._onMove(), this._container;
        }, qr.prototype.onRemove = function() {
          i.remove(this._container), this._map.off("move", this._onMove), this._map = void 0;
        }, qr.prototype.setUnit = function(t2) {
          this.options.unit = t2, jr(this._map, this._container, this.options);
        };
        var Gr = function(e2) {
          this._fullscreen = false, e2 && e2.container && (e2.container instanceof t.window.HTMLElement ? this._container = e2.container : t.warnOnce("Full screen control 'container' must be a DOM element.")), t.bindAll(["_onClickFullscreen", "_changeIcon"], this), "onfullscreenchange" in t.window.document ? this._fullscreenchange = "fullscreenchange" : "onmozfullscreenchange" in t.window.document ? this._fullscreenchange = "mozfullscreenchange" : "onwebkitfullscreenchange" in t.window.document ? this._fullscreenchange = "webkitfullscreenchange" : "onmsfullscreenchange" in t.window.document && (this._fullscreenchange = "MSFullscreenChange");
        };
        Gr.prototype.onAdd = function(e2) {
          return this._map = e2, this._container || (this._container = this._map.getContainer()), this._controlContainer = i.create("div", "mapboxgl-ctrl mapboxgl-ctrl-group"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none", t.warnOnce("This device does not support fullscreen mode.")), this._controlContainer;
        }, Gr.prototype.onRemove = function() {
          i.remove(this._controlContainer), this._map = null, t.window.document.removeEventListener(this._fullscreenchange, this._changeIcon);
        }, Gr.prototype._checkFullscreenSupport = function() {
          return !!(t.window.document.fullscreenEnabled || t.window.document.mozFullScreenEnabled || t.window.document.msFullscreenEnabled || t.window.document.webkitFullscreenEnabled);
        }, Gr.prototype._setupUI = function() {
          var e2 = this._fullscreenButton = i.create("button", "mapboxgl-ctrl-fullscreen", this._controlContainer);
          i.create("span", "mapboxgl-ctrl-icon", e2).setAttribute("aria-hidden", true), e2.type = "button", this._updateTitle(), this._fullscreenButton.addEventListener("click", this._onClickFullscreen), t.window.document.addEventListener(this._fullscreenchange, this._changeIcon);
        }, Gr.prototype._updateTitle = function() {
          var t2 = this._getTitle();
          this._fullscreenButton.setAttribute("aria-label", t2), this._fullscreenButton.title = t2;
        }, Gr.prototype._getTitle = function() {
          return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter");
        }, Gr.prototype._isFullscreen = function() {
          return this._fullscreen;
        }, Gr.prototype._changeIcon = function() {
          (t.window.document.fullscreenElement || t.window.document.mozFullScreenElement || t.window.document.webkitFullscreenElement || t.window.document.msFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"), this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"), this._updateTitle());
        }, Gr.prototype._onClickFullscreen = function() {
          this._isFullscreen() ? t.window.document.exitFullscreen ? t.window.document.exitFullscreen() : t.window.document.mozCancelFullScreen ? t.window.document.mozCancelFullScreen() : t.window.document.msExitFullscreen ? t.window.document.msExitFullscreen() : t.window.document.webkitCancelFullScreen && t.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.mozRequestFullScreen ? this._container.mozRequestFullScreen() : this._container.msRequestFullscreen ? this._container.msRequestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen();
        };
        var Wr = {closeButton: true, closeOnClick: true, focusAfterOpen: true, className: "", maxWidth: "240px"}, Xr = ["a[href]", "[tabindex]:not([tabindex='-1'])", "[contenteditable]:not([contenteditable='false'])", "button:not([disabled])", "input:not([disabled])", "select:not([disabled])", "textarea:not([disabled])"].join(", "), Hr = function(e2) {
          function o2(i2) {
            e2.call(this), this.options = t.extend(Object.create(Wr), i2), t.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], this);
          }
          return e2 && (o2.__proto__ = e2), (o2.prototype = Object.create(e2 && e2.prototype)).constructor = o2, o2.prototype.addTo = function(e3) {
            return this._map && this.remove(), this._map = e3, this.options.closeOnClick && this._map.on("click", this._onClose), this.options.closeOnMove && this._map.on("move", this._onClose), this._map.on("remove", this.remove), this._update(), this._focusFirstElement(), this._trackPointer ? (this._map.on("mousemove", this._onMouseMove), this._map.on("mouseup", this._onMouseUp), this._container && this._container.classList.add("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")) : this._map.on("move", this._update), this.fire(new t.Event("open")), this;
          }, o2.prototype.isOpen = function() {
            return !!this._map;
          }, o2.prototype.remove = function() {
            return this._content && i.remove(this._content), this._container && (i.remove(this._container), delete this._container), this._map && (this._map.off("move", this._update), this._map.off("move", this._onClose), this._map.off("click", this._onClose), this._map.off("remove", this.remove), this._map.off("mousemove", this._onMouseMove), this._map.off("mouseup", this._onMouseUp), this._map.off("drag", this._onDrag), delete this._map), this.fire(new t.Event("close")), this;
          }, o2.prototype.getLngLat = function() {
            return this._lngLat;
          }, o2.prototype.setLngLat = function(e3) {
            return this._lngLat = t.LngLat.convert(e3), this._pos = null, this._trackPointer = false, this._update(), this._map && (this._map.on("move", this._update), this._map.off("mousemove", this._onMouseMove), this._container && this._container.classList.remove("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")), this;
          }, o2.prototype.trackPointer = function() {
            return this._trackPointer = true, this._pos = null, this._update(), this._map && (this._map.off("move", this._update), this._map.on("mousemove", this._onMouseMove), this._map.on("drag", this._onDrag), this._container && this._container.classList.add("mapboxgl-popup-track-pointer"), this._map._canvasContainer.classList.add("mapboxgl-track-pointer")), this;
          }, o2.prototype.getElement = function() {
            return this._container;
          }, o2.prototype.setText = function(e3) {
            return this.setDOMContent(t.window.document.createTextNode(e3));
          }, o2.prototype.setHTML = function(e3) {
            var i2, o3 = t.window.document.createDocumentFragment(), r2 = t.window.document.createElement("body");
            for (r2.innerHTML = e3; i2 = r2.firstChild; )
              o3.appendChild(i2);
            return this.setDOMContent(o3);
          }, o2.prototype.getMaxWidth = function() {
            return this._container && this._container.style.maxWidth;
          }, o2.prototype.setMaxWidth = function(t2) {
            return this.options.maxWidth = t2, this._update(), this;
          }, o2.prototype.setDOMContent = function(t2) {
            if (this._content)
              for (; this._content.hasChildNodes(); )
                this._content.firstChild && this._content.removeChild(this._content.firstChild);
            else
              this._content = i.create("div", "mapboxgl-popup-content", this._container);
            return this._content.appendChild(t2), this._createCloseButton(), this._update(), this._focusFirstElement(), this;
          }, o2.prototype.addClassName = function(t2) {
            this._container && this._container.classList.add(t2);
          }, o2.prototype.removeClassName = function(t2) {
            this._container && this._container.classList.remove(t2);
          }, o2.prototype.setOffset = function(t2) {
            return this.options.offset = t2, this._update(), this;
          }, o2.prototype.toggleClassName = function(t2) {
            if (this._container)
              return this._container.classList.toggle(t2);
          }, o2.prototype._createCloseButton = function() {
            this.options.closeButton && (this._closeButton = i.create("button", "mapboxgl-popup-close-button", this._content), this._closeButton.type = "button", this._closeButton.setAttribute("aria-label", "Close popup"), this._closeButton.innerHTML = "&#215;", this._closeButton.addEventListener("click", this._onClose));
          }, o2.prototype._onMouseUp = function(t2) {
            this._update(t2.point);
          }, o2.prototype._onMouseMove = function(t2) {
            this._update(t2.point);
          }, o2.prototype._onDrag = function(t2) {
            this._update(t2.point);
          }, o2.prototype._update = function(e3) {
            var o3 = this;
            if (this._map && (this._lngLat || this._trackPointer) && this._content && (this._container || (this._container = i.create("div", "mapboxgl-popup", this._map.getContainer()), this._tip = i.create("div", "mapboxgl-popup-tip", this._container), this._container.appendChild(this._content), this.options.className && this.options.className.split(" ").forEach(function(t2) {
              return o3._container.classList.add(t2);
            }), this._trackPointer && this._container.classList.add("mapboxgl-popup-track-pointer")), this.options.maxWidth && this._container.style.maxWidth !== this.options.maxWidth && (this._container.style.maxWidth = this.options.maxWidth), this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = Mr(this._lngLat, this._pos, this._map.transform)), !this._trackPointer || e3)) {
              var r2 = this._pos = this._trackPointer && e3 ? e3 : this._map.project(this._lngLat), a2 = this.options.anchor, n2 = function e4(i2) {
                if (i2) {
                  if (typeof i2 == "number") {
                    var o4 = Math.round(Math.sqrt(0.5 * Math.pow(i2, 2)));
                    return {center: new t.Point(0, 0), top: new t.Point(0, i2), "top-left": new t.Point(o4, o4), "top-right": new t.Point(-o4, o4), bottom: new t.Point(0, -i2), "bottom-left": new t.Point(o4, -o4), "bottom-right": new t.Point(-o4, -o4), left: new t.Point(i2, 0), right: new t.Point(-i2, 0)};
                  }
                  if (i2 instanceof t.Point || Array.isArray(i2)) {
                    var r3 = t.Point.convert(i2);
                    return {center: r3, top: r3, "top-left": r3, "top-right": r3, bottom: r3, "bottom-left": r3, "bottom-right": r3, left: r3, right: r3};
                  }
                  return {center: t.Point.convert(i2.center || [0, 0]), top: t.Point.convert(i2.top || [0, 0]), "top-left": t.Point.convert(i2["top-left"] || [0, 0]), "top-right": t.Point.convert(i2["top-right"] || [0, 0]), bottom: t.Point.convert(i2.bottom || [0, 0]), "bottom-left": t.Point.convert(i2["bottom-left"] || [0, 0]), "bottom-right": t.Point.convert(i2["bottom-right"] || [0, 0]), left: t.Point.convert(i2.left || [0, 0]), right: t.Point.convert(i2.right || [0, 0])};
                }
                return e4(new t.Point(0, 0));
              }(this.options.offset);
              if (!a2) {
                var s2, l2 = this._container.offsetWidth, c2 = this._container.offsetHeight;
                s2 = r2.y + n2.bottom.y < c2 ? ["top"] : r2.y > this._map.transform.height - c2 ? ["bottom"] : [], r2.x < l2 / 2 ? s2.push("left") : r2.x > this._map.transform.width - l2 / 2 && s2.push("right"), a2 = s2.length === 0 ? "bottom" : s2.join("-");
              }
              var u2 = r2.add(n2[a2]).round();
              i.setTransform(this._container, Lr[a2] + " translate(" + u2.x + "px," + u2.y + "px)"), Rr(this._container, a2, "popup");
            }
          }, o2.prototype._focusFirstElement = function() {
            if (this.options.focusAfterOpen && this._container) {
              var t2 = this._container.querySelector(Xr);
              t2 && t2.focus();
            }
          }, o2.prototype._onClose = function() {
            this.remove();
          }, o2;
        }(t.Evented), Kr = {version: t.version, supported: e, setRTLTextPlugin: t.setRTLTextPlugin, getRTLTextPluginStatus: t.getRTLTextPluginStatus, Map: Sr, NavigationControl: Dr, GeolocateControl: Nr, AttributionControl: yr, ScaleControl: qr, FullscreenControl: Gr, Popup: Hr, Marker: Br, Style: je, LngLat: t.LngLat, LngLatBounds: t.LngLatBounds, Point: t.Point, MercatorCoordinate: t.MercatorCoordinate, Evented: t.Evented, config: t.config, prewarm: function() {
          Ft().acquire(Rt);
        }, clearPrewarmedResources: function() {
          var t2 = Bt;
          t2 && (t2.isPreloaded() && t2.numActive() === 1 ? (t2.release(Rt), Bt = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"));
        }, get accessToken() {
          return t.config.ACCESS_TOKEN;
        }, set accessToken(e2) {
          t.config.ACCESS_TOKEN = e2;
        }, get baseApiUrl() {
          return t.config.API_URL;
        }, set baseApiUrl(e2) {
          t.config.API_URL = e2;
        }, get workerCount() {
          return kt.workerCount;
        }, set workerCount(t2) {
          kt.workerCount = t2;
        }, get maxParallelImageRequests() {
          return t.config.MAX_PARALLEL_IMAGE_REQUESTS;
        }, set maxParallelImageRequests(e2) {
          t.config.MAX_PARALLEL_IMAGE_REQUESTS = e2;
        }, clearStorage: function(e2) {
          t.clearTileCache(e2);
        }, workerUrl: ""};
        return Kr;
      });
      return maplibregl;
    });
  });

  // index.ts
  const maplibre_gl = __toModule(require_maplibre_gl());
  const map = new maplibre_gl.Map({
    container: "map",
    style: "https://tile.openstreetmap.jp/styles/osm-bright/style.json",
    center: [139.767184, 35.680952],
    zoom: 16,
    pitch: 55
  });
  const context = new (window.AudioContext || window.webkitAudioContext)();
  let musicBuffer = null;
  const bins = 16;
  const analyser = context.createAnalyser();
  analyser.minDecibels = -90;
  analyser.maxDecibels = -10;
  analyser.smoothingTimeConstant = 0.05;
  analyser.fftSize = bins * 2;
  let bufferSource;
  let loaded = false;
  let playing = false;
  const playSilence = () => {
    const buf = context.createBuffer(1, 1, 22050);
    const src = context.createBufferSource();
    src.buffer = buf;
    src.connect(context.destination);
    src.start(0);
  };
  const play = (buffer) => {
    bufferSource = context.createBufferSource();
    bufferSource.buffer = buffer;
    bufferSource.loop = true;
    bufferSource.connect(context.destination);
    bufferSource.connect(analyser);
    bufferSource.start(context.currentTime + 0.1);
  };
  const loadSound = (url) => {
    playSilence();
    const request = new XMLHttpRequest();
    request.open("GET", url, true);
    request.responseType = "arraybuffer";
    request.onload = () => {
      context.decodeAudioData(request.response, (buffer) => {
        loaded = true;
        musicBuffer = buffer;
        if (playing) {
          play(musicBuffer);
        }
      });
    };
    request.send();
  };
  let dataArray = null;
  map.on("load", () => {
    const maxHeight = 200;
    const binWidth = maxHeight / bins;
    for (let i = 0; i < bins; i++) {
      map.addLayer({
        id: "3d-buildings-" + i,
        source: "openmaptiles",
        "source-layer": "building",
        filter: [
          "all",
          [">", "render_height", i * binWidth],
          ["<=", "render_height", (i + 1) * binWidth]
        ],
        type: "fill-extrusion",
        paint: {
          "fill-extrusion-color": "#aaa",
          "fill-extrusion-height-transition": {
            duration: 0,
            delay: 0
          },
          "fill-extrusion-opacity": 0.6
        }
      });
    }
    dataArray = new Uint8Array(bins);
  });
  let requestId = null;
  const draw = (now) => {
    analyser.getByteFrequencyData(dataArray);
    let avg = 0;
    for (let i = 0; i < bins; i++) {
      avg += dataArray[i];
      map.setPaintProperty("3d-buildings-" + i, "fill-extrusion-height", 10 + 4 * i + dataArray[i]);
    }
    avg /= bins;
    map.setBearing(now / 500);
    map.setLight({
      color: "hsl(" + now / 100 % 360 + "," + Math.min(50 + avg / 4, 100) + "%,50%)",
      intensity: Math.min(1, avg / 256 * 10)
    });
    requestId = requestAnimationFrame(draw);
  };
  const btn = document.getElementById("button");
  btn.addEventListener("click", () => {
    if (!playing) {
      if (!loaded) {
        loadSound("https://archive.org/download/OTMN051/3_memory-of-the-cartridge.mp3");
      } else {
        playSilence();
        play(musicBuffer);
      }
      requestId = requestAnimationFrame(draw);
      btn.textContent = "Stop";
    } else {
      if (loaded) {
        !bufferSource || bufferSource.stop();
        bufferSource = null;
      }
      cancelAnimationFrame(requestId);
      requestId = null;
      btn.textContent = "Play";
    }
    playing = !playing;
  }, false);
})();
